

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/blog/assets/favicon.ico">
  <link rel="icon" href="/blog/assets/favicon.ico">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="毛 俊">
  <meta name="keywords" content="博客,技术,生活,Java,架构,研发,测试,Python,前端,数据库,运维,设计">
  
    <meta name="description" content="考试信息考试时间：3小时满分：300分及格分：210分携带物品：身份证，签字笔(考试会发） 做题注意：如果是服务，都设置下开机启动systemctl enable xxx。 同时设置开启防火墙。 考试是在/etc/selinuxconfig为enforce下进行的,使用命令getenforce可查询状态。Linux命令如果不存在，使用yum whatprovides */semanage,sema">
  
  
  
  <title>红帽RHCSA学习总结 - 毛俊的博客</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/blog/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/blog/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/blog/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="/blog/css/custom.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"maojun.xyz","root":"/blog/","version":"1.9.7","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":"¶"},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"left","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":3},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":{"measurement_id":"G-EEHN1VS01B"},"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/blog/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/blog/js/utils.js" ></script>
  <script  src="/blog/js/color-schema.js" ></script>
  

  

  
    <!-- Google tag (gtag.js) -->
    <script async>
      if (!Fluid.ctx.dnt) {
        Fluid.utils.createScript("https://www.googletagmanager.com/gtag/js?id=G-EEHN1VS01B", function() {
          window.dataLayer = window.dataLayer || [];
          function gtag() {
            dataLayer.push(arguments);
          }
          gtag('js', new Date());
          gtag('config', 'G-EEHN1VS01B');
        });
      }
    </script>
  

  

  

  

  



  
<meta name="generator" content="Hexo 7.1.1"><link rel="alternate" href="/blog/atom.xml" title="毛俊的博客" type="application/atom+xml">
</head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 60vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/blog/">
      <strong>毛俊的博客</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/blog/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/blog/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/blog/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/blog/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/blog/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/blog/assets/banner.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="红帽RHCSA学习总结"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2022-02-11 16:52" pubdate>
          2022年2月11日 下午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          4.8k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          40 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="padding-left: 2rem; margin-right: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">红帽RHCSA学习总结</h1>
            
            
              <div class="markdown-body">
                
                <h2 id="考试信息"><a href="#考试信息" class="headerlink" title="考试信息"></a>考试信息</h2><p>考试时间：3小时<br>满分：300分<br>及格分：210分<br>携带物品：身份证，签字笔(考试会发）</p>
<p>做题注意：<br>如果是服务，都设置下开机启动<code>systemctl enable xxx</code>。 同时设置开启防火墙。 考试是在<code>/etc/selinuxconfig</code>为<strong>enforce</strong>下进行的,使用命令<code>getenforce</code>可查询状态。<br>Linux命令如果不存在，使用<code>yum whatprovides */semanage</code>,semanage可替换成其他命令。在查询结果中找到*.noarch的包，在使用<code>yum install *.noarch -y</code>。<br>所有编写的脚本都设置x执行权限。<br>做完题目后重启机器检查。</p>
<h2 id="网络设置"><a href="#网络设置" class="headerlink" title="网络设置"></a>网络设置</h2><ul>
<li>主机名：node1.domain250.example.com</li>
</ul>
<p>查看现在的主机名：<code>hostname</code><br>修改主机名: <code>hostnamectl set-hostname node1.domain250.example.com</code><br>验证主机名：<code>hostname</code></p>
<blockquote>
<p><em>此题还可以通过编辑</em><code>*/etc/hostname*</code><em>来配置，需要重启才能生效</em></p>
</blockquote>
<ul>
<li>IP 地址：172.25.250.100</li>
</ul>
<p>方法一：<br>查看现在IP地址：<code>ifconfig</code>，记下网卡名称比如:<code>eth0</code><br>修改IP地址:<code>nmtui-edit</code>,删除刚才的网卡名称<code>eth0</code>,再点击<strong>Add</strong>按钮添加一个新的连接，选择<strong>Ethernet</strong>， <strong>Profile name</strong>和<strong>Device</strong>填入对应的网卡名称<code>eth0</code>,再<strong>IPV4 CONFIGURATION</strong>将<strong>Automatic</strong>修改为<strong>Manual</strong>，然后点击<strong>Show</strong>，在<strong>ADddresses</strong>填入<code>172.25.250.100/24</code>,<strong>Gateway</strong>,<strong>DNS servers</strong>依次配置，最后点击<strong>OK</strong>并退出。<br>验证IP地址：<code>ifconfig</code></p>
<blockquote>
<p><em>注意新增无需刷新生效，如果是新修改则需要</em><code>*nmcli device reapply eth0*</code><em>刷新生效</em></p>
</blockquote>
<p>方法二：<br>查看网络设置信息：<code>nmcli connection show</code><br>设置网络：<code>nmcli connection eth0 ipv4.address 172.25.250.100/24 ipv4.getway 172.25.250.254 ipv4.dns 172.25.250.254 ipv4.method manual</code><br>重启生效:<code>nmcli connection up eth0</code></p>
<p>方法三：<br>通过vim编辑配置文件 <code>vim /etc/sysconfig/network-scripts/ifcfg-eth0</code></p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">TYPE</span>=Ethernet<br><span class="hljs-attr">PROXY_METHOD</span>=none<br><span class="hljs-attr">BROWSER_ONLY</span>=<span class="hljs-literal">no</span><br><span class="hljs-attr">BOOTPROTO</span>=static<br><span class="hljs-attr">IPADDR</span>=<span class="hljs-number">172.25</span>.<span class="hljs-number">250.100</span><br><span class="hljs-attr">PREFIX</span>=<span class="hljs-number">24</span><br><span class="hljs-attr">GATEWAY</span>=<span class="hljs-number">172.25</span>.<span class="hljs-number">250.254</span><br><span class="hljs-attr">DNS1</span>=<span class="hljs-number">172.25</span>.<span class="hljs-number">250.254</span><br><span class="hljs-attr">DEFROUTE</span>=<span class="hljs-literal">yes</span><br><span class="hljs-attr">IPV4_FAILURE_FATAL</span>=<span class="hljs-literal">no</span><br><span class="hljs-attr">IPV6INIT</span>=<span class="hljs-literal">yes</span><br><span class="hljs-attr">IPV6_AUTOCONF</span>=<span class="hljs-literal">yes</span><br><span class="hljs-attr">IPV6_DEFROUTE</span>=<span class="hljs-literal">yes</span><br><span class="hljs-attr">IPV6_FAILURE_FATAL</span>=<span class="hljs-literal">no</span><br><span class="hljs-attr">IPV6_ADDR_GEN_MODE</span>=stable-privacy<br><span class="hljs-attr">NAME</span>=eth0<br><span class="hljs-attr">UUID</span>=e5d912ab-<span class="hljs-number">45</span>ae-<span class="hljs-number">4</span>d2d-<span class="hljs-number">85</span>fa-<span class="hljs-number">0</span>ea82150b3bb<br><span class="hljs-attr">DEVICE</span>=eth0<br><span class="hljs-attr">ONBOOT</span>=<span class="hljs-literal">yes</span><br></code></pre></td></tr></table></figure>

<blockquote>
<p><em>需要刷新网络（考试环境无法刷新）或重启生效</em></p>
</blockquote>
<ul>
<li>子网掩码：255.255.255.0</li>
</ul>
<p>无需配置，默认。<br>验证:<code>ifconfig</code></p>
<ul>
<li>网关：172.25.250.254</li>
</ul>
<p>同IP配置。<br>验证:<code>ifconfig</code></p>
<ul>
<li>DNS服务器：172.25.250.254</li>
</ul>
<p>同IP配置。<br>验证：<code>netstat -nr</code>或<code>route -n</code>或<code>nslookup node1</code></p>
<h2 id="配置您的系统以使用默认存储库"><a href="#配置您的系统以使用默认存储库" class="headerlink" title="配置您的系统以使用默认存储库"></a>配置您的系统以使用默认存储库</h2><p>YUM 存储库已可以从 <a target="_blank" rel="noopener" href="http://foundation0.ilt.example.com/dvd/BaseOS">http://foundation0.ilt.example.com/dvd/BaseOS</a> 和 <a target="_blank" rel="noopener" href="http://foundation0.ilt.example.com/dvd/AppStream">http://foundation0.ilt.example.com/dvd/AppStream</a> 使用配置您的系统，以将这些位置用作默认存储库</p>
<p>进入<code>/etc/yum.repos.d</code>，任意起名一个文件，以<code>.repo</code>结尾，在文件中增加以下配置内容:</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-section">[BaseOS]</span><br><span class="hljs-attr">name</span>=BaseOS<br><span class="hljs-attr">baseurl</span>=http://foundation0.ilt.example.com/dvd/BaseOS<br><span class="hljs-attr">enabled</span>=<span class="hljs-number">1</span><br><span class="hljs-attr">gpgcheck</span>=<span class="hljs-number">0</span>[AppStream]<br><span class="hljs-attr">name</span>=AppStream<br><span class="hljs-attr">baseurl</span>=http://foundation0.ilt.example.com/dvd/AppStream<br><span class="hljs-attr">enabled</span>=<span class="hljs-number">1</span><br><span class="hljs-attr">gpgcheck</span>=<span class="hljs-number">0</span><br></code></pre></td></tr></table></figure>

<p>检查：</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ada">yum clean <span class="hljs-keyword">all</span><br>yum repolist <span class="hljs-keyword">all</span><br></code></pre></td></tr></table></figure>

<p>能在命令行输出中看到配置的两个仓库地址即配置成功。</p>
<blockquote>
<p><em>可以使用</em><code>*yum list all*</code><em>来校验仓库地址是否有配错</em></p>
</blockquote>
<h2 id="调试-SELinux"><a href="#调试-SELinux" class="headerlink" title="调试 SELinux"></a>调试 SELinux</h2><p>非标准端口 82 上运行的 Web 服务器在提供内容时遇到问题。根据需要调试并解决问题，使其满足以下条件：</p>
<ul>
<li>系统上的 Web 服务器能够提供 &#x2F;var&#x2F;www&#x2F;html 中所有现有的 HTML 文件（注：不要删除或以其他方式改动现有的文件内容）</li>
<li>Web 服务器在端口 82 上提供此内容</li>
<li>Web 服务器在系统启动时自动启动</li>
</ul>
<p>82端口启动失败，发现是semanage中并没有加入http的82端口</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">semanage</span> port -l |grep http<br><span class="hljs-attribute">http_cache_port_t</span>              tcp      <span class="hljs-number">8080</span>, <span class="hljs-number">8118</span>, <span class="hljs-number">8123</span>, <span class="hljs-number">10001</span>-<span class="hljs-number">10010</span><br><span class="hljs-attribute">http_cache_port_t</span>              udp      <span class="hljs-number">3130</span><br><span class="hljs-attribute">http_port_t</span>                    tcp      <span class="hljs-number">80</span>, <span class="hljs-number">81</span>, <span class="hljs-number">443</span>, <span class="hljs-number">488</span>, <span class="hljs-number">8008</span>, <span class="hljs-number">8009</span>, <span class="hljs-number">8443</span>, <span class="hljs-number">9000</span><br><span class="hljs-attribute">pegasus_http_port_t</span>            tcp      <span class="hljs-number">5988</span><br><span class="hljs-attribute">pegasus_https_port_t</span>           tcp      <span class="hljs-number">5989</span><br></code></pre></td></tr></table></figure>

<p>添加82端口：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">semanage port -<span class="hljs-selector-tag">a</span> -t http_port_t  -<span class="hljs-selector-tag">p</span> tcp <span class="hljs-number">82</span><br></code></pre></td></tr></table></figure>

<p>如果配置错了，可以使用修改命令：</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">semanage</span> port -m -t http_port_t  -p tcp <span class="hljs-number">82</span><br></code></pre></td></tr></table></figure>

<blockquote>
<p><em>semanager可以参考<br>grep semanage &#x2F;etc&#x2F;ssh&#x2F;sshd_config<br>#semanage port -a -t ssh_port_t -p tcp #PORTNUMBER</em></p>
</blockquote>
<p>开启访问墙端口放行：</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile">firewall-<span class="hljs-keyword">cmd</span><span class="language-bash"> --add-port=82/tcp --permanent</span><br><span class="hljs-comment"># reload</span><br>firewall-<span class="hljs-keyword">cmd</span><span class="language-bash"> --reload</span><br></code></pre></td></tr></table></figure>

<blockquote>
<p><em>查看httpd端口</em><code>*vim /etc/httpd/conf/httpd.conf*</code>*<br>检查httpd服务状态:<em><code>*systemctl status httpd*</code></em><br>启动httpd服务:<em><code>*systemctl start httpd*</code></em><br>重启httpd服务:<em><code>*systemctl restart httpd*</code></em><br>开启启动httpd:*<code>*systemctl enable httpd*</code></p>
</blockquote>
<p>验证：</p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c">semanage port -l <span class="hljs-string">|grep http</span><br></code></pre></td></tr></table></figure>

<p>在http里面查看到82端口即可，同时curl访问文件有返回内容<code>curl 127.0.0.1:82/file</code></p>
<p>额外的练习： 以下内容考试不需要做:</p>
<p>查看静态资源文件下的file1文件权限：</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs dts">ls -Zd <span class="hljs-keyword">/var/</span>www<span class="hljs-keyword">/html/</span>*<br><span class="hljs-symbol">              system_u:</span>object_r:etc_t:s0 <span class="hljs-keyword">/var/</span>www<span class="hljs-keyword">/html/</span>file1<br><span class="hljs-symbol">system_u:</span>object_r:httpd_sys_content_t:s0 <span class="hljs-keyword">/var/</span>www<span class="hljs-keyword">/html/</span>file2<br><span class="hljs-symbol">system_u:</span>object_r:httpd_sys_content_t:s0 <span class="hljs-keyword">/var/</span>www<span class="hljs-keyword">/html/</span>file3<br></code></pre></td></tr></table></figure>

<p>修改file1的文件权限同file2和file3:</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">semanage fcontext -a -t httpd_sys_content_t <span class="hljs-regexp">/var/</span>www<span class="hljs-regexp">/html/</span>file1<br><span class="hljs-comment"># 刷新配置</span><br>restorecon -R -v <span class="hljs-regexp">/var/</span>www<span class="hljs-regexp">/html/</span><br></code></pre></td></tr></table></figure>

<h2 id="创建用户帐户"><a href="#创建用户帐户" class="headerlink" title="创建用户帐户"></a>创建用户帐户</h2><p>创建下列用户、组和组成员资格：</p>
<ul>
<li>名为 sysmgrs 的组</li>
</ul>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">groupadd sysmgrs</span><br></code></pre></td></tr></table></figure>

<p>验证:</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gradle"><span class="hljs-keyword">grep</span> sysmgrs <span class="hljs-regexp">/etc/g</span>roup<br></code></pre></td></tr></table></figure>

<ul>
<li>用户 natasha ，作为次要组从属于 sysmgrs</li>
</ul>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">useradd -G sysmgrs natasha</span><br></code></pre></td></tr></table></figure>

<p>验证：</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript"><span class="hljs-built_in">id</span> natasha<br></code></pre></td></tr></table></figure>

<ul>
<li>用户 harry ，作为次要组还从属于 sysmgrs</li>
</ul>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">useradd -G sysmgrs harry</span><br></code></pre></td></tr></table></figure>

<p>验证：</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript"><span class="hljs-built_in">id</span> harry<br></code></pre></td></tr></table></figure>

<ul>
<li>用户 sarah ，无权访问系统上的交互式 shell 且不是 sysmgrs 的成员</li>
</ul>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">useradd  sarah -s <span class="hljs-regexp">/sbin/</span>nologin<br></code></pre></td></tr></table></figure>

<blockquote>
<p><em>非交互式shell可以是</em><code>*/bin/false*</code><em>或</em><code>*/sbin/nologin*</code></p>
</blockquote>
<p>验证：<br>sarah无法使登入ssh或者查看shell: <code>grep sarah /etc/passed</code></p>
<ul>
<li>natasha 、 harry 和 sarah 的密码应当都是 flectrag</li>
</ul>
<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli"><span class="hljs-keyword">echo</span> flectrag | passwd <span class="hljs-params">--stdin</span> natasha<br><span class="hljs-keyword">echo</span> flectrag | passwd <span class="hljs-params">--stdin</span> harry<br><span class="hljs-keyword">echo</span> flectrag | passwd <span class="hljs-params">--stdin</span> sarah<br></code></pre></td></tr></table></figure>

<p>验证：<br>natasha和harry可以使用密码登入ssh</p>
<h2 id="配置-cron-作业"><a href="#配置-cron-作业" class="headerlink" title="配置 cron 作业"></a>配置 cron 作业</h2><p>配置 cron 作业，该作业每隔 2 分钟运行并执行以下命令:<br>logger “EX200 in progress”，以用户 natasha 身份运行</p>
<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">crontab -u natasha -e<br>*<span class="hljs-string">/2</span> * * * * logger <span class="hljs-string">&quot;EX200 in progress&quot;</span><br></code></pre></td></tr></table></figure>

<p>验证：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-keyword">grep</span> EX200 /var/<span class="hljs-built_in">log</span>/<span class="hljs-keyword">messages</span><br></code></pre></td></tr></table></figure>

<h2 id="创建协作目录"><a href="#创建协作目录" class="headerlink" title="创建协作目录"></a>创建协作目录</h2><p>创建具有以下特征的协作目录 &#x2F;home&#x2F;managers ：</p>
<ul>
<li>&#x2F;home&#x2F;managers 的组用权是 sysmgrs</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">chgrp</span> sysmgrs /home/managers<br></code></pre></td></tr></table></figure>

<ul>
<li>目录应当可被 sysmgrs 的成员读取、写入和访问，但任何其他用户不具这些权限。（当然，root 用户有权访问系统上的所有文件和目录）</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">chmod</span> g+rw,o-rw /home/managers<br></code></pre></td></tr></table></figure>

<ul>
<li>&#x2F;home&#x2F;managers 中创建的文件自动将组所有权设置到 sysmgrs 组</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">chmod</span> g+s /home/managers<br></code></pre></td></tr></table></figure>

<p>验证:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">ls</span> -ld /home/managers<br></code></pre></td></tr></table></figure>

<p>去<code>/home/managers</code>中创建文件，查看文件属性，确认后删除该文件。</p>
<h2 id="配置-NTP"><a href="#配置-NTP" class="headerlink" title="配置 NTP"></a>配置 NTP</h2><p>配置您的系统，使其成为 materials.example.com 的 NTP 客户端。（注：materials.example.com 是 classroom.example.com 的 DNS 别名）</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs routeros">vim /etc/chrony.conf<br><span class="hljs-comment"># 添加配置</span><span class="hljs-built_in"></span><br><span class="hljs-built_in">server </span>materials.example.com iburst<br><span class="hljs-comment"># 重启服务</span><br>systemctl restart chronyd<br><span class="hljs-comment"># 开机启动</span><br>systemctl <span class="hljs-built_in">enable</span> chronyd<br></code></pre></td></tr></table></figure>

<p>验证:</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">chronyc sources</span><br></code></pre></td></tr></table></figure>

<h2 id="配置-autofs"><a href="#配置-autofs" class="headerlink" title="配置 autofs"></a>配置 autofs</h2><p>配置 autofs ，以按照如下所述自动挂载远程用户的主目录：</p>
<ul>
<li>materials.example.com ( 172.25.254.254 ) NFS 导出 &#x2F;rhome 到您的系统。此文件系统包含为用户 remoteuser1 预配置的主目录</li>
<li>remoteuser1 的主目录是 materials.example.com:&#x2F;rhome&#x2F;remoteuser1</li>
<li>remoteuser1 的主目录应自动挂载到本地 &#x2F;rhome 下的 &#x2F;rhome&#x2F;remoteuser1</li>
<li>主目录必须可供其用户写入</li>
<li>remoteuser1 的密码是 flectrag</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#新建编辑</span><br>vim /etc/auto.master.d/rhcsa.autofs<br><span class="hljs-comment">#添加以下内容</span><br>/rhome /etc/rhcsa.misc<br><span class="hljs-comment">#新建编辑/etc/rhcsa.misc</span><br>vim /etc/rhcsa.misc<br>remoteuser1     -fstype=nfs,rw    materials.example.com:/rhome/remoteuser1<br></code></pre></td></tr></table></figure>

<blockquote>
<p><em>注意&#x2F;rhome&#x2F;remoteuser1 如果有多级目录如&#x2F;rhome&#x2F;b&#x2F;c&#x2F;remoteuser1，则需要在rhcsa.autofs配置多级&#x2F;rhome&#x2F;a&#x2F;b。</em></p>
</blockquote>
<p>重启配置：</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">systemctl restart <span class="hljs-built_in">auto</span>fs<br></code></pre></td></tr></table></figure>

<p>开机启动：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">systemctl <span class="hljs-built_in">enable</span> autofs<br></code></pre></td></tr></table></figure>

<p>验证：<br><code>su - remoteuser1</code> 或者<code>cd /rhome/remoteuse1</code></p>
<h2 id="配置-var-tmp-fstab-权限"><a href="#配置-var-tmp-fstab-权限" class="headerlink" title="配置 &#x2F;var&#x2F;tmp&#x2F;fstab 权限"></a>配置 &#x2F;var&#x2F;tmp&#x2F;fstab 权限</h2><p>将文件 &#x2F;etc&#x2F;fstab 复制到 &#x2F;var&#x2F;tmp&#x2F;fstab 。配置 &#x2F;var&#x2F;tmp&#x2F;fstab 的权限以满足如下条件：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cp</span> -a /etc/fstab /var/tmp/fstab<br></code></pre></td></tr></table></figure>

<ul>
<li>文件 &#x2F;var&#x2F;tmp&#x2F;fstab 自 root 用户所有<br>无需修改</li>
<li>文件 &#x2F;var&#x2F;tmp&#x2F;fstab 属于组 root<br>无需修改</li>
<li>文件 &#x2F;var&#x2F;tmp&#x2F;fstab 应不能被任何人执行<br>无需修改</li>
<li>用户 natasha 能够读取和写入 &#x2F;var&#x2F;tmp&#x2F;fstab<br><code>setfacl -m u:natasha:rw /var/tmp/fstab</code></li>
<li>用户 harry 无法写入或读取 &#x2F;var&#x2F;tmp&#x2F;fstab<br><code>setfacl -m u:harry:- /var/tmp/fstab</code></li>
<li>所有其他用户（当前或未来）能够读取 &#x2F;var&#x2F;tmp&#x2F;fstab<br>无需修改</li>
</ul>
<p>验证：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#查看文件信息</span><br><span class="hljs-built_in">ls</span> -ld /var/tmp/fstab<br><span class="hljs-comment"># 验证文件权限</span><br>getfacl /var/tmp/fstab<br></code></pre></td></tr></table></figure>

<blockquote>
<p><em>查看帮助里面的例子：</em><code>*man setfacl |grep -A8 -i example*</code></p>
</blockquote>
<h2 id="配置用户帐号"><a href="#配置用户帐号" class="headerlink" title="配置用户帐号"></a>配置用户帐号</h2><p>配置用户 manalo ，其用户 ID 为 3533。此用户的密码应当为 flectrag。</p>
<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli"><span class="hljs-comment"># 创建用户并设置uid</span><br>useradd -u 3533 manalo<br><span class="hljs-comment"># 设置密码</span><br><span class="hljs-keyword">echo</span> flectrag | passwd <span class="hljs-params">--stdin</span> manalo<br></code></pre></td></tr></table></figure>

<p>验证：</p>
<p>查看uid:<code>id manalo</code><br>验证密码:<code>ssh manalo @localhost</code></p>
<p>或者使用远程执行ssh命令验证:<code>ssh manalo@localhost id</code></p>
<h2 id="查找文件"><a href="#查找文件" class="headerlink" title="查找文件"></a>查找文件</h2><p>查找当 jacques 所有的所有文件并将其副本放入 &#x2F;root&#x2F;findfiles 目录。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">find / -user jacques -<span class="hljs-built_in">exec</span> <span class="hljs-built_in">cp</span> -a &#123;&#125; /root/findfiles/ \;<br></code></pre></td></tr></table></figure>

<p>验证:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">ls</span> -l /root/findfiles<br></code></pre></td></tr></table></figure>

<p>找出&#x2F;etc目录下大小超过5MB的文件，并将其副本放入 &#x2F;root&#x2F;findfiles 目录。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">find /etc/ -size +5M -<span class="hljs-built_in">exec</span> <span class="hljs-built_in">cp</span> -a &#123;&#125; /root/findfiles/ \;<br></code></pre></td></tr></table></figure>

<p>验证:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">ls</span> -l /root/findfiles<br></code></pre></td></tr></table></figure>

<h2 id="查找字符串"><a href="#查找字符串" class="headerlink" title="查找字符串"></a>查找字符串</h2><p>查找文件 &#x2F;usr&#x2F;share&#x2F;xml&#x2F;iso-codes&#x2F;iso_639_3.xml 中包含字符串 ng 的所有行。将所有这些行的副本按原始顺序放在文件 &#x2F;root&#x2F;list 中。 &#x2F;root&#x2F;list 不得包含空行，且所有行必须是 &#x2F;usr&#x2F;share&#x2F;xml&#x2F;iso-codes&#x2F;iso_639_3.xml 中原始行的确切副本。</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gradle"><span class="hljs-keyword">grep</span> ng <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/xml/i</span>so-codes<span class="hljs-regexp">/iso_639_3.xml &gt; /</span>root/list<br></code></pre></td></tr></table></figure>

<p>验证：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> /root/list<br></code></pre></td></tr></table></figure>

<h2 id="创建存档"><a href="#创建存档" class="headerlink" title="创建存档"></a>创建存档</h2><p>创建一个名为 &#x2F;root&#x2F;backup.tar.gz 的 tar 存档，其应包含 &#x2F;usr&#x2F;local 的 tar 存档，其应包含 &#x2F;usr&#x2F;local 的内容。该 tar 存档必须使用 gzip 进行压缩。</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">tar -zcvf <span class="hljs-regexp">/root/</span>backup.tar.gz <span class="hljs-regexp">/usr/</span>local<br></code></pre></td></tr></table></figure>

<p>验证：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-comment"># 查看文件类型</span><br>file <span class="hljs-regexp">/root/</span>backup.tar.gz<br><span class="hljs-comment"># 查看压缩包内容</span><br>tar -tf <span class="hljs-regexp">/root/</span>backup.tar.gz<br></code></pre></td></tr></table></figure>

<blockquote>
<p><em>gzip压缩或bzip2压缩查阅参数</em><code>*man tar |egrep &#39;gzip|bzip2&#39;*</code></p>
</blockquote>
<h2 id="sudo提权"><a href="#sudo提权" class="headerlink" title="sudo提权"></a>sudo提权</h2><p>配置sudo提权，允许admins组的成员可以以root身份执行命令，且不需要输入密码。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs perl"><span class="hljs-comment"># 复制模板</span><br><span class="hljs-keyword">grep</span> wheel /etc/sudoers &gt; <span class="hljs-regexp">/etc/sud</span>oers.d/admins<br><span class="hljs-comment"># 编辑/etc/sudoers.d/admins内容</span><br>%admins ALL=(ALL)       NOPASSWD: ALL<br></code></pre></td></tr></table></figure>

<h2 id="密码过期"><a href="#密码过期" class="headerlink" title="密码过期"></a>密码过期</h2><p>设置新建用户的密码20天过期。</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-comment"># 编辑配置文件</span><br><span class="hljs-attribute">vim</span> /etc/login.defs<br><span class="hljs-comment"># 修改密码20天过期</span><br><span class="hljs-attribute">PASS_MAX_DAYS</span>   <span class="hljs-number">20</span><br></code></pre></td></tr></table></figure>

<h2 id="配置容器使其自动启动"><a href="#配置容器使其自动启动" class="headerlink" title="配置容器使其自动启动"></a>配置容器使其自动启动</h2><p>利用注册服务器上的 rsyslog 镜像，创建一个名为 logserver 的容器 这两道容器题目需要结合来做，根据步骤来做题。</p>
<ul>
<li>面向 wallah 用户，配置一个 systemd 服务</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 步骤四</span><br><span class="hljs-comment"># 创建systemd 用户目录</span><br><span class="hljs-built_in">mkdir</span> -p ~/.config/systemd/user<br><span class="hljs-comment"># 进入systemd 用户目录</span><br><span class="hljs-built_in">cd</span> .config/systemd/user/<br></code></pre></td></tr></table></figure>

<ul>
<li>该服务命名为 container-logserver ，并在系统重启时自动启动，无需干预</li>
</ul>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs crmsh"><span class="hljs-comment"># 步骤五</span><br><span class="hljs-comment"># 停止容器服务</span><br>podman <span class="hljs-literal">stop</span> logserver<br><span class="hljs-comment"># 检查 systemd 控制权的状态</span><br>loginctl enable-linger wallah<br>loginctl show-<span class="hljs-keyword">user</span> <span class="hljs-title">wallah</span><br><span class="hljs-comment"># 生成systemd服务</span><br>podman generate systemd -n logserver  -f<br><span class="hljs-comment"># 开机启动</span><br>systemctl --<span class="hljs-keyword">user</span> <span class="hljs-title">enable</span> --now container-logserver.service<br><span class="hljs-comment"># 查看状态</span><br>systemctl --<span class="hljs-keyword">user</span> <span class="hljs-title">status</span> container-logserver<br></code></pre></td></tr></table></figure>

<blockquote>
<p><em>注意题目描述服务命名为 container-logserver，这里创建时不需要额外加container，直接使用logserver创建后会自动加上。</em></p>
</blockquote>
<p>验证：</p>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs crmsh"><span class="hljs-comment"># 查看Linger=no是否变为yes</span><br>loginctl show-<span class="hljs-keyword">user</span> <span class="hljs-title">wallah</span><br><span class="hljs-comment"># 查看是否开机启动</span><br>systemctl --<span class="hljs-keyword">user</span> <span class="hljs-title">is-enabled</span>  container-logserver.service<br></code></pre></td></tr></table></figure>

<blockquote>
<p><em>如果重新生成了systemc服务，并且是同名的。则使用</em><code>*systemctl --user daemon-reload*</code><em>刷新生效</em></p>
</blockquote>
<h2 id="为容器配置持久存储"><a href="#为容器配置持久存储" class="headerlink" title="为容器配置持久存储"></a>为容器配置持久存储</h2><p>通过以下方式扩展上一个任务的服务</p>
<ul>
<li>配置主机系统的 journald 日志以在系统重启后保留数据，并重新启动日志记录服务</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 步骤一# 先查看所需要的所有者和所属组</span><br>ll -d /run/log/journal<br><span class="hljs-comment"># 检查目录/var/log/journal 是否存在，没有就创建</span><br><span class="hljs-built_in">mkdir</span> /var/log/journa<br><span class="hljs-comment"># 和/run/log/journal一样的用户和组权限</span><br><span class="hljs-built_in">chown</span> root:systemd-journal /var/log/journal<br><span class="hljs-built_in">chmod</span> 2755 /var/log/journa<br><span class="hljs-comment"># 重启日志记录服务systemctl </span><br>restart systemd-journald<br><span class="hljs-comment"># 设置容器永久化</span><br>vim /etc/systemd/journald.conf<br><span class="hljs-comment"># 将Storage=auto内容修改为Storage=persistent</span><br></code></pre></td></tr></table></figure>

<ul>
<li>将主机 &#x2F;var&#x2F;log&#x2F;journal目录下任何以 *.journal 的文件复制到 &#x2F;home&#x2F;wallah&#x2F;container_logfile 中</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 步骤二</span><br><span class="hljs-comment"># 将日志拷贝到指定目录</span><br><span class="hljs-built_in">cp</span> -a /var/log/journal/*/*.journal /home/wallah/container_logfile/<br><span class="hljs-comment"># 修改文件权限</span><br><span class="hljs-built_in">chown</span> -R wallah /home/wallah/<br><span class="hljs-comment"># 修改wallah密码</span><br><span class="hljs-built_in">echo</span> flectrag | passwd --stdin wallah<br></code></pre></td></tr></table></figure>

<ul>
<li>将服务配置为在启动时自动将 &#x2F;home&#x2F;wallah&#x2F;container_logfile 挂载到容器中的 &#x2F;var&#x2F;log&#x2F;journal 下</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">步骤三</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">ssh到wallah</span><br>ssh wallah @node1<br><span class="hljs-meta prompt_"># </span><span class="language-bash">登入镜像仓库podman login registry.domain250.example.com</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">拉取镜像podman pull rhel8/rsyslog</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">启动容器并挂载目录podman run -d --name logserver -v /home/wallah/container_logfile:/var/log/journal:Zregistry.domain250.example.com/rhel8/rsyslog</span><br></code></pre></td></tr></table></figure>

<blockquote>
<p><em>登入时提示错误</em>Error: error authenticating creds for “registry.domain250.example.com”: error pinging docker registry registry.domain250.example.com: Get <a target="_blank" rel="noopener" href="https://registry.domain250.example.com/v2/">https://registry.domain250.example.com/v2/</a>: x509: certificate has expired or is not yet valid<em>，解决思路：</em> <code>*man podman login |grep -A8 certificates*</code></p>
</blockquote>
<p>验证：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">在容器里执行命令查看日志文件podman <span class="hljs-built_in">exec</span> logserver <span class="hljs-built_in">ls</span> /var/log/journal</span><br></code></pre></td></tr></table></figure>

<h2 id="设置-root-密码"><a href="#设置-root-密码" class="headerlink" title="设置 root 密码"></a>设置 root 密码</h2><p>将 node2 的 root 密码设置为 flectrag 。您需要获得系统访问权限才能进行此操作。 这道题是在不知道node2密码的前提下设置root密码。</p>
<p>关机，开机（使用重启时来不及打开控制台就进入系统了）。在第一个选项中输入e，进入编辑模式，在<strong>Linux</strong>开头的那行ctrl+e，进入末尾，空格，输入<code>rd.break</code>,然后按<code>ctrl+x</code>，等待进入<strong>switch_root</strong>终端界面后,在终端输入命令:</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs awk">mount -o remount,rw <span class="hljs-regexp">/sysroot/</span><br>chroot <span class="hljs-regexp">/sysroot/</span><br><span class="hljs-comment"># 修改root密码</span><br>echo flectrag | passwd --stdin root<br>touch /.autorelabel<br><span class="hljs-keyword">exit</span><br><span class="hljs-keyword">exit</span><br></code></pre></td></tr></table></figure>

<h2 id="预先创建2G的分区-dev-vdb1-并用于创建卷组testvg"><a href="#预先创建2G的分区-dev-vdb1-并用于创建卷组testvg" class="headerlink" title="预先创建2G的分区&#x2F;dev&#x2F;vdb1,并用于创建卷组testvg"></a>预先创建2G的分区&#x2F;dev&#x2F;vdb1,并用于创建卷组testvg</h2><p>提示: lvm结构 从下到上 pp pv vg lg</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-comment"># 创建pp</span><br><span class="hljs-comment"># 查看块设备</span><br><span class="hljs-attribute">lsblk</span><br><span class="hljs-comment"># 分区</span><br><span class="hljs-attribute">fdisk</span> /dev/vdb<br><span class="hljs-comment"># 进入fdisk交互界面</span><br><span class="hljs-comment"># 查看分区信息</span><br><span class="hljs-attribute">p</span><br><span class="hljs-comment"># 增加新分区</span><br><span class="hljs-attribute">n</span><br><span class="hljs-comment"># 添加主分区(p）或扩展分区(e)</span><br><span class="hljs-attribute">p</span><br><span class="hljs-comment"># 分区信息，前2个默认即可,直接回车</span><br><span class="hljs-attribute">Partition</span> number (<span class="hljs-number">1</span>,<span class="hljs-number">2</span>, default <span class="hljs-number">1</span>):<br><span class="hljs-attribute">First</span> sector (<span class="hljs-number">2095106</span>-<span class="hljs-number">8388607</span>, default <span class="hljs-number">2097152</span>):<br><span class="hljs-comment"># 设置结束分区大小</span><br><span class="hljs-attribute">Last</span> sector, +sectors or +size&#123;K,M,G,T,P&#125; (<span class="hljs-number">2097152</span>-<span class="hljs-number">8388607</span>, default <span class="hljs-number">8388607</span>): +<span class="hljs-number">2</span>G<br><span class="hljs-comment"># 保存</span><br><span class="hljs-attribute">w</span><br><span class="hljs-comment"># 再次查看块设备</span><br><span class="hljs-attribute">lsblk</span><br><span class="hljs-comment"># 创建pv</span><br><span class="hljs-attribute">pvcreate</span> /dev/vdb1<br><span class="hljs-attribute">Physical</span> volume <span class="hljs-string">&quot;/dev/vdb1&quot;</span> successfully created.<br><span class="hljs-comment">#查看</span><br><span class="hljs-attribute">pvs</span><br><span class="hljs-comment"># 创建vg</span><br><span class="hljs-attribute">vgcreate</span> testvg /dev/vdb1<br><span class="hljs-attribute">Volume</span> group <span class="hljs-string">&quot;testvg&quot;</span> successfully created<br><span class="hljs-comment"># 查看</span><br><span class="hljs-attribute">vgs</span><br></code></pre></td></tr></table></figure>

<h2 id="创建大小为200M的逻辑卷-dev-testvg-vo-格式化为xfs文件系统，并挂载在-mnt-vo上"><a href="#创建大小为200M的逻辑卷-dev-testvg-vo-格式化为xfs文件系统，并挂载在-mnt-vo上" class="headerlink" title="创建大小为200M的逻辑卷&#x2F;dev&#x2F;testvg&#x2F;vo,格式化为xfs文件系统，并挂载在&#x2F;mnt&#x2F;vo上"></a>创建大小为200M的逻辑卷&#x2F;dev&#x2F;testvg&#x2F;vo,格式化为xfs文件系统，并挂载在&#x2F;mnt&#x2F;vo上</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 创建lv</span><br>lvcreate -L 200M -n vo testvg<br>Logical volume <span class="hljs-string">&quot;vo&quot;</span> created.<br><span class="hljs-comment"># 查看</span><br>lvs<br><span class="hljs-comment"># 格式化</span><br>mkfs.xfs /dev/testvg/vo<br><span class="hljs-comment">#查看块信息</span><br>blkid<br>/dev/mapper/testvg-vo: UUID=<span class="hljs-string">&quot;61414b60-5003-48ed-94ec-14a6a7d69b67&quot;</span> TYPE=<span class="hljs-string">&quot;xfs&quot;</span><br><span class="hljs-comment"># 永久挂载</span><br>vim /etc/fstab<br><span class="hljs-comment"># 添加以下内容</span><br>dev/mapper/testvg-vo /mnt/vo xfs defaults        0 0<br><span class="hljs-comment"># 刷新挂载</span><br>mount -a<br><span class="hljs-comment"># 查看</span><br><span class="hljs-built_in">df</span> -hT<br></code></pre></td></tr></table></figure>

<h2 id="设置逻辑卷大小"><a href="#设置逻辑卷大小" class="headerlink" title="设置逻辑卷大小"></a>设置逻辑卷大小</h2><p>将逻辑卷 vo 及其文件系统的大小调整到 230 MiB。确保文件系统内容保持不变。注：分区大小很少与请求的大小完全相同，因此可以接受范围为 217 MiB 到 243 MiB 的大小。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># ext4</span><br><span class="hljs-comment"># 查看volo逻辑卷</span><br><span class="hljs-built_in">df</span> -hT |grep vo<br>/dev/mapper/myvol-vo ext4      175M  1.6M  160M   1% /reports<br><span class="hljs-comment"># 扩展逻辑卷</span><br>lvextend -L 230M /dev/mapper/myvol-vo<br><span class="hljs-comment"># 应用扩展(ext4格式),后面跟随逻辑卷的路径</span><br>resize2fs /dev/mapper/myvol-vo<br><span class="hljs-comment"># 如果是xfs格式</span><br><span class="hljs-comment"># xfs_growfs /reports</span><br><span class="hljs-comment"># xfs</span><br><span class="hljs-built_in">df</span> -hT |grep vo<br>/dev/mapper/testvg-vo xfs       195M   12M  184M   6% /mnt/vo<br>lvextend -L 300M /dev/mapper/testvg-vo<br><span class="hljs-comment"># xfs后面跟随挂载点路径</span><br>xfs_growfs /mnt/vo<br></code></pre></td></tr></table></figure>

<blockquote>
<p><em>注意：</em><code>*lvextend -L 230M /dev/mapper/myvol-vo*</code><em>和</em><code>*resize2fs /dev/mapper/myvol-vo*</code><em>可以合并为一步</em><code>*lvextend -L 230M -r /dev/mapper/myvol-vo*</code></p>
</blockquote>
<h2 id="添加交换分区"><a href="#添加交换分区" class="headerlink" title="添加交换分区"></a>添加交换分区</h2><p>向您的系统添加一个额外的交换分区 756MiB 。交换分区应在系统启动时自动挂载。不要删除或以任何方式改动系统上的任何现有交换分区。</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs autoit"><span class="hljs-meta"># 做题要先lsblk查看块设备，能在同个块上做的就在同块上做，保留完整的块做后面的题</span><br><span class="hljs-meta"># 查看块设备，找到符合大小的块设备</span><br>lsblk<br>fdisk /dev/vdb<br><span class="hljs-meta"># 新建分区</span><br>n<br><span class="hljs-meta"># 划分分区大小</span><br>Partition <span class="hljs-built_in">number</span> (<span class="hljs-number">3</span>,<span class="hljs-number">4</span>, <span class="hljs-literal">default</span> <span class="hljs-number">3</span>):<br>First sector (<span class="hljs-number">2095106</span><span class="hljs-number">-8388607</span>, <span class="hljs-literal">default</span> <span class="hljs-number">2097152</span>):<br>Last sector, +sectors <span class="hljs-literal">or</span> +size&#123;K,M,G,T,P&#125; (<span class="hljs-number">2097152</span><span class="hljs-number">-8388607</span>, <span class="hljs-literal">default</span> <span class="hljs-number">8388607</span>): +<span class="hljs-number">756</span>M<br><span class="hljs-meta"># 转化分区</span><br>t<br><span class="hljs-meta"># 选择分区3</span><br>Partition <span class="hljs-built_in">number</span> (<span class="hljs-number">1</span><span class="hljs-number">-3</span>, <span class="hljs-literal">default</span> <span class="hljs-number">3</span>): <span class="hljs-number">3</span><br><span class="hljs-meta"># 选择swap(82  Linux swap / So)</span><br><span class="hljs-built_in">Hex</span> code (type L <span class="hljs-keyword">to</span> list all codes): <span class="hljs-number">82</span><br><span class="hljs-meta"># 保存</span><br>w<br>partprobe /dev/vdb<br><span class="hljs-meta"># 格式化分区</span><br>mkswap /dev/vdb3<br><span class="hljs-meta"># 编辑永久挂载</span><br>vim /etc/fstab<br>/dev/vdb3 none swap defaults <span class="hljs-number">0</span> <span class="hljs-number">0</span><br><span class="hljs-meta"># 刷新fstab挂载</span><br>swapon -a<br>swapon -s<br></code></pre></td></tr></table></figure>

<h2 id="创建逻辑卷"><a href="#创建逻辑卷" class="headerlink" title="创建逻辑卷"></a>创建逻辑卷</h2><p>根据如下要求，创建新的逻辑卷：</p>
<ul>
<li>逻辑卷取名为 qa ，属于 qagroup 卷组，大小为 60 个扩展块</li>
<li>qagroup 卷组中逻辑卷的扩展块大小应当为 16 MiB</li>
<li>使用 ext3 文件系统格式化新逻辑卷。该逻辑卷应在系统启动时自动挂载到 &#x2F;mnt&#x2F;qa 下</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs bash">fdisk /dev/vdb<br><span class="hljs-comment"># 新建分区</span><br>n<br><span class="hljs-comment"># 划分分区大小</span><br>Selected partition 4<br>First sector (2095106-8388607, default 3645440):<br>Last sector, +sectors or +size&#123;K,M,G,T,P&#125; (3645440-8388607, default 8388607): +1200M<br><span class="hljs-comment"># 转化分区</span><br>t<br><span class="hljs-comment"># 选择分区3</span><br>Partition number (1-3, default 3): 3<br><span class="hljs-comment"># 选择LVM(Linux LVM)</span><br>Hex code (<span class="hljs-built_in">type</span> L to list all codes): 8e<br><span class="hljs-comment"># 保存</span><br>w<br>partprobe /dev/vdb<br><span class="hljs-comment"># 创建物理卷</span><br>pvcreate /dev/vdb4<br><span class="hljs-comment"># 创建卷组</span><br>vgcreate -s 16 qagroup /dev/vdb4<br><span class="hljs-comment"># 创建逻辑卷</span><br>lvcreate -l 60 -n qa qagroup<br><span class="hljs-comment"># 格式化exe3</span><br>mkfs.ext3 /dev/qagroup/qa<br><span class="hljs-comment"># 创建挂载目录</span><br><span class="hljs-built_in">mkdir</span> /mnt/qa<br><span class="hljs-comment"># 配置永久挂载点</span><br>vim /etc/fstab<br>/dev/qagroup/qa /mnt/qa  ext3 defaults 0 0<br><span class="hljs-comment"># 刷新fstab</span><br>mount -a<br></code></pre></td></tr></table></figure>

<h2 id="创建-VDO-卷"><a href="#创建-VDO-卷" class="headerlink" title="创建 VDO 卷"></a>创建 VDO 卷</h2><p>根据如下要求，创建新的 VDO 卷：</p>
<ul>
<li>使用未分区的磁盘</li>
<li>该卷的名称为 vdough</li>
<li>该卷的逻辑大小为 50G</li>
<li>该卷使用 xfs 文件系统格式化</li>
<li>该卷（在系统启动时）挂载到 &#x2F;vbread 下</li>
</ul>
<figure class="highlight dsconfig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs dsconfig"><span class="hljs-comment"># 搜索vod的包</span><br><span class="hljs-string">yum</span> <span class="hljs-string">list</span> *<span class="hljs-string">vdo</span>*<br><span class="hljs-comment"># 在找到的软件包中安装这2个包名</span><br><span class="hljs-string">yum</span> -<span class="hljs-string">y</span> <span class="hljs-string">install</span> <span class="hljs-string">kmod-kvdo</span>.<span class="hljs-string">x86_64</span>  <span class="hljs-string">vdo</span>.<span class="hljs-string">x86_64</span><br><span class="hljs-comment"># 查看是否有服务了</span><br><span class="hljs-string">systemctl</span> <span class="hljs-built_in">list-unit-files</span> |<span class="hljs-string">grep</span> <span class="hljs-string">vod</span><br><span class="hljs-comment"># 查看服务状态</span><br><span class="hljs-string">systemctl</span> <span class="hljs-string">status</span> <span class="hljs-string">vdo</span><br><span class="hljs-comment"># 启动服务</span><br><span class="hljs-string">systemctl</span> <span class="hljs-string">start</span> <span class="hljs-string">vdo</span><br><span class="hljs-comment"># 利用帮助找选项</span><br><span class="hljs-string">vdo</span> <span class="hljs-string">create</span> <span class="hljs-built_in">--help</span> |<span class="hljs-string">grep</span> <span class="hljs-string">Size</span><br><span class="hljs-comment"># 根据题目创建vdo</span><br><span class="hljs-string">vdo</span> <span class="hljs-string">create</span> <span class="hljs-built_in">--name=vdough</span> <span class="hljs-built_in">--device=/dev/vdc</span> <span class="hljs-built_in">--vdoLogicalSize=50G</span><br><span class="hljs-comment"># 快速格式化xfs</span><br><span class="hljs-string">mkfs</span>.<span class="hljs-string">xfs</span> -<span class="hljs-string">K</span> /<span class="hljs-string">dev</span>/<span class="hljs-string">mapper</span>/<span class="hljs-string">vdough</span><br><span class="hljs-comment"># 创建挂载目录</span><br><span class="hljs-string">mkdir</span> /<span class="hljs-string">vbread</span><br><span class="hljs-comment"># 配置永久挂载文件</span><br><span class="hljs-string">vim</span> /<span class="hljs-string">etc</span>/<span class="hljs-string">fstab</span><br><span class="hljs-comment"># 如果不配置_netdev或写错了，系统会启动不起来，并进入emergency模式</span><br>/<span class="hljs-string">dev</span>/<span class="hljs-string">mapper</span>/<span class="hljs-string">vdough</span> /<span class="hljs-string">vbread</span>  <span class="hljs-string">xfs</span>  <span class="hljs-string">defaults</span>,<span class="hljs-string">_netdev</span>  <span class="hljs-string">0</span> <span class="hljs-string">0</span><br><span class="hljs-comment"># 刷新fstab</span><br><span class="hljs-string">mount</span> -<span class="hljs-string">a</span><br><span class="hljs-comment"># 查看</span><br><span class="hljs-string">df</span> -<span class="hljs-string">hT</span><br></code></pre></td></tr></table></figure>

<blockquote>
<p><em>利用帮助:</em> <code>*man vdo |grep create*</code> <em>和</em><code>*man vdo |grep defaults*</code></p>
</blockquote>
<h2 id="配置系统调优"><a href="#配置系统调优" class="headerlink" title="配置系统调优"></a>配置系统调优</h2><p>为您的系统选择建议的 tuned 配置集并将它设为默认设置。</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-meta"># 查看系统推荐的配置</span><br>tuned-adm recommend<br><span class="hljs-keyword">virtual</span>-guest<br><span class="hljs-meta"># 查看目前使用的配置</span><br>tuned-adm active<br>Current active profile: throughput-performance<br><span class="hljs-meta"># 设置推荐的配置</span><br>tuned-adm profile <span class="hljs-keyword">virtual</span>-guest<br><span class="hljs-meta"># 验证修改后的配置</span><br>tuned-adm active<br>Current active profile: <span class="hljs-keyword">virtual</span>-guest<br></code></pre></td></tr></table></figure>

<h2 id="删除逻辑卷"><a href="#删除逻辑卷" class="headerlink" title="删除逻辑卷"></a>删除逻辑卷</h2><ol>
<li>卸载文件系统，并删除&#x2F;etc&#x2F;fstab中的记录</li>
</ol>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">unmount</span> /dev/vg0/<span class="hljs-number">1</span>v01<br></code></pre></td></tr></table></figure>

<ol>
<li>删除逻辑卷</li>
</ol>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">lvremove</span> /dev/vg0/<span class="hljs-number">1</span>v01<br></code></pre></td></tr></table></figure>

<ol>
<li>删除卷组</li>
</ol>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">vgremove v<span class="hljs-name">g0</span><br></code></pre></td></tr></table></figure>

<ol>
<li>删除物理卷</li>
</ol>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">pvremove <span class="hljs-regexp">/dev/</span>sdb1 <span class="hljs-regexp">/dev/</span>db2<br></code></pre></td></tr></table></figure>

<h2 id="查找拷贝"><a href="#查找拷贝" class="headerlink" title="查找拷贝"></a>查找拷贝</h2><p>在&#x2F;usr&#x2F;bin 目录下创建一个 repwis 脚本，查找&#x2F;usr 目录大小范围在 10–50K 之间并且组 id 不为 root 的文件且拥有 sgid 的文件，把查到的文件结果拷贝到&#x2F;root&#x2F;myfiles文件夹内。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#/bin/bash</span><br><span class="hljs-keyword">if</span> [ ! -d /root/myfiles ]; <span class="hljs-keyword">then</span><br><span class="hljs-built_in">mkdir</span> /root/myfiles<br><span class="hljs-keyword">fi</span><br>find /usr -<span class="hljs-built_in">type</span> f -a \( -size +10k -size -50k \) -a \( ! -group root \) -a \( -perm /2000 \) -<span class="hljs-built_in">exec</span> <span class="hljs-built_in">cp</span> -a &#123;&#125; /root/myfiles \;<br></code></pre></td></tr></table></figure>

<h2 id="欢迎语"><a href="#欢迎语" class="headerlink" title="欢迎语"></a>欢迎语</h2><p>登录到普通用户后提示一句欢迎语’hello word !’或者用户在登陆前显示欢迎语提示。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 配置登入后的欢迎语（登入系统输入账号后）</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;hello word !&#x27;</span> &gt;&gt; /etc/motd<br><span class="hljs-comment"># 配置登入前的欢迎语（登入系统输入账号前）</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;hello word !&#x27;</span> &gt;&gt; /etc/issue<br></code></pre></td></tr></table></figure>

<h2 id="查找文件-1"><a href="#查找文件-1" class="headerlink" title="查找文件"></a>查找文件</h2><p>在&#x2F;usr&#x2F;bin 目录下创建一个 repwis 脚本，查找&#x2F;usr&#x2F;目录下小于 10M 并且组 id 不为 root 的文 件，把查找到的文件放在&#x2F;root&#x2F;myfiles 文件夹内</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">find /usr -<span class="hljs-built_in">type</span> f -a  \( -size -10M \) -a \( ! -group root \)  -<span class="hljs-built_in">exec</span> <span class="hljs-built_in">cp</span> -a &#123;&#125; /root/myfiles \;<br></code></pre></td></tr></table></figure>

<h2 id="查找文件-2"><a href="#查找文件-2" class="headerlink" title="查找文件"></a>查找文件</h2><p>在&#x2F;usr&#x2F;bin 目录下创建一个 repwis 脚本，查找&#x2F;usr&#x2F; 具有粘贴位是 4（u 的位置上有 s 位）， 其他 ugo 是什么权限， 不管。且组 id 不为 root 的文件，把查找到的文件放在&#x2F;root&#x2F;myfiles文件夹内</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">find /usr -<span class="hljs-built_in">type</span> f -a \( -perm /4000 \) -a \( ! -group root  \) -<span class="hljs-built_in">exec</span> <span class="hljs-built_in">cp</span> -a &#123;&#125; /root/myfiles \;<br></code></pre></td></tr></table></figure>

<h2 id="权限设置"><a href="#权限设置" class="headerlink" title="权限设置"></a>权限设置</h2><p>对 diff 用户设置默认权限：</p>
<ul>
<li>用户新创建的文件权限都为：444 r — r — r —</li>
<li>同一个用户下新创建的目录权限为：554 dr-xr-xr —</li>
</ul>
<p>如果既要求了文件的默认权限 xxx，也要求了目录的默认权限 yyy。<br>则 umask 的值以目录来算，即 umask&#x3D;777-yyy，不用管文件。<br>比如目录的默认权限为 554，文件的默认权限为 444。<br>则 umask 可以设置为 777–554&#x3D;223，不用管文件的默认权限了。<br>如果题目只要求设置文件的默认权限 xxx，并没有说目录的默认权限是什么。<br>则 umask&#x3D;666-xxx<br>算出来 umask 值为 zzz 之后。<br>用户 vim ~用户&#x2F;.bash_profile，添加 umask zzz 这里 zzz 是你算出来的数字。</p>
<h2 id="打印输出"><a href="#打印输出" class="headerlink" title="打印输出"></a>打印输出</h2><p>在节点上使用 bob 用户写一个脚本 rhcsa，然后执行 rhcsa,执行后输出<strong>it is ok</strong></p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-comment"># 查看用户的环境变量</span><br>echo <span class="hljs-variable">$PATH</span><br><span class="hljs-regexp">/home/</span>bob<span class="hljs-regexp">/.local/</span>bin:<span class="hljs-regexp">/home/</span>bob<span class="hljs-regexp">/bin:/u</span>sr<span class="hljs-regexp">/local/</span>bin:<span class="hljs-regexp">/usr/</span>bin:<span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/sbin:/u</span>sr/sbin<br>mkdir <span class="hljs-regexp">/home/</span>bob/bin<br><span class="hljs-comment"># 编辑脚本</span><br>vim <span class="hljs-regexp">/home/</span>bob<span class="hljs-regexp">/bin/</span>rhcsa<br><span class="hljs-comment">#/bin/bash</span><br>echo <span class="hljs-string">&quot;it is ok&quot;</span><br><span class="hljs-comment"># 设置可执行权限</span><br>chmod +x <span class="hljs-regexp">/home/</span>bob<span class="hljs-regexp">/bin/</span>rhcsa<br></code></pre></td></tr></table></figure>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/blog/categories/%E5%AD%A6%E4%B9%A0/" class="category-chain-item">学习</a>
  
  
    <span>></span>
    
  <a href="/blog/categories/%E5%AD%A6%E4%B9%A0/%E8%80%83%E8%AF%95/" class="category-chain-item">考试</a>
  
  

  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/blog/tags/Linux/" class="print-no-link">#Linux</a>
      
        <a href="/blog/tags/podman/" class="print-no-link">#podman</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>红帽RHCSA学习总结</div>
      <div>https://maojun.xyz/blog/2022/02/红帽RHCSA学习总结.html</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>毛 俊</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2022年2月11日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by-nc-nd/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by-nc-nd/4.0/">
                  <span class="hint--top hint--rounded" aria-label="NC - 非商业性使用">
                    <i class="iconfont icon-nc"></i>
                  </span>
                </a>
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by-nc-nd/4.0/">
                  <span class="hint--top hint--rounded" aria-label="ND - 禁止演绎">
                    <i class="iconfont icon-nd"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/blog/2022/02/%E7%BA%A2%E5%B8%BDRHCE%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93.html" title="红帽RHCE学习总结">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">红帽RHCE学习总结</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/blog/2021/10/Bug%E6%8A%A5%E5%91%8A%E5%86%99%E4%BD%9C%E6%8C%87%E5%8D%97.html" title="Bug报告写作指南">
                        <span class="hidden-mobile">Bug报告写作指南</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://nav.maojun.xyz/" target="_blank" rel="nofollow noopener" <i class="iconfont icon-th-large"><span>网址导航</span></a> <a href="https://maojun.xyz/blog/atom.xml" target="_blank" rel="nofollow noopener"><i class="iconfont icon-rss"></i><span>RSS</span></a> <i class="iconfont icon-copyright"></i> <a href="https://maojun.xyz" target="_blank" rel="nofollow noopener"><span>maojun.xyz ❤ </span></a> <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo </span></a><span>& </span>  <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/blog/js/events.js" ></script>
<script  src="/blog/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/blog/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/blog/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/blog/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
