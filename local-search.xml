<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>Vue3项目搭建的4种方式</title>
    <link href="/blog/2024/04/Vue3%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA%E7%9A%844%E7%A7%8D%E6%96%B9%E5%BC%8F.html"/>
    <url>/blog/2024/04/Vue3%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA%E7%9A%844%E7%A7%8D%E6%96%B9%E5%BC%8F.html</url>
    
    <content type="html"><![CDATA[<h2 id="Vue介绍"><a href="#Vue介绍" class="headerlink" title="Vue介绍"></a>Vue介绍</h2><ul><li>官方文档：<a href="https://vuejs.org/">https://vuejs.org</a></li><li>地址：<a href="https://github.com/vuejs">https://github.com/vuejs</a></li></ul><h2 id="特性"><a href="#特性" class="headerlink" title="特性"></a>特性</h2><ul><li><p>渐进式框架</p><p>能够自动追踪依赖的模板表达式和计算属性，提供 MVVM 数据绑定和一个可组合的组件系统，具有简单、灵活的 API，使读者更加容易理解，能够更快上手。</p></li><li><p>双向数据绑定</p><p>声明式渲染是数据双向绑定的主要体现，同样也是 Vue.js 的核心，它允许采用简洁的模板语法将数据声明式渲染整合进 DOM。</p></li><li><p>指令</p><p>Vue.js 与页面进行交互，主要就是通过内置指令来完成的，指令的作用是当其表达式的值改变时相应地将某些行为应用到 DOM 上。</p></li><li><p>组件化</p><p>组件可以扩展 HTML 元素，封装可重用的代码。</p></li><li><p>Vue 路由管理</p><p>Vue-Router 是 Vue 全家桶中的路由管理插件，与 Vue.js 深度集成，用于构建单页面应用。Vue 单页面应用是基于路由和组件的，路由用于设定访问路径，并将路径和组件映射起来，传统的页面是通过超链接实现页面的切换和跳转的。</p></li><li><p>Vue 状态管理</p><p>Vuex 是 Vue 全家桶中的状态管理插件，与 Vue.js 深度集成，用于管理应用的状态。</p></li><li><p>Vue 脚手架</p><p>Vue-Cli 是 Vue 全家桶中的脚手架工具，给 Vue 应用提供了开箱即用的功能，让开发者能够快速创建、开发、构建一个完整的 Vue 项目。</p></li></ul><h2 id="DOM操作"><a href="#DOM操作" class="headerlink" title="DOM操作"></a>DOM操作</h2><p>网页是由 DOM 组合的视图结构，再加上 CSS 样式的修饰，使用 JavaScript 接受用户的交互请求，并通过事件机制来响应用户交互操作而形成的。</p><p><code>Jquery</code>是一个经典的DOM操作库。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;!<span class="hljs-variable constant_">DOCTYPE</span> html&gt;<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span></span><br><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;utf-8&quot;</span> /&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>jquery Dom测试<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-comment">&lt;!-- 引入 jquery 框架 --&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;https://code.jquery.com/jquery-3.6.0.min.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></span><br><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;root&quot;</span>&gt;</span></span><br><span class="language-xml">      hello world</span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="language-javascript"><span class="language-xml">      $(<span class="hljs-string">&quot;#root&quot;</span>).<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;click&quot;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">        event.<span class="hljs-property">target</span>.<span class="hljs-property">innerText</span> = <span class="hljs-string">&quot;hello DOM&quot;</span>;</span></span><br><span class="language-javascript"><span class="language-xml">      &#125;);</span></span><br><span class="language-javascript"><span class="language-xml">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span><br></code></pre></td></tr></table></figure><h2 id="数据绑定"><a href="#数据绑定" class="headerlink" title="数据绑定"></a>数据绑定</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;utf-8&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Vue MVVM测试<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- 引入 Vue.js 框架 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;https://cdnjs.cloudflare.com/ajax/libs/vue/3.4.21/vue.global.prod.min.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;root&quot;</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;handleClick&quot;</span>&gt;</span>&#123;&#123;msg&#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">      <span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">createApp</span>(&#123;</span><br><span class="language-javascript">        <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">          <span class="hljs-keyword">return</span> &#123;</span><br><span class="language-javascript">            <span class="hljs-attr">msg</span>: <span class="hljs-string">&quot;hello world&quot;</span>,</span><br><span class="language-javascript">          &#125;;</span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-attr">methods</span>: &#123;</span><br><span class="language-javascript">          <span class="hljs-title function_">handleClick</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">msg</span> = <span class="hljs-string">&quot;hello MVVM&quot;</span>;</span><br><span class="language-javascript">          &#125;,</span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">      &#125;).<span class="hljs-title function_">mount</span>(<span class="hljs-string">&quot;#root&quot;</span>);</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="项目搭建"><a href="#项目搭建" class="headerlink" title="项目搭建"></a>项目搭建</h2><h3 id="通过CDN引入"><a href="#通过CDN引入" class="headerlink" title="通过CDN引入"></a>通过CDN引入</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;script src=<span class="hljs-string">&quot;https://unpkg.com/vue@3.0.11/dist/vue.global.js&quot;</span>&gt;&lt;/script&gt;<br></code></pre></td></tr></table></figure><p>你可以使用官方提供的资源包（这里以 3.0.11 版本为例）：</p><ul><li><p><a href="https://unpkg.com/vue@3.0.11/dist/vue.global.js">https://unpkg.com/vue@3.0.11/dist/vue.global.js</a></p><p>浏览器环境中的全量 Vue.js 代码。</p></li><li><p><a href="https://unpkg.com/vue@3.0.11/dist/vue.global.prod.js">https://unpkg.com/vue@3.0.11/dist/vue.global.prod.js</a></p><p>浏览器环境中的全量并且压缩过后的 Vue.js 代码。</p></li><li><p><a href="https://unpkg.com/vue@3.0.11/dist/vue.runtime.global.js">https://unpkg.com/vue@3.0.11/dist/vue.runtime.global.js</a></p><p>浏览器环境中的不带编译功能的 Vue.js 代码。</p></li><li><p><a href="https://unpkg.com/vue@3.0.11/dist/vue.runtime.global.prod.js">https://unpkg.com/vue@3.0.11/dist/vue.runtime.global.prod.js</a></p><p>浏览器环境中的不带编译功能并且压缩过后的 Vue.js 代码。</p></li><li><p><a href="https://unpkg.com/vue@3.0.11/dist/vue.esm-browser.js">https://unpkg.com/vue@3.0.11/dist/vue.esm-browser.js</a></p><p><code>EsModule</code> 规范的 Vue.js 全量代码，直接在浏览器通过 <code>ES modules</code> 方式引入（<code>&lt;script type=&quot;module&quot;&gt;</code>）。</p></li><li><p><a href="https://unpkg.com/vue@3.0.11/dist/vue.runtime.esm-browser.js">https://unpkg.com/vue@3.0.11/dist/vue.runtime.esm-browser.js</a></p><p><code>EsModule</code> 规范的不带编译功能 Vue.js 代码，直接在浏览器通过 <code>ES modules</code> 方式引入（<code>&lt;script type=&quot;module&quot;&gt;</code>）。</p></li></ul><p>带 <code>runtime</code> 跟不带 <code>runtime</code> 的资源包，比如：vue.runtime.global.js 跟 vue.global.js：</p><ul><li>vue.runtime.global.js：除了编译 template 功能以外的 Vue 代码。</li><li>vue.global.js：包含了编译 template 功能完整的 Vue 代码。</li></ul><p>如果你的项目需要用到编译 template 属性的功能，比如：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">createApp</span>(&#123;<br>  <span class="hljs-attr">template</span>: <span class="hljs-string">&quot;&lt;app&gt;&lt;/app&gt;&quot;</span>,<br>&#125;);<br></code></pre></td></tr></table></figure><p>Vue 最后是需要将 template 编译成 <code>render</code> 方法进行渲染的，所以你就需要用到 Vue 的编译功能，因此就需要引入带有编译功能的 Vue 代码（vue.global.js）。</p><p><code>prod</code> 和 <code>prod</code> 后缀的资源包</p><p>比如：<code>vue.global.js</code> 跟 <code>vue.global.prod.js</code>。</p><p>带 <code>prod</code> 的意思就是 “是否经过压缩混淆过后的代码”，<code>prod</code> 的全称是 <code>production</code>，也就是生产环境的意思。</p><blockquote><p>当项目处在开发阶段的时候，用没有 <code>prod</code> 后缀的代码，当项目需要发布上线的时候，用带 <code>prod</code> 后缀的代码。</p></blockquote><p>CDN引入示例：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;!doctype html&gt;<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span></span><br><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;utf-8&quot;</span> /&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Vue use CDN<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-comment">&lt;!-- 引入 全量 Vue.js 代码 --&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;https://unpkg.com/vue@3.0.11/dist/vue.global.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></span><br><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;root&quot;</span>&gt;</span></span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>&#123;&#123;msg&#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="language-javascript"><span class="language-xml">      <span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">createApp</span>(&#123;</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-keyword">return</span> &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-attr">msg</span>: <span class="hljs-string">&quot;hello CDN&quot;</span>,</span></span><br><span class="language-javascript"><span class="language-xml">          &#125;;</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">      &#125;).<span class="hljs-title function_">mount</span>(<span class="hljs-string">&quot;#root&quot;</span>);</span></span><br><span class="language-javascript"><span class="language-xml">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span><br></code></pre></td></tr></table></figure><h3 id="通过NPM安装"><a href="#通过NPM安装" class="headerlink" title="通过NPM安装"></a>通过NPM安装</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs npm"># 创建工程目录<br>mkdir ./vue-npm-demo <br># 进入目录并初始化npm项目<br>cd vue-npm-demo &amp;&amp; npm init -y<br># 安装webpack依赖<br>npm install -D webpack@4.46.0 webpack-cli@4.10 webpack-dev-server@3.11.2 vue-loader@16.1.2 @vue/compiler-sfc@3.0.11 html-webpack-plugin@3.2.0<br># 安装vue<br>npm install vue@3.0.11<br># 创建webpack配置文件<br>touch ./webpack.config.js<br></code></pre></td></tr></table></figure><p>添加<code>webpack.config.js</code>内容：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;path&quot;</span>);<br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">target</span>: <span class="hljs-string">&quot;web&quot;</span>,<br>  <span class="hljs-attr">module</span>: &#123;<br>    <span class="hljs-attr">rules</span>: [<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.vue$/</span>,<br>        <span class="hljs-attr">loader</span>: <span class="hljs-string">&quot;vue-loader&quot;</span>,<br>      &#125;,<br>    ],<br>  &#125;,<br>  <span class="hljs-attr">plugins</span>: [<br>    <span class="hljs-keyword">new</span> (<span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;vue-loader&quot;</span>).<span class="hljs-property">VueLoaderPlugin</span>)(),<br>    <span class="hljs-keyword">new</span> (<span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;html-webpack-plugin&quot;</span>))(&#123;<br>      <span class="hljs-attr">template</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;./public/index.html&quot;</span>), <span class="hljs-comment">// 指定模版文件</span><br>    &#125;),<br>  ],<br>  <span class="hljs-attr">devServer</span>: &#123;<br>    <span class="hljs-attr">host</span>: <span class="hljs-string">&quot;0.0.0.0&quot;</span>,<br>    <span class="hljs-attr">disableHostCheck</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-attr">contentBase</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;./public&quot;</span>), <span class="hljs-comment">// 设置一个 express 静态目录</span><br>    <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span>,<br>    <span class="hljs-attr">hot</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-attr">sockPort</span>: <span class="hljs-string">&quot;location&quot;</span>,<br>  &#125;,<br>&#125;;<br></code></pre></td></tr></table></figure><p>配置完Webpack后，创建webpack的入口文件。</p><p>在 <code>vue-npm-demo</code> 工程目录下创建一个 <code>src</code> 目录，并且在 <code>src</code> 目录下创建一个 <code>index.js</code> 文件：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">mkdir</span> ./src &amp;&amp; <span class="hljs-built_in">touch</span> ./src/index.js<br></code></pre></td></tr></table></figure><p>将以下内容写入到 <code>vue-npm-demo/src/index.js</code> 文件：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; createApp &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;vue&quot;</span>;<br><span class="hljs-comment">// 引入 App.vue 组件</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">App</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./App.vue&quot;</span>;<br><span class="hljs-comment">// 渲染 app</span><br><span class="hljs-title function_">createApp</span>(<span class="hljs-title class_">App</span>).<span class="hljs-title function_">mount</span>(<span class="hljs-string">&quot;#app&quot;</span>);<br></code></pre></td></tr></table></figure><p>然后创建一个 <code>App.vue</code> 组件。</p><p>在 <code>vue-npm-demo/src</code> 目录下创建一个 <code>App.vue</code> 文件：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>  &lt;div&gt;&#123;&#123; msg &#125;&#125;&lt;/div&gt;<br>&lt;/template&gt;<br>&lt;script&gt;<br>export default &#123;<br>  setup() &#123;<br>    return &#123;<br>      msg: &quot;hello world&quot;,<br>    &#125;;<br>  &#125;,<br>&#125;;<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure><p>为了能让项目跑起来，我们还需要创建应用的入口文件 <code>index.html</code>。</p><p>我们在 <code>vue-npm-demo</code> 目录下创建一个 <code>public</code> 目录，并且在 <code>vue-npm-demo/public</code> 目录下创建一个 <code>index.html</code> 文件：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">mkdir</span> ./public &amp;&amp; <span class="hljs-built_in">touch</span> ./public/index.html<br></code></pre></td></tr></table></figure><p>将以下内容写入到 <code>vue-npm-demo/public/index.html</code> 文件：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!doctype <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Title<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">noscript</span>&gt;</span>your browser should support javascript!<span class="hljs-tag">&lt;/<span class="hljs-name">noscript</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;app&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- html-webpack-plugin 将自动引入入口文件 --&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>在 <code>vue-npm-demo</code> 工程目录下执行以下命令开启 <code>webpack</code> 服务：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 设置环境变量</span><br><span class="hljs-built_in">export</span> NODE_OPTIONS=--openssl-legacy-provider<br><span class="hljs-comment"># 开启 webpack 服务</span><br>npx webpack serve --mode=development <br></code></pre></td></tr></table></figure><p> <code>Webpack</code> 搭建的 <code>Vue</code> 项目就搞定了。</p><h3 id="通过Vue-cli安装"><a href="#通过Vue-cli安装" class="headerlink" title="通过Vue-cli安装"></a>通过Vue-cli安装</h3><p>执行以下命令安装</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">npm install -g @vue/cli@4.5.12 &amp;&amp; vue create vue-cli-demo<br><span class="hljs-comment"># 安装完根据提示选择(选择：Vue3和npm)</span><br></code></pre></td></tr></table></figure><p>在<code>vue-cli-demo</code> 工程目录下创建一个 <code>vue.config.js</code> 文件：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">touch</span> ./vue-cli-demo/vue.config.js<br></code></pre></td></tr></table></figure><p>将以下内容写入到 <code>vue-cli-demo/vue.config.js</code> 文件：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">configureWebpack</span>: &#123;<br>    <span class="hljs-attr">devServer</span>: &#123;<br>      <span class="hljs-attr">host</span>: <span class="hljs-string">&quot;0.0.0.0&quot;</span>,<br>      <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span>, <br>      <span class="hljs-attr">disableHostCheck</span>: <span class="hljs-literal">true</span>, <br>    &#125;,<br>  &#125;,<br>&#125;;<br></code></pre></td></tr></table></figure><p>进入到 <code>vue-cli-demo</code> 工程目录，并且在 <code>vue-cli-demo</code> 目录下执行以下命令启动项目：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 设置环境变量</span><br><span class="hljs-built_in">export</span> NODE_OPTIONS=--openssl-legacy-provider <br><span class="hljs-built_in">cd</span> vue-cli-demo &amp;&amp; npm run serve<br></code></pre></td></tr></table></figure><p> <code>Vue-Cli</code> 脚手架项目就搭建完了。 </p><h3 id="通过Vite安装"><a href="#通过Vite安装" class="headerlink" title="通过Vite安装"></a>通过Vite安装</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">npm init vite vue-vite-demo<br><span class="hljs-comment"># 在后续的选择中选择Vue项目和JavaScript</span><br></code></pre></td></tr></table></figure><p>进入到 <code>vue-vite-demo</code> 项目目录并执行 <code>npm</code> 初始化：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">cd</span> vue-vite-demo &amp;&amp; npm install<br></code></pre></td></tr></table></figure><p>修改 <code>vue-vite-demo</code> 目录下的 <code>vite.config.js</code> 文件：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; defineConfig &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;vite&quot;</span>;<br><span class="hljs-keyword">import</span> vue <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@vitejs/plugin-vue&quot;</span>;<br><br><span class="hljs-comment">// https://vitejs.dev/config/</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>(&#123;<br>  <span class="hljs-attr">plugins</span>: [<span class="hljs-title function_">vue</span>()],<br>  <span class="hljs-attr">server</span>: &#123;<br>    <span class="hljs-attr">host</span>: <span class="hljs-string">&quot;0.0.0.0&quot;</span>, <br>    <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span>, <br>  &#125;,<br>&#125;);<br></code></pre></td></tr></table></figure><p>执行命令启动项目：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">npm run dev<br></code></pre></td></tr></table></figure><p>这样就完成了通过Vite搭建项目。</p><p>（完）</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>Vue</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Vue</tag>
      
      <tag>Vite</tag>
      
      <tag>NPM</tag>
      
      <tag>Webpack</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Kubernetes及其生态介绍和使用</title>
    <link href="/blog/2024/04/Kubernetes%E5%8F%8A%E5%85%B6%E7%94%9F%E6%80%81%E4%BB%8B%E7%BB%8D%E5%92%8C%E4%BD%BF%E7%94%A8.html"/>
    <url>/blog/2024/04/Kubernetes%E5%8F%8A%E5%85%B6%E7%94%9F%E6%80%81%E4%BB%8B%E7%BB%8D%E5%92%8C%E4%BD%BF%E7%94%A8.html</url>
    
    <content type="html"><![CDATA[<h2 id="Kubernetes简介"><a href="#Kubernetes简介" class="headerlink" title="Kubernetes简介"></a>Kubernetes简介</h2><p>Kubernetes是一个全新的基于容器技术的分布式系统支撑平台。是Googe开源的容器集群管理系统(谷歌内部:Borg)。在Docker技术的基础上，为容器化的应用提供部署运行、资源调度、服务发现和动态伸缩等一系列完整功能，提高了大规模容器集群管理的便捷性。并且具有完备的集群管理能力，多层次的安全防护和准入机制、多租户应用支撑能力、透明的服务注册和发现机制、內建智能负载均衡器、强大的故障发现和自我修复能力、服务滚动升级和在线扩容能力、可扩展的资源自动调度机制以及多粒度的资源配额管理能力。</p><h2 id="Kubernetes和Docker的关系"><a href="#Kubernetes和Docker的关系" class="headerlink" title="Kubernetes和Docker的关系"></a>Kubernetes和Docker的关系</h2><ul><li>Docker提供容器的生命周期管理和，Docker镜像构建运行时容器。它的主要优点是将将软件&#x2F;应用程序运行所需的设置和依赖项打包到一个容器中，从而实现了可移植性等优点。</li><li>Kubernetes用于关联和编排在多个主机上运行的容器。</li></ul><h2 id="Minikube、Kubect、Kubelet？"><a href="#Minikube、Kubect、Kubelet？" class="headerlink" title="Minikube、Kubect、Kubelet？"></a>Minikube、Kubect、Kubelet？</h2><ul><li>Minikube是一种可以在本地轻松运行一个单节点Kubernetes群集的工具。</li><li>Kubect是一个命令行工具，可以使用该工具控制Kubernetes集群管理器，如检查群集资源，创建、删除和更新组件，查看应用程序。</li><li>Kubelet是一个代理服务，它在每个节点上运行，并使从服务器与主服务器通信。</li></ul><h2 id="Kubernetes的部署方式"><a href="#Kubernetes的部署方式" class="headerlink" title="Kubernetes的部署方式"></a>Kubernetes的部署方式</h2><ul><li>kubeadm：也是推荐的一种部署方式；</li><li>二进制;</li><li>minikube：在本地轻松运行一个单节点Kubernetes群集的工具。</li></ul><h2 id="Kubernetes集群管理"><a href="#Kubernetes集群管理" class="headerlink" title="Kubernetes集群管理"></a>Kubernetes集群管理</h2><p>在集群管理方面，Kubernetes将集群中的机器划分为一个Master节点和一群工作节点Node。其中，在Master节点运行着集群管理相关的一组进程kube-apiserver、kube-controer-manager和kube-scheduer，这些进程实现了整个集群的资源管理、Pod调度、弹性伸缩、安全控制、系统监控和纠错等管理能力，并且都是全自动完成的。</p><h2 id="Kubernetes的优势和特点"><a href="#Kubernetes的优势和特点" class="headerlink" title="Kubernetes的优势和特点"></a>Kubernetes的优势和特点</h2><p>Kubernetes作为一个完备的分布式系统支撑平台，其主要优势：</p><ul><li>容器编排</li><li>轻量级</li><li>开源</li><li>弹性伸缩</li><li>负载均衡</li></ul><p>Kubernetes常见场景：</p><ul><li>快速部署应用</li><li>快速扩展应用</li><li>无缝对接新的应用功能</li><li>节省资源，优化硬件资源的使用</li></ul><p>Kubernetes相关特点：</p><ul><li>可移植:支持公有云、私有云、混合云、多重云(muti-coud)。</li><li>可扩展:模块化,、插件化、可挂载、可组合。</li><li>自动化:自动部署、自动重启、自动复制、自动伸缩&#x2F;扩展。</li></ul><h2 id="Kubernetes的缺点或不足"><a href="#Kubernetes的缺点或不足" class="headerlink" title="Kubernetes的缺点或不足"></a>Kubernetes的缺点或不足</h2><ul><li>安装过程和配置相对困难复杂。</li><li>管理服务相对繁琐。</li><li>运行和编译需要很多时间。</li><li>它比其他替代品更昂贵。</li><li>对于简单的应用程序来说，可能不需要涉及Kubernetes即可满足。</li></ul><h2 id="Kubernetes基础概念"><a href="#Kubernetes基础概念" class="headerlink" title="Kubernetes基础概念"></a>Kubernetes基础概念</h2><ul><li>master：k8s集群的管理节点，负责管理集群，提供集群的资源数据访问入口。拥有Etcd存储服务(可选)，运行ApiServer进程，ControerManager服务进程及Scheduer服务进程。</li><li>node(worker)：Node(worker)是Kubernetes集群架构中运行Pod的服务节点，是Kubernetes集群操作的单元，用来承载被分配Pod的运行，是Pod运行的宿主机。运行dockereninge服务，守护进程kuneet及负载均衡器kube-proxy。</li><li>pod：运行于Node节点上，若干相关容器的组合。Pod内包含的容器运行在同一宿主机上，使用相同的网络命名空间、IP地址和端口，能够通过ocahost进行通信。Pod是Kurbernetes进行创建、调度和管理的最小单位，它提供了比容器更高层次的抽象，使得部署和管理更加灵活。一个Pod可以包含一个容器或者多个相关容器。</li><li>labe：Kubernetes中的abe实质是一系列的Key&#x2F;Vaue键值对，其中key与vaue可自定义。labe可以附加到各种资源对象上，如Node、Pod、Service、RC等。一个资源对象可以定义任意数量的labe，同一个labe也可以被添加到任意数量的资源对象上去。Kubernetes通过abeSeector(标签选择器)查询和筛选资源对象。</li><li>RepicationControer：RepicationControer用来管理Pod的副本，保证集群中存在指定数量的Pod副本。集群中副本的数量大于指定数量，则会停止指定数量之外的多余容器数量。反之，则会启动少于指定数量个数的容器，保证数量不变。RepicationControer是实现弹性伸缩、动态扩容和滚动升级的核心。</li><li>Depoyment：Depoyment在内部使用了RS来实现目的，Depoyment相当于RC的一次升级，其最大的特色为可以随时获知当前Pod的部署进度。</li><li>HPA(HorizontaPodAutoscaer)：Pod的横向自动扩容，也是Kubernetes的一种资源，通过追踪分析RC控制的所有Pod目标的负载变化情况，来确定是否需要针对性的调整Pod副本数量。</li><li>Service：Service定义了Pod的逻辑集合和访问该集合的策略，是真实服务的抽象。Service提供了一个统一的服务访问入口以及服务代理和发现机制，关联多个相同abe的Pod，用户不需要了解后台Pod是如何运行。</li><li>Voume：Voume是Pod中能够被多个容器访问的共享目录，Kubernetes中的Voume是定义在Pod上，可以被一个或多个Pod中的容器挂载到某个目录下。</li><li>Namespace：Namespace用于实现多租户的资源隔离，可将集群内部的资源对象分配到不同的Namespace中，形成逻辑上的不同项目、小组或用户组，便于不同的Namespace在共享使用整个集群的资源的同时还能被分别管理。</li></ul><h2 id="Kubernetes集群相关组件"><a href="#Kubernetes集群相关组件" class="headerlink" title="Kubernetes集群相关组件"></a>Kubernetes集群相关组件</h2><p>KubernetesMaster控制组件，调度管理整个系统(集群)，包含如下组件:</p><ul><li>KubernetesAPIServer：作为Kubernetes系统的入口，其封装了核心对象的增删改查操作，以RESTfuAPI接口方式提供给外部客户和内部组件调用，集群内各个功能模块之间数据交互和通信的中心枢纽。</li><li>KubernetesScheduer：为新建立的Pod进行节点(node)选择(即分配机器)，负<br>责集群的资源调度。</li><li>KubernetesControer：负责执行各种控制器，目前已经提供了很多控制器来保证Kubernetes的正常运行。</li><li>RepicationControer：管理维护RepicationControer，关联Repication Controer和Pod，保证RepicationControer定义的副本数量与实际运行Pod数量一致。</li><li>NodeControer：管理维护Node，定期检查Node的健康状态，标识出(失效|未失效)的Node节点。</li><li>NamespaceControer：管理维护Namespace，定期清理无效的Namespace，包括Namesapce下的API对象，比如Pod、Service等。</li><li>ServiceControer：管理维护Service，提供负载以及服务代理。</li><li>EndPointsControer：管理维护Endpoints，关联Service和Pod，创建Endpoints为Service的后端，当Pod发生变化时，实时更新Endpoints。</li><li>ServiceAccountControer：管理维护ServiceAccount，为每个Namespace创建默认的ServiceAccount，同时为ServiceAccount创建ServiceAccountSecret。</li><li>PersistentVoumeControer：管理维护PersistentVoume和PersistentVoumeCaim，为新的PersistentVoumeCaim分配PersistentVoume进行绑定，为释放的PersistentVoume执行清理回收。</li><li>DaemonSetControer：管理维护DaemonSet，负责创建DaemonPod，保证指定的Node上正常的运行DaemonPod。</li><li>DepoymentControer：管理维护Depoyment，关联Depoyment和RepicationControer，保证运行指定数量的Pod。当Depoyment更新时，控制实现RepicationControer和Pod的更新。</li><li>JobControer：管理维护Job，为Jod创建一次性任务Pod，保证完成Job指定完成的任务数目</li><li>PodAutoscaerControer：实现Pod的自动伸缩，定时获取监控数据，进行策略匹配，当满足条件时执行Pod的伸缩动作。</li></ul><h2 id="简述Kubernetes-RC的机制？"><a href="#简述Kubernetes-RC的机制？" class="headerlink" title="简述Kubernetes RC的机制？"></a>简述Kubernetes RC的机制？</h2><p>RepicationControer用来管理Pod的副本，保证集群中存在指定数量的Pod副本。当定义了RC并提交至Kubernetes集群中之后，Master节点上的ControerManager组件获悉，并同时巡检系统中当前存活的目标Pod，并确保目标Pod实例的数量刚好等于此RC的期望值，若存在过多的Pod副本在运行，系统会停止一些Pod，反之则自动创建一些Pod。</p><h2 id="RepicaSet和RepicationControer的区别？"><a href="#RepicaSet和RepicationControer的区别？" class="headerlink" title="RepicaSet和RepicationControer的区别？"></a>RepicaSet和RepicationControer的区别？</h2><p>RepicaSet和RepicationControer类似，都是确保在任何给定时间运行指定数量的Pod副本。不同之处在于RS使用基于集合的选择器，而RepicationControer使用基于权限的选择器。</p><h2 id="kube-proxy的作用"><a href="#kube-proxy的作用" class="headerlink" title="kube-proxy的作用"></a>kube-proxy的作用</h2><p>kube-proxy运行在所有节点上，它监听apiserver中service和endpoint的变化情况，创建路由规则以提供服务IP和负载均衡功能。简单理解此进程是Service的透明代理兼负载均衡器，其核心功能是将到某个Service的访问请求转发到后端的多个Pod实例上。</p><h2 id="kube-proxyiptabes的原理"><a href="#kube-proxyiptabes的原理" class="headerlink" title="kube-proxyiptabes的原理"></a>kube-proxyiptabes的原理</h2><p>Kubernetes从1.2版本开始，将iptabes作为kube-proxy的默认模式。iptabes模式下的kube-proxy不再起到Proxy的作用，其核心功能：通过APIServer的Watch接口实时跟踪Service与Endpoint的变更信息，并更新对应iptabes规则，Cient的请求流量则通过iptabes的NAT机制“直接路由”到目标Pod。</p><h2 id="kube-proxy-ipvs原理"><a href="#kube-proxy-ipvs原理" class="headerlink" title="kube-proxy ipvs原理"></a>kube-proxy ipvs原理</h2><p>IPVS在Kubernetes1.11中升级为GA稳定版。IPVS则专门用于高性能负载均衡，并使用更高效的数据结构(Hash表)，允许几乎无限的规模扩张，因此被kube-proxy采纳为最新模式。</p><p>在IPVS模式下，使用iptabes的扩展ipset，而不是直接调用iptabes来生成规则链。iptabes规则链是一个线性的数据结构，ipset则引入了带索引的数据结构，因此当规则很多时，也可以很高效地查找和匹配。</p><p>可以将ipset简单理解为一个IP(段)的集合，这个集合的内容可以是IP地址、IP网段、端口等，iptabes可以直接添加规则对这个“可变的集合”进行操作，这样做的好处在于可以大大减少iptabes规则的数量，从而减少性能损耗。</p><h2 id="kube-proxyipvs和iptabes的异同？"><a href="#kube-proxyipvs和iptabes的异同？" class="headerlink" title="kube-proxyipvs和iptabes的异同？"></a>kube-proxyipvs和iptabes的异同？</h2><p>iptabes与IPVS都是基于Netfiter实现的，但因为定位不同，二者有着本质的差别：iptabes是为防火墙而设计的；IPVS则专门用于高性能负载均衡，并使用更高效的数据结构(Hash表)，允许几乎无限的规模扩张。</p><p>与iptabes相比，IPVS拥有以下明显优势：</p><ul><li>为大型集群提供了更好的可扩展性和性能；</li><li>支持比iptabes更复杂的复制均衡算法(最小负载、最少连接、加权等)；</li><li>支持服务器健康检查和连接重试等功能；</li><li>可以动态修改ipset的集合，即使iptabes的规则正在使用这个集合。</li></ul><h2 id="Kubernetes的静态Pod"><a href="#Kubernetes的静态Pod" class="headerlink" title="Kubernetes的静态Pod"></a>Kubernetes的静态Pod</h2><p>静态pod是由kubeet进行管理的仅存在于特定Node的Pod上，他们不能通过APIServer进行管理，无法与RepicationControer、Depoyment或者DaemonSet进行关联，并且kubeet无法对他们进行健康检查。静态Pod总是由kubelet进行创建，并且总是在kubelet所在的Node上运行。</p><h2 id="Kubernetes中Pod的状态"><a href="#Kubernetes中Pod的状态" class="headerlink" title="Kubernetes中Pod的状态"></a>Kubernetes中Pod的状态</h2><ul><li>Pending：APIServer已经创建该Pod，且Pod内还有一个或多个容器的镜像没有创建，包括正在下载镜像的过程。</li><li>Running：Pod内所有容器均已创建，且至少有一个容器处于运行状态、正在启动状态或正在重启状态。</li><li>Succeeded：Pod内所有容器均成功执行退出，且不会重启。</li><li>Faied：Pod内所有容器均已退出，但至少有一个容器退出为失败状态。</li><li>Unknown：由于某种原因无法获取该Pod状态，可能由于网络通信不畅导致。</li></ul><h2 id="Kubernetes创建Pod的流程？"><a href="#Kubernetes创建Pod的流程？" class="headerlink" title="Kubernetes创建Pod的流程？"></a>Kubernetes创建Pod的流程？</h2><p>Kubernetes中创建一个Pod涉及多个组件之间联动，主要流程如下：</p><ol><li>客户端提交Pod的配置信息(可以是yam文件定义的信息)到kube-apiserver。</li><li>Apiserver收到指令后，通知给controer-manager创建一个资源对象。</li><li>Controer-manager通过api-server将pod的配置信息存储到ETCD数据中心中。</li><li>Kube-scheduer检测到pod信息会开始调度预选，会先过滤掉不符合Pod资源配置要求的节点，然后开始调度调优，主要是挑选出更适合运行pod的节点，然后将pod的资源配置单发送到node节点上的kubeet组件上。</li><li>Kubeet根据scheduer发来的资源配置单运行pod，运行成功后，将pod的运行信息返回给scheduer，scheduer将返回的pod运行状况的信息存储到etcd数据中心。</li></ol><h2 id="Kubernetes中Pod的重启策略"><a href="#Kubernetes中Pod的重启策略" class="headerlink" title="Kubernetes中Pod的重启策略"></a>Kubernetes中Pod的重启策略</h2><p>Pod重启策略(RestartPoicy)应用于Pod内的所有容器，并且仅在Pod所处的Node上由kubeet进行判断和重启操作。当某个容器异常退出或者健康检查失败时，kubeet将根据RestartPoicy的设置来进行相应操作。<br>Pod的重启策略包括Aways、OnFaiure和Never，默认值为Aways。</p><ul><li>Aways：当容器失效时，由kubeet自动重启该容器；</li><li>OnFaiure：当容器终止运行且退出码不为0时，由kubeet自动重启该容器；</li><li>Never：不论容器运行状态如何，kubeet都不会重启该容器。</li></ul><p>同时Pod的重启策略与控制方式关联，当前可用于管理Pod的控制器包括RepicationControer、Job、DaemonSet及直接管理kubelet管理(静态Pod)。不同控制器的重启策略限制如下：</p><ul><li>RC和DaemonSet：必须设置为Aways，需要保证该容器持续运行；</li><li>Job：OnFaiure或Never，确保容器执行完成后不再重启；</li><li>kubelet：在Pod失效时重启，不论将RestartPoicy设置为何值，也不会对Pod进行健康检查。</li></ul><h2 id="Kubernetes中Pod的健康检查方式"><a href="#Kubernetes中Pod的健康检查方式" class="headerlink" title="Kubernetes中Pod的健康检查方式"></a>Kubernetes中Pod的健康检查方式</h2><p>对Pod的健康检查可以通过两类探针来检查：LivenessProbe和ReadinessProbe。</p><ul><li>LivenessProbe探针：用于判断容器是否存活(running状态)，如果ivenessProbe探针探测到容器不健康，则kubeet将杀掉该容器，并根据容器的重启策略做相应处理。若一个容器不包含ivenessProbe探针，kubeet认为该容器的ivenessProbe探针返回值用于是“Success”。</li><li>ReadineeProbe探针：用于判断容器是否启动完成(ready状态)。如果ReadinessProbe探针探测到失败，则Pod的状态将被修改。EndpointControer将从Service的Endpoint中删除包含该容器所在Pod的Eenpoint。</li><li>startupProbe探针：启动检查机制，应用一些启动缓慢的业务，避免业务长时间启动而被上面两类探针ki掉。</li></ul><h2 id="KubernetesPod的LivenessProbe探针的常见方式"><a href="#KubernetesPod的LivenessProbe探针的常见方式" class="headerlink" title="KubernetesPod的LivenessProbe探针的常见方式"></a>KubernetesPod的LivenessProbe探针的常见方式</h2><p>kubeet定期执行ivenessProbe探针来诊断容器的健康状态，通常有以下三种方式：</p><ul><li>ExecAction：在容器内执行一个命令，若返回码为0，则表明容器健康。</li><li>TCPSocketAction：通过容器的IP地址和端口号执行TCP检查，若能建立TCP连接，则表明容器健康。</li><li>HTTPGetAction：通过容器的IP地址、端口号及路径调用HTTPGet方法，若响应的状态码大于等于200且小于400，则表明容器健康。</li></ul><h2 id="KubernetesPod的常见调度方式"><a href="#KubernetesPod的常见调度方式" class="headerlink" title="KubernetesPod的常见调度方式"></a>KubernetesPod的常见调度方式</h2><p>Kubernetes中，Pod通常是容器的载体，主要有如下常见调度方式：</p><ul><li><p>Depoyment或RC：该调度策略主要功能就是自动部署一个容器应用的多份副本，以及持续监控副本的数量，在集群内始终维持用户指定的副本数量。</p></li><li><p>NodeSelector：定向调度，当需要手动指定将Pod调度到特定Node上，可以通过Node的标签(abe)和Pod的nodeSeector属性相匹配。</p></li><li><p>NodeAffinity亲和性调度：亲和性调度机制极大的扩展了Pod的调度能力，目前有两种节点亲和力表达：</p><ul><li>requiredDuringScheduingIgnoredDuringExecution：硬规则，必须满足指定的规则，调度器才可以调度Pod至Node上(类似nodeSeector，语法不同)。</li><li>preferredDuringScheduingIgnoredDuringExecution：软规则，优先调度至满足的Node的节点，但不强求，多个优先级规则还可以设置权重值。</li></ul></li><li><p>Taints和Toerations(污点和容忍)：</p></li><li><p>Taint：使Node拒绝特定Pod运行；</p></li><li><p>Toeration：为Pod的属性，表示Pod能容忍(运行)标注了Taint的Node。</p></li></ul><h2 id="Kubernetes初始化容器-initcontainer"><a href="#Kubernetes初始化容器-initcontainer" class="headerlink" title="Kubernetes初始化容器(initcontainer)"></a>Kubernetes初始化容器(initcontainer)</h2><p>initcontainer的运行方式与应用容器不同，它们必须先于应用容器执行完成，当设置了多个initcontainer时，将按顺序逐个运行，并且只有前一个initcontainer运行成功后才能运行后一个initcontainer。当所有initcontainer都成功运行后，Kubernetes才会初始化Pod的各种信息，并开始创建和运行应用容器。</p><h2 id="Kubernetes-depoyment升级过程"><a href="#Kubernetes-depoyment升级过程" class="headerlink" title="Kubernetes depoyment升级过程"></a>Kubernetes depoyment升级过程</h2><ol><li>初始创建Depoyment时，系统创建了一个RepicaSet，并按用户的需求创建了对应数量的Pod副本。</li><li>当更新Depoyment时，系统创建了一个新的RepicaSet，并将其副本数量扩展到1，然后将旧RepicaSet缩减为2。</li><li>之后，系统继续按照相同的更新策略对新旧两个RepicaSet进行逐个调整。</li><li>最后，新的RepicaSet运行了对应个新版本Pod副本，旧的RepicaSet副本数量则缩减为0。</li></ol><h2 id="Kubernetes-depoyment升级策略"><a href="#Kubernetes-depoyment升级策略" class="headerlink" title="Kubernetes depoyment升级策略"></a>Kubernetes depoyment升级策略</h2><p>在Depoyment的定义中，可以通过spec.strategy指定Pod更新的策略，目前支持两种策略：Recreate(重建)和RoingUpdate(滚动更新)，默认值为RoingUpdate。</p><ul><li>Recreate：设置spec.strategy.type&#x3D;Recreate，表示Depoyment在更新Pod时，会先杀掉所有正在运行的Pod，然后创建新的Pod。</li><li>RoingUpdate：设置spec.strategy.type&#x3D;RoingUpdate，表示Depoyment会以滚动更新的方式来逐个更新Pod。同时，可以通过设置spec.strategy.roingUpdate下的两个参数(maxUnavaiabe和maxSurge)来控制滚动更新的过程。</li></ul><h2 id="Kubernetes-DaemonSet类型的资源特性"><a href="#Kubernetes-DaemonSet类型的资源特性" class="headerlink" title="Kubernetes DaemonSet类型的资源特性"></a>Kubernetes DaemonSet类型的资源特性</h2><p>DaemonSet资源对象会在每个Kubernetes集群中的节点上运行，并且每个节点只能运行一个pod，这是它和depoyment资源对象的最大也是唯一的区别。因此，在定义yam文件中，不支持定义repicas。<br>它的一般使用场景如下：</p><ul><li>在去做每个节点的日志收集工作。</li><li>监控每个节点的的运行状态。</li></ul><h2 id="Kubernetes自动扩容机制"><a href="#Kubernetes自动扩容机制" class="headerlink" title="Kubernetes自动扩容机制"></a>Kubernetes自动扩容机制</h2><p>Kubernetes使用HorizontaPodAutoscaer(HPA)的控制器实现基于CPU使用率进行自动Pod扩缩容的功能。HPA控制器周期性地监测目标Pod的资源性能指标，并与HPA资源对象中的扩缩容条件进行对比，在满足条件时对Pod副本数量进行调整。</p><h3 id="HPA原理"><a href="#HPA原理" class="headerlink" title="HPA原理"></a>HPA原理</h3><p>Kubernetes中的某个MetricsServer(Heapster或自定义MetricsServer)持续采集所有Pod副本的指标数据。HPA控制器通过MetricsServer的API(Heapster的API或聚合API)获取这些数据，基于用户定义的扩缩容规则进行计算，得到目标Pod副本数量。<br>当目标Pod副本数量与当前副本数量不同时，HPA控制器就向Pod的副本控制器(Depoyment、RC或RepicaSet)发起scae操作，调整Pod的副本数量，完成扩缩容操作。</p><h2 id="Kubernetes-Service类型"><a href="#Kubernetes-Service类型" class="headerlink" title="Kubernetes Service类型"></a>Kubernetes Service类型</h2><p>通过创建Service，可以为一组具有相同功能的容器应用提供一个统一的入口地址，并且将请求负载分发到后端的各个容器应用上。其主要类型有：</p><ul><li>CusterIP：虚拟的服务IP地址，该地址用于Kubernetes集群内部的Pod访问，在Node上kube-proxy通过设置的iptabes规则进行转发；</li><li>NodePort：使用宿主机的端口，使能够访问各Node的外部客户端通过Node的IP地址和端口号就能访问服务；</li><li>LoadBaancer：使用外接负载均衡器完成到服务的负载分发，需要在spec.status.oadBaancer字段指定外部负载均衡器的IP地址，通常用于公有云。</li></ul><h2 id="KubernetesService分发后端的策略"><a href="#KubernetesService分发后端的策略" class="headerlink" title="KubernetesService分发后端的策略"></a>KubernetesService分发后端的策略</h2><p>Service负载分发的策略有：RoundRobin和SessionAffinity</p><ul><li>RoundRobin：默认为轮询模式，即轮询将请求转发到后端的各个Pod上。</li><li>SessionAffinity：基于客户端IP地址进行会话保持的模式，即第1次将某个客户端发起的请求转发到后端的某个Pod上，之后从相同的客户端发起的请求都将被转发到后端相同的Pod上。</li></ul><h2 id="Kubernetes-Headess-Service"><a href="#Kubernetes-Headess-Service" class="headerlink" title="Kubernetes Headess Service"></a>Kubernetes Headess Service</h2><p>在某些应用场景中，若需要人为指定负载均衡器，不使用Service提供的默认负载均衡的功能，或者应用程序希望知道属于同组服务的其他实例。Kubernetes提供了HeadessService来实现这种功能，即不为Service设置CusterIP(入口IP地址)，仅通过abeSeector将后端的Pod列表返回给调用的客户端。</p><h2 id="Kubernetes外部如何访问集群内的服务"><a href="#Kubernetes外部如何访问集群内的服务" class="headerlink" title="Kubernetes外部如何访问集群内的服务"></a>Kubernetes外部如何访问集群内的服务</h2><p>对于Kubernetes，集群外的客户端默认情况，无法通过Pod的IP地址或者Service的虚拟IP地址:虚拟端口号进行访问。通常可以通过以下方式进行访问Kubernetes集群内的服务：</p><ul><li>映射Pod到物理机：将Pod端口号映射到宿主机，即在Pod中采用hostPort方式，以使客户端应用能够通过物理机访问容器应用。</li><li>映射Service到物理机：将Service端口号映射到宿主机，即在Service中采用nodePort方式，以使客户端应用能够通过物理机访问容器应用。</li><li>映射Sercie到LoadBaancer：通过设置oadBaancer映射到云服务商提供的LoadBaancer地址。这种用法仅用于在公有云服务提供商的云平台上设置Service的场景。</li></ul><h2 id="Kubernetes-ingress"><a href="#Kubernetes-ingress" class="headerlink" title="Kubernetes ingress"></a>Kubernetes ingress</h2><p>Kubernetes的Ingress资源对象，用于将不同UR的访问请求转发到后端不同的Service，以实现HTTP层的业务路由机制。</p><p>Kubernetes使用了Ingress策略和IngressControer，两者结合并实现了一个完整的Ingress负载均衡器。使用Ingress进行负载分发时，IngressControer基于Ingress规则将客户端请求直接转发到Service对应的后端Endpoint(Pod)上，从而跳过kube-proxy的转发功能，kube-proxy不再起作用，全过程为：ingresscontroer+ingress规则—-&gt;services。<br>同时当IngressControer提供的是对外服务，则实际上实现的是边缘路由器的功能。</p><h2 id="Kubernetes镜像的下载策略"><a href="#Kubernetes镜像的下载策略" class="headerlink" title="Kubernetes镜像的下载策略"></a>Kubernetes镜像的下载策略</h2><p>K8s的镜像下载策略有三种：Aways、Never、IFNotPresent。</p><ul><li>Aways：镜像标签为atest时，总是从指定的仓库中获取镜像。</li><li>Never：禁止从仓库中下载镜像，也就是说只能使用本地镜像。</li><li>IfNotPresent：仅当本地没有对应镜像时，才从目标仓库中下载。默认的镜像下载策略是：当镜像标签是latest时，默认策略是Aways；当镜像标签是自定义时(也就是标签不是latest)，那么默认策略是IfNotPresent。</li></ul><h2 id="Kubernetes的负载均衡器"><a href="#Kubernetes的负载均衡器" class="headerlink" title="Kubernetes的负载均衡器"></a>Kubernetes的负载均衡器</h2><p>负载均衡器是暴露服务的最常见和标准方式之一。</p><p>根据工作环境使用两种类型的负载均衡器，即内部负载均衡器或外部负载均衡器。</p><ul><li>内部负载均衡器自动平衡负载并使用所需配置分配容器;</li><li>外部负载均衡器将流量从外部负载引导至后端容器。</li></ul><h2 id="Kubernetes各模块与APIServer通信"><a href="#Kubernetes各模块与APIServer通信" class="headerlink" title="Kubernetes各模块与APIServer通信"></a>Kubernetes各模块与APIServer通信</h2><p>KubernetesAPIServer作为集群的核心，负责集群各功能模块之间的通信。集群内的各个功能模块通过APIServer将信息存入etcd，当需要获取和操作这些数据时，则通过APIServer提供的REST接口(用GET、IST或WATCH方法)来实现，从而实现各模块之间的信息交互。<br>如kubeet进程与APIServer的交互：每个Node上的kubeet每隔一个时间周期，就会调用一次APIServer的REST接口报告自身状态，APIServer在接收到这些信息后，会将节点状态信息更新到etcd中。<br>如kube-controer-manager进程与APIServer的交互：kube-controer-manager中的NodeControer模块通过APIServer提供的Watch接口实时监控Node的信息，并做相应处理。<br>如kube-scheduer进程与APIServer的交互：Scheduer通过APIServer的Watch接口监听到新建Pod副本的信息后，会检索所有符合该Pod要求的Node列表，开始执行Pod调度逻辑，在调度成功后将Pod绑定到目标节点上。</p><h2 id="Kubernetes-Scheduer作用及实现原理"><a href="#Kubernetes-Scheduer作用及实现原理" class="headerlink" title="Kubernetes Scheduer作用及实现原理"></a>Kubernetes Scheduer作用及实现原理</h2><p>Kubernetes Scheduer是负责Pod调度的重要功能模块，KubernetesScheduer在整个系统中承担了“承上启下”的重要功能，“承上”是指它负责接收ControerManager创建的新Pod，为其调度至目标Node；“启下”是指调度完成后，目标Node上的kubeet服务进程接管后继工作，负责Pod接下来生命周期。KubernetesScheduer的作用是将待调度的Pod(API新创建的Pod、ControerManager为补足副本而创建的Pod等)按照特定的调度算法和调度策略绑定(Binding)到集群中某个合适的Node上，并将绑定信息写入etcd中。<br>在整个调度过程中涉及三个对象，分别是待调度Pod列表、可用Node列表，以及调度算法和策略。</p><p>KubernetesScheduer通过调度算法调度为待调度Pod列表中的每个Pod从Node列表中选择一个最适合的Node来实现Pod的调度。随后，目标节点上的kubeet通过APIServer监听到KubernetesScheduer产生的Pod绑定事件，然后获取对应的Pod清单，下载Image镜像并启动容器。</p><h2 id="KubernetesScheduer使用算法将Pod绑定到worker节点"><a href="#KubernetesScheduer使用算法将Pod绑定到worker节点" class="headerlink" title="KubernetesScheduer使用算法将Pod绑定到worker节点"></a>KubernetesScheduer使用算法将Pod绑定到worker节点</h2><p>KubernetesScheduer根据如下两种调度算法将Pod绑定到最合适的工作节点：</p><ul><li>预选(Predicates)：输入是所有节点，输出是满足预选条件的节点。kube-scheduer根据预选策略过滤掉不满足策略的Nodes。如果某节点的资源不足或者不满足预选策略的条件则无法通过预选。如“Node的abe必须与Pod的Seector一致”。</li><li>优选(Priorities)：输入是预选阶段筛选出的节点，优选会根据优先策略为通过预选的Nodes进行打分排名，选择得分最高的Node。例如，资源越富裕、负载越小的Node可能具有越高的排名。</li></ul><h2 id="Kubernetes-kubelet的作用"><a href="#Kubernetes-kubelet的作用" class="headerlink" title="Kubernetes kubelet的作用"></a>Kubernetes kubelet的作用</h2><p>在Kubernetes集群中，每个Node(又称Worker)上都会启动一个kubelet服务进程。该进程用于处理Master下发到本节点的任务，管理Pod及Pod中的容器。每个kubelet进程都会在APIServer上注册节点自身的信息，定期向Master汇报节点资源的使用情况，并通过cAdvisor监控容器和节点资源。</p><h2 id="Kubernetes-kubelet监控Worker节点资源"><a href="#Kubernetes-kubelet监控Worker节点资源" class="headerlink" title="Kubernetes kubelet监控Worker节点资源"></a>Kubernetes kubelet监控Worker节点资源</h2><p>kubelet使用cAdvisor对worker节点资源进行监控。在Kubernetes系统中，cAdvisor已被默认集成到kubelet组件内，当kubelet服务启动时，它会自动启动cAdvisor服务，然后cAdvisor会实时采集所在节点的性能指标及在节点上运行的容器的性能指标。</p><h2 id="Kubernetes保证集群的安全性"><a href="#Kubernetes保证集群的安全性" class="headerlink" title="Kubernetes保证集群的安全性"></a>Kubernetes保证集群的安全性</h2><p>Kubernetes通过一系列机制来实现集群的安全控制，主要有如下不同的维度：</p><ul><li><p>基础设施方面：保证容器与其所在宿主机的隔离；</p></li><li><p>权限方面</p><ul><li>最小权限原则：合理限制所有组件的权限，确保组件只执行它被授权的行为，<br>通过限制单个组件的能力来限制它的权限范围。</li><li>用户权限：划分普通用户和管理员的角色。</li></ul></li><li><p>集群方面：</p><ul><li>APIServer的认证授权：Kubernetes集群中所有资源的访问和变更都是通过KubernetesAPIServer来实现的，因此需要建议采用更安全的HTTPS或Token来识别和认证客户端身份(Authentication)，以及随后访问权限的授权(Authorization)环节。</li><li>APIServer的授权管理：通过授权策略来决定一个API调用是否合法。对合法用户进行授权并且随后在用户访问时进行鉴权，建议采用更安全的RBAC方式来提升集群安全授权。</li><li>敏感数据引入Secret机制：对于集群敏感数据建议使用Secret方式进行保护。</li><li>AdmissionContro(准入机制)：对kubernetesapi的请求过程中，顺序为：先经过认证&amp;授权，然后执行准入操作，最后对目标对象进行操作。</li></ul></li></ul><h2 id="Kubernetes准入机制"><a href="#Kubernetes准入机制" class="headerlink" title="Kubernetes准入机制"></a>Kubernetes准入机制</h2><p>在对集群进行请求时，每个准入控制代码都按照一定顺序执行。如果有一个准入控制拒绝了此次请求，那么整个请求的结果将会立即返回，并提示用户相应的error信息。<br>准入控制(AdmissionContro)准入控制本质上为一段准入代码，在对kubernetesapi的请求过程中，顺序为：先经过认证&amp;授权，然后执行准入操作，最后对目标对象进行操作。常用组件(控制代码)如下：</p><ul><li>AwaysAdmit：允许所有请求</li><li>AwaysDeny：禁止所有请求，多用于测试环境。</li><li>ServiceAccount：它将serviceAccounts实现了自动化，它会辅助serviceAccount做一些事情，比如如果pod没有serviceAccount属性，它会自动添加一个defaut，并确保pod的serviceAccount始终存在。</li><li>LimitRanger：观察所有的请求，确保没有违反已经定义好的约束条件，这些条件定义在namespace中：LimitRange对象中。</li><li>NamespaceExists：观察所有的请求，如果请求尝试创建一个不存在的namespace，则这个请求被拒绝。</li></ul><h2 id="Kubernetes-RBAC及其特点"><a href="#Kubernetes-RBAC及其特点" class="headerlink" title="Kubernetes RBAC及其特点"></a>Kubernetes RBAC及其特点</h2><p>RBAC是基于角色的访问控制，是一种基于个人用户的角色来管理对计算机或网络资源的访问的方法。<br>相对于其他授权模式，RBAC具有如下优势：</p><ul><li>对集群中的资源和非资源权限均有完整的覆盖。</li><li>整个RBAC完全由几个API对象完成，同其他API对象一样，可以用kubelet或API进行操作。</li><li>可以在运行时进行调整，无须重新启动APIServer。</li></ul><h2 id="Kubernetes-Secret作用"><a href="#Kubernetes-Secret作用" class="headerlink" title="Kubernetes Secret作用"></a>Kubernetes Secret作用</h2><p>Secret对象，主要作用是保管私密数据，比如密码、OAuthTokens、SSHKeys等信息。将这些私密信息放在Secret对象中比直接放在Pod或DockerImage中更安全，也更便于使用和分发。</p><h2 id="Kubernetes-Secret使用方式"><a href="#Kubernetes-Secret使用方式" class="headerlink" title="Kubernetes Secret使用方式"></a>Kubernetes Secret使用方式</h2><p>创建完secret之后，可通过如下三种方式使用：</p><ul><li>在创建Pod时，通过为Pod指定ServiceAccount来自动使用该Secret。</li><li>通过挂载该Secret到Pod来使用它。</li><li>在Docker镜像下载时使用，通过指定Pod的spc.ImagePuSecrets来引用它。</li></ul><h2 id="Kubernetes-PodSecurityPoicy机制"><a href="#Kubernetes-PodSecurityPoicy机制" class="headerlink" title="Kubernetes PodSecurityPoicy机制"></a>Kubernetes PodSecurityPoicy机制</h2><p>KubernetesPodSecurityPoicy是为了更精细地控制Pod对资源的使用方式以及提升安全策略。在开启PodSecurityPoicy准入控制器后，Kubernetes默认不允许创建任何Pod，需要创建PodSecurityPoicy策略和相应的RBAC授权策略(AuthorizingPoicies)，Pod才能创建成功。</p><h2 id="Kubernetes-PodSecurityPoicy能实现的安全策略"><a href="#Kubernetes-PodSecurityPoicy能实现的安全策略" class="headerlink" title="Kubernetes PodSecurityPoicy能实现的安全策略"></a>Kubernetes PodSecurityPoicy能实现的安全策略</h2><p>在PodSecurityPoicy对象中可以设置不同字段来控制Pod运行时的各种安全策略，常见的有：</p><ul><li>特权模式：privileged是否允许Pod以特权模式运行。</li><li>宿主机资源：控制Pod对宿主机资源的控制，如hostPID：是否允许Pod共享宿主机的进程空间。</li><li>用户和组：设置运行容器的用户ID(范围)或组(范围)。</li><li>提升权限：AllowPrivilegeEscalation：设置容器内的子进程是否可以提升权限，通常在设置非root用户(MustRunAsNonRoot)时进行设置。</li><li>SELinux：进行SEinux的相关配置。</li></ul><h2 id="Kubernetes网络模型"><a href="#Kubernetes网络模型" class="headerlink" title="Kubernetes网络模型"></a>Kubernetes网络模型</h2><p>Kubernetes网络模型中每个Pod都拥有一个独立的IP地址，并假定所有Pod都在一个可以直接连通的、扁平的网络空间中。所以不管它们是否运行在同一个Node(宿主机)中，都要求它们可以直接通过对方的IP进行访问。设计这个原则的原因是，用户不需要额外考虑如何建立Pod之间的连接，也不需要考虑如何将容器端口映射到主机端口等问题。</p><p>同时为每个Pod都设置一个IP地址的模型使得同一个Pod内的不同容器会共享同一个网络命名空间，也就是同一个inux网络协议栈。这就意味着同一个Pod内的容器可以通过ocahost来连接对方的端口。<br>在Kubernetes的集群里，IP是以Pod为单位进行分配的。一个Pod内部的所有容器共享一个网络堆栈(相当于一个网络命名空间，它们的IP地址、网络设备、配置等都是共享的)。</p><h2 id="Kubernetes-CNI模型"><a href="#Kubernetes-CNI模型" class="headerlink" title="Kubernetes CNI模型"></a>Kubernetes CNI模型</h2><p>CNI提供了一种应用容器的插件化网络解决方案，定义对容器网络进行操作和配置的规范，通过插件的形式对CNI接口进行实现。CNI仅关注在创建容器时分配网络资源，和在销毁容器时删除网络资源。在CNI模型中只涉及两个概念：容器和网络。</p><ul><li>容器(Container)：是拥有独立inux网络命名空间的环境，例如使用Docker或rkt创建的容器。容器需要拥有自己的inux网络命名空间，这是加入网络的必要条件。</li><li>网络(Network)：表示可以互连的一组实体，这些实体拥有各自独立、唯一的IP地址，可以是容器、物理机或者其他网络设备(比如路由器)等。</li></ul><p>对容器网络的设置和操作都通过插件(Pugin)进行具体实现，CNI插件包括两种类型：CNI Plugin和IPAM(IPAddress Management)Plugin。CNI Plugin负责为容器配置网络资源，IPAM Plugin负责对容器的IP地址进行分配和管理。IPAM Plugin作为CNI Plugin的一部分，与CNI Plugin协同工作。</p><h2 id="Kubernetes-网络策略"><a href="#Kubernetes-网络策略" class="headerlink" title="Kubernetes 网络策略"></a>Kubernetes 网络策略</h2><p>为实现细粒度的容器间网络访问隔离策略，Kubernetes引入NetworkPolicy。NetworkPolicy的主要功能是对Pod间的网络通信进行限制和准入控制，设置允许访问或禁止访问的客户端Pod列表。Network Policy定义网络策略，配合策略控制器(PoicyControer)进行策略的实现。</p><h2 id="Kubernetes网络策略原理"><a href="#Kubernetes网络策略原理" class="headerlink" title="Kubernetes网络策略原理"></a>Kubernetes网络策略原理</h2><p>NetworkPoicy的工作原理主要为：poicycontroer需要实现一个APIistener，监听用户设置的NetworkPoicy定义，并将网络访问规则通过各Node的Agent进行实际设置(Agent则需要通过CNI网络插件实现)。</p><h2 id="Kubernetes中flanne的作用"><a href="#Kubernetes中flanne的作用" class="headerlink" title="Kubernetes中flanne的作用"></a>Kubernetes中flanne的作用</h2><p>Flanne可以用于Kubernetes底层网络的实现，主要作用有：</p><ul><li>它能协助Kubernetes，给每一个Node上的Docker容器都分配互相不冲突的IP地址。</li><li>它能在这些IP地址之间建立一个覆盖网络(OverayNetwork)，通过这个覆盖网络，将数据包原封不动地传递到目标容器内。</li></ul><h2 id="Kubernetes-Caico网络组件实现原理"><a href="#Kubernetes-Caico网络组件实现原理" class="headerlink" title="Kubernetes Caico网络组件实现原理"></a>Kubernetes Caico网络组件实现原理</h2><p>Caico是一个基于BGP的纯三层的网络方案，与OpenStack、Kubernetes、AWS、GCE等云平台都能够良好地集成。</p><p>Caico在每个计算节点都利用inuxKerne实现了一个高效的vRouter来负责数据转发。每个vRouter都通过BGP协议把在本节点上运行的容器的路由信息向整个Caico网络广播，并自动设置到达其他节点的路由转发规则。</p><p>Caico保证所有容器之间的数据流量都是通过IP路由的方式完成互联互通的。Caico节点组网时可以直接利用数据中心的网络结构(2或者3)，不需要额外的NAT、隧道或者OverayNetwork，没有额外的封包解包，能够节约CPU运算，提高网络效率。</p><h2 id="Kubernetes共享存储的作用"><a href="#Kubernetes共享存储的作用" class="headerlink" title="Kubernetes共享存储的作用"></a>Kubernetes共享存储的作用</h2><p>Kubernetes对于有状态的容器应用或者对数据需要持久化的应用，因此需要更加可靠的存储来保存应用产生的重要数据，以便容器应用在重建之后仍然可以使用之前的数据。因此需要使用共享存储。</p><h2 id="Kubernetes数据持久化的方式有哪些？"><a href="#Kubernetes数据持久化的方式有哪些？" class="headerlink" title="Kubernetes数据持久化的方式有哪些？"></a>Kubernetes数据持久化的方式有哪些？</h2><p>Kubernetes通过数据持久化来持久化保存重要数据，常见的方式有：</p><ul><li>EmptyDir(空目录)：没有指定要挂载宿主机上的某个目录，直接由Pod内保部映射到宿主机上。类似于docker中的managervoume。<ul><li>场景<ul><li>只需要临时将数据保存在磁盘上，比如在合并&#x2F;排序算法中；</li><li>作为两个容器的共享存储。</li></ul></li><li>特性<ul><li>同个pod里面的不同容器，共享同一个持久化目录，当pod节点删除时，voume的数据也会被删除。</li><li>emptyDir的数据持久化的生命周期和使用的pod一致，一般是作为临时存储使用。</li></ul></li></ul></li><li>Hostpath：将宿主机上已存在的目录或文件挂载到容器内部。类似于docker中的bindmount挂载方式。<ul><li>特性<ul><li>增加了pod与节点之间的鹅合。</li></ul></li></ul></li><li>PersistentVoume(简称PV)：如基于NFS服务的PV，也可以基于GFS的PV。它的作用是统一数据持久化目录，方便管理。</li></ul><h2 id="Kubernetes-PV和PVC"><a href="#Kubernetes-PV和PVC" class="headerlink" title="Kubernetes PV和PVC"></a>Kubernetes PV和PVC</h2><p>PV是对底层网络共享存储的抽象，将共享存储定义为一种“资源”。</p><p>PVC则是用户对存储资源的一个“申请”。</p><h2 id="Kubernetes-PV生命周期内的阶段"><a href="#Kubernetes-PV生命周期内的阶段" class="headerlink" title="Kubernetes PV生命周期内的阶段"></a>Kubernetes PV生命周期内的阶段</h2><p>某个PV在生命周期中可能处于以下4个阶段(Phaes)之一。</p><ul><li>Avaiabe：可用状态，还未与某个PVC绑定。</li><li>Bound：已与某个PVC绑定。</li><li>Reeased：绑定的PVC已经删除，资源已释放，但没有被集群回收。</li><li>Faied：自动资源回收失败。</li></ul><h2 id="Kubernetes所支持的存储供应模式"><a href="#Kubernetes所支持的存储供应模式" class="headerlink" title="Kubernetes所支持的存储供应模式"></a>Kubernetes所支持的存储供应模式</h2><p>答：Kubernetes支持两种资源的存储供应模式：静态模式(Static)和动态模式(Dynamic)。</p><ul><li>静态模式：集群管理员手工创建许多PV，在定义PV时需要将后端存储的特性进行设置。</li><li>动态模式：集群管理员无须手工创建PV，而是通过StorageCass的设置对后端</li></ul><p>存储进行描述，标记为某种类型。此时要求PVC对存储的类型进行声明，系统将自动完成PV的创建及与PVC的绑定。</p><h2 id="Kubernetes-CSI模型"><a href="#Kubernetes-CSI模型" class="headerlink" title="Kubernetes CSI模型"></a>Kubernetes CSI模型</h2><p>Kubernetes CSI是Kubernetes推出与容器对接的存储接口标准，存储提供方只需要基于标准接口进行存储插件的实现，就能使用Kubernetes的原生存储机制为容器提供存储服务。CSI使得存储提供方的代码能和Kubernetes代码彻底解耦，部署也与Kubernetes核心组件分离，显然，存储插件的开发由提供方自行维护，就能为Kubernetes用户提供更多的存储功能，也更加安全可靠。<br>CSI包括CSI Controer和CSI Node：</p><ul><li>CSI Controer的主要功能是提供存储服务视角对存储资源和存储卷进行管理和</li><li>操作。</li><li>CSI Node的主要功能是对主机(Node)上的Voume进行管理和操作。</li></ul><h2 id="Kubernetes-Worker节点加入集群的过程"><a href="#Kubernetes-Worker节点加入集群的过程" class="headerlink" title="Kubernetes Worker节点加入集群的过程"></a>Kubernetes Worker节点加入集群的过程</h2><p>通常需要对Worker节点进行扩容，从而将应用系统进行水平扩展。主要过程如下：</p><ol><li>在该Node上安装Docker、kubeet和kube-proxy服务；</li><li>然后配置kubeet和kubeproxy的启动参数，将MasterUR指定为当前Kubernetes集群Master的地址，最后启动这些服务；</li><li>通过kubeet默认的自动注册机制，新的Worker将会自动加入现有的Kubernetes集群中；</li><li>KubernetesMaster在接受了新Worker的注册之后，会自动将其纳入当前集群的调度范围。</li></ol><h2 id="Kubernetes-Pod如何实现对节点的资源控制"><a href="#Kubernetes-Pod如何实现对节点的资源控制" class="headerlink" title="Kubernetes Pod如何实现对节点的资源控制"></a>Kubernetes Pod如何实现对节点的资源控制</h2><p>Kubernetes集群里的节点提供的资源主要是计算资源，计算资源是可计量的能被申请、分配和使用的基础资源。当前Kubernetes集群中的计算资源主要包括CPU、GPU及Memory。CPU与Memory是被Pod使用的，因此在配置Pod时可以通过参数CPURequest及MemoryRequest为其中的每个容器指定所需使用的CPU与Memory量，Kubernetes会根据Request的值去查找有足够资源的Node来调度此Pod。<br>通常，一个程序所使用的CPU与Memory是一个动态的量，确切地说，是一个范围，跟它的负载密切相关：负载增加时，CPU和Memory的使用量也会增加。</p><h2 id="Kubernetes-Requests和imits影响Pod的调度"><a href="#Kubernetes-Requests和imits影响Pod的调度" class="headerlink" title="Kubernetes Requests和imits影响Pod的调度"></a>Kubernetes Requests和imits影响Pod的调度</h2><p>当一个Pod创建成功时，Kubernetes调度器(Scheduer)会为该Pod选择一个节点来执行。对于每种计算资源(CPU和Memory)而言，每个节点都有一个能用于运行Pod的最大容量值。调度器在调度时，首先要确保调度后该节点上所有Pod的CPU和内存的Requests总和，不超过该节点能提供给Pod使用的CPU和Memory的最大容量值。</p><h2 id="Kubernetes-Metric-Service"><a href="#Kubernetes-Metric-Service" class="headerlink" title="Kubernetes Metric Service"></a>Kubernetes Metric Service</h2><p>在Kubernetes从1.10版本后采用MetricsServer作为默认的性能数据采集和监控，主要用于提供核心指标(CoreMetrics)，包括Node、Pod的CPU和内存使用指标。<br>对其他自定义指标(CustomMetrics)的监控则由Prometheus等组件来完成。</p><h2 id="Kubernetes中，使用EFK实现日志的统一管理"><a href="#Kubernetes中，使用EFK实现日志的统一管理" class="headerlink" title="Kubernetes中，使用EFK实现日志的统一管理"></a>Kubernetes中，使用EFK实现日志的统一管理</h2><p>在Kubernetes集群环境中，通常一个完整的应用或服务涉及组件过多，建议对日志系统进行集中化管理，通常采用EFK实现。<br>EFK是Easticsearch、Fuentd和Kibana的组合，其各组件功能如下：</p><ul><li>Easticsearch：是一个搜索引擎，负责存储日志并提供查询接口；</li><li>Fuentd：负责从Kubernetes搜集日志，每个node节点上面的fuentd监控并收集该节点上面的系统日志，并将处理过后的日志信息发送给Easticsearch；</li><li>Kibana：提供了一个WebGUI，用户可以浏览和搜索存储在Easticsearch中的日志。</li></ul><p>通过在每台node上部署一个以DaemonSet方式运行的fuentd来收集每台node上的日志。Fuentd将docker日志目录&#x2F;var&#x2F;ib&#x2F;docker&#x2F;containers和&#x2F;var&#x2F;og目录挂载到Pod中，然后Pod会在node节点的&#x2F;var&#x2F;og&#x2F;pods目录中创建新的目录，可以区别不同的容器日志输出，该目录下有一个日志文件链接到&#x2F;var&#x2F;ib&#x2F;docker&#x2F;contianers目录下的容器日志输出。</p><h2 id="Kubernetes进行优雅的节点关机维护"><a href="#Kubernetes进行优雅的节点关机维护" class="headerlink" title="Kubernetes进行优雅的节点关机维护"></a>Kubernetes进行优雅的节点关机维护</h2><p>由于Kubernetes节点运行大量Pod，因此在进行关机维护之前，建议先使用kubect drain将该节点的Pod进行驱逐，然后进行关机维护。</p><h2 id="Kubernetes集群联邦"><a href="#Kubernetes集群联邦" class="headerlink" title="Kubernetes集群联邦"></a>Kubernetes集群联邦</h2><p>Kubernetes集群联邦可以将多个Kubernetes集群作为一个集群进行管理。因此，可以在一个数据中心&#x2F;云中创建多个Kubernetes集群，并使用集群联邦在一个地方控制&#x2F;管理所有集群。</p><h2 id="Hem及其优势"><a href="#Hem及其优势" class="headerlink" title="Hem及其优势"></a>Hem及其优势</h2><p>Hem是Kubernetes的软件包管理工具。类似Ubuntu中使用的apt、Centos中使用的yum或者Python中的pip一样。<br>Hem能够将一组K8S资源打包统一管理,是查找、共享和使用为Kubernetes构建的软件的最佳方式。</p><p>Hem中通常每个包称为一个Chart，一个Chart是一个目录(一般情况下会将目录进行打包压缩，形成name-version.tgz格式的单一文件，方便传输和存储)。</p><h3 id="Hem优势"><a href="#Hem优势" class="headerlink" title="Hem优势"></a>Hem优势</h3><p>在Kubernetes中部署一个可以使用的应用，需要涉及到很多的Kubernetes资源的共同协作。使用hem则具有如下优势：</p><ul><li>统一管理、配置和更新这些分散的k8s的应用资源文件；</li><li>分发和复用一套应用模板；</li><li>将应用的一系列资源当做一个软件包管理。<ul><li>对于应用发布者而言，可以通过Hem打包应用、管理应用依赖关系、管理应用版本并发布应用到软件仓库。</li><li>对于使用者而言，使用Hem后不用需要编写复杂的应用部署文件，可以以简单的方式在Kubernetes上查找、安装、升级、回滚、卸载应用程序。</li></ul></li></ul><h2 id="etcd及其特点"><a href="#etcd及其特点" class="headerlink" title="etcd及其特点"></a>etcd及其特点</h2><p>etcd是CoreOS团队发起的开源项目，是一个管理配置信息和服务发现(servicediscovery)的项目，它的目标是构建一个高可用的分布式键值(key-vaue)数据库，基于Go语言实现。<br>特点：</p><ul><li>简单：支持REST风格的HTTP+JSONAPI</li><li>安全：支持HTTPS方式的访问</li><li>快速：支持并发1k&#x2F;s的写操作</li><li>可靠：支持分布式结构，基于Raft的一致性算法，Raft是一套通过选举主节点来实现分布式系统一致性的算法。</li></ul><h2 id="etcd适应的场景"><a href="#etcd适应的场景" class="headerlink" title="etcd适应的场景"></a>etcd适应的场景</h2><ul><li>服务发现(ServiceDiscovery)：服务发现主要解决在同一个分布式集群中的进程或服务，要如何才能找到对方并建立连接。本质上来说，服务发现就是想要了解集群中是否有进程在监听udp或tcp端口，并且通过名字就可以查找和连接。</li><li>消息发布与订阅：在分布式系统中，最适用的一种组件间通信方式就是消息发布与订阅。即构建一个配置共享中心，数据提供者在这个配置中心发布消息，而消息使用者则订阅他们关心的主题，一旦主题有消息发布，就会实时通知订阅者。通过这种方式可以做到分布式系统配置的集中式管理与动态更新。应用中用到的一些配置信息放到etcd上进行集中管理。</li><li>负载均衡：在分布式系统中，为了保证服务的高可用以及数据的一致性，通常都会把数据和服务部署多份，以此达到对等服务，即使其中的某一个服务失效了，也不影响使用。etcd本身分布式架构存储的信息访问支持负载均衡。etcd集群化以后，每个etcd的核心节点都可以处理用户的请求。所以，把数据量小但是访问频繁的消息数据直接存储到etcd中也可以实现负载均衡的效果。</li><li>分布式通知与协调：与消息发布和订阅类似，都用到了etcd中的Watcher机制，通过注册与异步通知机制，实现分布式环境下不同系统之间的通知与协调，从而对数据变更做到实时处理。</li><li>分布式锁：因为etcd使用Raft算法保持了数据的强一致性，某次操作存储到集<br>群中的值必然是全局一致的，所以很容易实现分布式锁。锁服务有两种使用方式，<br>一是保持独占，二是控制时序。</li><li>集群监控与eader竞选：通过etcd来进行监控实现起来非常简单并且实时性强。</li></ul><p>（完）</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>Kubernetes</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Docker</tag>
      
      <tag>Kubernetes</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MPV播放器默认快捷键</title>
    <link href="/blog/2024/04/MPV%E6%92%AD%E6%94%BE%E5%99%A8%E9%BB%98%E8%AE%A4%E5%BF%AB%E6%8D%B7%E9%94%AE.html"/>
    <url>/blog/2024/04/MPV%E6%92%AD%E6%94%BE%E5%99%A8%E9%BB%98%E8%AE%A4%E5%BF%AB%E6%8D%B7%E9%94%AE.html</url>
    
    <content type="html"><![CDATA[<h2 id="键盘控制"><a href="#键盘控制" class="headerlink" title="键盘控制"></a>键盘控制</h2><table><thead><tr><th>快捷键</th><th>功能</th><th>配置项</th></tr></thead><tbody><tr><td>← →</td><td>前进&#x2F;后退5秒，加shift变为移动1秒</td><td><code>--hr-seek</code></td></tr><tr><td>↑↓</td><td>前进&#x2F;后退60秒，加shift变为5秒</td><td><code>--hr-seek</code></td></tr><tr><td>Ctrl+← &#x2F;→</td><td>切换字幕</td><td>sub-seek</td></tr><tr><td>Ctrl+Shift+← &#x2F;→</td><td>调整字幕延迟</td><td></td></tr><tr><td>[ 和 ]</td><td>减少&#x2F;增加当前播放速度的10%</td><td></td></tr><tr><td>{ 和 }</td><td>减半&#x2F;加倍播放速度</td><td></td></tr><tr><td>&lt; 和 &gt;</td><td>在播放列表中后退&#x2F;前进</td><td></td></tr><tr><td>p或空格</td><td>暂停&#x2F;播放</td><td></td></tr><tr><td>,&#x2F;.</td><td>前&#x2F;后逐帧播放，点一下移动一帧</td><td></td></tr><tr><td><kbd>q</kbd></td><td>退出</td><td></td></tr><tr><td><kbd>Q</kbd></td><td>退出，但保存当前播放位置</td><td></td></tr><tr><td>&#x2F; 和* ， 9和0</td><td>减少&#x2F;增加音量</td><td></td></tr><tr><td>m</td><td>静音</td><td></td></tr><tr><td>-</td><td>循环视频轨</td><td></td></tr><tr><td>#</td><td>循环音轨</td><td></td></tr><tr><td>f</td><td>全屏切换</td><td>–fs</td></tr><tr><td>ESC</td><td>退出全屏</td><td></td></tr><tr><td><kbd>Shift</kbd>+<kbd>t</kbd></td><td>置顶&#x2F;取消置顶</td><td></td></tr><tr><td>w 和 W</td><td>减少&#x2F;增加平移和扫描范围。目前 <code>e</code> 键与 <code>W</code> 键的作用相同但不赞成使用</td><td></td></tr><tr><td>o (或 P)</td><td>按住显示进度条</td><td></td></tr><tr><td>v</td><td>显示或隐藏字幕</td><td></td></tr><tr><td>j&#x2F;J</td><td>切换字幕</td><td></td></tr><tr><td>z 和 Z</td><td>调节字幕延迟0.1秒</td><td></td></tr><tr><td>l</td><td>设置ab循环点</td><td>ab-loop</td></tr><tr><td>L</td><td>切换无限循环</td><td></td></tr><tr><td>Ctrl + 和 Ctrl -</td><td>调节音轨延迟0.1秒</td><td></td></tr><tr><td>u</td><td>去除字幕样式</td><td>–sub-ass-override</td></tr><tr><td>V</td><td>切换字幕的VSFilter长宽比兼容模式</td><td>–sub-ass-vsfilter-aspect-compat</td></tr><tr><td>r 和 R</td><td>调整字幕位置</td><td></td></tr><tr><td>s</td><td>截屏</td><td></td></tr><tr><td>S</td><td>截屏（不截字幕）</td><td></td></tr><tr><td>Ctrl+s</td><td>截屏（包含界面）</td><td></td></tr><tr><td>PGUP PGDWN</td><td>切换章节</td><td>–chapter-seek-threshold</td></tr><tr><td>Shift+PGUP&#x2F;PGDWN</td><td>后退&#x2F;前进10分钟</td><td></td></tr><tr><td>d</td><td>激活&#x2F;注销去隔行扫描器</td><td></td></tr><tr><td>A</td><td>循环长宽比覆盖</td><td></td></tr><tr><td>Ctrl h</td><td>切换硬件加速</td><td></td></tr><tr><td>Alt+↑↓← →</td><td>视频位置调整</td><td></td></tr><tr><td>Alt + 和 Alt -</td><td>缩放视频</td><td></td></tr><tr><td>Alt+BACKSPACE</td><td>重置视频位置和缩放</td><td></td></tr><tr><td>F8</td><td>显示播放列表</td><td></td></tr><tr><td>F9</td><td>显示视音频stream列表</td><td></td></tr><tr><td>i 和 I</td><td>显示几秒&#x2F;切换 详细状态信息显示（1,2,3翻页）</td><td></td></tr><tr><td>Del</td><td>调节OSC显示方式（进度条之类的）</td><td></td></tr><tr><td>1 和 2</td><td>对比度调节</td><td></td></tr><tr><td>3 和 4</td><td>明亮度调节</td><td></td></tr><tr><td>5 和 6</td><td>调整伽马Adjust gamma</td><td></td></tr><tr><td>7 和 8</td><td>调节饱和度</td><td></td></tr><tr><td>Alt+0</td><td>50%原视频大小</td><td></td></tr><tr><td>Alt+1</td><td>原视频大小</td><td></td></tr><tr><td>Alt+2</td><td>2倍原视频大小</td><td></td></tr></tbody></table><h2 id="鼠标控制"><a href="#鼠标控制" class="headerlink" title="鼠标控制"></a>鼠标控制</h2><table><thead><tr><th>鼠标操作</th><th>功能</th></tr></thead><tbody><tr><td>左键双击</td><td>切换全屏的开&#x2F;关</td></tr><tr><td>右键</td><td>切换暂停的开&#x2F;关</td></tr><tr><td>前进&#x2F;后退键</td><td>跳至播放列表中的下&#x2F;上一个条目</td></tr><tr><td>滚轮向上&#x2F;下</td><td>减少&#x2F;增加音量</td></tr><tr><td>滚轮向左&#x2F;右</td><td>向前&#x2F;向后跳转10秒</td></tr></tbody></table><p><img src="/blog/./assets/v2-672e28d79cc4d140187d84c25a79aeae_1440w.png" alt="MPV默认快捷键表"></p><p>（完）</p><p><strong>参考</strong></p><ul><li><a href="https://mpv.io/manual/master/#keyboard-control">keyboard-control</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>操作演示</category>
      
    </categories>
    
    
    <tags>
      
      <tag>MPV</tag>
      
      <tag>快捷键</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Markdown导出带大纲目录的Html</title>
    <link href="/blog/2024/04/Markdown%E5%AF%BC%E5%87%BA%E5%B8%A6%E5%A4%A7%E7%BA%B2%E7%9B%AE%E5%BD%95%E7%9A%84Html.html"/>
    <url>/blog/2024/04/Markdown%E5%AF%BC%E5%87%BA%E5%B8%A6%E5%A4%A7%E7%BA%B2%E7%9B%AE%E5%BD%95%E7%9A%84Html.html</url>
    
    <content type="html"><![CDATA[<h2 id="Typora导出HTML"><a href="#Typora导出HTML" class="headerlink" title="Typora导出HTML"></a>Typora导出HTML</h2><h3 id="原生侧边栏导出"><a href="#原生侧边栏导出" class="headerlink" title="原生侧边栏导出"></a>原生侧边栏导出</h3><p>Typora导出HTML是支持导出目录大纲的，导出的时候勾选<strong>保留大纲侧边栏</strong>。</p><p><img src="/blog/./assets/image-20240404225835454.png" alt="导出保留大纲侧边栏"></p><p>导出后的样式有些美观，侧边栏左侧空隙过大。但是锚点和功能都可以正常使用，是一种快速方便的导出HTML且保留大纲的方式。</p><p><img src="/blog/./assets/image-20240404230059074.png" alt="默认导出大纲样式"></p><h3 id="自定义导出样式"><a href="#自定义导出样式" class="headerlink" title="自定义导出样式"></a>自定义导出样式</h3><p>根据通过引入外部样式来自定义修改导出的HTML样式。导出的自定义样式效果如下：</p><p><img src="/blog/./assets/image-20240404230400534.png" alt="自定义导出大纲样式"></p><h4 id="配置步骤"><a href="#配置步骤" class="headerlink" title="配置步骤"></a>配置步骤</h4><ol><li><p>下载<code>jquery-3.3.1.min.js</code>文件到本地文件。</p><p><a href="https://code.jquery.com/jquery-3.3.1.min.js">下载地址</a></p></li><li><p>保存下面的css内容为<code>md2html.js</code>文件。</p></li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//是否显示导航栏</span><br> <span class="hljs-keyword">var</span> showNavBar = <span class="hljs-literal">true</span>;<br> <span class="hljs-comment">//是否展开导航栏</span><br> <span class="hljs-keyword">var</span> expandNavBar = <span class="hljs-literal">true</span>;<br><br> $(<span class="hljs-variable language_">document</span>).<span class="hljs-title function_">ready</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br><br>    <span class="hljs-keyword">var</span> h1s = $(<span class="hljs-string">&quot;body&quot;</span>).<span class="hljs-title function_">find</span>(<span class="hljs-string">&quot;h1&quot;</span>);<br>    <span class="hljs-keyword">var</span> h2s = $(<span class="hljs-string">&quot;body&quot;</span>).<span class="hljs-title function_">find</span>(<span class="hljs-string">&quot;h2&quot;</span>);<br>    <span class="hljs-keyword">var</span> h3s = $(<span class="hljs-string">&quot;body&quot;</span>).<span class="hljs-title function_">find</span>(<span class="hljs-string">&quot;h3&quot;</span>);<br>    <span class="hljs-keyword">var</span> h4s = $(<span class="hljs-string">&quot;body&quot;</span>).<span class="hljs-title function_">find</span>(<span class="hljs-string">&quot;h4&quot;</span>);<br>    <span class="hljs-keyword">var</span> h5s = $(<span class="hljs-string">&quot;body&quot;</span>).<span class="hljs-title function_">find</span>(<span class="hljs-string">&quot;h5&quot;</span>);<br>    <span class="hljs-keyword">var</span> h6s = $(<span class="hljs-string">&quot;body&quot;</span>).<span class="hljs-title function_">find</span>(<span class="hljs-string">&quot;h6&quot;</span>);<br><br>   <span class="hljs-keyword">var</span> links = <span class="hljs-variable language_">document</span>.<span class="hljs-property">links</span>;<br>   <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; links.<span class="hljs-property">length</span>; i++) &#123;<br>    <span class="hljs-keyword">if</span> (!links[i].<span class="hljs-property">target</span>) &#123;<br>        <span class="hljs-keyword">if</span> (<br>            links[i].<span class="hljs-property">hostname</span> !== <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">hostname</span> || <br>            <span class="hljs-regexp">/\.(?!html?)([a-z]&#123;0,3&#125;|[a-zt]&#123;0,4&#125;)$/</span>.<span class="hljs-title function_">test</span>(links[i].<span class="hljs-property">pathname</span>)<br>        ) &#123;<br>            links[i].<span class="hljs-property">target</span> = <span class="hljs-string">&#x27;_blank&#x27;</span>;<br>            &#125; <br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">var</span> headCounts = [h1s.<span class="hljs-property">length</span>, h2s.<span class="hljs-property">length</span>, h3s.<span class="hljs-property">length</span>, h4s.<span class="hljs-property">length</span>, h5s.<span class="hljs-property">length</span>, h6s.<span class="hljs-property">length</span>];<br>    <span class="hljs-comment">// 获取所有样式</span><br>    <span class="hljs-keyword">var</span> vH1Tag = <span class="hljs-literal">null</span>;<br>    <span class="hljs-keyword">var</span> vH2Tag = <span class="hljs-literal">null</span>;<br>    <span class="hljs-keyword">var</span> vH3Tag = <span class="hljs-literal">null</span>;<br>    <span class="hljs-keyword">var</span> vH4Tag = <span class="hljs-literal">null</span>;<br>    <span class="hljs-keyword">var</span> vH5Tag = <span class="hljs-literal">null</span>;<br>    <span class="hljs-keyword">var</span> vH6Tag = <span class="hljs-literal">null</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; headCounts.<span class="hljs-property">length</span>; i++)&#123;<br>        <span class="hljs-keyword">if</span>(headCounts[i] &gt; <span class="hljs-number">0</span>)&#123;<br>            <span class="hljs-keyword">if</span>(vH1Tag == <span class="hljs-literal">null</span>)&#123;<br>                vH1Tag = <span class="hljs-string">&#x27;h&#x27;</span> + (i + <span class="hljs-number">1</span>);<br>            &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(vH2Tag == <span class="hljs-literal">null</span>)&#123;<br>                vH2Tag = <span class="hljs-string">&#x27;h&#x27;</span> + (i + <span class="hljs-number">1</span>);<br>            &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(vH3Tag == <span class="hljs-literal">null</span>)&#123;<br>                vH3Tag = <span class="hljs-string">&#x27;h&#x27;</span> + (i + <span class="hljs-number">1</span>);<br>            &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(vH4Tag == <span class="hljs-literal">null</span>)&#123;<br>                vH4Tag = <span class="hljs-string">&#x27;h&#x27;</span> + (i + <span class="hljs-number">1</span>);<br>            &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(vH5Tag == <span class="hljs-literal">null</span>)&#123;<br>                vH5Tag = <span class="hljs-string">&#x27;h&#x27;</span> + (i + <span class="hljs-number">1</span>);<br>            &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(vH6Tag == <span class="hljs-literal">null</span>)&#123;<br>                vH6Tag = <span class="hljs-string">&#x27;h&#x27;</span> + (i + <span class="hljs-number">1</span>);<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">if</span>(vH1Tag == <span class="hljs-literal">null</span>)&#123;<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// 导航侧边栏</span><br>    $(<span class="hljs-string">&quot;body&quot;</span>).<span class="hljs-title function_">prepend</span>(<span class="hljs-string">&#x27;&lt;div class=&quot;BlogAnchor&quot;&gt;&#x27;</span> + <br>        <br>        <span class="hljs-string">&#x27;&lt;p class=&quot;html_header&quot;&gt;&#x27;</span> + <br>            <span class="hljs-string">&#x27;&lt;span&gt;&lt;/span&gt;&#x27;</span> + <br>        <span class="hljs-string">&#x27;&lt;/p&gt;&#x27;</span> + <br>        <span class="hljs-string">&#x27;&lt;div class=&quot;AnchorContent&quot; id=&quot;AnchorContent&quot;&gt; &lt;/div&gt;&#x27;</span> +<br>    <span class="hljs-string">&#x27;&lt;/div&gt;&#x27;</span> );<br><br>    <span class="hljs-keyword">var</span> menuIndex = <span class="hljs-number">0</span>;<br>    $(<span class="hljs-string">&quot;body&quot;</span>).<span class="hljs-title function_">find</span>(<span class="hljs-string">&quot;h1,h2,h3,h4,h5,h6&quot;</span>).<span class="hljs-title function_">each</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">i,item</span>)&#123;<br>        <span class="hljs-keyword">var</span> id = <span class="hljs-string">&#x27;&#x27;</span>;<br>        <span class="hljs-keyword">var</span> tag = $(item).<span class="hljs-title function_">get</span>(<span class="hljs-number">0</span>).<span class="hljs-property">tagName</span>.<span class="hljs-title function_">toLowerCase</span>();<br>        <span class="hljs-keyword">var</span> className = <span class="hljs-string">&#x27;&#x27;</span>;<br>        <span class="hljs-keyword">if</span>(tag == vH1Tag)&#123;<br>            className = <span class="hljs-string">&#x27;item_h1&#x27;</span>;<br>        &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(tag == vH2Tag)&#123;<br>            className = <span class="hljs-string">&#x27;item_h2&#x27;</span>;<br>        &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(tag == vH3Tag)&#123;<br>            className = <span class="hljs-string">&#x27;item_h3&#x27;</span>;<br>        &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(tag == vH4Tag)&#123;<br>            className = <span class="hljs-string">&#x27;item_h4&#x27;</span>;<br>        &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(tag == vH5Tag)&#123;<br>            className = <span class="hljs-string">&#x27;item_h5&#x27;</span>;<br>        &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(tag == vH6Tag)&#123;<br>            className = <span class="hljs-string">&#x27;item_h6&#x27;</span>;<br>        &#125;<br><br>        <span class="hljs-comment">//修改 id 生成策略</span><br>        id = <span class="hljs-string">&quot;_&quot;</span> + menuIndex;<br>        menuIndex++;<br><br>        $(item).<span class="hljs-title function_">attr</span>(<span class="hljs-string">&quot;id&quot;</span>,<span class="hljs-string">&quot;wow&quot;</span>+id);<br>        $(item).<span class="hljs-title function_">addClass</span>(<span class="hljs-string">&quot;wow_head&quot;</span>);<br>        $(<span class="hljs-string">&quot;#AnchorContent&quot;</span>).<span class="hljs-title function_">css</span>(<span class="hljs-string">&#x27;max-height&#x27;</span>, ($(<span class="hljs-variable language_">window</span>).<span class="hljs-title function_">height</span>() - <span class="hljs-number">80</span>) + <span class="hljs-string">&#x27;px&#x27;</span>);<br>        $(<span class="hljs-string">&quot;#AnchorContent&quot;</span>).<span class="hljs-title function_">append</span>(<span class="hljs-string">&#x27;&lt;li&gt;&lt;a class=&quot;nav_item &#x27;</span>+className+<span class="hljs-string">&#x27; anchor-link&quot; onclick=&quot;return false;&quot; href=&quot;#&quot; link=&quot;#wow&#x27;</span>+id+<span class="hljs-string">&#x27;&quot;&gt;&#x27;</span>+<span class="hljs-string">&quot;&quot;</span>+<span class="hljs-string">&quot;&quot;</span>+$(<span class="hljs-variable language_">this</span>).<span class="hljs-title function_">text</span>()+<span class="hljs-string">&#x27;&lt;/a&gt;&lt;/li&gt;&#x27;</span>);<br>    &#125;);<br><br>    <br>    $(<span class="hljs-string">&quot;.anchor-link&quot;</span>).<span class="hljs-title function_">click</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>        $(<span class="hljs-string">&quot;html,body&quot;</span>).<span class="hljs-title function_">animate</span>(&#123;<span class="hljs-attr">scrollTop</span>: $($(<span class="hljs-variable language_">this</span>).<span class="hljs-title function_">attr</span>(<span class="hljs-string">&quot;link&quot;</span>)).<span class="hljs-title function_">offset</span>().<span class="hljs-property">top</span>&#125;, <span class="hljs-number">500</span>);<br>    &#125;);<br><br>    <span class="hljs-keyword">var</span> headerNavs = $(<span class="hljs-string">&quot;.BlogAnchor li .nav_item&quot;</span>);<br>    <span class="hljs-keyword">var</span> headerTops = [];<br>    $(<span class="hljs-string">&quot;.wow_head&quot;</span>).<span class="hljs-title function_">each</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">i, n</span>)&#123;<br>        headerTops.<span class="hljs-title function_">push</span>($(n).<span class="hljs-title function_">offset</span>().<span class="hljs-property">top</span>);<br>    &#125;);<br>    $(<span class="hljs-variable language_">window</span>).<span class="hljs-title function_">scroll</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-keyword">var</span> scrollTop = $(<span class="hljs-variable language_">window</span>).<span class="hljs-title function_">scrollTop</span>();<br>        $.<span class="hljs-title function_">each</span>(headerTops, <span class="hljs-keyword">function</span>(<span class="hljs-params">i, n</span>)&#123;<br>            <span class="hljs-keyword">var</span> distance = n - scrollTop;<br>            <span class="hljs-keyword">if</span>(distance &gt;= <span class="hljs-number">0</span>)&#123;<br>                $(<span class="hljs-string">&quot;.BlogAnchor li .nav_item.current&quot;</span>).<span class="hljs-title function_">removeClass</span>(<span class="hljs-string">&#x27;current&#x27;</span>);<br>                $(headerNavs[i]).<span class="hljs-title function_">addClass</span>(<span class="hljs-string">&#x27;current&#x27;</span>);<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>            &#125;<br>        &#125;);<br>    &#125;);<br><br>    <span class="hljs-keyword">if</span>(!showNavBar)&#123;<br>        $(<span class="hljs-string">&#x27;.BlogAnchor&#x27;</span>).<span class="hljs-title function_">hide</span>();<br>    &#125;<br>    <span class="hljs-keyword">if</span>(!expandNavBar)&#123;<br>        $(<span class="hljs-string">&quot;#AnchorContent&quot;</span>).<span class="hljs-title function_">hide</span>();<br>    &#125;<br> &#125;);<br><br><br> $(<span class="hljs-variable language_">window</span>).<span class="hljs-title function_">resize</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>  $(<span class="hljs-string">&quot;#AnchorContent&quot;</span>).<span class="hljs-title function_">css</span>(<span class="hljs-string">&#x27;max-height&#x27;</span>, ($(<span class="hljs-variable language_">window</span>).<span class="hljs-title function_">height</span>() - <span class="hljs-number">80</span>) + <span class="hljs-string">&#x27;px&#x27;</span>);<br>&#125;);<br><br><br><span class="hljs-comment">//插入title的ico图标  </span><br><span class="hljs-keyword">var</span> ico_link = <span class="hljs-string">&quot;&lt;link rel=icon  sizes=32x32 href=favicon.ico&gt;&quot;</span>;<br>$(<span class="hljs-string">&quot;head&quot;</span>).<span class="hljs-title function_">prepend</span>(ico_link);<br></code></pre></td></tr></table></figure><ol start="3"><li>保存下面的css内容为md2html.css文件。</li></ol><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-comment">/*markdown_box*/</span><br>    <span class="hljs-selector-tag">html</span>&#123;<span class="hljs-attribute">background</span>: <span class="hljs-number">#F4F6F9</span>; <span class="hljs-attribute">font-family</span>:<span class="hljs-string">&quot;Microsoft YaHei&quot;</span>, <span class="hljs-string">&quot;微软雅黑&quot;</span>, Arial; <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">400</span>&#125;<br>    <span class="hljs-selector-tag">body</span>&#123;<span class="hljs-attribute">background</span>:<span class="hljs-number">#F4F6F9</span>;<span class="hljs-attribute">font-size</span>: <span class="hljs-number">16px</span>; <span class="hljs-attribute">color</span>: <span class="hljs-number">#515254</span>; <span class="hljs-attribute">line-height</span>: <span class="hljs-number">188%</span>; <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> <span class="hljs-meta">!important</span>; <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span> <span class="hljs-meta">!important</span>;&#125;<br>    <span class="hljs-selector-class">.html_header</span>&#123;<span class="hljs-attribute">display</span>:block; <span class="hljs-attribute">height</span>: <span class="hljs-number">60px</span>; <span class="hljs-attribute">line-height</span>: <span class="hljs-number">46px</span>; <span class="hljs-attribute">border-bottom</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#E6ECF1</span>; <span class="hljs-attribute">text-align</span>: left <span class="hljs-meta">!important</span>;&#125;<br>    <span class="hljs-selector-class">.html_header</span> <span class="hljs-selector-tag">span</span><span class="hljs-selector-pseudo">::after</span>&#123;<span class="hljs-attribute">content</span>: <span class="hljs-string">&quot;导航目录&quot;</span>; <span class="hljs-attribute">font-size</span>: <span class="hljs-number">17px</span>; <span class="hljs-attribute">font-weight</span>: bold;&#125;<br>    <span class="hljs-selector-class">.html_header</span> <span class="hljs-selector-tag">span</span><span class="hljs-selector-pseudo">::before</span>&#123;<span class="hljs-attribute">content</span>: <span class="hljs-string">&quot;❖&quot;</span>; <span class="hljs-attribute">font-size</span>: <span class="hljs-number">19px</span>; <span class="hljs-attribute">font-weight</span>: bold; <span class="hljs-attribute">margin</span>:<span class="hljs-number">0</span> <span class="hljs-number">8px</span> <span class="hljs-number">0</span> <span class="hljs-number">5px</span>; <span class="hljs-attribute">color</span>: <span class="hljs-number">#1284d9</span>&#125;<br>    <span class="hljs-selector-tag">blockquote</span>&#123;<span class="hljs-attribute">border-radius</span>:<span class="hljs-number">0</span> <span class="hljs-number">4px</span> <span class="hljs-number">4px</span> <span class="hljs-number">0</span>;<span class="hljs-attribute">color</span>:<span class="hljs-number">#708090</span>;<span class="hljs-attribute">border-left</span>:<span class="hljs-number">3px</span> solid <span class="hljs-number">#1284d9</span>; <span class="hljs-attribute">background</span>:<span class="hljs-built_in">rgba</span>(<span class="hljs-number">238</span>,<span class="hljs-number">242</span>,<span class="hljs-number">249</span>,.<span class="hljs-number">7</span>); <span class="hljs-attribute">padding</span>:<span class="hljs-number">8px</span> <span class="hljs-number">16px</span>; <span class="hljs-attribute">font-size</span>: <span class="hljs-number">15px</span>;&#125;<br>    <span class="hljs-selector-tag">code</span>&#123;<span class="hljs-attribute">padding</span>: <span class="hljs-number">2px</span> <span class="hljs-number">4px</span> <span class="hljs-number">1px</span>; <span class="hljs-attribute">font-weight</span>: bold; <span class="hljs-attribute">margin</span>:<span class="hljs-number">0</span> <span class="hljs-number">3px</span>; <span class="hljs-attribute">border</span>:<span class="hljs-number">1px</span> solid <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>,<span class="hljs-number">130</span>,<span class="hljs-number">130</span>,.<span class="hljs-number">3</span>);<span class="hljs-attribute">background</span>:<span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>,<span class="hljs-number">130</span>,<span class="hljs-number">120</span>,.<span class="hljs-number">05</span>); <span class="hljs-attribute">color</span>:<span class="hljs-number">#F66</span>; <span class="hljs-attribute">font-family</span>:arial;&#125;<br>    <span class="hljs-selector-tag">a</span>&#123;<span class="hljs-attribute">color</span>: <span class="hljs-number">#1284d9</span>&#125;<br>    <span class="hljs-selector-tag">a</span><span class="hljs-selector-pseudo">:visited</span>&#123;<span class="hljs-attribute">color</span>:<span class="hljs-number">#1284d9</span>&#125;<br>    <span class="hljs-selector-tag">a</span><span class="hljs-selector-pseudo">:hover</span>&#123;<span class="hljs-attribute">text-decoration</span>: none; <span class="hljs-attribute">color</span>: <span class="hljs-number">#087cd2</span>&#125;<br><br>    <span class="hljs-selector-tag">h2</span>&#123;<span class="hljs-attribute">margin</span>: <span class="hljs-number">40px</span> <span class="hljs-number">0</span> <span class="hljs-number">20px</span>; <span class="hljs-attribute">font-size</span>: <span class="hljs-number">36px</span>; <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">400</span>&#125;<br>    <span class="hljs-selector-tag">h3</span>&#123;<span class="hljs-attribute">margin-top</span>: <span class="hljs-number">40px</span>; <span class="hljs-attribute">font-size</span>: <span class="hljs-number">30px</span>; <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">400</span>&#125;<br>    <span class="hljs-selector-tag">img</span>&#123;<span class="hljs-attribute">border-radius</span>:<span class="hljs-number">5px</span>;<span class="hljs-attribute">margin</span>:<span class="hljs-number">30px</span> <span class="hljs-number">0</span> <span class="hljs-number">46px</span> <span class="hljs-meta">!important</span>;<span class="hljs-attribute">width</span>:<span class="hljs-number">100%</span>;<span class="hljs-attribute">max-width</span>: <span class="hljs-number">1100px</span>; <span class="hljs-attribute">opacity</span>: .<span class="hljs-number">6</span>; <span class="hljs-attribute">transition</span>: opacity .<span class="hljs-number">3s</span>&#125;<br>    <span class="hljs-selector-tag">img</span><span class="hljs-selector-pseudo">:hover</span>&#123;<span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>&#125;<br><br><br>    <span class="hljs-selector-id">#write</span>&#123;<span class="hljs-attribute">margin</span>:<span class="hljs-number">50px</span> <span class="hljs-number">50px</span> <span class="hljs-number">50px</span> <span class="hljs-number">260px</span>; <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span> <span class="hljs-number">60px</span>; <span class="hljs-attribute">max-width</span>: unset; <span class="hljs-attribute">background</span>: <span class="hljs-number">#fff</span>;<span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#E6ECF1</span>; <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">2px</span> <span class="hljs-number">8px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">116</span>, <span class="hljs-number">129</span>, <span class="hljs-number">141</span>, .<span class="hljs-number">08</span>); <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">4px</span>&#125;<br>    <span class="hljs-selector-class">.BlogAnchor</span> &#123;<span class="hljs-attribute">width</span>: <span class="hljs-number">330px</span> <span class="hljs-meta">!important</span>&#125;<br><br>    <span class="hljs-keyword">@media</span> screen <span class="hljs-keyword">and</span> (<span class="hljs-attribute">max-width</span>: <span class="hljs-number">1620px</span>) &#123;<br>        <span class="hljs-selector-id">#write</span>&#123;<span class="hljs-attribute">margin</span>:<span class="hljs-number">40px</span> <span class="hljs-number">40px</span> <span class="hljs-number">40px</span> <span class="hljs-number">250px</span>; <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span> <span class="hljs-number">40px</span>;&#125;<br>        <span class="hljs-selector-class">.BlogAnchor</span> &#123;<span class="hljs-attribute">width</span>: <span class="hljs-number">330px</span> <span class="hljs-meta">!important</span>&#125;<br>    &#125;<br><br>    <span class="hljs-keyword">@media</span> screen <span class="hljs-keyword">and</span> (<span class="hljs-attribute">max-width</span>: <span class="hljs-number">1370px</span>) &#123;<br>        <span class="hljs-selector-id">#write</span>&#123;<span class="hljs-attribute">margin</span>:<span class="hljs-number">30px</span> <span class="hljs-number">30px</span> <span class="hljs-number">30px</span> <span class="hljs-number">230px</span>; <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span> <span class="hljs-number">40px</span>;&#125;<br>        <span class="hljs-selector-class">.BlogAnchor</span> &#123;<span class="hljs-attribute">width</span>: <span class="hljs-number">200px</span> <span class="hljs-meta">!important</span>&#125;<br>    &#125;<br><br>    <span class="hljs-keyword">@media</span> screen <span class="hljs-keyword">and</span> (<span class="hljs-attribute">max-width</span>: <span class="hljs-number">1220px</span>) &#123;<br>        <span class="hljs-selector-id">#write</span>&#123;<span class="hljs-attribute">margin</span>:<span class="hljs-number">20px</span> <span class="hljs-number">20px</span> <span class="hljs-number">20px</span> <span class="hljs-number">220px</span>; <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span> <span class="hljs-number">40px</span>;&#125;<br>    &#125;<br><br>    <span class="hljs-keyword">@media</span> screen <span class="hljs-keyword">and</span> (<span class="hljs-attribute">max-width</span>: <span class="hljs-number">820px</span>) &#123;<br>        <span class="hljs-selector-id">#write</span>&#123;<span class="hljs-attribute">margin</span>:<span class="hljs-number">20px</span> <span class="hljs-number">20px</span> <span class="hljs-number">20px</span> <span class="hljs-number">200px</span>; <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span> <span class="hljs-number">20px</span>; <span class="hljs-attribute">font-size</span>: <span class="hljs-number">15px</span>; <span class="hljs-attribute">line-height</span>: <span class="hljs-number">170%</span>&#125;<br>        <span class="hljs-selector-class">.BlogAnchor</span> &#123;<span class="hljs-attribute">width</span>: <span class="hljs-number">180px</span> <span class="hljs-meta">!important</span>&#125;<br>        <span class="hljs-selector-class">.html_header</span> <span class="hljs-selector-tag">span</span><span class="hljs-selector-pseudo">::before</span>&#123; <span class="hljs-attribute">margin-left</span>: <span class="hljs-number">0</span>&#125;<br>        <span class="hljs-selector-class">.html_header</span> <span class="hljs-selector-tag">span</span><span class="hljs-selector-pseudo">::after</span>&#123; <span class="hljs-attribute">font-size</span>: <span class="hljs-number">15px</span>;&#125;<br>        <span class="hljs-selector-tag">h2</span>&#123; <span class="hljs-attribute">font-size</span>: <span class="hljs-number">30px</span>; &#125;<br>        <span class="hljs-selector-tag">h3</span>&#123; <span class="hljs-attribute">font-size</span>: <span class="hljs-number">24px</span>; &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">@media</span> screen <span class="hljs-keyword">and</span> (<span class="hljs-attribute">max-width</span>: <span class="hljs-number">640px</span>) &#123;<br>        <span class="hljs-selector-id">#write</span>&#123;<span class="hljs-attribute">margin</span>:<span class="hljs-number">10px</span>; <span class="hljs-attribute">padding</span>: <span class="hljs-number">16px</span>; <span class="hljs-attribute">font-size</span>: <span class="hljs-number">14px</span>; <span class="hljs-attribute">line-height</span>: <span class="hljs-number">160%</span>&#125;<br>        <span class="hljs-selector-class">.BlogAnchor</span> &#123;<span class="hljs-attribute">display</span>: none;&#125;<br>        <span class="hljs-selector-tag">h2</span>&#123; <span class="hljs-attribute">font-size</span>: <span class="hljs-number">28px</span>; &#125;<br>        <span class="hljs-selector-tag">h3</span>&#123; <span class="hljs-attribute">font-size</span>: <span class="hljs-number">22px</span>; &#125;<br>    &#125;<br><br><br><span class="hljs-comment">/*scroll_style*/</span><br><span class="hljs-selector-class">.AnchorContent</span> &#123;<br>    <span class="hljs-attribute">overflow-y</span>: auto <span class="hljs-meta">!important</span>;<br>    <span class="hljs-attribute">overflow-x</span>: hidden <span class="hljs-meta">!important</span>;<br>    <span class="hljs-attribute">margin-right</span>:<span class="hljs-number">0</span> <span class="hljs-meta">!important</span><br>&#125;<br><br><span class="hljs-selector-class">.AnchorContent</span>::-webkit-scrollbar &#123;<br>    <span class="hljs-attribute">width</span>: <span class="hljs-number">6px</span>;<br>    <span class="hljs-attribute">height</span>: <span class="hljs-number">10px</span>;<br>    <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>) <span class="hljs-meta">!important</span>;<br>    <span class="hljs-attribute">position</span>: absolute;<br>    <span class="hljs-attribute">right</span>: <span class="hljs-number">10px</span><br>&#125;<br><span class="hljs-selector-class">.AnchorContent</span>::-webkit-scrollbar-track &#123;<br>    -webkit-<span class="hljs-attribute">box-shadow</span>: none;<br>    <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">0</span>;<br>    <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>) <span class="hljs-meta">!important</span><br>&#125;<br><span class="hljs-selector-class">.AnchorContent</span>::-webkit-scrollbar-thumb &#123;<br>    <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">0px</span>;<br>    -webkit-<span class="hljs-attribute">box-shadow</span>: none;<br>    <span class="hljs-attribute">background-color</span>: none;<br>    <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span> <span class="hljs-meta">!important</span>;<br>    <span class="hljs-attribute">transition</span>: all .<span class="hljs-number">3s</span><br>&#125;<br><br><span class="hljs-selector-class">.AnchorContent</span><span class="hljs-selector-pseudo">:hover</span>::-webkit-scrollbar-thumb &#123;<br>    <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">0px</span>;<br>    -webkit-<span class="hljs-attribute">box-shadow</span>: none;<br>    <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#d4d6d8</span>;<br>    <span class="hljs-attribute">border-right</span>:<span class="hljs-number">2px</span> solid <span class="hljs-number">#fff</span>;<br>    <span class="hljs-attribute">opacity</span>:<span class="hljs-number">1</span>;<br>&#125;<br><br><span class="hljs-selector-class">.AnchorContent</span>::-webkit-scrollbar-thumb:hover &#123;<br>    <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#c0c2c4</span> <span class="hljs-meta">!important</span><br>&#125;<br><br><br><span class="hljs-comment">/*导航*/</span><br>    <span class="hljs-selector-class">.BlogAnchor</span> &#123;<br>        <span class="hljs-attribute">background</span>: <span class="hljs-number">#fff</span>;<br>        <span class="hljs-attribute">padding</span>: <span class="hljs-number">10px</span> <span class="hljs-number">0</span> ;<br>        <span class="hljs-attribute">line-height</span>: <span class="hljs-number">180%</span>;<br>        <span class="hljs-attribute">position</span>: fixed;<br>        <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;<br>        <span class="hljs-attribute">width</span>: <span class="hljs-number">200px</span>;<br>        <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>;<br>        <span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>;<br>        <span class="hljs-attribute">border-right</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#E6ECF1</span>;<br><br>    &#125;<br>    <span class="hljs-selector-class">.BlogAnchor</span> <span class="hljs-selector-tag">p</span> &#123;<br>        <span class="hljs-attribute">font-size</span>: <span class="hljs-number">20px</span>;<br>        <span class="hljs-attribute">color</span>: <span class="hljs-number">#444</span>;<br>        <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> <span class="hljs-number">16px</span>;<br>        <span class="hljs-attribute">text-align</span>: center;<br>    &#125;<br>    <span class="hljs-selector-class">.BlogAnchor</span> <span class="hljs-selector-class">.AnchorContent</span> &#123;<br>        <span class="hljs-attribute">padding</span>: <span class="hljs-number">5px</span> <span class="hljs-number">0px</span>;<br>        <span class="hljs-attribute">overflow</span>: auto;<br>    &#125;<br>    <span class="hljs-selector-class">.BlogAnchor</span> <span class="hljs-selector-tag">li</span>&#123;<br>        <span class="hljs-attribute">text-indent</span>: <span class="hljs-number">1.5rem</span>;<br>        <span class="hljs-attribute">font-size</span>: <span class="hljs-number">14px</span>;<br>        <span class="hljs-attribute">list-style</span>: none;<br>        <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span> <span class="hljs-number">0px</span>;<br>    &#125;<br>    <span class="hljs-selector-class">.BlogAnchor</span> <span class="hljs-selector-tag">li</span> <span class="hljs-selector-class">.nav_item</span>&#123;<br>        <span class="hljs-attribute">padding</span>:<span class="hljs-number">3px</span> <span class="hljs-number">16px</span>;<br><br>    &#125;<br>    <span class="hljs-selector-class">.BlogAnchor</span> <span class="hljs-selector-tag">li</span> <span class="hljs-selector-class">.item_h1</span>&#123;<br>        <span class="hljs-attribute">margin-left</span>: <span class="hljs-number">0rem</span>;<br>        <span class="hljs-attribute">padding-left</span>:<span class="hljs-number">3px</span>;<br>        <span class="hljs-attribute">font-size</span>: <span class="hljs-number">1rem</span>;<br>        <span class="hljs-attribute">font-weight</span>: bold;<br>    &#125;<br>    <span class="hljs-selector-class">.BlogAnchor</span> <span class="hljs-selector-tag">li</span> <span class="hljs-selector-class">.item_h2</span>&#123;<br>        <span class="hljs-attribute">margin-left</span>: <span class="hljs-number">0</span>;<br>        <span class="hljs-attribute">font-size</span>: <span class="hljs-number">0.9rem</span>;<br>        <span class="hljs-attribute">padding-left</span>: <span class="hljs-number">18px</span>;<br>        <span class="hljs-attribute">font-weight</span>: bold;<br>    &#125;<br>    <span class="hljs-selector-class">.BlogAnchor</span> <span class="hljs-selector-tag">li</span> <span class="hljs-selector-class">.item_h3</span>&#123;<br>        <span class="hljs-attribute">margin-left</span>: <span class="hljs-number">0</span>;<br>        <span class="hljs-attribute">font-size</span>: <span class="hljs-number">0.8rem</span>;<br>        <span class="hljs-attribute">padding-left</span>: <span class="hljs-number">33px</span>;<br>    &#125;<br>    <span class="hljs-selector-class">.BlogAnchor</span> <span class="hljs-selector-tag">li</span> <span class="hljs-selector-class">.item_h4</span>&#123;<br>        <span class="hljs-attribute">margin-left</span>: <span class="hljs-number">0</span>;<br>        <span class="hljs-attribute">font-size</span>: <span class="hljs-number">0.7rem</span>;<br>        <span class="hljs-attribute">padding-left</span>: <span class="hljs-number">48px</span>;<br>    &#125;<br>    <span class="hljs-selector-class">.BlogAnchor</span> <span class="hljs-selector-tag">li</span> <span class="hljs-selector-class">.item_h5</span>&#123;<br>        <span class="hljs-attribute">margin-left</span>: <span class="hljs-number">0</span>;<br>        <span class="hljs-attribute">font-size</span>: <span class="hljs-number">0.7rem</span>;<br>        <span class="hljs-attribute">padding-left</span>: <span class="hljs-number">63px</span>;<br>    &#125;<br>    <span class="hljs-selector-class">.BlogAnchor</span> <span class="hljs-selector-tag">li</span> <span class="hljs-selector-class">.item_h6</span>&#123;<br>        <span class="hljs-attribute">margin-left</span>: <span class="hljs-number">0</span>;<br>        <span class="hljs-attribute">font-size</span>: <span class="hljs-number">0.7rem</span>;<br>        <span class="hljs-attribute">padding-left</span>: <span class="hljs-number">78px</span>;<br>    &#125;<br>    <span class="hljs-selector-class">.BlogAnchor</span> <span class="hljs-selector-tag">li</span> <span class="hljs-selector-class">.nav_item</span><span class="hljs-selector-class">.current</span>&#123;<br>        <span class="hljs-attribute">color</span>: <span class="hljs-number">#087cd2</span>;<br>        <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">238</span>,<span class="hljs-number">242</span>,<span class="hljs-number">249</span>,.<span class="hljs-number">8</span>);<br>        <span class="hljs-attribute">border-left</span>:<span class="hljs-number">4px</span> solid <span class="hljs-number">#087cd2</span>;<br>        <span class="hljs-attribute">text-indent</span>: <span class="hljs-number">20px</span>;<br>        <span class="hljs-attribute">font-weight</span>: bold;<br><br>    &#125;<br>    <span class="hljs-selector-id">#AnchorContentToggle</span> &#123;<br>        <span class="hljs-attribute">font-size</span>: <span class="hljs-number">13px</span>;<br>        <span class="hljs-attribute">font-weight</span>: normal;<br>        <span class="hljs-attribute">color</span>: <span class="hljs-number">#FFF</span>;<br>        <span class="hljs-attribute">display</span>: inline-block;<br>        <span class="hljs-attribute">line-height</span>: <span class="hljs-number">20px</span>;<br>        <span class="hljs-attribute">background</span>: <span class="hljs-built_in">rgb</span>(<span class="hljs-number">7</span>,<span class="hljs-number">196</span>,<span class="hljs-number">189</span>);<br>        <span class="hljs-attribute">font-style</span>: normal;<br>        <span class="hljs-attribute">padding</span>: <span class="hljs-number">1px</span> <span class="hljs-number">8px</span>;<br>    &#125;<br>    <span class="hljs-selector-class">.BlogAnchor</span> <span class="hljs-selector-tag">a</span><span class="hljs-selector-pseudo">:hover</span> &#123;<br>        <span class="hljs-attribute">color</span>: <span class="hljs-number">#087cd2</span>  ;<br>        <span class="hljs-attribute">background</span>:<span class="hljs-built_in">rgba</span>(<span class="hljs-number">238</span>,<span class="hljs-number">242</span>,<span class="hljs-number">249</span>,.<span class="hljs-number">5</span>);<br>    &#125;<br>    <span class="hljs-selector-class">.BlogAnchor</span> <span class="hljs-selector-tag">a</span> &#123;<br>        <span class="hljs-attribute">text-decoration</span>: none;<br>        <span class="hljs-attribute">color</span>: <span class="hljs-number">#333</span>;<br>        <span class="hljs-attribute">display</span>: block;<br>        <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">0px</span>;<br>    &#125;<br></code></pre></td></tr></table></figure><ol start="4"><li>设置Typora导出的偏好，将下载和保存的文件配置到导出HTML的header位置。</li></ol><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;C:\Users\maojun\code\static\jquery-3.3.1.min.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;C:\Users\maojun\code\static\md2html.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;stylesheet&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/css&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;C:\Users\maojun\code\static\md2html.css&quot;</span>&gt;</span><br></code></pre></td></tr></table></figure><p><img src="/blog/./assets/image-20240404225227093.png" alt="导出HTML添加样式"></p><blockquote><p>注意，不要勾选保留大纲侧边栏，否则会生成2个侧边栏。</p></blockquote><p>（完）</p><p><strong>参考</strong></p><ul><li><a href="https://github.com/icanleric/other/blob/master/Typora%202%20Html%E5%B8%A6%E7%9B%AE%E5%BD%95.md">Typora 2 Html带目录</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>操作演示</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Markdown</tag>
      
      <tag>Typora</tag>
      
      <tag>Html</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Windows设置操作URI指令</title>
    <link href="/blog/2024/03/Windows%E8%AE%BE%E7%BD%AE%E6%93%8D%E4%BD%9CURI%E6%8C%87%E4%BB%A4.html"/>
    <url>/blog/2024/03/Windows%E8%AE%BE%E7%BD%AE%E6%93%8D%E4%BD%9CURI%E6%8C%87%E4%BB%A4.html</url>
    
    <content type="html"><![CDATA[<h2 id="ms-settings-URI-方案参考"><a href="#ms-settings-URI-方案参考" class="headerlink" title="ms-settings: URI 方案参考"></a>ms-settings: URI 方案参考</h2><p>以下部分描述了用于打开“设置”应用的不同页面的各类 ms-settings URI：</p><ul><li><a href="https://learn.microsoft.com/zh-cn/windows/uwp/launch-resume/launch-settings-app#accounts">帐户</a></li><li><a href="https://learn.microsoft.com/zh-cn/windows/uwp/launch-resume/launch-settings-app#apps">应用</a></li><li><a href="https://learn.microsoft.com/zh-cn/windows/uwp/launch-resume/launch-settings-app#control-center">控制中心</a></li><li><a href="https://learn.microsoft.com/zh-cn/windows/uwp/launch-resume/launch-settings-app#cortana">Cortana</a></li><li><a href="https://learn.microsoft.com/zh-cn/windows/uwp/launch-resume/launch-settings-app#devices">设备</a></li><li><a href="https://learn.microsoft.com/zh-cn/windows/uwp/launch-resume/launch-settings-app#ease-of-access">轻松访问</a></li><li><a href="https://learn.microsoft.com/zh-cn/windows/uwp/launch-resume/launch-settings-app#extras">附加信息</a></li><li><a href="https://learn.microsoft.com/zh-cn/windows/uwp/launch-resume/launch-settings-app#family-group">家庭组</a></li><li><a href="https://learn.microsoft.com/zh-cn/windows/uwp/launch-resume/launch-settings-app#gaming">游戏</a></li><li><a href="https://learn.microsoft.com/zh-cn/windows/uwp/launch-resume/launch-settings-app#mixed-reality">混合现实</a></li><li><a href="https://learn.microsoft.com/zh-cn/windows/uwp/launch-resume/launch-settings-app#network-and-internet">网络和 Internet</a></li><li><a href="https://learn.microsoft.com/zh-cn/windows/uwp/launch-resume/launch-settings-app#personalization">个性化设置</a></li><li><a href="https://learn.microsoft.com/zh-cn/windows/uwp/launch-resume/launch-settings-app#phone">电话</a></li><li><a href="https://learn.microsoft.com/zh-cn/windows/uwp/launch-resume/launch-settings-app#privacy">隐私</a></li><li><a href="https://learn.microsoft.com/zh-cn/windows/uwp/launch-resume/launch-settings-app#search">搜索</a></li><li><a href="https://learn.microsoft.com/zh-cn/windows/uwp/launch-resume/launch-settings-app#surface-hub">Surface Hub</a></li><li><a href="https://learn.microsoft.com/zh-cn/windows/uwp/launch-resume/launch-settings-app#system">系统</a></li><li><a href="https://learn.microsoft.com/zh-cn/windows/uwp/launch-resume/launch-settings-app#time-and-language">时间和语言</a></li><li><a href="https://learn.microsoft.com/zh-cn/windows/uwp/launch-resume/launch-settings-app#update-and-security">更新和安全</a></li><li><a href="https://learn.microsoft.com/zh-cn/windows/uwp/launch-resume/launch-settings-app#user-accounts">用户帐户</a></li></ul><h3 id="帐户"><a href="#帐户" class="headerlink" title="帐户"></a>帐户</h3><table><thead><tr><th align="left">“设置”页面</th><th align="left">URI</th></tr></thead><tbody><tr><td align="left">访问工作单位或学校</td><td align="left">ms-settings:workplace</td></tr><tr><td align="left">电子邮件和应用帐户</td><td align="left">ms-settings:emailandaccounts</td></tr><tr><td align="left">家人和其他人</td><td align="left">ms-settings:otherusers</td></tr><tr><td align="left">设置展台</td><td align="left">ms-settings:assignedaccess</td></tr><tr><td align="left">登录选项</td><td align="left">ms-settings:signinoptions ms-settings:signinoptions-dynamiclock</td></tr><tr><td align="left">同步你的设置</td><td align="left">ms-settings:sync ms-settings:backup（已在 Windows 11 中弃用的备份页）</td></tr><tr><td align="left">Windows Hello 设置</td><td align="left">ms-settings:signinoptions-launchfaceenrollment ms-settings:signinoptions-launchfingerprintenrollment</td></tr><tr><td align="left">你的信息</td><td align="left">ms-settings:yourinfo</td></tr></tbody></table><h3 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h3><table><thead><tr><th align="left">“设置”页面</th><th align="left">URI</th></tr></thead><tbody><tr><td align="left">应用和功能</td><td align="left">ms-settings:appsfeatures</td></tr><tr><td align="left">应用功能</td><td align="left">ms-settings:appsfeatures-app（应用的重置、管理加载项和可下载内容等）  若要使用 URI 访问此页面，请使用 ms-settings:appsfeatures-app URI 并传递应用的“包系列名称”的可选参数。</td></tr><tr><td align="left">网站应用</td><td align="left">ms-settings:appsforwebsites</td></tr><tr><td align="left">默认应用</td><td align="left">ms-settings:defaultapps（<strong>在 Windows 11 版本 21H2（具有 2023-04 累积更新）或 22H2（具有 2023-04 累积更新）或更高版本中引入的行为。</strong>） 使用应用的 URI 转义名称以下列格式追加查询字符串参数，以直接启动该应用的默认设置页：  - registeredAppMachine&#x3D;&lt;应用的 URI 转义的每台计算机安装名&gt; - registeredAppUser&#x3D;&lt;应用的 URI 转义的每个用户安装名&gt; - registeredAUMID&#x3D;&lt;URI 转义的应用程序用户模型 ID&gt;  有关详细信息，请参阅<a href="https://learn.microsoft.com/zh-cn/windows/uwp/launch-resume/launch-default-apps-settings">启动默认应用设置页</a>。</td></tr><tr><td align="left">默认浏览器设置</td><td align="left">ms-settings:defaultbrowsersettings（<strong>在 Windows 11 中弃用</strong>）</td></tr><tr><td align="left">管理可选功能</td><td align="left">ms-settings:optionalfeatures</td></tr><tr><td align="left">脱机地图</td><td align="left">ms-settings:maps ms-settings:maps-downloadmaps（下载地图）</td></tr><tr><td align="left">启动应用</td><td align="left">ms-settings:startupapps</td></tr><tr><td align="left">视频播放</td><td align="left">ms-settings:videoplayback</td></tr></tbody></table><h3 id="控制中心"><a href="#控制中心" class="headerlink" title="控制中心"></a>控制中心</h3><table><thead><tr><th align="left">“设置”页面</th><th align="left">URI</th></tr></thead><tbody><tr><td align="left">控制中心</td><td align="left">ms-settings:controlcenter</td></tr></tbody></table><h3 id="Cortana"><a href="#Cortana" class="headerlink" title="Cortana"></a>Cortana</h3><table><thead><tr><th align="left">“设置”页面</th><th align="left">URI</th></tr></thead><tbody><tr><td align="left">跨越我的设备使用 Cortana</td><td align="left">ms-settings:cortana-notifications</td></tr><tr><td align="left">更多详细信息</td><td align="left">ms-settings:cortana-moredetails</td></tr><tr><td align="left">权限和历史记录</td><td align="left">ms-settings:cortana-permissions</td></tr><tr><td align="left">搜索 Windows</td><td align="left">ms-settings:cortana-windowssearch</td></tr><tr><td align="left">与 Cortana 交谈</td><td align="left">ms-settings:cortana-language ms-settings:cortana ms-settings:cortana-talktocortana</td></tr></tbody></table><p> 备注</p><p>将电脑设置为 Cortana 当前不可用或 Cortana 已禁用的区域时，桌面上的此“设置”部分称为“搜索”。 在这种情况下，不会列出特定于 Cortana 的页面（“跨设备的 Cortana”和“与 Cortana 交谈”）。</p><h3 id="设备"><a href="#设备" class="headerlink" title="设备"></a>设备</h3><table><thead><tr><th align="left">“设置”页面</th><th align="left">URI</th></tr></thead><tbody><tr><td align="left">自动播放</td><td align="left">ms-settings:autoplay</td></tr><tr><td align="left">Bluetooth</td><td align="left">ms-settings:bluetooth</td></tr><tr><td align="left">连接的设备数</td><td align="left">ms-settings:connecteddevices</td></tr><tr><td align="left">默认相机</td><td align="left">ms-settings:camera（已在 Windows 10 版本 1809 及更高版本中弃用的行为）</td></tr><tr><td align="left">相机设置</td><td align="left">ms-settings:camera（已在 Windows 11 版本 22000 及更高版本中引入的行为）将查询字符串参数 <code>cameraId</code> 集追加到相机设备的 URI 转义符号链接名称，以直接启动该相机的设置。 有关详细信息，请参阅<a href="https://learn.microsoft.com/zh-cn/windows/uwp/audio-video-camera/launch-camera-settings">启动相机设置页</a>。</td></tr><tr><td align="left">鼠标和触摸板</td><td align="left">ms-settings:mousetouchpad（仅在具有触控板的设备上可用的触控板设置）</td></tr><tr><td align="left">触控笔和 Windows Ink</td><td align="left">ms-settings:pen</td></tr><tr><td align="left">打印机和扫描仪</td><td align="left">ms-settings:printers</td></tr><tr><td align="left">触控</td><td align="left">ms-settings:devices-touch</td></tr><tr><td align="left">触摸板</td><td align="left">ms-settings:devices-touchpad（仅当存在触控板硬件时才可用）</td></tr><tr><td align="left">文本建议</td><td align="left">ms-settings:devicestyping-hwkbtextsuggestions</td></tr><tr><td align="left">Typing</td><td align="left">ms-settings:typing</td></tr><tr><td align="left">USB</td><td align="left">ms-settings:usb</td></tr><tr><td align="left">滚轮</td><td align="left">ms-settings:wheel（仅当拨号配对时可用）</td></tr><tr><td align="left">你的手机</td><td align="left">ms-settings:mobile-devices</td></tr></tbody></table><h3 id="轻松访问"><a href="#轻松访问" class="headerlink" title="轻松访问"></a>轻松访问</h3><table><thead><tr><th align="left">“设置”页面</th><th align="left">URI</th></tr></thead><tbody><tr><td align="left">音频</td><td align="left">ms-settings:easeofaccess-audio</td></tr><tr><td align="left">隐藏式字幕</td><td align="left">ms-settings:easeofaccess-closedcaptioning</td></tr><tr><td align="left">颜色筛选器</td><td align="left">ms-settings:easeofaccess-colorfilter ms-settings:easeofaccess-colorfilter-adaptivecolorlink ms-settings:easeofaccess-colorfilter-bluelightlink</td></tr><tr><td align="left">显示</td><td align="left">ms-settings:easeofaccess-display</td></tr><tr><td align="left">眼球控制</td><td align="left">ms-settings:easeofaccess-eyecontrol</td></tr><tr><td align="left">字体</td><td align="left">ms-settings:fonts</td></tr><tr><td align="left">高对比度</td><td align="left">ms-settings:easeofaccess-highcontrast</td></tr><tr><td align="left">键盘</td><td align="left">ms-settings:easeofaccess-keyboard</td></tr><tr><td align="left">放大镜</td><td align="left">ms-settings:easeofaccess-magnifier</td></tr><tr><td align="left">鼠标</td><td align="left">ms-settings:easeofaccess-mouse</td></tr><tr><td align="left">鼠标指针和触控</td><td align="left">ms-settings:easeofaccess-mousepointer</td></tr><tr><td align="left">讲述人</td><td align="left">ms-settings:easeofaccess-narrator ms-settings:easeofaccess-narrator-isautostartenabled</td></tr><tr><td align="left">语音</td><td align="left">ms-settings:easeofaccess-speechrecognition</td></tr><tr><td align="left">文本光标</td><td align="left">ms-settings:easeofaccess-cursor</td></tr><tr><td align="left">视觉效果</td><td align="left">ms-settings:easeofaccess-visualeffects</td></tr></tbody></table><h3 id="附加信息"><a href="#附加信息" class="headerlink" title="附加信息"></a>附加信息</h3><table><thead><tr><th align="left">“设置”页面</th><th align="left">URI</th></tr></thead><tbody><tr><td align="left">附加信息</td><td align="left">ms-settings:extras（仅在通过某种方式（例如第三方）安装了“设置应用”后可用）</td></tr></tbody></table><h3 id="家庭组"><a href="#家庭组" class="headerlink" title="家庭组"></a>家庭组</h3><table><thead><tr><th align="left">“设置”页面</th><th align="left">URI</th></tr></thead><tbody><tr><td align="left">家庭组</td><td align="left">ms-settings:family-group</td></tr></tbody></table><h3 id="游戏"><a href="#游戏" class="headerlink" title="游戏"></a>游戏</h3><table><thead><tr><th align="left">“设置”页面</th><th align="left">URI</th></tr></thead><tbody><tr><td align="left">游戏栏</td><td align="left">ms-settings:gaming-gamebar</td></tr><tr><td align="left">游戏 DVR</td><td align="left">ms-settings:gaming-gamedvr</td></tr><tr><td align="left">游戏模式</td><td align="left">ms-settings:gaming-gamemode</td></tr><tr><td align="left">全屏玩游戏</td><td align="left">ms-settings:quietmomentsgame</td></tr><tr><td align="left">TruePlay</td><td align="left">ms-settings:gaming-trueplay（从 Windows 10 版本 1809（10.0，内部版本 17763）起，Windows 中会删除此功能）</td></tr></tbody></table><h3 id="混合现实"><a href="#混合现实" class="headerlink" title="混合现实"></a>混合现实</h3><p>只有在已安装混合现实门户应用的情况下，这些设置才可用。</p><table><thead><tr><th align="left">“设置”页面</th><th align="left">URI</th></tr></thead><tbody><tr><td align="left">音频和语音</td><td align="left">ms-settings:holographic-audio</td></tr><tr><td align="left">环境</td><td align="left">ms-settings:privacy-holographic-environment</td></tr><tr><td align="left">头戴显示设备显示</td><td align="left">ms-settings:holographic-headset</td></tr><tr><td align="left">卸载</td><td align="left">ms-settings:holographic-management</td></tr><tr><td align="left">启动和桌面</td><td align="left">ms-settings:holographic-startupandesktop</td></tr></tbody></table><h3 id="网络和-Internet"><a href="#网络和-Internet" class="headerlink" title="网络和 Internet"></a>网络和 Internet</h3><table><thead><tr><th align="left">“设置”页面</th><th align="left">URI</th></tr></thead><tbody><tr><td align="left">网络和 Internet</td><td align="left">ms-settings:network-status</td></tr><tr><td align="left">高级设置</td><td align="left">ms-settings:network-advancedsettings</td></tr><tr><td align="left">飞行模式</td><td align="left">ms-settings:network-airplanemode ms-settings:proximity</td></tr><tr><td align="left">手机网络和 SIM 卡</td><td align="left">ms-settings:network-cellular</td></tr><tr><td align="left">拨号</td><td align="left">ms-settings:network-dialup</td></tr><tr><td align="left">DirectAccess</td><td align="left">ms-settings:network-directaccess（仅在启用 DirectAccess 时才可用）</td></tr><tr><td align="left">以太网</td><td align="left">ms-settings:network-ethernet</td></tr><tr><td align="left">管理已知网络</td><td align="left">ms-settings:network-wifisettings</td></tr><tr><td align="left">移动热点</td><td align="left">ms-settings:network-mobilehotspot</td></tr><tr><td align="left">代理</td><td align="left">ms-settings:network-proxy</td></tr><tr><td align="left">VPN</td><td align="left">ms-settings:network-vpn</td></tr><tr><td align="left">WLAN</td><td align="left">ms-settings:network-wifi（仅当设备具有 wifi 适配器时才可用）</td></tr><tr><td align="left">Wi-Fi 预配</td><td align="left">ms-settings:wifi-provisioning</td></tr></tbody></table><h3 id="个性化设置"><a href="#个性化设置" class="headerlink" title="个性化设置"></a>个性化设置</h3><table><thead><tr><th align="left">“设置”页面</th><th align="left">URI</th></tr></thead><tbody><tr><td align="left">背景</td><td align="left">ms-settings:personalization-background</td></tr><tr><td align="left">选择哪些文件夹显示于“开始”屏幕</td><td align="left">ms-settings:personalization-start-places</td></tr><tr><td align="left">颜色</td><td align="left">ms-settings:personalization-colors ms-settings:colors</td></tr><tr><td align="left">概览</td><td align="left">ms-settings:personalization-glance（已在 Windows 10 版本 1809 及更高版本中弃用）</td></tr><tr><td align="left">锁屏界面</td><td align="left">ms-settings:lockscreen</td></tr><tr><td align="left">导航栏</td><td align="left">ms-settings:personalization-navbar（已在 Windows 10 版本 1809 及更高版本中弃用）</td></tr><tr><td align="left">个性化（类别）</td><td align="left">ms-settings:personalization</td></tr><tr><td align="left">开始</td><td align="left">ms-settings:personalization-start</td></tr><tr><td align="left">任务栏</td><td align="left">ms-settings:taskbar</td></tr><tr><td align="left">触摸键盘</td><td align="left">ms-settings:personalization-touchkeyboard</td></tr><tr><td align="left">主题</td><td align="left">ms-settings:themes</td></tr></tbody></table><h3 id="电话"><a href="#电话" class="headerlink" title="电话"></a>电话</h3><table><thead><tr><th align="left">“设置”页面</th><th align="left">URI</th></tr></thead><tbody><tr><td align="left">你的手机</td><td align="left">ms-settings:mobile-devices ms-settings:mobile-devices-addphone ms-settings:mobile-devices-addphone-direct（打开“你的手机”应用）</td></tr><tr><td align="left">设备使用情况</td><td align="left">ms-settings:deviceusage</td></tr></tbody></table><h3 id="隐私"><a href="#隐私" class="headerlink" title="隐私"></a>隐私</h3><table><thead><tr><th align="left">“设置”页面</th><th align="left">URI</th></tr></thead><tbody><tr><td align="left">附件应用</td><td align="left">ms-settings:privacy-accessoryapps（已在 Windows 10 版本 1809 及更高版本中弃用）</td></tr><tr><td align="left">帐户信息</td><td align="left">ms-settings:privacy-accountinfo</td></tr><tr><td align="left">活动历史记录</td><td align="left">ms-settings:privacy-activityhistory</td></tr><tr><td align="left">广告 ID</td><td align="left">ms-settings:privacy-advertisingid（已在 Windows 10 版本 1809 及更高版本中弃用）</td></tr><tr><td align="left">应用诊断</td><td align="left">ms-settings:privacy-appdiagnostics</td></tr><tr><td align="left">自动文件下载</td><td align="left">ms-settings:privacy-automaticfiledownloads</td></tr><tr><td align="left">后台应用</td><td align="left">ms-settings:privacy-backgroundapps（已在 Windows 11 21H2 及更高版本中弃用）  <strong>注意：</strong>在 Windows 11 中，后台应用权限是单独访问的。 若要查看权限，请转到“应用”-&gt;“已安装的应用”，然后在新式应用中选择“…”，然后选择“高级选项”。 新式应用会显示高级页面，除非设置了组策略或设置了用户的全局切换值（Windows 10 中已弃用的设置），否则将显示“后台应用权限”部分。 若要使用 URI 访问此页面，请使用 <code>ms-settings:appsfeatures-app</code> URI 并传递应用的包系列名称的可选参数。</td></tr><tr><td align="left">后台空间感知</td><td align="left">ms-settings:privacy-backgroundspatialperception</td></tr><tr><td align="left">日历</td><td align="left">ms-settings:privacy-calendar</td></tr><tr><td align="left">联络历史记录</td><td align="left">ms-settings:privacy-callhistory</td></tr><tr><td align="left">Camera</td><td align="left">ms-settings:privacy-webcam</td></tr><tr><td align="left">联系人</td><td align="left">ms-settings:privacy-contacts</td></tr><tr><td align="left">文档</td><td align="left">ms-settings:privacy-documents</td></tr><tr><td align="left">“下载”文件夹</td><td align="left">ms-settings:privacy-downloadsfolder</td></tr><tr><td align="left">电子邮件</td><td align="left">ms-settings:privacy-email</td></tr><tr><td align="left">眼动追踪仪</td><td align="left">ms-settings:privacy-eyetracker（需要眼动跟踪器硬件）</td></tr><tr><td align="left">反馈和诊断</td><td align="left">ms-settings:privacy-feedback</td></tr><tr><td align="left">文件系统</td><td align="left">ms-settings:privacy-broadfilesystemaccess</td></tr><tr><td align="left">常规</td><td align="left">ms-settings:privacy 或 ms-settings:privacy-general</td></tr><tr><td align="left">图形</td><td align="left">ms-settings:privacy-graphicscaptureprogrammatic ms-settings:privacy-graphicscapturewithoutborder</td></tr><tr><td align="left">墨迹书写和键入</td><td align="left">ms-settings:privacy-speechtyping</td></tr><tr><td align="left">位置</td><td align="left">ms-settings:privacy-location</td></tr><tr><td align="left">Messaging</td><td align="left">ms-settings:privacy-messaging</td></tr><tr><td align="left">Microphone</td><td align="left">ms-settings:privacy-microphone</td></tr><tr><td align="left">动态效果</td><td align="left">ms-settings:privacy-motion</td></tr><tr><td align="left">音乐库</td><td align="left">ms-settings:privacy-musiclibrary</td></tr><tr><td align="left">通知</td><td align="left">ms-settings:privacy-notifications</td></tr><tr><td align="left">其他设备</td><td align="left">ms-settings:privacy-customdevices</td></tr><tr><td align="left">电话联络</td><td align="left">ms-settings:privacy-phonecalls</td></tr><tr><td align="left">图片</td><td align="left">ms-settings:privacy-pictures</td></tr><tr><td align="left">无线电收发器</td><td align="left">ms-settings:privacy-radios</td></tr><tr><td align="left">语音</td><td align="left">ms-settings:privacy-speech</td></tr><tr><td align="left">任务</td><td align="left">ms-settings:privacy-tasks</td></tr><tr><td align="left">视频</td><td align="left">ms-settings:privacy-videos</td></tr><tr><td align="left">语音激活</td><td align="left">ms-settings:privacy-voiceactivation</td></tr></tbody></table><h3 id="搜索"><a href="#搜索" class="headerlink" title="搜索"></a>搜索</h3><table><thead><tr><th align="left">“设置”页面</th><th align="left">URI</th></tr></thead><tbody><tr><td align="left">搜索</td><td align="left">ms-settings:search</td></tr><tr><td align="left">搜索更多详细信息</td><td align="left">ms-settings:search-moredetails</td></tr><tr><td align="left">搜索权限</td><td align="left">ms-settings:search-permissions</td></tr></tbody></table><h3 id="Surface-Hub"><a href="#Surface-Hub" class="headerlink" title="Surface Hub"></a>Surface Hub</h3><table><thead><tr><th align="left">“设置”页面</th><th align="left">URI</th></tr></thead><tbody><tr><td align="left">帐户</td><td align="left">ms-settings:surfacehub-accounts</td></tr><tr><td align="left">会话清理</td><td align="left">ms-settings:surfacehub-sessioncleanup</td></tr><tr><td align="left">团队会议</td><td align="left">ms-settings:surfacehub-calling</td></tr><tr><td align="left">设备管理团队</td><td align="left">ms-settings:surfacehub-devicemanagenent</td></tr><tr><td align="left">欢迎屏幕</td><td align="left">ms-settings:surfacehub-welcome</td></tr></tbody></table><h3 id="系统"><a href="#系统" class="headerlink" title="系统"></a>系统</h3><table><thead><tr><th align="left">“设置”页面</th><th align="left">URI</th></tr></thead><tbody><tr><td align="left">关于</td><td align="left">ms-settings:about</td></tr><tr><td align="left">高级显示设置</td><td align="left">ms-settings:display-advanced（仅支持高级显示选项的设备可用）</td></tr><tr><td align="left">应用音量和设备首选项</td><td align="left">ms-settings:apps-volume（已在 Windows 10 版本 1903 中添加）</td></tr><tr><td align="left">节电模式</td><td align="left">ms-settings:batterysaver（仅具有电池的设备可用，例如平板电脑）</td></tr><tr><td align="left">节电模式设置</td><td align="left">ms-settings:batterysaver-settings（仅具有电池的设备可用，例如平板电脑）</td></tr><tr><td align="left">电池使用</td><td align="left">ms-settings:batterysaver-usagedetails（仅具有电池的设备可用，例如平板电脑）</td></tr><tr><td align="left">剪贴板</td><td align="left">ms-settings:clipboard</td></tr><tr><td align="left">显示</td><td align="left">ms-settings:display</td></tr><tr><td align="left">默认保存位置</td><td align="left">ms-settings:savelocations</td></tr><tr><td align="left">显示</td><td align="left">ms-settings:screenrotation</td></tr><tr><td align="left">复制我的显示器</td><td align="left">ms-settings:quietmomentspresentation</td></tr><tr><td align="left">在这些小时内</td><td align="left">ms-settings:quietmomentsscheduled</td></tr><tr><td align="left">加密</td><td align="left">ms-settings:deviceencryption</td></tr><tr><td align="left">能源推荐</td><td align="left">ms-settings:energyrecommendations（已在适用于 Windows 11 版本 22H2 内部版本 22624 的 2 月 Moment 更新中添加）</td></tr><tr><td align="left">专注助手</td><td align="left">ms-settings:quiethours</td></tr><tr><td align="left">图形设置</td><td align="left">ms-settings:display-advancedgraphics（仅支持高级图形选项的设备可用）</td></tr><tr><td align="left">图形默认设置</td><td align="left">ms-settings:display-advancedgraphics-default</td></tr><tr><td align="left">多任务</td><td align="left">ms-settings:multitasking ms-settings:multitasking-sgupdate</td></tr><tr><td align="left">夜灯设置</td><td align="left">ms-settings:nightlight</td></tr><tr><td align="left">投影到此电脑</td><td align="left">ms-settings:project</td></tr><tr><td align="left">共享体验</td><td align="left">ms-settings:crossdevice</td></tr><tr><td align="left">平板模式</td><td align="left">ms-settings:tabletmode（已在 Windows 11 中删除）</td></tr><tr><td align="left">任务栏</td><td align="left">ms-settings:taskbar</td></tr><tr><td align="left">通知和操作</td><td align="left">ms-settings:notifications</td></tr><tr><td align="left">远程桌面</td><td align="left">ms-settings:remotedesktop</td></tr><tr><td align="left">电话</td><td align="left">ms-settings:phone（已在 Windows 10 版本 1809 及更高版本中弃用）</td></tr><tr><td align="left">电源和睡眠</td><td align="left">ms-settings:powersleep</td></tr><tr><td align="left">存在感测</td><td align="left">ms-settings:presence（已在适用于 Windows 11 版本 22H2 内部版本 22624 的 5 月 Moment 更新中添加）</td></tr><tr><td align="left">声音</td><td align="left">ms-settings:sound</td></tr><tr><td align="left">声音设备</td><td align="left">ms-settings:sound-devices</td></tr><tr><td align="left">存储</td><td align="left">ms-settings:storagesense</td></tr><tr><td align="left">存储感知</td><td align="left">ms-settings:storagepolicies</td></tr><tr><td align="left">有关存储的建议</td><td align="left">ms-settings:storagerecommendations</td></tr><tr><td align="left">磁盘和卷</td><td align="left">ms-settings:disksandvolumes</td></tr></tbody></table><h3 id="时间和语言"><a href="#时间和语言" class="headerlink" title="时间和语言"></a>时间和语言</h3><table><thead><tr><th align="left">“设置”页面</th><th align="left">URI</th></tr></thead><tbody><tr><td align="left">日期和时间</td><td align="left">ms-settings:dateandtime</td></tr><tr><td align="left">日本 IME 设置</td><td align="left">ms-settings:regionlanguage-jpnime（安装了 Microsoft Japan 输入法编辑器则可用）</td></tr><tr><td align="left">区域</td><td align="left">ms-settings:regionformatting</td></tr><tr><td align="left">语言</td><td align="left">ms-settings:keyboard ms-settings:keyboard-advanced ms-settings:regionlanguage ms-settings:regionlanguage-bpmfime ms-settings:regionlanguage-cangjieime ms-settings:regionlanguage-chsime-wubi-udp ms-settings:regionlanguage-quickime ms-settings:regionlanguage-korime</td></tr><tr><td align="left">拼音 IME 设置</td><td align="left">ms-settings:regionlanguage-chsime-pinyin（在安装了 Microsoft 拼音输入法编辑器的情况下可用） ms-settings:regionlanguage-chsime-pinyin-domainlexicon ms-settings:regionlanguage-chsime-pinyin-keyconfig ms-settings:regionlanguage-chsime-pinyin-udp</td></tr><tr><td align="left">语音</td><td align="left">ms-settings:speech</td></tr><tr><td align="left">五笔 IME 设置</td><td align="left">ms-settings:regionlanguage-chsime-wubi（安装了 Microsoft 五笔输入法编辑器则可用）</td></tr><tr><td align="left">添加显示语言</td><td align="left">ms-settings:regionlanguage-adddisplaylanguage</td></tr><tr><td align="left">语言选项</td><td align="left">ms-settings:regionlanguage-languageoptions</td></tr><tr><td align="left">设置显示语言</td><td align="left">ms-settings:regionlanguage-setdisplaylanguage</td></tr></tbody></table><h3 id="更新和安全"><a href="#更新和安全" class="headerlink" title="更新和安全"></a>更新和安全</h3><table><thead><tr><th align="left">“设置”页面</th><th align="left">URI</th></tr></thead><tbody><tr><td align="left">激活</td><td align="left">ms-settings:activation</td></tr><tr><td align="left">备份</td><td align="left">ms-settings:backup（已在 Windows 11 中删除的页；打开同步）</td></tr><tr><td align="left">传递优化</td><td align="left">ms-settings:delivery-optimization ms-settings:delivery-optimization-activity ms-settings:delivery-optimization-advanced</td></tr><tr><td align="left">查找我的设备</td><td align="left">ms-settings:findmydevice</td></tr><tr><td align="left">面向开发人员</td><td align="left">ms-settings:developers</td></tr><tr><td align="left">恢复</td><td align="left">ms-settings:recovery</td></tr><tr><td align="left">启动安全密钥注册</td><td align="left">ms-settings:signinoptions-launchsecuritykeyenrollment</td></tr><tr><td align="left">疑难解答</td><td align="left">ms-settings:troubleshoot</td></tr><tr><td align="left">Windows 安全性</td><td align="left">ms-settings:windowsdefender</td></tr><tr><td align="left">Windows 预览体验计划</td><td align="left">ms-settings:windowsinsider（仅当用户在 WIP 中注册后才存在） ms-settings:windowsinsider-optin</td></tr><tr><td align="left">Windows 更新</td><td align="left">ms-settings:windowsupdate ms-settings:windowsupdate-action</td></tr><tr><td align="left">Windows 更新-活动小时数</td><td align="left">ms-settings:windowsupdate-activehours</td></tr><tr><td align="left">Windows 更新-高级选项</td><td align="left">ms-settings:windowsupdate-options</td></tr><tr><td align="left">Windows 更新-可选更新</td><td align="left">ms-settings:windowsupdate-optionalupdates</td></tr><tr><td align="left">Windows 更新-重启选项</td><td align="left">ms-settings:windowsupdate-restartoptions</td></tr><tr><td align="left">Windows 更新-按需查找器</td><td align="left">ms-settings:windowsupdate-seekerondemand</td></tr><tr><td align="left">Windows 更新-查看更新历史记录</td><td align="left">ms-settings:windowsupdate-history</td></tr></tbody></table><h3 id="用户帐户"><a href="#用户帐户" class="headerlink" title="用户帐户"></a>用户帐户</h3><table><thead><tr><th align="left">“设置”页面</th><th align="left">URI</th></tr></thead><tbody><tr><td align="left">预配</td><td align="left">ms-settings:workplace-provisioning（仅当企业部署了预配程序包时才可用）</td></tr><tr><td align="left">修复令牌</td><td align="left">ms-settings:workplace-repairtoken</td></tr><tr><td align="left">预配</td><td align="left">ms-settings:provisioning（仅当移动设备上企业部署了预配程序包时才可用）</td></tr><tr><td align="left">Windows Anywhere</td><td align="left">ms-settings:windowsanywhere（设备必须支持 Windows Anywhere）</td></tr></tbody></table><p>(完)</p><p><strong>参考</strong></p><ul><li><a href="https://learn.microsoft.com/zh-cn/windows/uwp/launch-resume/launch-settings-app">启动 Windows 设置应用</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>翻译转载</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Windows</tag>
      
      <tag>转载</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>极简生活可以尝试的实践</title>
    <link href="/blog/2024/03/%E6%9E%81%E7%AE%80%E7%94%9F%E6%B4%BB%E5%8F%AF%E4%BB%A5%E5%B0%9D%E8%AF%95%E7%9A%84%E5%AE%9E%E8%B7%B5.html"/>
    <url>/blog/2024/03/%E6%9E%81%E7%AE%80%E7%94%9F%E6%B4%BB%E5%8F%AF%E4%BB%A5%E5%B0%9D%E8%AF%95%E7%9A%84%E5%AE%9E%E8%B7%B5.html</url>
    
    <content type="html"><![CDATA[<blockquote><p>拥有却不珍惜，才是最可惜的事情。</p></blockquote><p><img src="/blog/./assets/d26213f37ab4422ecd5f0bfd049e2a23.jpg" alt="我是单身"></p><h2 id="生活篇"><a href="#生活篇" class="headerlink" title="生活篇"></a>生活篇</h2><p>直接打地铺，不需要买床。</p><p><img src="/blog/./assets/E3C3UZYXABAF2-1711639803786-9.png" alt="img"></p><p>小坐垫</p><p><img src="/blog/./assets/3FXLWZYXAAQHW-1711639826858-12.png" alt="img"></p><p>单人冰箱，电饭煲，微波炉，镜子</p><p><img src="/blog/./assets/GPZ3WZYXACAEC-1711639833540-15.png" alt="img"></p><p>室内绿植</p><p><img src="/blog/./assets/NMQ32ZYXABAE4-1711639840135-18.png" alt="img"></p><p>（完）</p><p>参考资料：</p><ul><li><p><a href="https://v.qq.com/x/page/h3364s2sm40.html">人文讲堂——从断舍离实践老子道德经</a></p></li><li><p><a href="https://v.qq.com/x/cover/mzc003j5ct15nqx/p35087f17f5.html">生活中的一天日本极简主义者的一天，过的有多简单？</a></p></li></ul>]]></content>
    
    
    <categories>
      
      <category>生活</category>
      
      <category>经验</category>
      
    </categories>
    
    
    <tags>
      
      <tag>极简生活</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>《不持有的生活》读书摘录</title>
    <link href="/blog/2024/03/%E3%80%8A%E4%B8%8D%E6%8C%81%E6%9C%89%E7%9A%84%E7%94%9F%E6%B4%BB%E3%80%8B%E8%AF%BB%E4%B9%A6%E6%91%98%E5%BD%95.html"/>
    <url>/blog/2024/03/%E3%80%8A%E4%B8%8D%E6%8C%81%E6%9C%89%E7%9A%84%E7%94%9F%E6%B4%BB%E3%80%8B%E8%AF%BB%E4%B9%A6%E6%91%98%E5%BD%95.html</url>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://book.douban.com/subject/4086725/">《不持有的生活》</a><br>作者: 金子由纪子<br>出版社: 山东人民出版社<br>译者: 燕子<br>出版年: 2009-9-1<br>页数: 191<br>定价: 29.00元<br>装帧: 平装<br>ISBN: 9787209049467</p></blockquote><h2 id="时间就是金钱"><a href="#时间就是金钱" class="headerlink" title="时间就是金钱"></a>时间就是金钱</h2><p>物品四溢、乱糟糟的生活，使人混乱，毫无生气。</p><p>物品四溢的生活之所以是我们的压力，难道不是因为，东西的本质就是时间的集合体吗？</p><p>无论是多么没用的东西，也都耗费了地球上的资源，并且是经过了工厂机器的加工，或因人们的手工劳动，才制造岀來的。</p><p>即使是一张纸，如果不是具有一定年龄的树木，也是无法制成的。</p><p>一粒种子在发芽之后，需要阳光的滋养才能长成参天大树。</p><p>某天，这棵树被砍伐，运送到了工厂。</p><p>经过了多道工序，最终制成纸张。</p><p>这些纸被卡车运到店里，然后被打好包装、贴上价签，之后被出售。</p><p>我们一想那些冗长的过程，就会感觉要昏过去了。我们不得不承认，周围所有的东西，都要历经不同的，并与之相适应的漫长时间才得以产生。</p><p>当然，没有人会在平日里关注这些事情，所以更值得关注。其实，每件东西上都凝结了时间，这种时间的重量压在我们心上，就变成了一种无形的压力。  只不过，这种压力会因为物品的不同，而表现岀不同的意义。</p><p>那些虽然没有用也不喜欢，但是却嫌麻烦没有扔掉的东西，就算再小，我们也会觉得像海底的水压一般沉重。而那些我们喜欢的、每天使用时心情都很愉悦的东两，即使很重，我们也会毫无感觉。</p><p>拥有很多收藏品,并且对这些东西十分珍惜的人,一定不会感到有任何压力, 还会生活得轻松自在。有问题的是那些被不喜欢的东西所包围，但是又不知道  该如何是好，只能选择继续保留的人们。这种生活被时间的重量压碎，变得不 再正常了。</p><p>我们通常都是把时间“出售”给企业或个人，用以此获得的报酬来谋生。</p><p>我们周围的某些东西，实质上都是“我们的时间“的另一种表现形式。</p><p>“时间就是金钱”，这是现代社会中众所周知的常识。我们也可以换个说法, 即“时间就是物品”。</p><p>被物品包围却无法很好地利用物品的人，不能将自己历尽艰辛付岀的时间 收回来，就是浪费了这些时间。</p><p>不仅如此，有些人还抱有这样的想法：“不能有效利用东西是因为现在的东西都没用，如果是好东西一定会很珍惜，所以想要拥有比现在更好的东西，这些人难道不可笑吗？</p><p>为了实现上述目标，我们就需要花费更多的钱，也就必须出卖更多的时间。</p><p>用这种方式获得的东西，那些人能够有效地利用吗？</p><p>为了这些连是否能有效利用都不知道的东西，而抱怨说“很忙、没有时间”, 难道不是一种本末倒置的行为吗？</p><h2 id="这种生活方式支持着“不持有的生活”"><a href="#这种生活方式支持着“不持有的生活”" class="headerlink" title="这种生活方式支持着“不持有的生活”"></a>这种生活方式支持着“不持有的生活”</h2><p>我曾经在门户网站“All ABOUT”的“简单生活”专栏中•担任指导员的工作。 所以，有很多机会接触那些过着“不持有的生活”的人。通过与他们接触的经历,  我深深地感受到：</p><p>“东西越少，越不会使人慌张张”</p><p>“不持有的生活使自己的时间变得绰绰有余”</p><p>说到“不会慌慌張张”、“时间绰绰有余”，我们会条件反射地联想到“长期休假”、“提前退休”、“乡下的慢节奏生活”等等</p><p>但是，与我交谈过的人，并不是非常有钱或不用工作就可以生存下去的人, 反而是些每天都要拼命工作，与普通人一样工作很忙，但却过着惬意生活的人。</p><p>有些人如果不长期休假、不提前退休、不移居到孤岛，就无法过上这种惬 意的生活。他们就必须加倍地努力，否则将无法赚到足够的钱来实现这些日的。</p><p>有一些人曾经成功地做到了这一点，并不意味着所有人都可以。这种方式 获得的时间也未必就是悠闲、宽裕的。</p><p>我们似乎都认为，只有比平常人付岀多倍劳动或能力较一般人强的人，才 能获得宽裕的时间。</p><p>事实却并非如此。</p><p>宽裕的时间并不一定等于集中的时间。</p><p>一边过着极为普通的生活，一边拥有宽裕的时间，也是很容易办到的事情。</p><p>如果你也想这样的话，就不妨尝试一下我下面为你推荐的生活方式。</p><h2 id="早起"><a href="#早起" class="headerlink" title="早起"></a>早起</h2><p>每天尽量早起。早晨比起一天中的其他时间更容易“制造”出多余时间。 也许会有很多人讶异地说：“紧张匆忙的早上，哪有什么宽裕的时间可言啊？ ”</p><p>但事实的确如此</p><p>从现在起，就尝试一下比平时早起30分钟吧。在这段时间里，去做任何自 己喜欢的或能感到快乐的事。即使剩下的事情都没有改变，但仅仅是因为早起 30分钟，你也会感到一天的流程不知是何原因竟慢了许多。</p><p>早起30分钟，让你的时间渐渐地宽裕起来。</p><h2 id="保持充足的睡眠"><a href="#保持充足的睡眠" class="headerlink" title="保持充足的睡眠"></a>保持充足的睡眠</h2><p>这一点看起来似乎和“早起”有些冲突，不过，我们还是要在晚上好好休息。 有些人为了学习或是“自强奋发”而彻夜不休地努力。不过，我们要清楚一点,  睡眠对于你的整个人生来说有着无可替代的重要作用。</p><p>睡眠并不是在浪费时间。睡眠时,我们身体上和心灵上的创伤都能得到治愈。</p><p>如果你属于每天睡眠时间都较长的人，也不要为此而感到羞愧。就像爱因斯坦这样的大科学家，也是个每天需要睡10个小时以上的“嗜睡者(long  sleeper )”。</p><p>如果你认为长时间睡眠对自己是必要的，你就好好地睡一觉，这样一天的时间也会变得缓慢下来。如果你无法挤岀睡眠时间，就减少在看电视、上网等 事情上花费的时间。</p><h2 id="享受用餐"><a href="#享受用餐" class="headerlink" title="享受用餐"></a>享受用餐</h2><p>你无须了解美食信息和专业的营养，但你需要尽可能多地了解所住的地区 一年四季都有什么美味的食品，以及如何烹饪它们才最美味。还要考虑怎样将这些美味盛装，并和谁在哪里享用。当然，如果能自己亲手制作美味的菜肴,  就再好不过啦！</p><p>认真地享受自己的每一餐(包括做饭的过程)，这样你的心情也会得到放松。 这种方式能让我们不再心慌意乱，听上去似乎有些不可思议，但这无比真实。</p><h2 id="仰望天空"><a href="#仰望天空" class="headerlink" title="仰望天空"></a>仰望天空</h2><p>仰望天空似乎毫无意义，但是对减缓时间的流逝感而言，这是十分重要的。 当你心烦意乱、焦躁不安时，做个深呼吸，仰望一下天空吧！向上仰望时，也许你会更清楚地意识到自己所奋力追逐的事物，实际上并没有想象中的那么困难。</p><p>仰望天空无须花费你很多的时间，但却能使你的生活变得悠闲、舒适。</p><h2 id="不要总说“我很忙”"><a href="#不要总说“我很忙”" class="headerlink" title="不要总说“我很忙”"></a>不要总说“我很忙”</h2><p>现在，无论是大人还是小孩都会感到很忙碌。但是，并不是你抱怨完自己有多“忙”之后，时间就宽裕了了。所以，你可不可以不要再说“忙” 了？</p><p>当你不再抱怨自己忙以后，心情自然就会舒畅许多，甚至也能让周围的人感到惬意。</p><p>如果你仅仅是通过减少浪费，而实现有效地利用时间。从表面上來看，生活中很多事情的效率都有了不小的提高。</p><p>快节奏的生活中包含了很多不合理的、与人类生理习惯相违背的东西，在某些方面会岀现些“扭曲”。举个例子来说，很多人不明所以地沉迷于赌博，也有人对购物疯狂迷恋，还有一些人会无法门控地暴饮暴食。这些现象不就是当今社会的病患所在吗？</p><p>“充裕的时间”并不是指那些通过努力工作，才终于到手的时间，而是现在这一瞬。</p><p>每天24小时，不管你如何努力它也变不成30个小时。</p><p>但是，现在的一瞬确实存在，比你想象中的之后的某一时间更加现实。</p><p>如果我们能将这一瞬，用我们双眼和双手来体味，从中找寻到无限乐趣， 这一瞬就是我们最为充裕的时间。</p><p>本章中所叙述的这些生活方式，咋一看似乎都没冇什么意义。</p><p>但是，这些看似无意义的行为，却能够在很大程度上帮助我们。如果你能通过珍惜这些时间，使内心恢复到原有的平静状态.在追求某件事物时，原本焦躁不安的情绪也能得到很好的缓解。</p><p>这样一來，这种无须依赖东西的生活，会变得轻松和愉快。同时，你也能够淸楚地知道，什么才是对自己有用的东西。</p><h2 id="东西不是敌人，而是朋友"><a href="#东西不是敌人，而是朋友" class="headerlink" title="东西不是敌人，而是朋友"></a>东西不是敌人，而是朋友</h2><p>“我不要东西。”</p><p>“我要远离东西。”</p><p>虽然有人总会这样说，但是这并不是让我们将东西视为敌人。虽说是“不持有的生活”，但是修行僧人那种生活中一切多余事物都没有的生活方式，称不上是人类应有的，充满人情冷暖的生活方式。</p><p>我也有特别喜爱的东西，当听到别人说“那种东西快扔掉”时，也会感到很失落。因为，是那些东西让我的生活变得丰富多彩。若是没有了它们，那就不是我的生活了。</p><p>很多东西在我们经常使用的过程中，会变得和身体很契合，简直就像自已 的一部分一样。这样的东西就如同朋友一般。试想一下，拥有众多朋友的生活  将会是多么温暖美好啊！</p><p>但是，就像我们无法与所有遇见的人都成为朋友一样，我们也不可能开开心心地和所有东西“打交道”。</p><p>比如说，有人就很喜欢用百元的商品，但我就不属于这种人.我不希望自己家中堆满了百元商品；香奈儿、迪奥可谓非常有名的品牌，很多人都很爱用，却不适合我。</p><p>只要清楚这些，你就会知道它们是不可能和自己成为朋友的！</p><p>那么，什么东西才适合我们的生活呢？</p><p>又有什么东西可以与我们成为朋友呢？</p><p>我想，这不是一朝一夕就能弄明白的事情，而需要在日常生活中不断思索和探求。</p><p>如果你把东西当成了敌人的话，不仅会使自己的生活变得繁杂，而且会无谓地耗费许多精力。但是，如果将它们视为自己的朋友，我们将不需要其他多余的东西。</p><p>“不持有的生活”倡导我们适度拥有物品。不过，想要做到让物品的数量恰到好处，是件很难的事情。因为，这个所谓的“度”，既没有一个可以参考的平均值，也没有正确的答案。</p><p>如果可能的话，我想过这种“不持有的生活”、不丢弃东西的生活。无论生活中是否有物品存在，我都能应对自如。</p><p>我们每天的生活，都是一种以此为目的的学习和修行。</p><h2 id="后记为了不迷失"><a href="#后记为了不迷失" class="headerlink" title="后记为了不迷失"></a>后记为了不迷失</h2><p>摄影中有一个专业词语叫做“背景处理”。</p><p>在摄影时，如果被拍摄物的周围有很多乱七八糟的东西，拍摄的主体看上 去也不会很漂亮。如果一张照片看不出背景和被拍摄物的分別，这照片究竞想拍摄的是什么，别人也就无从得知了。</p><p>为了防止这种情况的发生，摄影师或是移动被摄物体，或是把背景中的东西挪走，不然就只有把背景虚化。这样一来，被摄物体立刻就会变得突出了。</p><p>“不持有的生活”与摄影的原理相同。</p><p>如果你不清楚自己现在的生活状态，那么，就像摄影中的背景处理那样, 一件一件来减少周围的东西吧！</p><p>想要一下子改变自己的生活，使之清新、舒适，是很难办到的。我们可以 从一点一滴做起，慢慢实践于生活之中，这样一来就简单多了。</p><p>就像挖掘化石的时候，需要小心翼翼地去掉它周围的泥土和砂石，模糊的镜面在能够清晰映照前，需要不断进行打磨一样，经过这个过程一一养成“不持有”的生活习惯——你才能够找到埋藏于自己内心深处的那些个性风格及喜欢的东西。而“不持有的生活”正是这样一个过程。</p><p>“不持有的生活”是珍惜现在的生活。</p><p>因为“东西”也可以看做是“时间”的代名词，或许“继续保留”便意味着执著于过去；而过量地“准备”则是种对未来的担忧，这也许是一种逃避现实生活的举动。</p><p>如果仅仅着眼于现在的生活，这种“现在的生活”，并不需要太多东西。</p><p>而珍惜“现在”的人，知道此时此刻自己该做些什么。</p><p>不管多么“忙”，你也要听一听哭泣着撒着娇的孩子都说了些什么。</p><p>当身边的朋友失去了勇气、无路可走的时候，我们必须给予他们面对“现在” 的力量。</p><p>还有比这些更重要的东西吗？</p><p>为了不遗失自己最重要的东西。</p><p>为了在“现在”中生活着的自己。</p><p>就让我们开始过这种“不持有的生活”吧！</p><p>一无所有的生活称不上是“不持有的生活”。</p><p>我相信，一百个人会有一百种“不持有的生活”。</p><p>与“想拥有什么”相比，“不持有什么”更能体现出一个人的风格。</p><p>（完）</p>]]></content>
    
    
    <categories>
      
      <category>生活</category>
      
      <category>经验</category>
      
    </categories>
    
    
    <tags>
      
      <tag>读书笔记</tag>
      
      <tag>极简生活</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>艾宾浩斯遗忘曲线复习计划表</title>
    <link href="/blog/2024/03/%E8%89%BE%E5%AE%BE%E6%B5%A9%E6%96%AF%E9%81%97%E5%BF%98%E6%9B%B2%E7%BA%BF%E5%A4%8D%E4%B9%A0%E8%AE%A1%E5%88%92%E8%A1%A8.html"/>
    <url>/blog/2024/03/%E8%89%BE%E5%AE%BE%E6%B5%A9%E6%96%AF%E9%81%97%E5%BF%98%E6%9B%B2%E7%BA%BF%E5%A4%8D%E4%B9%A0%E8%AE%A1%E5%88%92%E8%A1%A8.html</url>
    
    <content type="html"><![CDATA[<table><thead><tr><th align="center"></th><th align="center"></th><th align="center"></th><th align="center"></th><th align="center"></th><th align="center">__________________________复习计划表</th><th align="center"></th><th align="center"></th><th align="center"></th><th align="center"></th><th align="center"></th></tr></thead><tbody><tr><td align="center">序号</td><td align="center">学习日期</td><td align="center">学  习  内  容</td><td align="center">复习周期</td><td align="center">复习周期</td><td align="center">复习周期</td><td align="center">复习周期</td><td align="center">复习周期</td><td align="center">复习周期</td><td align="center">复习周期</td><td align="center">复习周期</td></tr><tr><td align="center"></td><td align="center"></td><td align="center"></td><td align="center">1天</td><td align="center">2天</td><td align="center">4天</td><td align="center">7天</td><td align="center">15天</td><td align="center">1月</td><td align="center">3月</td><td align="center">6月</td></tr><tr><td align="center">1</td><td align="center">月  日</td><td align="center"></td><td align="center">-</td><td align="center">-</td><td align="center">-</td><td align="center">-</td><td align="center">-</td><td align="center">-</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">2</td><td align="center">月  日</td><td align="center"></td><td align="center">1</td><td align="center">-</td><td align="center">-</td><td align="center">-</td><td align="center">-</td><td align="center">-</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">3</td><td align="center">月  日</td><td align="center"></td><td align="center">2</td><td align="center">1</td><td align="center">-</td><td align="center">-</td><td align="center">-</td><td align="center">-</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">4</td><td align="center">月  日</td><td align="center"></td><td align="center">3</td><td align="center">2</td><td align="center">-</td><td align="center">-</td><td align="center">-</td><td align="center">-</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">5</td><td align="center">月  日</td><td align="center"></td><td align="center">4</td><td align="center">3</td><td align="center">1</td><td align="center">-</td><td align="center">-</td><td align="center">-</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">6</td><td align="center">月  日</td><td align="center"></td><td align="center">5</td><td align="center">4</td><td align="center">2</td><td align="center">-</td><td align="center">-</td><td align="center">-</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">7</td><td align="center">月  日</td><td align="center"></td><td align="center">6</td><td align="center">5</td><td align="center">3</td><td align="center">-</td><td align="center">-</td><td align="center">-</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">8</td><td align="center">月  日</td><td align="center"></td><td align="center">7</td><td align="center">6</td><td align="center">4</td><td align="center">1</td><td align="center">-</td><td align="center">-</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">9</td><td align="center">月  日</td><td align="center"></td><td align="center">8</td><td align="center">7</td><td align="center">5</td><td align="center">2</td><td align="center">-</td><td align="center">-</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">10</td><td align="center">月  日</td><td align="center"></td><td align="center">9</td><td align="center">8</td><td align="center">6</td><td align="center">3</td><td align="center">-</td><td align="center">-</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">11</td><td align="center">月  日</td><td align="center"></td><td align="center">10</td><td align="center">9</td><td align="center">7</td><td align="center">4</td><td align="center">-</td><td align="center">-</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">12</td><td align="center">月  日</td><td align="center"></td><td align="center">11</td><td align="center">10</td><td align="center">8</td><td align="center">5</td><td align="center">-</td><td align="center">-</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">13</td><td align="center">月  日</td><td align="center"></td><td align="center">12</td><td align="center">11</td><td align="center">9</td><td align="center">6</td><td align="center">-</td><td align="center">-</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">14</td><td align="center">月  日</td><td align="center"></td><td align="center">13</td><td align="center">12</td><td align="center">10</td><td align="center">7</td><td align="center">-</td><td align="center">-</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">15</td><td align="center">月  日</td><td align="center"></td><td align="center">14</td><td align="center">13</td><td align="center">11</td><td align="center">8</td><td align="center">-</td><td align="center">-</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">16</td><td align="center">月  日</td><td align="center"></td><td align="center">15</td><td align="center">14</td><td align="center">12</td><td align="center">9</td><td align="center">1</td><td align="center">-</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">17</td><td align="center">月  日</td><td align="center"></td><td align="center">16</td><td align="center">15</td><td align="center">13</td><td align="center">10</td><td align="center">2</td><td align="center">-</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">18</td><td align="center">月  日</td><td align="center"></td><td align="center">17</td><td align="center">16</td><td align="center">14</td><td align="center">11</td><td align="center">3</td><td align="center">-</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">19</td><td align="center">月  日</td><td align="center"></td><td align="center">18</td><td align="center">17</td><td align="center">15</td><td align="center">12</td><td align="center">4</td><td align="center">-</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">20</td><td align="center">月  日</td><td align="center"></td><td align="center">19</td><td align="center">18</td><td align="center">16</td><td align="center">13</td><td align="center">5</td><td align="center">-</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">21</td><td align="center">月  日</td><td align="center"></td><td align="center">20</td><td align="center">19</td><td align="center">17</td><td align="center">14</td><td align="center">6</td><td align="center">-</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">22</td><td align="center">月  日</td><td align="center"></td><td align="center">21</td><td align="center">20</td><td align="center">18</td><td align="center">15</td><td align="center">7</td><td align="center">-</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">23</td><td align="center">月  日</td><td align="center"></td><td align="center">22</td><td align="center">21</td><td align="center">19</td><td align="center">16</td><td align="center">8</td><td align="center">-</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">24</td><td align="center">月  日</td><td align="center"></td><td align="center">23</td><td align="center">22</td><td align="center">20</td><td align="center">17</td><td align="center">9</td><td align="center">-</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">25</td><td align="center">月  日</td><td align="center"></td><td align="center">24</td><td align="center">23</td><td align="center">21</td><td align="center">18</td><td align="center">10</td><td align="center">-</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">26</td><td align="center">月  日</td><td align="center"></td><td align="center">25</td><td align="center">24</td><td align="center">22</td><td align="center">19</td><td align="center">11</td><td align="center">-</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">27</td><td align="center">月  日</td><td align="center"></td><td align="center">26</td><td align="center">25</td><td align="center">23</td><td align="center">20</td><td align="center">12</td><td align="center">-</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">28</td><td align="center">月  日</td><td align="center"></td><td align="center">27</td><td align="center">26</td><td align="center">24</td><td align="center">21</td><td align="center">13</td><td align="center">-</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">29</td><td align="center">月  日</td><td align="center"></td><td align="center">28</td><td align="center">27</td><td align="center">25</td><td align="center">22</td><td align="center">14</td><td align="center">-</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">30</td><td align="center">月  日</td><td align="center"></td><td align="center">29</td><td align="center">28</td><td align="center">26</td><td align="center">23</td><td align="center">15</td><td align="center">-</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">31</td><td align="center">月  日</td><td align="center"></td><td align="center">30</td><td align="center">29</td><td align="center">27</td><td align="center">24</td><td align="center">16</td><td align="center">1</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">32</td><td align="center">月  日</td><td align="center"></td><td align="center">31</td><td align="center">30</td><td align="center">28</td><td align="center">25</td><td align="center">17</td><td align="center">2</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">33</td><td align="center">月  日</td><td align="center"></td><td align="center">32</td><td align="center">31</td><td align="center">29</td><td align="center">26</td><td align="center">18</td><td align="center">3</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">34</td><td align="center">月  日</td><td align="center"></td><td align="center">33</td><td align="center">32</td><td align="center">30</td><td align="center">27</td><td align="center">19</td><td align="center">4</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">35</td><td align="center">月  日</td><td align="center"></td><td align="center">34</td><td align="center">33</td><td align="center">31</td><td align="center">28</td><td align="center">20</td><td align="center">5</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">36</td><td align="center">月  日</td><td align="center"></td><td align="center">35</td><td align="center">34</td><td align="center">32</td><td align="center">29</td><td align="center">21</td><td align="center">6</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">37</td><td align="center">月  日</td><td align="center"></td><td align="center">36</td><td align="center">35</td><td align="center">33</td><td align="center">30</td><td align="center">22</td><td align="center">7</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">38</td><td align="center">月  日</td><td align="center"></td><td align="center">37</td><td align="center">36</td><td align="center">34</td><td align="center">31</td><td align="center">23</td><td align="center">8</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">39</td><td align="center">月  日</td><td align="center"></td><td align="center">38</td><td align="center">37</td><td align="center">35</td><td align="center">32</td><td align="center">24</td><td align="center">9</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">40</td><td align="center">月  日</td><td align="center"></td><td align="center">39</td><td align="center">38</td><td align="center">36</td><td align="center">33</td><td align="center">25</td><td align="center">10</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">41</td><td align="center">月  日</td><td align="center"></td><td align="center">40</td><td align="center">39</td><td align="center">37</td><td align="center">34</td><td align="center">26</td><td align="center">11</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">42</td><td align="center">月  日</td><td align="center"></td><td align="center">41</td><td align="center">40</td><td align="center">38</td><td align="center">35</td><td align="center">27</td><td align="center">12</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">43</td><td align="center">月  日</td><td align="center"></td><td align="center">42</td><td align="center">41</td><td align="center">39</td><td align="center">36</td><td align="center">28</td><td align="center">13</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">44</td><td align="center">月  日</td><td align="center"></td><td align="center">43</td><td align="center">42</td><td align="center">40</td><td align="center">37</td><td align="center">29</td><td align="center">14</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">45</td><td align="center">月  日</td><td align="center"></td><td align="center">44</td><td align="center">43</td><td align="center">41</td><td align="center">38</td><td align="center">30</td><td align="center">15</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">46</td><td align="center">月  日</td><td align="center"></td><td align="center">45</td><td align="center">44</td><td align="center">42</td><td align="center">39</td><td align="center">31</td><td align="center">16</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">47</td><td align="center">月  日</td><td align="center"></td><td align="center">46</td><td align="center">45</td><td align="center">43</td><td align="center">40</td><td align="center">32</td><td align="center">17</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">48</td><td align="center">月  日</td><td align="center"></td><td align="center">47</td><td align="center">46</td><td align="center">44</td><td align="center">41</td><td align="center">33</td><td align="center">18</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">49</td><td align="center">月  日</td><td align="center"></td><td align="center">48</td><td align="center">47</td><td align="center">45</td><td align="center">42</td><td align="center">34</td><td align="center">19</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">50</td><td align="center">月  日</td><td align="center"></td><td align="center">49</td><td align="center">48</td><td align="center">46</td><td align="center">43</td><td align="center">35</td><td align="center">20</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">51</td><td align="center">月  日</td><td align="center"></td><td align="center">50</td><td align="center">49</td><td align="center">47</td><td align="center">44</td><td align="center">36</td><td align="center">21</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">52</td><td align="center">月  日</td><td align="center"></td><td align="center">51</td><td align="center">50</td><td align="center">48</td><td align="center">45</td><td align="center">37</td><td align="center">22</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">53</td><td align="center">月  日</td><td align="center"></td><td align="center">52</td><td align="center">51</td><td align="center">49</td><td align="center">46</td><td align="center">38</td><td align="center">23</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">54</td><td align="center">月  日</td><td align="center"></td><td align="center">53</td><td align="center">52</td><td align="center">50</td><td align="center">47</td><td align="center">39</td><td align="center">24</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">55</td><td align="center">月  日</td><td align="center"></td><td align="center">54</td><td align="center">53</td><td align="center">51</td><td align="center">48</td><td align="center">40</td><td align="center">25</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">56</td><td align="center">月  日</td><td align="center"></td><td align="center">55</td><td align="center">54</td><td align="center">52</td><td align="center">49</td><td align="center">41</td><td align="center">26</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">57</td><td align="center">月  日</td><td align="center"></td><td align="center">56</td><td align="center">55</td><td align="center">53</td><td align="center">50</td><td align="center">42</td><td align="center">27</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">58</td><td align="center">月  日</td><td align="center"></td><td align="center">57</td><td align="center">56</td><td align="center">54</td><td align="center">51</td><td align="center">43</td><td align="center">28</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">59</td><td align="center">月  日</td><td align="center"></td><td align="center">58</td><td align="center">57</td><td align="center">55</td><td align="center">52</td><td align="center">44</td><td align="center">29</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">60</td><td align="center">月  日</td><td align="center"></td><td align="center">59</td><td align="center">58</td><td align="center">56</td><td align="center">53</td><td align="center">45</td><td align="center">30</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">61</td><td align="center">月  日</td><td align="center"></td><td align="center">60</td><td align="center">59</td><td align="center">57</td><td align="center">54</td><td align="center">46</td><td align="center">31</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">62</td><td align="center">月  日</td><td align="center"></td><td align="center">61</td><td align="center">60</td><td align="center">58</td><td align="center">55</td><td align="center">47</td><td align="center">32</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">63</td><td align="center">月  日</td><td align="center"></td><td align="center">62</td><td align="center">61</td><td align="center">59</td><td align="center">56</td><td align="center">48</td><td align="center">33</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">64</td><td align="center">月  日</td><td align="center"></td><td align="center">63</td><td align="center">62</td><td align="center">60</td><td align="center">57</td><td align="center">49</td><td align="center">34</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">65</td><td align="center">月  日</td><td align="center"></td><td align="center">64</td><td align="center">63</td><td align="center">61</td><td align="center">58</td><td align="center">50</td><td align="center">35</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">66</td><td align="center">月  日</td><td align="center"></td><td align="center">65</td><td align="center">64</td><td align="center">62</td><td align="center">59</td><td align="center">51</td><td align="center">36</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">67</td><td align="center">月  日</td><td align="center"></td><td align="center">66</td><td align="center">65</td><td align="center">63</td><td align="center">60</td><td align="center">52</td><td align="center">37</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">68</td><td align="center">月  日</td><td align="center"></td><td align="center">67</td><td align="center">66</td><td align="center">64</td><td align="center">61</td><td align="center">53</td><td align="center">38</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">69</td><td align="center">月  日</td><td align="center"></td><td align="center">68</td><td align="center">67</td><td align="center">65</td><td align="center">62</td><td align="center">54</td><td align="center">39</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">70</td><td align="center">月  日</td><td align="center"></td><td align="center">69</td><td align="center">68</td><td align="center">66</td><td align="center">63</td><td align="center">55</td><td align="center">40</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">71</td><td align="center">月  日</td><td align="center"></td><td align="center">70</td><td align="center">69</td><td align="center">67</td><td align="center">64</td><td align="center">56</td><td align="center">41</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">72</td><td align="center">月  日</td><td align="center"></td><td align="center">71</td><td align="center">70</td><td align="center">68</td><td align="center">65</td><td align="center">57</td><td align="center">42</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">73</td><td align="center">月  日</td><td align="center"></td><td align="center">72</td><td align="center">71</td><td align="center">69</td><td align="center">66</td><td align="center">58</td><td align="center">43</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">74</td><td align="center">月  日</td><td align="center"></td><td align="center">73</td><td align="center">72</td><td align="center">70</td><td align="center">67</td><td align="center">59</td><td align="center">44</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">75</td><td align="center">月  日</td><td align="center"></td><td align="center">74</td><td align="center">73</td><td align="center">71</td><td align="center">68</td><td align="center">60</td><td align="center">45</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">76</td><td align="center">月  日</td><td align="center"></td><td align="center">75</td><td align="center">74</td><td align="center">72</td><td align="center">69</td><td align="center">61</td><td align="center">46</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">77</td><td align="center">月  日</td><td align="center"></td><td align="center">76</td><td align="center">75</td><td align="center">73</td><td align="center">70</td><td align="center">62</td><td align="center">47</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">78</td><td align="center">月  日</td><td align="center"></td><td align="center">77</td><td align="center">76</td><td align="center">74</td><td align="center">71</td><td align="center">63</td><td align="center">48</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">79</td><td align="center">月  日</td><td align="center"></td><td align="center">78</td><td align="center">77</td><td align="center">75</td><td align="center">72</td><td align="center">64</td><td align="center">49</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">80</td><td align="center">月  日</td><td align="center"></td><td align="center">79</td><td align="center">78</td><td align="center">76</td><td align="center">73</td><td align="center">65</td><td align="center">50</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">81</td><td align="center">月  日</td><td align="center"></td><td align="center">80</td><td align="center">79</td><td align="center">77</td><td align="center">74</td><td align="center">66</td><td align="center">51</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">82</td><td align="center">月  日</td><td align="center"></td><td align="center">81</td><td align="center">80</td><td align="center">78</td><td align="center">75</td><td align="center">67</td><td align="center">52</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">83</td><td align="center">月  日</td><td align="center"></td><td align="center">82</td><td align="center">81</td><td align="center">79</td><td align="center">76</td><td align="center">68</td><td align="center">53</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">84</td><td align="center">月  日</td><td align="center"></td><td align="center">83</td><td align="center">82</td><td align="center">80</td><td align="center">77</td><td align="center">69</td><td align="center">54</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">85</td><td align="center">月  日</td><td align="center"></td><td align="center">84</td><td align="center">83</td><td align="center">81</td><td align="center">78</td><td align="center">70</td><td align="center">55</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">86</td><td align="center">月  日</td><td align="center"></td><td align="center">85</td><td align="center">84</td><td align="center">82</td><td align="center">79</td><td align="center">71</td><td align="center">56</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">87</td><td align="center">月  日</td><td align="center"></td><td align="center">86</td><td align="center">85</td><td align="center">83</td><td align="center">80</td><td align="center">72</td><td align="center">57</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">88</td><td align="center">月  日</td><td align="center"></td><td align="center">87</td><td align="center">86</td><td align="center">84</td><td align="center">81</td><td align="center">73</td><td align="center">58</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">89</td><td align="center">月  日</td><td align="center"></td><td align="center">88</td><td align="center">87</td><td align="center">85</td><td align="center">82</td><td align="center">74</td><td align="center">59</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">90</td><td align="center">月  日</td><td align="center"></td><td align="center">89</td><td align="center">88</td><td align="center">86</td><td align="center">83</td><td align="center">75</td><td align="center">60</td><td align="center">-</td><td align="center">-</td></tr><tr><td align="center">91</td><td align="center">月  日</td><td align="center"></td><td align="center">90</td><td align="center">89</td><td align="center">87</td><td align="center">84</td><td align="center">76</td><td align="center">61</td><td align="center">1</td><td align="center">-</td></tr><tr><td align="center">92</td><td align="center">月  日</td><td align="center"></td><td align="center">91</td><td align="center">90</td><td align="center">88</td><td align="center">85</td><td align="center">77</td><td align="center">62</td><td align="center">2</td><td align="center">-</td></tr><tr><td align="center">93</td><td align="center">月  日</td><td align="center"></td><td align="center">92</td><td align="center">91</td><td align="center">89</td><td align="center">86</td><td align="center">78</td><td align="center">63</td><td align="center">3</td><td align="center">-</td></tr><tr><td align="center">94</td><td align="center">月  日</td><td align="center"></td><td align="center">93</td><td align="center">92</td><td align="center">90</td><td align="center">87</td><td align="center">79</td><td align="center">64</td><td align="center">4</td><td align="center">-</td></tr><tr><td align="center">95</td><td align="center">月  日</td><td align="center"></td><td align="center">94</td><td align="center">93</td><td align="center">91</td><td align="center">88</td><td align="center">80</td><td align="center">65</td><td align="center">5</td><td align="center">-</td></tr><tr><td align="center">96</td><td align="center">月  日</td><td align="center"></td><td align="center">95</td><td align="center">94</td><td align="center">92</td><td align="center">89</td><td align="center">81</td><td align="center">66</td><td align="center">6</td><td align="center">-</td></tr><tr><td align="center">97</td><td align="center">月  日</td><td align="center"></td><td align="center">96</td><td align="center">95</td><td align="center">93</td><td align="center">90</td><td align="center">82</td><td align="center">67</td><td align="center">7</td><td align="center">-</td></tr><tr><td align="center">98</td><td align="center">月  日</td><td align="center"></td><td align="center">97</td><td align="center">96</td><td align="center">94</td><td align="center">91</td><td align="center">83</td><td align="center">68</td><td align="center">8</td><td align="center">-</td></tr><tr><td align="center">99</td><td align="center">月  日</td><td align="center"></td><td align="center">98</td><td align="center">97</td><td align="center">95</td><td align="center">92</td><td align="center">84</td><td align="center">69</td><td align="center">9</td><td align="center">-</td></tr><tr><td align="center">100</td><td align="center">月  日</td><td align="center"></td><td align="center">99</td><td align="center">98</td><td align="center">96</td><td align="center">93</td><td align="center">85</td><td align="center">70</td><td align="center">10</td><td align="center">-</td></tr><tr><td align="center">101</td><td align="center">月  日</td><td align="center"></td><td align="center">100</td><td align="center">99</td><td align="center">97</td><td align="center">94</td><td align="center">86</td><td align="center">71</td><td align="center">11</td><td align="center">-</td></tr><tr><td align="center">102</td><td align="center">月  日</td><td align="center"></td><td align="center">101</td><td align="center">100</td><td align="center">98</td><td align="center">95</td><td align="center">87</td><td align="center">72</td><td align="center">12</td><td align="center">-</td></tr><tr><td align="center">103</td><td align="center">月  日</td><td align="center"></td><td align="center">102</td><td align="center">101</td><td align="center">99</td><td align="center">96</td><td align="center">88</td><td align="center">73</td><td align="center">13</td><td align="center">-</td></tr><tr><td align="center">104</td><td align="center">月  日</td><td align="center"></td><td align="center">103</td><td align="center">102</td><td align="center">100</td><td align="center">97</td><td align="center">89</td><td align="center">74</td><td align="center">14</td><td align="center">-</td></tr><tr><td align="center">105</td><td align="center">月  日</td><td align="center"></td><td align="center">104</td><td align="center">103</td><td align="center">101</td><td align="center">98</td><td align="center">90</td><td align="center">75</td><td align="center">15</td><td align="center">-</td></tr><tr><td align="center">106</td><td align="center">月  日</td><td align="center"></td><td align="center">105</td><td align="center">104</td><td align="center">102</td><td align="center">99</td><td align="center">91</td><td align="center">76</td><td align="center">16</td><td align="center">-</td></tr><tr><td align="center">107</td><td align="center">月  日</td><td align="center"></td><td align="center">106</td><td align="center">105</td><td align="center">103</td><td align="center">100</td><td align="center">92</td><td align="center">77</td><td align="center">17</td><td align="center">-</td></tr><tr><td align="center">108</td><td align="center">月  日</td><td align="center"></td><td align="center">107</td><td align="center">106</td><td align="center">104</td><td align="center">101</td><td align="center">93</td><td align="center">78</td><td align="center">18</td><td align="center">-</td></tr><tr><td align="center">109</td><td align="center">月  日</td><td align="center"></td><td align="center">108</td><td align="center">107</td><td align="center">105</td><td align="center">102</td><td align="center">94</td><td align="center">79</td><td align="center">19</td><td align="center">-</td></tr><tr><td align="center">110</td><td align="center">月  日</td><td align="center"></td><td align="center">109</td><td align="center">108</td><td align="center">106</td><td align="center">103</td><td align="center">95</td><td align="center">80</td><td align="center">20</td><td align="center">-</td></tr><tr><td align="center">111</td><td align="center">月  日</td><td align="center"></td><td align="center">110</td><td align="center">109</td><td align="center">107</td><td align="center">104</td><td align="center">96</td><td align="center">81</td><td align="center">21</td><td align="center">-</td></tr><tr><td align="center">112</td><td align="center">月  日</td><td align="center"></td><td align="center">111</td><td align="center">110</td><td align="center">108</td><td align="center">105</td><td align="center">97</td><td align="center">82</td><td align="center">22</td><td align="center">-</td></tr><tr><td align="center">113</td><td align="center">月  日</td><td align="center"></td><td align="center">112</td><td align="center">111</td><td align="center">109</td><td align="center">106</td><td align="center">98</td><td align="center">83</td><td align="center">23</td><td align="center">-</td></tr><tr><td align="center">114</td><td align="center">月  日</td><td align="center"></td><td align="center">113</td><td align="center">112</td><td align="center">110</td><td align="center">107</td><td align="center">99</td><td align="center">84</td><td align="center">24</td><td align="center">-</td></tr><tr><td align="center">115</td><td align="center">月  日</td><td align="center"></td><td align="center">114</td><td align="center">113</td><td align="center">111</td><td align="center">108</td><td align="center">100</td><td align="center">85</td><td align="center">25</td><td align="center">-</td></tr><tr><td align="center">116</td><td align="center">月  日</td><td align="center"></td><td align="center">115</td><td align="center">114</td><td align="center">112</td><td align="center">109</td><td align="center">101</td><td align="center">86</td><td align="center">26</td><td align="center">-</td></tr><tr><td align="center">117</td><td align="center">月  日</td><td align="center"></td><td align="center">116</td><td align="center">115</td><td align="center">113</td><td align="center">110</td><td align="center">102</td><td align="center">87</td><td align="center">27</td><td align="center">-</td></tr><tr><td align="center">118</td><td align="center">月  日</td><td align="center"></td><td align="center">117</td><td align="center">116</td><td align="center">114</td><td align="center">111</td><td align="center">103</td><td align="center">88</td><td align="center">28</td><td align="center">-</td></tr><tr><td align="center">119</td><td align="center">月  日</td><td align="center"></td><td align="center">118</td><td align="center">117</td><td align="center">115</td><td align="center">112</td><td align="center">104</td><td align="center">89</td><td align="center">29</td><td align="center">-</td></tr><tr><td align="center">120</td><td align="center">月  日</td><td align="center"></td><td align="center">119</td><td align="center">118</td><td align="center">116</td><td align="center">113</td><td align="center">105</td><td align="center">90</td><td align="center">30</td><td align="center">-</td></tr><tr><td align="center">121</td><td align="center">月  日</td><td align="center"></td><td align="center">120</td><td align="center">119</td><td align="center">117</td><td align="center">114</td><td align="center">106</td><td align="center">91</td><td align="center">31</td><td align="center">-</td></tr><tr><td align="center">122</td><td align="center">月  日</td><td align="center"></td><td align="center">121</td><td align="center">120</td><td align="center">118</td><td align="center">115</td><td align="center">107</td><td align="center">92</td><td align="center">32</td><td align="center">-</td></tr><tr><td align="center">123</td><td align="center">月  日</td><td align="center"></td><td align="center">122</td><td align="center">121</td><td align="center">119</td><td align="center">116</td><td align="center">108</td><td align="center">93</td><td align="center">33</td><td align="center">-</td></tr><tr><td align="center">124</td><td align="center">月  日</td><td align="center"></td><td align="center">123</td><td align="center">122</td><td align="center">120</td><td align="center">117</td><td align="center">109</td><td align="center">94</td><td align="center">34</td><td align="center">-</td></tr><tr><td align="center">125</td><td align="center">月  日</td><td align="center"></td><td align="center">124</td><td align="center">123</td><td align="center">121</td><td align="center">118</td><td align="center">110</td><td align="center">95</td><td align="center">35</td><td align="center">-</td></tr><tr><td align="center">126</td><td align="center">月  日</td><td align="center"></td><td align="center">125</td><td align="center">124</td><td align="center">122</td><td align="center">119</td><td align="center">111</td><td align="center">96</td><td align="center">36</td><td align="center">-</td></tr><tr><td align="center">127</td><td align="center">月  日</td><td align="center"></td><td align="center">126</td><td align="center">125</td><td align="center">123</td><td align="center">120</td><td align="center">112</td><td align="center">97</td><td align="center">37</td><td align="center">-</td></tr><tr><td align="center">128</td><td align="center">月  日</td><td align="center"></td><td align="center">127</td><td align="center">126</td><td align="center">124</td><td align="center">121</td><td align="center">113</td><td align="center">98</td><td align="center">38</td><td align="center">-</td></tr><tr><td align="center">129</td><td align="center">月  日</td><td align="center"></td><td align="center">128</td><td align="center">127</td><td align="center">125</td><td align="center">122</td><td align="center">114</td><td align="center">99</td><td align="center">39</td><td align="center">-</td></tr><tr><td align="center">130</td><td align="center">月  日</td><td align="center"></td><td align="center">129</td><td align="center">128</td><td align="center">126</td><td align="center">123</td><td align="center">115</td><td align="center">100</td><td align="center">40</td><td align="center">-</td></tr><tr><td align="center">131</td><td align="center">月  日</td><td align="center"></td><td align="center">130</td><td align="center">129</td><td align="center">127</td><td align="center">124</td><td align="center">116</td><td align="center">101</td><td align="center">41</td><td align="center">-</td></tr><tr><td align="center">132</td><td align="center">月  日</td><td align="center"></td><td align="center">131</td><td align="center">130</td><td align="center">128</td><td align="center">125</td><td align="center">117</td><td align="center">102</td><td align="center">42</td><td align="center">-</td></tr><tr><td align="center">133</td><td align="center">月  日</td><td align="center"></td><td align="center">132</td><td align="center">131</td><td align="center">129</td><td align="center">126</td><td align="center">118</td><td align="center">103</td><td align="center">43</td><td align="center">-</td></tr><tr><td align="center">134</td><td align="center">月  日</td><td align="center"></td><td align="center">133</td><td align="center">132</td><td align="center">130</td><td align="center">127</td><td align="center">119</td><td align="center">104</td><td align="center">44</td><td align="center">-</td></tr><tr><td align="center">135</td><td align="center">月  日</td><td align="center"></td><td align="center">134</td><td align="center">133</td><td align="center">131</td><td align="center">128</td><td align="center">120</td><td align="center">105</td><td align="center">45</td><td align="center">-</td></tr><tr><td align="center">136</td><td align="center">月  日</td><td align="center"></td><td align="center">135</td><td align="center">134</td><td align="center">132</td><td align="center">129</td><td align="center">121</td><td align="center">106</td><td align="center">46</td><td align="center">-</td></tr><tr><td align="center">137</td><td align="center">月  日</td><td align="center"></td><td align="center">136</td><td align="center">135</td><td align="center">133</td><td align="center">130</td><td align="center">122</td><td align="center">107</td><td align="center">47</td><td align="center">-</td></tr><tr><td align="center">138</td><td align="center">月  日</td><td align="center"></td><td align="center">137</td><td align="center">136</td><td align="center">134</td><td align="center">131</td><td align="center">123</td><td align="center">108</td><td align="center">48</td><td align="center">-</td></tr><tr><td align="center">139</td><td align="center">月  日</td><td align="center"></td><td align="center">138</td><td align="center">137</td><td align="center">135</td><td align="center">132</td><td align="center">124</td><td align="center">109</td><td align="center">49</td><td align="center">-</td></tr><tr><td align="center">140</td><td align="center">月  日</td><td align="center"></td><td align="center">139</td><td align="center">138</td><td align="center">136</td><td align="center">133</td><td align="center">125</td><td align="center">110</td><td align="center">50</td><td align="center">-</td></tr><tr><td align="center">141</td><td align="center">月  日</td><td align="center"></td><td align="center">140</td><td align="center">139</td><td align="center">137</td><td align="center">134</td><td align="center">126</td><td align="center">111</td><td align="center">51</td><td align="center">-</td></tr><tr><td align="center">142</td><td align="center">月  日</td><td align="center"></td><td align="center">141</td><td align="center">140</td><td align="center">138</td><td align="center">135</td><td align="center">127</td><td align="center">112</td><td align="center">52</td><td align="center">-</td></tr><tr><td align="center">143</td><td align="center">月  日</td><td align="center"></td><td align="center">142</td><td align="center">141</td><td align="center">139</td><td align="center">136</td><td align="center">128</td><td align="center">113</td><td align="center">53</td><td align="center">-</td></tr><tr><td align="center">144</td><td align="center">月  日</td><td align="center"></td><td align="center">143</td><td align="center">142</td><td align="center">140</td><td align="center">137</td><td align="center">129</td><td align="center">114</td><td align="center">54</td><td align="center">-</td></tr><tr><td align="center">145</td><td align="center">月  日</td><td align="center"></td><td align="center">144</td><td align="center">143</td><td align="center">141</td><td align="center">138</td><td align="center">130</td><td align="center">115</td><td align="center">55</td><td align="center">-</td></tr><tr><td align="center">146</td><td align="center">月  日</td><td align="center"></td><td align="center">145</td><td align="center">144</td><td align="center">142</td><td align="center">139</td><td align="center">131</td><td align="center">116</td><td align="center">56</td><td align="center">-</td></tr><tr><td align="center">147</td><td align="center">月  日</td><td align="center"></td><td align="center">146</td><td align="center">145</td><td align="center">143</td><td align="center">140</td><td align="center">132</td><td align="center">117</td><td align="center">57</td><td align="center">-</td></tr><tr><td align="center">148</td><td align="center">月  日</td><td align="center"></td><td align="center">147</td><td align="center">146</td><td align="center">144</td><td align="center">141</td><td align="center">133</td><td align="center">118</td><td align="center">58</td><td align="center">-</td></tr><tr><td align="center">149</td><td align="center">月  日</td><td align="center"></td><td align="center">148</td><td align="center">147</td><td align="center">145</td><td align="center">142</td><td align="center">134</td><td align="center">119</td><td align="center">59</td><td align="center">-</td></tr><tr><td align="center">150</td><td align="center">月  日</td><td align="center"></td><td align="center">149</td><td align="center">148</td><td align="center">146</td><td align="center">143</td><td align="center">135</td><td align="center">120</td><td align="center">60</td><td align="center">-</td></tr><tr><td align="center">151</td><td align="center">月  日</td><td align="center"></td><td align="center">150</td><td align="center">149</td><td align="center">147</td><td align="center">144</td><td align="center">136</td><td align="center">121</td><td align="center">61</td><td align="center">-</td></tr><tr><td align="center">152</td><td align="center">月  日</td><td align="center"></td><td align="center">151</td><td align="center">150</td><td align="center">148</td><td align="center">145</td><td align="center">137</td><td align="center">122</td><td align="center">62</td><td align="center">-</td></tr><tr><td align="center">153</td><td align="center">月  日</td><td align="center"></td><td align="center">152</td><td align="center">151</td><td align="center">149</td><td align="center">146</td><td align="center">138</td><td align="center">123</td><td align="center">63</td><td align="center">-</td></tr><tr><td align="center">154</td><td align="center">月  日</td><td align="center"></td><td align="center">153</td><td align="center">152</td><td align="center">150</td><td align="center">147</td><td align="center">139</td><td align="center">124</td><td align="center">64</td><td align="center">-</td></tr><tr><td align="center">155</td><td align="center">月  日</td><td align="center"></td><td align="center">154</td><td align="center">153</td><td align="center">151</td><td align="center">148</td><td align="center">140</td><td align="center">125</td><td align="center">65</td><td align="center">-</td></tr><tr><td align="center">156</td><td align="center">月  日</td><td align="center"></td><td align="center">155</td><td align="center">154</td><td align="center">152</td><td align="center">149</td><td align="center">141</td><td align="center">126</td><td align="center">66</td><td align="center">-</td></tr><tr><td align="center">157</td><td align="center">月  日</td><td align="center"></td><td align="center">156</td><td align="center">155</td><td align="center">153</td><td align="center">150</td><td align="center">142</td><td align="center">127</td><td align="center">67</td><td align="center">-</td></tr><tr><td align="center">158</td><td align="center">月  日</td><td align="center"></td><td align="center">157</td><td align="center">156</td><td align="center">154</td><td align="center">151</td><td align="center">143</td><td align="center">128</td><td align="center">68</td><td align="center">-</td></tr><tr><td align="center">159</td><td align="center">月  日</td><td align="center"></td><td align="center">158</td><td align="center">157</td><td align="center">155</td><td align="center">152</td><td align="center">144</td><td align="center">129</td><td align="center">69</td><td align="center">-</td></tr><tr><td align="center">160</td><td align="center">月  日</td><td align="center"></td><td align="center">159</td><td align="center">158</td><td align="center">156</td><td align="center">153</td><td align="center">145</td><td align="center">130</td><td align="center">70</td><td align="center">-</td></tr><tr><td align="center">161</td><td align="center">月  日</td><td align="center"></td><td align="center">160</td><td align="center">159</td><td align="center">157</td><td align="center">154</td><td align="center">146</td><td align="center">131</td><td align="center">71</td><td align="center">-</td></tr><tr><td align="center">162</td><td align="center">月  日</td><td align="center"></td><td align="center">161</td><td align="center">160</td><td align="center">158</td><td align="center">155</td><td align="center">147</td><td align="center">132</td><td align="center">72</td><td align="center">-</td></tr><tr><td align="center">163</td><td align="center">月  日</td><td align="center"></td><td align="center">162</td><td align="center">161</td><td align="center">159</td><td align="center">156</td><td align="center">148</td><td align="center">133</td><td align="center">73</td><td align="center">-</td></tr><tr><td align="center">164</td><td align="center">月  日</td><td align="center"></td><td align="center">163</td><td align="center">162</td><td align="center">160</td><td align="center">157</td><td align="center">149</td><td align="center">134</td><td align="center">74</td><td align="center">-</td></tr><tr><td align="center">165</td><td align="center">月  日</td><td align="center"></td><td align="center">164</td><td align="center">163</td><td align="center">161</td><td align="center">158</td><td align="center">150</td><td align="center">135</td><td align="center">75</td><td align="center">-</td></tr><tr><td align="center">166</td><td align="center">月  日</td><td align="center"></td><td align="center">165</td><td align="center">164</td><td align="center">162</td><td align="center">159</td><td align="center">151</td><td align="center">136</td><td align="center">76</td><td align="center">-</td></tr><tr><td align="center">167</td><td align="center">月  日</td><td align="center"></td><td align="center">166</td><td align="center">165</td><td align="center">163</td><td align="center">160</td><td align="center">152</td><td align="center">137</td><td align="center">77</td><td align="center">-</td></tr><tr><td align="center">168</td><td align="center">月  日</td><td align="center"></td><td align="center">167</td><td align="center">166</td><td align="center">164</td><td align="center">161</td><td align="center">153</td><td align="center">138</td><td align="center">78</td><td align="center">-</td></tr><tr><td align="center">169</td><td align="center">月  日</td><td align="center"></td><td align="center">168</td><td align="center">167</td><td align="center">165</td><td align="center">162</td><td align="center">154</td><td align="center">139</td><td align="center">79</td><td align="center">-</td></tr><tr><td align="center">170</td><td align="center">月  日</td><td align="center"></td><td align="center">169</td><td align="center">168</td><td align="center">166</td><td align="center">163</td><td align="center">155</td><td align="center">140</td><td align="center">80</td><td align="center">-</td></tr><tr><td align="center">171</td><td align="center">月  日</td><td align="center"></td><td align="center">170</td><td align="center">169</td><td align="center">167</td><td align="center">164</td><td align="center">156</td><td align="center">141</td><td align="center">81</td><td align="center">-</td></tr><tr><td align="center">172</td><td align="center">月  日</td><td align="center"></td><td align="center">171</td><td align="center">170</td><td align="center">168</td><td align="center">165</td><td align="center">157</td><td align="center">142</td><td align="center">82</td><td align="center">-</td></tr><tr><td align="center">173</td><td align="center">月  日</td><td align="center"></td><td align="center">172</td><td align="center">171</td><td align="center">169</td><td align="center">166</td><td align="center">158</td><td align="center">143</td><td align="center">83</td><td align="center">-</td></tr><tr><td align="center">174</td><td align="center">月  日</td><td align="center"></td><td align="center">173</td><td align="center">172</td><td align="center">170</td><td align="center">167</td><td align="center">159</td><td align="center">144</td><td align="center">84</td><td align="center">-</td></tr><tr><td align="center">175</td><td align="center">月  日</td><td align="center"></td><td align="center">174</td><td align="center">173</td><td align="center">171</td><td align="center">168</td><td align="center">160</td><td align="center">145</td><td align="center">85</td><td align="center">-</td></tr><tr><td align="center">176</td><td align="center">月  日</td><td align="center"></td><td align="center">175</td><td align="center">174</td><td align="center">172</td><td align="center">169</td><td align="center">161</td><td align="center">146</td><td align="center">86</td><td align="center">-</td></tr><tr><td align="center">177</td><td align="center">月  日</td><td align="center"></td><td align="center">176</td><td align="center">175</td><td align="center">173</td><td align="center">170</td><td align="center">162</td><td align="center">147</td><td align="center">87</td><td align="center">-</td></tr><tr><td align="center">178</td><td align="center">月  日</td><td align="center"></td><td align="center">177</td><td align="center">176</td><td align="center">174</td><td align="center">171</td><td align="center">163</td><td align="center">148</td><td align="center">88</td><td align="center">-</td></tr><tr><td align="center">179</td><td align="center">月  日</td><td align="center"></td><td align="center">178</td><td align="center">177</td><td align="center">175</td><td align="center">172</td><td align="center">164</td><td align="center">149</td><td align="center">89</td><td align="center">-</td></tr><tr><td align="center">180</td><td align="center">月  日</td><td align="center"></td><td align="center">179</td><td align="center">178</td><td align="center">176</td><td align="center">173</td><td align="center">165</td><td align="center">150</td><td align="center">90</td><td align="center">1</td></tr><tr><td align="center">181</td><td align="center">月  日</td><td align="center"></td><td align="center">180</td><td align="center">179</td><td align="center">177</td><td align="center">174</td><td align="center">166</td><td align="center">151</td><td align="center">91</td><td align="center">2</td></tr><tr><td align="center">182</td><td align="center">月  日</td><td align="center"></td><td align="center">181</td><td align="center">180</td><td align="center">178</td><td align="center">175</td><td align="center">167</td><td align="center">152</td><td align="center">92</td><td align="center">3</td></tr><tr><td align="center">183</td><td align="center">月  日</td><td align="center"></td><td align="center">182</td><td align="center">181</td><td align="center">179</td><td align="center">176</td><td align="center">168</td><td align="center">153</td><td align="center">93</td><td align="center">4</td></tr><tr><td align="center">184</td><td align="center">月  日</td><td align="center"></td><td align="center">183</td><td align="center">182</td><td align="center">180</td><td align="center">177</td><td align="center">169</td><td align="center">154</td><td align="center">94</td><td align="center">5</td></tr><tr><td align="center">185</td><td align="center">月  日</td><td align="center"></td><td align="center">184</td><td align="center">183</td><td align="center">181</td><td align="center">178</td><td align="center">170</td><td align="center">155</td><td align="center">95</td><td align="center">6</td></tr><tr><td align="center">186</td><td align="center">月  日</td><td align="center"></td><td align="center">185</td><td align="center">184</td><td align="center">182</td><td align="center">179</td><td align="center">171</td><td align="center">156</td><td align="center">96</td><td align="center">7</td></tr><tr><td align="center">187</td><td align="center">月  日</td><td align="center"></td><td align="center">186</td><td align="center">185</td><td align="center">183</td><td align="center">180</td><td align="center">172</td><td align="center">157</td><td align="center">97</td><td align="center">8</td></tr><tr><td align="center">188</td><td align="center">月  日</td><td align="center"></td><td align="center">187</td><td align="center">186</td><td align="center">184</td><td align="center">181</td><td align="center">173</td><td align="center">158</td><td align="center">98</td><td align="center">9</td></tr><tr><td align="center">189</td><td align="center">月  日</td><td align="center"></td><td align="center">188</td><td align="center">187</td><td align="center">185</td><td align="center">182</td><td align="center">174</td><td align="center">159</td><td align="center">99</td><td align="center">10</td></tr><tr><td align="center">190</td><td align="center">月  日</td><td align="center"></td><td align="center">189</td><td align="center">188</td><td align="center">186</td><td align="center">183</td><td align="center">175</td><td align="center">160</td><td align="center">100</td><td align="center">11</td></tr><tr><td align="center">191</td><td align="center">月  日</td><td align="center"></td><td align="center">190</td><td align="center">189</td><td align="center">187</td><td align="center">184</td><td align="center">176</td><td align="center">161</td><td align="center">101</td><td align="center">12</td></tr><tr><td align="center">192</td><td align="center">月  日</td><td align="center"></td><td align="center">191</td><td align="center">190</td><td align="center">188</td><td align="center">185</td><td align="center">177</td><td align="center">162</td><td align="center">102</td><td align="center">13</td></tr><tr><td align="center">193</td><td align="center">月  日</td><td align="center"></td><td align="center">192</td><td align="center">191</td><td align="center">189</td><td align="center">186</td><td align="center">178</td><td align="center">163</td><td align="center">103</td><td align="center">14</td></tr><tr><td align="center">194</td><td align="center">月  日</td><td align="center"></td><td align="center">193</td><td align="center">192</td><td align="center">190</td><td align="center">187</td><td align="center">179</td><td align="center">164</td><td align="center">104</td><td align="center">15</td></tr><tr><td align="center">195</td><td align="center">月  日</td><td align="center"></td><td align="center">194</td><td align="center">193</td><td align="center">191</td><td align="center">188</td><td align="center">180</td><td align="center">165</td><td align="center">105</td><td align="center">16</td></tr><tr><td align="center">196</td><td align="center">月  日</td><td align="center"></td><td align="center">195</td><td align="center">194</td><td align="center">192</td><td align="center">189</td><td align="center">181</td><td align="center">166</td><td align="center">106</td><td align="center">17</td></tr><tr><td align="center">197</td><td align="center">月  日</td><td align="center"></td><td align="center">196</td><td align="center">195</td><td align="center">193</td><td align="center">190</td><td align="center">182</td><td align="center">167</td><td align="center">107</td><td align="center">18</td></tr><tr><td align="center">198</td><td align="center">月  日</td><td align="center"></td><td align="center">197</td><td align="center">196</td><td align="center">194</td><td align="center">191</td><td align="center">183</td><td align="center">168</td><td align="center">108</td><td align="center">19</td></tr><tr><td align="center">199</td><td align="center">月  日</td><td align="center"></td><td align="center">198</td><td align="center">197</td><td align="center">195</td><td align="center">192</td><td align="center">184</td><td align="center">169</td><td align="center">109</td><td align="center">20</td></tr><tr><td align="center">200</td><td align="center">月  日</td><td align="center"></td><td align="center">199</td><td align="center">198</td><td align="center">196</td><td align="center">193</td><td align="center">185</td><td align="center">170</td><td align="center">110</td><td align="center">21</td></tr><tr><td align="center">201</td><td align="center">月  日</td><td align="center"></td><td align="center">200</td><td align="center">199</td><td align="center">197</td><td align="center">194</td><td align="center">186</td><td align="center">171</td><td align="center">111</td><td align="center">22</td></tr><tr><td align="center">202</td><td align="center">月  日</td><td align="center"></td><td align="center">201</td><td align="center">200</td><td align="center">198</td><td align="center">195</td><td align="center">187</td><td align="center">172</td><td align="center">112</td><td align="center">23</td></tr><tr><td align="center">203</td><td align="center">月  日</td><td align="center"></td><td align="center">202</td><td align="center">201</td><td align="center">199</td><td align="center">196</td><td align="center">188</td><td align="center">173</td><td align="center">113</td><td align="center">24</td></tr><tr><td align="center">204</td><td align="center">月  日</td><td align="center"></td><td align="center">203</td><td align="center">202</td><td align="center">200</td><td align="center">197</td><td align="center">189</td><td align="center">174</td><td align="center">114</td><td align="center">25</td></tr><tr><td align="center">205</td><td align="center">月  日</td><td align="center"></td><td align="center">204</td><td align="center">203</td><td align="center">201</td><td align="center">198</td><td align="center">190</td><td align="center">175</td><td align="center">115</td><td align="center">26</td></tr><tr><td align="center">206</td><td align="center">月  日</td><td align="center"></td><td align="center">205</td><td align="center">204</td><td align="center">202</td><td align="center">199</td><td align="center">191</td><td align="center">176</td><td align="center">116</td><td align="center">27</td></tr><tr><td align="center">207</td><td align="center">月  日</td><td align="center"></td><td align="center">206</td><td align="center">205</td><td align="center">203</td><td align="center">200</td><td align="center">192</td><td align="center">177</td><td align="center">117</td><td align="center">28</td></tr><tr><td align="center">208</td><td align="center">月  日</td><td align="center"></td><td align="center">207</td><td align="center">206</td><td align="center">204</td><td align="center">201</td><td align="center">193</td><td align="center">178</td><td align="center">118</td><td align="center">29</td></tr><tr><td align="center">209</td><td align="center">月  日</td><td align="center"></td><td align="center">208</td><td align="center">207</td><td align="center">205</td><td align="center">202</td><td align="center">194</td><td align="center">179</td><td align="center">119</td><td align="center">30</td></tr><tr><td align="center">210</td><td align="center">月  日</td><td align="center"></td><td align="center">209</td><td align="center">208</td><td align="center">206</td><td align="center">203</td><td align="center">195</td><td align="center">180</td><td align="center">120</td><td align="center">31</td></tr><tr><td align="center">211</td><td align="center">月  日</td><td align="center"></td><td align="center">210</td><td align="center">209</td><td align="center">207</td><td align="center">204</td><td align="center">196</td><td align="center">181</td><td align="center">121</td><td align="center">32</td></tr><tr><td align="center">212</td><td align="center">月  日</td><td align="center"></td><td align="center">211</td><td align="center">210</td><td align="center">208</td><td align="center">205</td><td align="center">197</td><td align="center">182</td><td align="center">122</td><td align="center">33</td></tr><tr><td align="center">213</td><td align="center">月  日</td><td align="center"></td><td align="center">212</td><td align="center">211</td><td align="center">209</td><td align="center">206</td><td align="center">198</td><td align="center">183</td><td align="center">123</td><td align="center">34</td></tr><tr><td align="center">214</td><td align="center">月  日</td><td align="center"></td><td align="center">213</td><td align="center">212</td><td align="center">210</td><td align="center">207</td><td align="center">199</td><td align="center">184</td><td align="center">124</td><td align="center">35</td></tr><tr><td align="center">215</td><td align="center">月  日</td><td align="center"></td><td align="center">214</td><td align="center">213</td><td align="center">211</td><td align="center">208</td><td align="center">200</td><td align="center">185</td><td align="center">125</td><td align="center">36</td></tr><tr><td align="center">216</td><td align="center">月  日</td><td align="center"></td><td align="center">215</td><td align="center">214</td><td align="center">212</td><td align="center">209</td><td align="center">201</td><td align="center">186</td><td align="center">126</td><td align="center">37</td></tr><tr><td align="center">217</td><td align="center">月  日</td><td align="center"></td><td align="center">216</td><td align="center">215</td><td align="center">213</td><td align="center">210</td><td align="center">202</td><td align="center">187</td><td align="center">127</td><td align="center">38</td></tr><tr><td align="center">218</td><td align="center">月  日</td><td align="center"></td><td align="center">217</td><td align="center">216</td><td align="center">214</td><td align="center">211</td><td align="center">203</td><td align="center">188</td><td align="center">128</td><td align="center">39</td></tr><tr><td align="center">219</td><td align="center">月  日</td><td align="center"></td><td align="center">218</td><td align="center">217</td><td align="center">215</td><td align="center">212</td><td align="center">204</td><td align="center">189</td><td align="center">129</td><td align="center">40</td></tr><tr><td align="center">220</td><td align="center">月  日</td><td align="center"></td><td align="center">219</td><td align="center">218</td><td align="center">216</td><td align="center">213</td><td align="center">205</td><td align="center">190</td><td align="center">130</td><td align="center">41</td></tr><tr><td align="center">221</td><td align="center">月  日</td><td align="center"></td><td align="center">220</td><td align="center">219</td><td align="center">217</td><td align="center">214</td><td align="center">206</td><td align="center">191</td><td align="center">131</td><td align="center">42</td></tr><tr><td align="center">222</td><td align="center">月  日</td><td align="center"></td><td align="center">221</td><td align="center">220</td><td align="center">218</td><td align="center">215</td><td align="center">207</td><td align="center">192</td><td align="center">132</td><td align="center">43</td></tr><tr><td align="center">223</td><td align="center">月  日</td><td align="center"></td><td align="center">222</td><td align="center">221</td><td align="center">219</td><td align="center">216</td><td align="center">208</td><td align="center">193</td><td align="center">133</td><td align="center">44</td></tr><tr><td align="center">224</td><td align="center">月  日</td><td align="center"></td><td align="center">223</td><td align="center">222</td><td align="center">220</td><td align="center">217</td><td align="center">209</td><td align="center">194</td><td align="center">134</td><td align="center">45</td></tr><tr><td align="center">225</td><td align="center">月  日</td><td align="center"></td><td align="center">224</td><td align="center">223</td><td align="center">221</td><td align="center">218</td><td align="center">210</td><td align="center">195</td><td align="center">135</td><td align="center">46</td></tr><tr><td align="center">226</td><td align="center">月  日</td><td align="center"></td><td align="center">225</td><td align="center">224</td><td align="center">222</td><td align="center">219</td><td align="center">211</td><td align="center">196</td><td align="center">136</td><td align="center">47</td></tr><tr><td align="center">227</td><td align="center">月  日</td><td align="center"></td><td align="center">226</td><td align="center">225</td><td align="center">223</td><td align="center">220</td><td align="center">212</td><td align="center">197</td><td align="center">137</td><td align="center">48</td></tr><tr><td align="center">228</td><td align="center">月  日</td><td align="center"></td><td align="center">227</td><td align="center">226</td><td align="center">224</td><td align="center">221</td><td align="center">213</td><td align="center">198</td><td align="center">138</td><td align="center">49</td></tr><tr><td align="center">229</td><td align="center">月  日</td><td align="center"></td><td align="center">228</td><td align="center">227</td><td align="center">225</td><td align="center">222</td><td align="center">214</td><td align="center">199</td><td align="center">139</td><td align="center">50</td></tr><tr><td align="center">230</td><td align="center">月  日</td><td align="center"></td><td align="center">229</td><td align="center">228</td><td align="center">226</td><td align="center">223</td><td align="center">215</td><td align="center">200</td><td align="center">140</td><td align="center">51</td></tr><tr><td align="center">231</td><td align="center">月  日</td><td align="center"></td><td align="center">230</td><td align="center">229</td><td align="center">227</td><td align="center">224</td><td align="center">216</td><td align="center">201</td><td align="center">141</td><td align="center">52</td></tr><tr><td align="center">232</td><td align="center">月  日</td><td align="center"></td><td align="center">231</td><td align="center">230</td><td align="center">228</td><td align="center">225</td><td align="center">217</td><td align="center">202</td><td align="center">142</td><td align="center">53</td></tr><tr><td align="center">233</td><td align="center">月  日</td><td align="center"></td><td align="center">232</td><td align="center">231</td><td align="center">229</td><td align="center">226</td><td align="center">218</td><td align="center">203</td><td align="center">143</td><td align="center">54</td></tr><tr><td align="center">234</td><td align="center">月  日</td><td align="center"></td><td align="center">233</td><td align="center">232</td><td align="center">230</td><td align="center">227</td><td align="center">219</td><td align="center">204</td><td align="center">144</td><td align="center">55</td></tr><tr><td align="center">235</td><td align="center">月  日</td><td align="center"></td><td align="center">234</td><td align="center">233</td><td align="center">231</td><td align="center">228</td><td align="center">220</td><td align="center">205</td><td align="center">145</td><td align="center">56</td></tr><tr><td align="center">236</td><td align="center">月  日</td><td align="center"></td><td align="center">235</td><td align="center">234</td><td align="center">232</td><td align="center">229</td><td align="center">221</td><td align="center">206</td><td align="center">146</td><td align="center">57</td></tr><tr><td align="center">237</td><td align="center">月  日</td><td align="center"></td><td align="center">236</td><td align="center">235</td><td align="center">233</td><td align="center">230</td><td align="center">222</td><td align="center">207</td><td align="center">147</td><td align="center">58</td></tr><tr><td align="center">238</td><td align="center">月  日</td><td align="center"></td><td align="center">237</td><td align="center">236</td><td align="center">234</td><td align="center">231</td><td align="center">223</td><td align="center">208</td><td align="center">148</td><td align="center">59</td></tr><tr><td align="center">239</td><td align="center">月  日</td><td align="center"></td><td align="center">238</td><td align="center">237</td><td align="center">235</td><td align="center">232</td><td align="center">224</td><td align="center">209</td><td align="center">149</td><td align="center">60</td></tr><tr><td align="center">240</td><td align="center">月  日</td><td align="center"></td><td align="center">239</td><td align="center">238</td><td align="center">236</td><td align="center">233</td><td align="center">225</td><td align="center">210</td><td align="center">150</td><td align="center">61</td></tr><tr><td align="center">241</td><td align="center">月  日</td><td align="center"></td><td align="center">240</td><td align="center">239</td><td align="center">237</td><td align="center">234</td><td align="center">226</td><td align="center">211</td><td align="center">151</td><td align="center">62</td></tr><tr><td align="center">242</td><td align="center">月  日</td><td align="center"></td><td align="center">241</td><td align="center">240</td><td align="center">238</td><td align="center">235</td><td align="center">227</td><td align="center">212</td><td align="center">152</td><td align="center">63</td></tr><tr><td align="center">243</td><td align="center">月  日</td><td align="center"></td><td align="center">242</td><td align="center">241</td><td align="center">239</td><td align="center">236</td><td align="center">228</td><td align="center">213</td><td align="center">153</td><td align="center">64</td></tr><tr><td align="center">244</td><td align="center">月  日</td><td align="center"></td><td align="center">243</td><td align="center">242</td><td align="center">240</td><td align="center">237</td><td align="center">229</td><td align="center">214</td><td align="center">154</td><td align="center">65</td></tr><tr><td align="center">245</td><td align="center">月  日</td><td align="center"></td><td align="center">244</td><td align="center">243</td><td align="center">241</td><td align="center">238</td><td align="center">230</td><td align="center">215</td><td align="center">155</td><td align="center">66</td></tr><tr><td align="center">246</td><td align="center">月  日</td><td align="center"></td><td align="center">245</td><td align="center">244</td><td align="center">242</td><td align="center">239</td><td align="center">231</td><td align="center">216</td><td align="center">156</td><td align="center">67</td></tr><tr><td align="center">247</td><td align="center">月  日</td><td align="center"></td><td align="center">246</td><td align="center">245</td><td align="center">243</td><td align="center">240</td><td align="center">232</td><td align="center">217</td><td align="center">157</td><td align="center">68</td></tr><tr><td align="center">248</td><td align="center">月  日</td><td align="center"></td><td align="center">247</td><td align="center">246</td><td align="center">244</td><td align="center">241</td><td align="center">233</td><td align="center">218</td><td align="center">158</td><td align="center">69</td></tr><tr><td align="center">249</td><td align="center">月  日</td><td align="center"></td><td align="center">248</td><td align="center">247</td><td align="center">245</td><td align="center">242</td><td align="center">234</td><td align="center">219</td><td align="center">159</td><td align="center">70</td></tr><tr><td align="center">250</td><td align="center">月  日</td><td align="center"></td><td align="center">249</td><td align="center">248</td><td align="center">246</td><td align="center">243</td><td align="center">235</td><td align="center">220</td><td align="center">160</td><td align="center">71</td></tr><tr><td align="center">251</td><td align="center">月  日</td><td align="center"></td><td align="center">250</td><td align="center">249</td><td align="center">247</td><td align="center">244</td><td align="center">236</td><td align="center">221</td><td align="center">161</td><td align="center">72</td></tr><tr><td align="center">252</td><td align="center">月  日</td><td align="center"></td><td align="center">251</td><td align="center">250</td><td align="center">248</td><td align="center">245</td><td align="center">237</td><td align="center">222</td><td align="center">162</td><td align="center">73</td></tr><tr><td align="center">253</td><td align="center">月  日</td><td align="center"></td><td align="center">252</td><td align="center">251</td><td align="center">249</td><td align="center">246</td><td align="center">238</td><td align="center">223</td><td align="center">163</td><td align="center">74</td></tr><tr><td align="center">254</td><td align="center">月  日</td><td align="center"></td><td align="center">253</td><td align="center">252</td><td align="center">250</td><td align="center">247</td><td align="center">239</td><td align="center">224</td><td align="center">164</td><td align="center">75</td></tr><tr><td align="center">255</td><td align="center">月  日</td><td align="center"></td><td align="center">254</td><td align="center">253</td><td align="center">251</td><td align="center">248</td><td align="center">240</td><td align="center">225</td><td align="center">165</td><td align="center">76</td></tr><tr><td align="center">256</td><td align="center">月  日</td><td align="center"></td><td align="center">255</td><td align="center">254</td><td align="center">252</td><td align="center">249</td><td align="center">241</td><td align="center">226</td><td align="center">166</td><td align="center">77</td></tr><tr><td align="center">257</td><td align="center">月  日</td><td align="center"></td><td align="center">256</td><td align="center">255</td><td align="center">253</td><td align="center">250</td><td align="center">242</td><td align="center">227</td><td align="center">167</td><td align="center">78</td></tr><tr><td align="center">258</td><td align="center">月  日</td><td align="center"></td><td align="center">257</td><td align="center">256</td><td align="center">254</td><td align="center">251</td><td align="center">243</td><td align="center">228</td><td align="center">168</td><td align="center">79</td></tr><tr><td align="center">259</td><td align="center">月  日</td><td align="center"></td><td align="center">258</td><td align="center">257</td><td align="center">255</td><td align="center">252</td><td align="center">244</td><td align="center">229</td><td align="center">169</td><td align="center">80</td></tr><tr><td align="center">260</td><td align="center">月  日</td><td align="center"></td><td align="center">259</td><td align="center">258</td><td align="center">256</td><td align="center">253</td><td align="center">245</td><td align="center">230</td><td align="center">170</td><td align="center">81</td></tr><tr><td align="center">261</td><td align="center">月  日</td><td align="center"></td><td align="center">260</td><td align="center">259</td><td align="center">257</td><td align="center">254</td><td align="center">246</td><td align="center">231</td><td align="center">171</td><td align="center">82</td></tr><tr><td align="center">262</td><td align="center">月  日</td><td align="center"></td><td align="center">261</td><td align="center">260</td><td align="center">258</td><td align="center">255</td><td align="center">247</td><td align="center">232</td><td align="center">172</td><td align="center">83</td></tr><tr><td align="center">263</td><td align="center">月  日</td><td align="center"></td><td align="center">262</td><td align="center">261</td><td align="center">259</td><td align="center">256</td><td align="center">248</td><td align="center">233</td><td align="center">173</td><td align="center">84</td></tr><tr><td align="center">264</td><td align="center">月  日</td><td align="center"></td><td align="center">263</td><td align="center">262</td><td align="center">260</td><td align="center">257</td><td align="center">249</td><td align="center">234</td><td align="center">174</td><td align="center">85</td></tr><tr><td align="center">265</td><td align="center">月  日</td><td align="center"></td><td align="center">264</td><td align="center">263</td><td align="center">261</td><td align="center">258</td><td align="center">250</td><td align="center">235</td><td align="center">175</td><td align="center">86</td></tr><tr><td align="center">266</td><td align="center">月  日</td><td align="center"></td><td align="center">265</td><td align="center">264</td><td align="center">262</td><td align="center">259</td><td align="center">251</td><td align="center">236</td><td align="center">176</td><td align="center">87</td></tr><tr><td align="center">267</td><td align="center">月  日</td><td align="center"></td><td align="center">266</td><td align="center">265</td><td align="center">263</td><td align="center">260</td><td align="center">252</td><td align="center">237</td><td align="center">177</td><td align="center">88</td></tr><tr><td align="center">268</td><td align="center">月  日</td><td align="center"></td><td align="center">267</td><td align="center">266</td><td align="center">264</td><td align="center">261</td><td align="center">253</td><td align="center">238</td><td align="center">178</td><td align="center">89</td></tr><tr><td align="center">269</td><td align="center">月  日</td><td align="center"></td><td align="center">268</td><td align="center">267</td><td align="center">265</td><td align="center">262</td><td align="center">254</td><td align="center">239</td><td align="center">179</td><td align="center">90</td></tr><tr><td align="center">270</td><td align="center">月  日</td><td align="center"></td><td align="center">269</td><td align="center">268</td><td align="center">266</td><td align="center">263</td><td align="center">255</td><td align="center">240</td><td align="center">180</td><td align="center">91</td></tr><tr><td align="center">271</td><td align="center">月  日</td><td align="center"></td><td align="center">270</td><td align="center">269</td><td align="center">267</td><td align="center">264</td><td align="center">256</td><td align="center">241</td><td align="center">181</td><td align="center">92</td></tr><tr><td align="center">272</td><td align="center">月  日</td><td align="center"></td><td align="center">271</td><td align="center">270</td><td align="center">268</td><td align="center">265</td><td align="center">257</td><td align="center">242</td><td align="center">182</td><td align="center">93</td></tr><tr><td align="center">273</td><td align="center">月  日</td><td align="center"></td><td align="center">272</td><td align="center">271</td><td align="center">269</td><td align="center">266</td><td align="center">258</td><td align="center">243</td><td align="center">183</td><td align="center">94</td></tr><tr><td align="center">274</td><td align="center">月  日</td><td align="center"></td><td align="center">273</td><td align="center">272</td><td align="center">270</td><td align="center">267</td><td align="center">259</td><td align="center">244</td><td align="center">184</td><td align="center">95</td></tr><tr><td align="center">275</td><td align="center">月  日</td><td align="center"></td><td align="center">274</td><td align="center">273</td><td align="center">271</td><td align="center">268</td><td align="center">260</td><td align="center">245</td><td align="center">185</td><td align="center">96</td></tr><tr><td align="center">276</td><td align="center">月  日</td><td align="center"></td><td align="center">275</td><td align="center">274</td><td align="center">272</td><td align="center">269</td><td align="center">261</td><td align="center">246</td><td align="center">186</td><td align="center">97</td></tr><tr><td align="center">277</td><td align="center">月  日</td><td align="center"></td><td align="center">276</td><td align="center">275</td><td align="center">273</td><td align="center">270</td><td align="center">262</td><td align="center">247</td><td align="center">187</td><td align="center">98</td></tr><tr><td align="center">278</td><td align="center">月  日</td><td align="center"></td><td align="center">277</td><td align="center">276</td><td align="center">274</td><td align="center">271</td><td align="center">263</td><td align="center">248</td><td align="center">188</td><td align="center">99</td></tr><tr><td align="center">279</td><td align="center">月  日</td><td align="center"></td><td align="center">278</td><td align="center">277</td><td align="center">275</td><td align="center">272</td><td align="center">264</td><td align="center">249</td><td align="center">189</td><td align="center">100</td></tr><tr><td align="center">280</td><td align="center">月  日</td><td align="center"></td><td align="center">279</td><td align="center">278</td><td align="center">276</td><td align="center">273</td><td align="center">265</td><td align="center">250</td><td align="center">190</td><td align="center">101</td></tr><tr><td align="center">281</td><td align="center">月  日</td><td align="center"></td><td align="center">280</td><td align="center">279</td><td align="center">277</td><td align="center">274</td><td align="center">266</td><td align="center">251</td><td align="center">191</td><td align="center">102</td></tr><tr><td align="center">282</td><td align="center">月  日</td><td align="center"></td><td align="center">281</td><td align="center">280</td><td align="center">278</td><td align="center">275</td><td align="center">267</td><td align="center">252</td><td align="center">192</td><td align="center">103</td></tr><tr><td align="center">283</td><td align="center">月  日</td><td align="center"></td><td align="center">282</td><td align="center">281</td><td align="center">279</td><td align="center">276</td><td align="center">268</td><td align="center">253</td><td align="center">193</td><td align="center">104</td></tr><tr><td align="center">284</td><td align="center">月  日</td><td align="center"></td><td align="center">283</td><td align="center">282</td><td align="center">280</td><td align="center">277</td><td align="center">269</td><td align="center">254</td><td align="center">194</td><td align="center">105</td></tr><tr><td align="center">285</td><td align="center">月  日</td><td align="center"></td><td align="center">284</td><td align="center">283</td><td align="center">281</td><td align="center">278</td><td align="center">270</td><td align="center">255</td><td align="center">195</td><td align="center">106</td></tr><tr><td align="center">286</td><td align="center">月  日</td><td align="center"></td><td align="center">285</td><td align="center">284</td><td align="center">282</td><td align="center">279</td><td align="center">271</td><td align="center">256</td><td align="center">196</td><td align="center">107</td></tr><tr><td align="center">287</td><td align="center">月  日</td><td align="center"></td><td align="center">286</td><td align="center">285</td><td align="center">283</td><td align="center">280</td><td align="center">272</td><td align="center">257</td><td align="center">197</td><td align="center">108</td></tr><tr><td align="center">288</td><td align="center">月  日</td><td align="center"></td><td align="center">287</td><td align="center">286</td><td align="center">284</td><td align="center">281</td><td align="center">273</td><td align="center">258</td><td align="center">198</td><td align="center">109</td></tr><tr><td align="center">289</td><td align="center">月  日</td><td align="center"></td><td align="center">288</td><td align="center">287</td><td align="center">285</td><td align="center">282</td><td align="center">274</td><td align="center">259</td><td align="center">199</td><td align="center">110</td></tr><tr><td align="center">290</td><td align="center">月  日</td><td align="center"></td><td align="center">289</td><td align="center">288</td><td align="center">286</td><td align="center">283</td><td align="center">275</td><td align="center">260</td><td align="center">200</td><td align="center">111</td></tr><tr><td align="center">291</td><td align="center">月  日</td><td align="center"></td><td align="center">290</td><td align="center">289</td><td align="center">287</td><td align="center">284</td><td align="center">276</td><td align="center">261</td><td align="center">201</td><td align="center">112</td></tr><tr><td align="center">292</td><td align="center">月  日</td><td align="center"></td><td align="center">291</td><td align="center">290</td><td align="center">288</td><td align="center">285</td><td align="center">277</td><td align="center">262</td><td align="center">202</td><td align="center">113</td></tr><tr><td align="center">293</td><td align="center">月  日</td><td align="center"></td><td align="center">292</td><td align="center">291</td><td align="center">289</td><td align="center">286</td><td align="center">278</td><td align="center">263</td><td align="center">203</td><td align="center">114</td></tr><tr><td align="center">294</td><td align="center">月  日</td><td align="center"></td><td align="center">293</td><td align="center">292</td><td align="center">290</td><td align="center">287</td><td align="center">279</td><td align="center">264</td><td align="center">204</td><td align="center">115</td></tr><tr><td align="center">295</td><td align="center">月  日</td><td align="center"></td><td align="center">294</td><td align="center">293</td><td align="center">291</td><td align="center">288</td><td align="center">280</td><td align="center">265</td><td align="center">205</td><td align="center">116</td></tr><tr><td align="center">296</td><td align="center">月  日</td><td align="center"></td><td align="center">295</td><td align="center">294</td><td align="center">292</td><td align="center">289</td><td align="center">281</td><td align="center">266</td><td align="center">206</td><td align="center">117</td></tr><tr><td align="center">297</td><td align="center">月  日</td><td align="center"></td><td align="center">296</td><td align="center">295</td><td align="center">293</td><td align="center">290</td><td align="center">282</td><td align="center">267</td><td align="center">207</td><td align="center">118</td></tr><tr><td align="center">298</td><td align="center">月  日</td><td align="center"></td><td align="center">297</td><td align="center">296</td><td align="center">294</td><td align="center">291</td><td align="center">283</td><td align="center">268</td><td align="center">208</td><td align="center">119</td></tr><tr><td align="center">299</td><td align="center">月  日</td><td align="center"></td><td align="center">298</td><td align="center">297</td><td align="center">295</td><td align="center">292</td><td align="center">284</td><td align="center">269</td><td align="center">209</td><td align="center">120</td></tr><tr><td align="center">300</td><td align="center">月  日</td><td align="center"></td><td align="center">299</td><td align="center">298</td><td align="center">296</td><td align="center">293</td><td align="center">285</td><td align="center">270</td><td align="center">210</td><td align="center">121</td></tr><tr><td align="center">301</td><td align="center">月  日</td><td align="center"></td><td align="center">300</td><td align="center">299</td><td align="center">297</td><td align="center">294</td><td align="center">286</td><td align="center">271</td><td align="center">211</td><td align="center">122</td></tr><tr><td align="center">302</td><td align="center">月  日</td><td align="center"></td><td align="center">301</td><td align="center">300</td><td align="center">298</td><td align="center">295</td><td align="center">287</td><td align="center">272</td><td align="center">212</td><td align="center">123</td></tr><tr><td align="center">303</td><td align="center">月  日</td><td align="center"></td><td align="center">302</td><td align="center">301</td><td align="center">299</td><td align="center">296</td><td align="center">288</td><td align="center">273</td><td align="center">213</td><td align="center">124</td></tr><tr><td align="center">304</td><td align="center">月  日</td><td align="center"></td><td align="center">303</td><td align="center">302</td><td align="center">300</td><td align="center">297</td><td align="center">289</td><td align="center">274</td><td align="center">214</td><td align="center">125</td></tr><tr><td align="center">305</td><td align="center">月  日</td><td align="center"></td><td align="center">304</td><td align="center">303</td><td align="center">301</td><td align="center">298</td><td align="center">290</td><td align="center">275</td><td align="center">215</td><td align="center">126</td></tr><tr><td align="center">306</td><td align="center">月  日</td><td align="center"></td><td align="center">305</td><td align="center">304</td><td align="center">302</td><td align="center">299</td><td align="center">291</td><td align="center">276</td><td align="center">216</td><td align="center">127</td></tr><tr><td align="center">307</td><td align="center">月  日</td><td align="center"></td><td align="center">306</td><td align="center">305</td><td align="center">303</td><td align="center">300</td><td align="center">292</td><td align="center">277</td><td align="center">217</td><td align="center">128</td></tr><tr><td align="center">308</td><td align="center">月  日</td><td align="center"></td><td align="center">307</td><td align="center">306</td><td align="center">304</td><td align="center">301</td><td align="center">293</td><td align="center">278</td><td align="center">218</td><td align="center">129</td></tr><tr><td align="center">309</td><td align="center">月  日</td><td align="center"></td><td align="center">308</td><td align="center">307</td><td align="center">305</td><td align="center">302</td><td align="center">294</td><td align="center">279</td><td align="center">219</td><td align="center">130</td></tr><tr><td align="center">310</td><td align="center">月  日</td><td align="center"></td><td align="center">309</td><td align="center">308</td><td align="center">306</td><td align="center">303</td><td align="center">295</td><td align="center">280</td><td align="center">220</td><td align="center">131</td></tr><tr><td align="center">311</td><td align="center">月  日</td><td align="center"></td><td align="center">310</td><td align="center">309</td><td align="center">307</td><td align="center">304</td><td align="center">296</td><td align="center">281</td><td align="center">221</td><td align="center">132</td></tr><tr><td align="center">312</td><td align="center">月  日</td><td align="center"></td><td align="center">311</td><td align="center">310</td><td align="center">308</td><td align="center">305</td><td align="center">297</td><td align="center">282</td><td align="center">222</td><td align="center">133</td></tr><tr><td align="center">313</td><td align="center">月  日</td><td align="center"></td><td align="center">312</td><td align="center">311</td><td align="center">309</td><td align="center">306</td><td align="center">298</td><td align="center">283</td><td align="center">223</td><td align="center">134</td></tr><tr><td align="center">314</td><td align="center">月  日</td><td align="center"></td><td align="center">313</td><td align="center">312</td><td align="center">310</td><td align="center">307</td><td align="center">299</td><td align="center">284</td><td align="center">224</td><td align="center">135</td></tr><tr><td align="center">315</td><td align="center">月  日</td><td align="center"></td><td align="center">314</td><td align="center">313</td><td align="center">311</td><td align="center">308</td><td align="center">300</td><td align="center">285</td><td align="center">225</td><td align="center">136</td></tr><tr><td align="center">316</td><td align="center">月  日</td><td align="center"></td><td align="center">315</td><td align="center">314</td><td align="center">312</td><td align="center">309</td><td align="center">301</td><td align="center">286</td><td align="center">226</td><td align="center">137</td></tr><tr><td align="center">317</td><td align="center">月  日</td><td align="center"></td><td align="center">316</td><td align="center">315</td><td align="center">313</td><td align="center">310</td><td align="center">302</td><td align="center">287</td><td align="center">227</td><td align="center">138</td></tr><tr><td align="center">318</td><td align="center">月  日</td><td align="center"></td><td align="center">317</td><td align="center">316</td><td align="center">314</td><td align="center">311</td><td align="center">303</td><td align="center">288</td><td align="center">228</td><td align="center">139</td></tr><tr><td align="center">319</td><td align="center">月  日</td><td align="center"></td><td align="center">318</td><td align="center">317</td><td align="center">315</td><td align="center">312</td><td align="center">304</td><td align="center">289</td><td align="center">229</td><td align="center">140</td></tr><tr><td align="center">320</td><td align="center">月  日</td><td align="center"></td><td align="center">319</td><td align="center">318</td><td align="center">316</td><td align="center">313</td><td align="center">305</td><td align="center">290</td><td align="center">230</td><td align="center">141</td></tr><tr><td align="center">321</td><td align="center">月  日</td><td align="center"></td><td align="center">320</td><td align="center">319</td><td align="center">317</td><td align="center">314</td><td align="center">306</td><td align="center">291</td><td align="center">231</td><td align="center">142</td></tr><tr><td align="center">322</td><td align="center">月  日</td><td align="center"></td><td align="center">321</td><td align="center">320</td><td align="center">318</td><td align="center">315</td><td align="center">307</td><td align="center">292</td><td align="center">232</td><td align="center">143</td></tr><tr><td align="center">323</td><td align="center">月  日</td><td align="center"></td><td align="center">322</td><td align="center">321</td><td align="center">319</td><td align="center">316</td><td align="center">308</td><td align="center">293</td><td align="center">233</td><td align="center">144</td></tr><tr><td align="center">324</td><td align="center">月  日</td><td align="center"></td><td align="center">323</td><td align="center">322</td><td align="center">320</td><td align="center">317</td><td align="center">309</td><td align="center">294</td><td align="center">234</td><td align="center">145</td></tr><tr><td align="center">325</td><td align="center">月  日</td><td align="center"></td><td align="center">324</td><td align="center">323</td><td align="center">321</td><td align="center">318</td><td align="center">310</td><td align="center">295</td><td align="center">235</td><td align="center">146</td></tr><tr><td align="center">326</td><td align="center">月  日</td><td align="center"></td><td align="center">325</td><td align="center">324</td><td align="center">322</td><td align="center">319</td><td align="center">311</td><td align="center">296</td><td align="center">236</td><td align="center">147</td></tr><tr><td align="center">327</td><td align="center">月  日</td><td align="center"></td><td align="center">326</td><td align="center">325</td><td align="center">323</td><td align="center">320</td><td align="center">312</td><td align="center">297</td><td align="center">237</td><td align="center">148</td></tr><tr><td align="center">328</td><td align="center">月  日</td><td align="center"></td><td align="center">327</td><td align="center">326</td><td align="center">324</td><td align="center">321</td><td align="center">313</td><td align="center">298</td><td align="center">238</td><td align="center">149</td></tr><tr><td align="center">329</td><td align="center">月  日</td><td align="center"></td><td align="center">328</td><td align="center">327</td><td align="center">325</td><td align="center">322</td><td align="center">314</td><td align="center">299</td><td align="center">239</td><td align="center">150</td></tr><tr><td align="center">330</td><td align="center">月  日</td><td align="center"></td><td align="center">329</td><td align="center">328</td><td align="center">326</td><td align="center">323</td><td align="center">315</td><td align="center">300</td><td align="center">240</td><td align="center">151</td></tr><tr><td align="center">331</td><td align="center">月  日</td><td align="center"></td><td align="center">330</td><td align="center">329</td><td align="center">327</td><td align="center">324</td><td align="center">316</td><td align="center">301</td><td align="center">241</td><td align="center">152</td></tr><tr><td align="center">332</td><td align="center">月  日</td><td align="center"></td><td align="center">331</td><td align="center">330</td><td align="center">328</td><td align="center">325</td><td align="center">317</td><td align="center">302</td><td align="center">242</td><td align="center">153</td></tr><tr><td align="center">333</td><td align="center">月  日</td><td align="center"></td><td align="center">332</td><td align="center">331</td><td align="center">329</td><td align="center">326</td><td align="center">318</td><td align="center">303</td><td align="center">243</td><td align="center">154</td></tr><tr><td align="center">334</td><td align="center">月  日</td><td align="center"></td><td align="center">333</td><td align="center">332</td><td align="center">330</td><td align="center">327</td><td align="center">319</td><td align="center">304</td><td align="center">244</td><td align="center">155</td></tr><tr><td align="center">335</td><td align="center">月  日</td><td align="center"></td><td align="center">334</td><td align="center">333</td><td align="center">331</td><td align="center">328</td><td align="center">320</td><td align="center">305</td><td align="center">245</td><td align="center">156</td></tr><tr><td align="center">336</td><td align="center">月  日</td><td align="center"></td><td align="center">335</td><td align="center">334</td><td align="center">332</td><td align="center">329</td><td align="center">321</td><td align="center">306</td><td align="center">246</td><td align="center">157</td></tr><tr><td align="center">337</td><td align="center">月  日</td><td align="center"></td><td align="center">336</td><td align="center">335</td><td align="center">333</td><td align="center">330</td><td align="center">322</td><td align="center">307</td><td align="center">247</td><td align="center">158</td></tr><tr><td align="center">338</td><td align="center">月  日</td><td align="center"></td><td align="center">337</td><td align="center">336</td><td align="center">334</td><td align="center">331</td><td align="center">323</td><td align="center">308</td><td align="center">248</td><td align="center">159</td></tr><tr><td align="center">339</td><td align="center">月  日</td><td align="center"></td><td align="center">338</td><td align="center">337</td><td align="center">335</td><td align="center">332</td><td align="center">324</td><td align="center">309</td><td align="center">249</td><td align="center">160</td></tr><tr><td align="center">340</td><td align="center">月  日</td><td align="center"></td><td align="center">339</td><td align="center">338</td><td align="center">336</td><td align="center">333</td><td align="center">325</td><td align="center">310</td><td align="center">250</td><td align="center">161</td></tr><tr><td align="center">341</td><td align="center">月  日</td><td align="center"></td><td align="center">340</td><td align="center">339</td><td align="center">337</td><td align="center">334</td><td align="center">326</td><td align="center">311</td><td align="center">251</td><td align="center">162</td></tr><tr><td align="center">342</td><td align="center">月  日</td><td align="center"></td><td align="center">341</td><td align="center">340</td><td align="center">338</td><td align="center">335</td><td align="center">327</td><td align="center">312</td><td align="center">252</td><td align="center">163</td></tr><tr><td align="center">343</td><td align="center">月  日</td><td align="center"></td><td align="center">342</td><td align="center">341</td><td align="center">339</td><td align="center">336</td><td align="center">328</td><td align="center">313</td><td align="center">253</td><td align="center">164</td></tr><tr><td align="center">344</td><td align="center">月  日</td><td align="center"></td><td align="center">343</td><td align="center">342</td><td align="center">340</td><td align="center">337</td><td align="center">329</td><td align="center">314</td><td align="center">254</td><td align="center">165</td></tr><tr><td align="center">345</td><td align="center">月  日</td><td align="center"></td><td align="center">344</td><td align="center">343</td><td align="center">341</td><td align="center">338</td><td align="center">330</td><td align="center">315</td><td align="center">255</td><td align="center">166</td></tr><tr><td align="center">346</td><td align="center">月  日</td><td align="center"></td><td align="center">345</td><td align="center">344</td><td align="center">342</td><td align="center">339</td><td align="center">331</td><td align="center">316</td><td align="center">256</td><td align="center">167</td></tr><tr><td align="center">347</td><td align="center">月  日</td><td align="center"></td><td align="center">346</td><td align="center">345</td><td align="center">343</td><td align="center">340</td><td align="center">332</td><td align="center">317</td><td align="center">257</td><td align="center">168</td></tr><tr><td align="center">348</td><td align="center">月  日</td><td align="center"></td><td align="center">347</td><td align="center">346</td><td align="center">344</td><td align="center">341</td><td align="center">333</td><td align="center">318</td><td align="center">258</td><td align="center">169</td></tr><tr><td align="center">349</td><td align="center">月  日</td><td align="center"></td><td align="center">348</td><td align="center">347</td><td align="center">345</td><td align="center">342</td><td align="center">334</td><td align="center">319</td><td align="center">259</td><td align="center">170</td></tr><tr><td align="center">350</td><td align="center">月  日</td><td align="center"></td><td align="center">349</td><td align="center">348</td><td align="center">346</td><td align="center">343</td><td align="center">335</td><td align="center">320</td><td align="center">260</td><td align="center">171</td></tr><tr><td align="center">351</td><td align="center">月  日</td><td align="center"></td><td align="center">350</td><td align="center">349</td><td align="center">347</td><td align="center">344</td><td align="center">336</td><td align="center">321</td><td align="center">261</td><td align="center">172</td></tr><tr><td align="center">352</td><td align="center">月  日</td><td align="center"></td><td align="center">351</td><td align="center">350</td><td align="center">348</td><td align="center">345</td><td align="center">337</td><td align="center">322</td><td align="center">262</td><td align="center">173</td></tr><tr><td align="center">353</td><td align="center">月  日</td><td align="center"></td><td align="center">352</td><td align="center">351</td><td align="center">349</td><td align="center">346</td><td align="center">338</td><td align="center">323</td><td align="center">263</td><td align="center">174</td></tr><tr><td align="center">354</td><td align="center">月  日</td><td align="center"></td><td align="center">353</td><td align="center">352</td><td align="center">350</td><td align="center">347</td><td align="center">339</td><td align="center">324</td><td align="center">264</td><td align="center">175</td></tr><tr><td align="center">355</td><td align="center">月  日</td><td align="center"></td><td align="center">354</td><td align="center">353</td><td align="center">351</td><td align="center">348</td><td align="center">340</td><td align="center">325</td><td align="center">265</td><td align="center">176</td></tr><tr><td align="center">356</td><td align="center">月  日</td><td align="center"></td><td align="center">355</td><td align="center">354</td><td align="center">352</td><td align="center">349</td><td align="center">341</td><td align="center">326</td><td align="center">266</td><td align="center">177</td></tr><tr><td align="center">357</td><td align="center">月  日</td><td align="center"></td><td align="center">356</td><td align="center">355</td><td align="center">353</td><td align="center">350</td><td align="center">342</td><td align="center">327</td><td align="center">267</td><td align="center">178</td></tr><tr><td align="center">358</td><td align="center">月  日</td><td align="center"></td><td align="center">357</td><td align="center">356</td><td align="center">354</td><td align="center">351</td><td align="center">343</td><td align="center">328</td><td align="center">268</td><td align="center">179</td></tr><tr><td align="center">359</td><td align="center">月  日</td><td align="center"></td><td align="center">358</td><td align="center">357</td><td align="center">355</td><td align="center">352</td><td align="center">344</td><td align="center">329</td><td align="center">269</td><td align="center">180</td></tr><tr><td align="center">360</td><td align="center">月  日</td><td align="center"></td><td align="center">359</td><td align="center">358</td><td align="center">356</td><td align="center">353</td><td align="center">345</td><td align="center">330</td><td align="center">270</td><td align="center">181</td></tr><tr><td align="center">361</td><td align="center">月  日</td><td align="center"></td><td align="center">360</td><td align="center">359</td><td align="center">357</td><td align="center">354</td><td align="center">346</td><td align="center">331</td><td align="center">271</td><td align="center">182</td></tr><tr><td align="center">362</td><td align="center">月  日</td><td align="center"></td><td align="center">361</td><td align="center">360</td><td align="center">358</td><td align="center">355</td><td align="center">347</td><td align="center">332</td><td align="center">272</td><td align="center">183</td></tr><tr><td align="center">363</td><td align="center">月  日</td><td align="center"></td><td align="center">362</td><td align="center">361</td><td align="center">359</td><td align="center">356</td><td align="center">348</td><td align="center">333</td><td align="center">273</td><td align="center">184</td></tr><tr><td align="center">364</td><td align="center">月  日</td><td align="center"></td><td align="center">363</td><td align="center">362</td><td align="center">360</td><td align="center">357</td><td align="center">349</td><td align="center">334</td><td align="center">274</td><td align="center">185</td></tr><tr><td align="center">365</td><td align="center">月  日</td><td align="center"></td><td align="center">364</td><td align="center">363</td><td align="center">361</td><td align="center">358</td><td align="center">350</td><td align="center">335</td><td align="center">275</td><td align="center">186</td></tr></tbody></table>]]></content>
    
    
    <categories>
      
      <category>生活</category>
      
      <category>经验</category>
      
    </categories>
    
    
    <tags>
      
      <tag>复习</tag>
      
      <tag>计划表</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Google搜索技巧</title>
    <link href="/blog/2024/03/Google%E6%90%9C%E7%B4%A2%E6%8A%80%E5%B7%A7.html"/>
    <url>/blog/2024/03/Google%E6%90%9C%E7%B4%A2%E6%8A%80%E5%B7%A7.html</url>
    
    <content type="html"><![CDATA[<h2 id="四阶段的智能化人机交互"><a href="#四阶段的智能化人机交互" class="headerlink" title="四阶段的智能化人机交互"></a>四阶段的智能化人机交互</h2><p><strong>第一个阶段</strong>，使用倒排索引解决匹配的效率问题，使用文档模型解决基本的相关性，使搜索引擎变得可用、可扩展，代表比如 Infoseek 。这一阶段只保证了基本的文字相关性，搜索的真正效果是无法保证的。</p><p><strong>第二个阶段</strong>，使用超链模型，比如 Google 的 PageRank 算法和百度的超链分析技术。解决信息的权威性问题，使搜索质量有了质的飞跃。从这一阶段开始，搜索引擎快速普及与并进入商业化，为 Google 和百度这样的公司带来了丰厚的利润。</p><p><strong>第三个阶段</strong>，一方面使用更复杂的规则和机器学习排序模型，综合考虑了用户的行为特征，如商品评论、点赞、收藏、购买等，使得搜索引擎的结果再次提升一个档次，这些在电商等垂直搜索上表现的会更加明显；另一方面，基于各种先进的自然语言处理技术，充分挖掘用户搜索行为日志，对 query 进行分析改写以召回更多更好的结果。</p><p><strong>第四个阶段</strong>，从「有框」搜索时代步入更加人工智能的「无框」搜索时代。人机交互方式也将更多的是问答式的自然语言加语音的方式，而搜索引擎也更像一个智能机器人，理解人的自然语言问题，提供更加直接有效的知识和答案。这一阶段目前尚处于起步阶段，Google、Amazon 以及一些优秀的创业公司都在进行积极的探索。</p><h2 id="谷歌搜索技巧"><a href="#谷歌搜索技巧" class="headerlink" title="谷歌搜索技巧"></a>谷歌搜索技巧</h2><table><thead><tr><th>搜索指令</th><th>功能</th><th>示例</th></tr></thead><tbody><tr><td>@</td><td>搜索社交媒体</td><td>@twitter</td></tr><tr><td>$</td><td>搜索特定价格</td><td>camera $400</td></tr><tr><td>#</td><td>搜索 # 标签</td><td>#throwbackthursday</td></tr><tr><td>-</td><td>从搜索结果中排除特定字词</td><td>马云语录 - 女人</td></tr><tr><td>“”</td><td>搜索完全匹配的结果</td><td>“tallest building”</td></tr><tr><td>..</td><td>在某个数字范围内执行搜索</td><td>camera $50..$100</td></tr><tr><td>OR（大写）</td><td>组合搜索</td><td>marathon OR race</td></tr><tr><td>site:</td><td>搜索特定网站</td><td>site:chongbuluo.com</td></tr><tr><td>related:</td><td>搜索相关网站</td><td>related:time.com</td></tr><tr><td>info:</td><td>获取网站详情</td><td>info:giffox.com</td></tr><tr><td>cache:</td><td>查看网站的 Google 缓存版本</td><td>cache:google.com</td></tr><tr><td>\</td><td>效用等同于 OR</td><td>apple\google, apple OR google</td></tr><tr><td>*</td><td>泛搜索，表征未知部分，只适用于英文</td><td>* is the mother of success</td></tr><tr><td>《》</td><td>只查询图书、影视作品，只适用于中文</td><td>《钢铁是怎样炼成的》</td></tr><tr><td>def:</td><td>查询关键词的定义</td><td>def:diversity &#x2F; google def:</td></tr><tr><td>inurl</td><td>查找在 URL 地址里有搜索关键词的页面</td><td>inurl:download</td></tr><tr><td>intitle</td><td>查找在网页标题里有搜索关键词的页面</td><td>intitle:</td></tr><tr><td>filetype</td><td>查找特定文件格式的结果</td><td>机器学习 filetype:csv</td></tr><tr><td>link:</td><td>查看网站的反向链接</td><td>link:chongbuluo.com</td></tr><tr><td>AROUND</td><td>搜索包含给点单词之间最大分隔数的网页</td><td>华为 AROUND (5) 必然</td></tr></tbody></table><p>（完）</p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><a href="https://events.google.com/io/recap/">Recap - Google I&#x2F;O 2019</a></li><li><a href="https://youtu.be/BNHR6IQJGZs">How Search Works</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>网络</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Google</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>GitHub搜索技巧</title>
    <link href="/blog/2024/03/GitHub%E6%90%9C%E7%B4%A2%E6%8A%80%E5%B7%A7.html"/>
    <url>/blog/2024/03/GitHub%E6%90%9C%E7%B4%A2%E6%8A%80%E5%B7%A7.html</url>
    
    <content type="html"><![CDATA[<h2 id="GitHub-搜索技巧"><a href="#GitHub-搜索技巧" class="headerlink" title="GitHub 搜索技巧"></a>GitHub 搜索技巧</h2><p>这里可以了解一些搜索语法，会对你的精准查询有所帮助。</p><h3 id="查询大于或小于另一个值的值"><a href="#查询大于或小于另一个值的值" class="headerlink" title="查询大于或小于另一个值的值"></a>查询大于或小于另一个值的值</h3><p>您可以使用 <code>&gt;</code>，<code>&gt;=</code>，<code>&lt;</code>，和 <code>&lt;=</code> 搜索是大于，大于或等于，小于和小于或等于另一个值的值。</p><table><thead><tr><th>匹配条件</th><th>举例</th></tr></thead><tbody><tr><td><code>&gt;</code> <em>n</em></td><td>cats<a href="https://github.com/search?utf8=%E2%9C%93&q=cats+stars:%3E1000&type=Repositories"> <strong>stars:&gt; 1000</strong></a> 匹配超过 1000 star 的包含 “cats” 关键字的仓库。</td></tr><tr><td><code>&gt;=</code> <em>n</em></td><td><a href="https://github.com/search?utf8=%E2%9C%93&q=cats+topics:%3E=5&type=Repositories"><strong>cats topics:&gt; &#x3D; 5</strong></a> 匹配具有 5 个或更多主题的单词 “cats” 的存储库。</td></tr><tr><td><code>&lt;</code> <em>n</em></td><td>****<a href="https://github.com/search?utf8=%E2%9C%93&q=cats+size:%3C10000&type=Code"><strong>cats size:&lt;10000</strong></a> 匹配小于 10 KB 的文件中带有 “cats” 字样的代码。</td></tr><tr><td><code>&lt;=</code> <em>n</em></td><td><a href="https://github.com/search?utf8=%E2%9C%93&q=cats+stars:%3C=50&type=Repositories"><strong>cats stars:&lt;&#x3D; 50</strong></a> 匹配具有 50 个或更少 star 的包含 “cats” 关键字的仓库。</td></tr></tbody></table><p>您还可以使用<a href="https://help.github.com/en/articles/understanding-the-search-syntax#query-for-values-between-a-range">范围查询</a>来搜索大于或等于，或小于或等于另一个值的值。</p><table><thead><tr><th>搜索语法</th><th>举例</th></tr></thead><tbody><tr><td><em>n</em> <code>..*</code></td><td>****<a href="https://github.com/search?utf8=%E2%9C%93&q=cats+stars:10..*&type=Repositories"><strong>cats stars:10 .. *</strong></a> 相当于 <code>stars:&gt;=10</code> 并匹配具有 10 个或更多星的 “猫” 一词的存储库。</td></tr><tr><td><code>*..</code> <em>n</em></td><td><a href="https://github.com/search?utf8=%E2%9C%93&q=cats+stars:%22*..10%22&type=Repositories">cats <strong>stars:* .. 10</strong></a> 相当于 <code>stars:&lt;=10</code> 和匹配具有 10 个或更少恒星的单词 “cats” 的存储库。</td></tr></tbody></table><h3 id="查询范围之间的值"><a href="#查询范围之间的值" class="headerlink" title="查询范围之间的值"></a><a href="https://help.github.com/en/articles/understanding-the-search-syntax#query-for-values-between-a-range">查询范围之间的值</a></h3><p>您可以使用范围语法搜索范围内的值，其中第一个数字 <em>n</em> 是最低值，第二个数字是最高值。<em>n</em><code>..</code><em>n</em></p><table><thead><tr><th>询问</th><th>举例</th></tr></thead><tbody><tr><td><em>n</em> <code>..</code> <em>n</em></td><td>****<a href="https://github.com/search?utf8=%E2%9C%93&q=cats+stars:10..50&type=Repositories"><strong>cats stars:10..50</strong></a> 匹配存储库，单词 “cats”，有 10 到 50 颗星。</td></tr></tbody></table><h3 id="查询日期"><a href="#查询日期" class="headerlink" title="查询日期"></a><a href="https://help.github.com/en/articles/understanding-the-search-syntax#query-for-dates">查询日期</a></h3><p>您可以搜索日期，除另一个日期，或者那年秋天日期范围内较早或较晚的是，通过使用 <code>&gt;</code>，<code>&gt;=</code>，<code>&lt;</code>，<code>&lt;=</code>，和<a href="https://help.github.com/en/articles/understanding-the-search-syntax#query-for-values-between-a-range">范围查询</a>。日期格式必须遵循 ISO8601 标准，即 <code>YYYY-MM-DD</code>（年 - 月 - 日）。</p><table><thead><tr><th>询问</th><th>举例</th></tr></thead><tbody><tr><td><code>&gt;</code> <em>YYYY-MM-DD</em></td><td><a href="https://github.com/search?utf8=%E2%9C%93&q=cats+created:%3E2016-04-29&type=Issues">cats <strong>created:&gt; 2016-04-29</strong></a> 匹配 2016 年 4 月 29 日之后创建的 “cats” 一词的问题。</td></tr><tr><td><code>&gt;=</code> <em>YYYY-MM-DD</em></td><td>****<a href="https://github.com/search?utf8=%E2%9C%93&q=cats+created:%3E=2017-04-01&type=Issues"><strong>cats created:&gt; &#x3D; 2017-04-01</strong></a> 匹配 2017 年 4 月 1 日或之后创建的 “cats” 一词的问题。</td></tr><tr><td><code>&lt;</code> <em>YYYY-MM-DD</em></td><td><a href="https://github.com/search?q=cats+pushed:%3C2012-07-05&type=Code&utf8=%E2%9C%93"><strong>cats pushed:&lt;2012-07-05</strong></a> 匹配代码与 2012 年 7 月 5 日之前推送到的存储库中的 “cats” 一词。</td></tr><tr><td><code>&lt;=</code> <em>YYYY-MM-DD</em></td><td><a href="https://github.com/search?utf8=%E2%9C%93&q=cats+created:%3E=2017-04-01&type=Issues">cats <strong>created</strong></a><a href="https://github.com/search?utf8=%E2%9C%93&q=cats+created:%3C=2012-07-04&type=Issues">:<strong>&lt;&#x3D; 2012-07-04</strong></a> 与 2012 年 7 月 4 日或之前创建的 “cats” 一词相匹配。</td></tr><tr><td><em>YYYY-MM-DD .. YYYY-MM-DD</em></td><td><a href="https://github.com/search?q=cats+pushed:%3C2012-07-05&type=Code&utf8=%E2%9C%93"><strong>cats pushed</strong></a><a href="https://github.com/search?utf8=%E2%9C%93&q=cats+pushed:2016-04-30..2016-07-04&type=Repositories">:<strong>2016-04-30..2016-07-04</strong></a> 匹配 2016 年 4 月底到 7 月期间被推到 “cats” 字样的知识库。</td></tr><tr><td><em>YYYYYYYY-MM-DD</em><code>..*</code></td><td><a href="https://github.com/search?utf8=%E2%9C%93&q=cats+created:2012-04-30..*&type=Issues"><strong>cats created</strong></a><a href="https://github.com/search?utf8=%E2%9C%93&q=cats+created:2012-04-30..*&type=Issues">:<strong>2012-04-30 .. *</strong></a> 匹配 2012 年 4 月 30 日之后创建的包含 “cats” 字样的问题。</td></tr><tr><td><code>*..</code><em>YYYYYYYY-MM-DD</em></td><td><a href="https://github.com/search?utf8=%E2%9C%93&q=cats+created:2012-04-30..*&type=Issues"><strong>cats created</strong></a><a href="https://github.com/search?utf8=%E2%9C%93&q=cats+created:*..2012-07-04&type=Issues">:*** .. 2012-04-30**</a> 匹配 2012 年 7 月 4 日之前创建的包含 “cats” 字样的问题。</td></tr></tbody></table><p>您还可以 <code>THH:MM:SS+00:00</code> 在日期之后添加可选时间信息，以按小时，分钟和秒搜索。那是 <code>T</code>，然后是 <code>HH:MM:SS</code>（小时 - 分 - 秒）和 UTC 偏移（<code>+00:00</code>）。</p><table><thead><tr><th>询问</th><th>例</th></tr></thead><tbody><tr><td><code>YYYY - MM - DD T HH : MM : SS + 00 : 00</code></td><td><a href="https://github.com/search?utf8=%E2%9C%93&q=cats+created:%3E=2017-04-01&type=Issues">cats <strong>created</strong></a><a href="https://github.com/search?utf8=%E2%9C%93&q=cats+created:2017-01-01T01:00:00+07:00..2017-03-01T15:30:15+07:00&type=Issues">:<strong>2017-01-01T01：00：00 + 07：00..2017-03-01T15：30：15 + 07:00</strong></a> **** 匹配 2017 年 1 月 1 日凌晨 1 点之间创建的问题，UTC 偏移量为 <code>07:00</code>3 月 1 日，2017 年下午 3 点，UTC 偏移量为 <code>07:00</code>。</td></tr><tr><td><code>YYYY - MM - DD T HH : MM : SS Z</code></td><td><a href="https://github.com/search?utf8=%E2%9C%93&q=cats+created:%3E=2017-04-01&type=Issues">cats <strong>created</strong></a><a href="https://github.com/search?utf8=%E2%9C%93&q=cats+created:2016-03-21T14:11:00Z..2016-04-07T20:45:00Z&type=Issues">:<strong>2016-03-21T14：11：00Z..2016-04-07T20：45：00Z</strong></a> 匹配 2016 年 3 月 21 日下午 2:11 和 2106 年 4 月 7 日晚上 8:45 之间创建的问题。</td></tr></tbody></table><h3 id="排除某些结果"><a href="#排除某些结果" class="headerlink" title="排除某些结果"></a><a href="https://help.github.com/en/articles/understanding-the-search-syntax#exclude-certain-results">排除某些结果</a></h3><p>您可以使用 <code>NOT</code> 语法排除包含特定单词的结果。该 <code>NOT</code> 操作只能用于字符串的关键词。它不适用于数字或日期。</p><table><thead><tr><th>询问</th><th>例子</th></tr></thead><tbody><tr><td><code>NOT</code></td><td><a href="https://github.com/search?q=hello+NOT+world&type=Repositories">hello NOT world</a> 匹配有 “hello” 这个词而没有 “world” 这个词的仓库。</td></tr></tbody></table><h3 id="对带有空格的查询使用引号"><a href="#对带有空格的查询使用引号" class="headerlink" title="对带有空格的查询使用引号"></a>对带有空格的查询使用引号</h3><p>如果您的搜索查询包含空格，则需要用引号括起来。例如：</p><ul><li><a href="https://github.com/search?utf8=%E2%9C%93&q=cats+NOT+%22hello+world%22&type=Repositories">cats NOT “hello world”</a> 匹配存储库的单词 “cats” 而不是 “hello world”。</li><li><a href="https://github.com/search?utf8=%E2%9C%93&q=build+label:%22bug+fix%22&type=Issues">构建标签：“bug fix”</a> 与 “build” 一词的问题相匹配，其标签为 “bug fix”。</li></ul><p>（完）</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>网络</category>
      
    </categories>
    
    
    <tags>
      
      <tag>GitHub</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>运动类影视剧集清单</title>
    <link href="/blog/2024/03/%E8%BF%90%E5%8A%A8%E7%B1%BB%E5%BD%B1%E8%A7%86%E5%89%A7%E9%9B%86%E6%B8%85%E5%8D%95.html"/>
    <url>/blog/2024/03/%E8%BF%90%E5%8A%A8%E7%B1%BB%E5%BD%B1%E8%A7%86%E5%89%A7%E9%9B%86%E6%B8%85%E5%8D%95.html</url>
    
    <content type="html"><![CDATA[<h2 id="动漫"><a href="#动漫" class="headerlink" title="动漫"></a>动漫</h2><ul><li>强风吹拂</li><li>灌篮高手</li><li>网球王子</li><li>足球小将</li><li>黑子的篮球</li><li>排球少年</li><li>乒乓</li><li>青之芦苇</li><li>轻羽飞扬</li><li>流汗吧，健身少女</li></ul><p>（完）</p>]]></content>
    
    
    <categories>
      
      <category>生活</category>
      
      <category>娱乐</category>
      
    </categories>
    
    
    <tags>
      
      <tag>清单</tag>
      
      <tag>运动</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>常用软件清单</title>
    <link href="/blog/2024/03/%E5%B8%B8%E7%94%A8%E8%BD%AF%E4%BB%B6%E6%B8%85%E5%8D%95.html"/>
    <url>/blog/2024/03/%E5%B8%B8%E7%94%A8%E8%BD%AF%E4%BB%B6%E6%B8%85%E5%8D%95.html</url>
    
    <content type="html"><![CDATA[<table><thead><tr><th align="center">名称</th><th align="center">用途</th><th>支持平台(Win、Linux)</th></tr></thead><tbody><tr><td align="center">bestTrace</td><td align="center">网络排查</td><td>Win</td></tr><tr><td align="center">ZoomIt</td><td align="center">windows工具集</td><td>Win</td></tr><tr><td align="center">powertoyes</td><td align="center">windows增强工具包</td><td>Win</td></tr><tr><td align="center">vagrant</td><td align="center">虚拟机管理</td><td>Win、Linux</td></tr><tr><td align="center">virtualbox</td><td align="center">虚拟机工具</td><td>Win、Linux</td></tr><tr><td align="center">filezilla pro</td><td align="center">sftp工具</td><td>Win、Linux</td></tr><tr><td align="center">tailscale</td><td align="center">组网工具</td><td>Win、Linux</td></tr><tr><td align="center">remnote</td><td align="center">双链笔记</td><td>Win、Linux</td></tr><tr><td align="center">gimp</td><td align="center">图像处理工具</td><td>Win、Linux</td></tr><tr><td align="center">gitui</td><td align="center">git终端工具</td><td>Win、Linux</td></tr><tr><td align="center">cryptomator</td><td align="center">文件加密同步网盘工具</td><td>Win、Linux</td></tr><tr><td align="center">7zip</td><td align="center">解压缩工具</td><td>Win、Linux</td></tr><tr><td align="center">potplayer</td><td align="center">音视频播放器</td><td>Win、Linux</td></tr><tr><td align="center">adguard</td><td align="center">广告拦截工具</td><td>Win、Linux</td></tr><tr><td align="center">mem reduct</td><td align="center">内存清理工具</td><td>Win</td></tr><tr><td align="center">小鹤双拼方案</td><td align="center">微软输入法自定义双拼方案</td><td>Win</td></tr><tr><td align="center">enpass</td><td align="center">密码管理工具</td><td>Win、Linux</td></tr><tr><td align="center">quicker</td><td align="center">快捷工具箱</td><td>Win</td></tr><tr><td align="center">everything</td><td align="center">快速搜索工具</td><td>Win</td></tr><tr><td align="center">百度网盘</td><td align="center">网络存储</td><td>Win、Linux</td></tr><tr><td align="center">typora</td><td align="center">markdown工具</td><td>Win、Linux</td></tr><tr><td align="center">vscode</td><td align="center">文本编辑器</td><td>Win、Linux</td></tr><tr><td align="center">thunderclient</td><td align="center">api测试(vscode 插件)</td><td>Win、Linux</td></tr><tr><td align="center">wps</td><td align="center">office工具</td><td>Win、Linux</td></tr><tr><td align="center">ventory</td><td align="center">u盘启动工具</td><td>Win、Linux</td></tr><tr><td align="center">node.js</td><td align="center">开发语言</td><td>Win、Linux</td></tr><tr><td align="center">git</td><td align="center">代码版本控制工具</td><td>Win、Linux</td></tr><tr><td align="center">java</td><td align="center">开发语言</td><td>Win、Linux</td></tr><tr><td align="center">idea</td><td align="center">集成开发环境</td><td>Win、Linux</td></tr><tr><td align="center">python</td><td align="center">开发语言</td><td>Win、Linux</td></tr><tr><td align="center">pycham</td><td align="center">集成开发环境</td><td>Win、Linux</td></tr><tr><td align="center">golang</td><td align="center">开发语言</td><td>Win、Linux</td></tr><tr><td align="center">goland</td><td align="center">集成开发环境</td><td>Win、Linux</td></tr><tr><td align="center">jprofiler</td><td align="center">JVM调优工具</td><td>Win、Linux</td></tr><tr><td align="center">anather redis desktop manager</td><td align="center">redis工具</td><td>Win、Linux</td></tr><tr><td align="center">EssentialPIM</td><td align="center">个人项目管理工具</td><td>Win</td></tr><tr><td align="center">winget脚本</td><td align="center">windows命令行下载工具</td><td>Win</td></tr><tr><td align="center">openhashTab</td><td align="center">查看文件的hash值</td><td>Win</td></tr><tr><td align="center">lnav</td><td align="center">日志查看工具</td><td>Linux</td></tr><tr><td align="center">白描</td><td align="center">ocr工具</td><td>Win</td></tr><tr><td align="center">fxsound</td><td align="center">声音增强</td><td>Win</td></tr><tr><td align="center">知犀</td><td align="center">思维导图工具</td><td>Win</td></tr><tr><td align="center">finalshell</td><td align="center">ssh工具</td><td>Win、Linux</td></tr><tr><td align="center">jdk</td><td align="center">java开发工具</td><td>Win、Linux</td></tr><tr><td align="center">maven</td><td align="center">java依赖管理工具</td><td>Win、Linux</td></tr><tr><td align="center">k6</td><td align="center">性能测试工具</td><td>Win、Linux</td></tr><tr><td align="center">k8s</td><td align="center">容器编排工具</td><td>Linux</td></tr><tr><td align="center">jq</td><td align="center">json处理工具</td><td>Win、Linux</td></tr></tbody></table><p>（完）</p>]]></content>
    
    
    <categories>
      
      <category>生活</category>
      
      <category>经验</category>
      
    </categories>
    
    
    <tags>
      
      <tag>软件</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>COCA 20000词根词汇练习</title>
    <link href="/blog/2024/03/COCA%2020000%E8%AF%8D%E6%B1%87%E5%A4%8D%E4%B9%A0%E5%92%8C%E7%BB%83%E4%B9%A0.html"/>
    <url>/blog/2024/03/COCA%2020000%E8%AF%8D%E6%B1%87%E5%A4%8D%E4%B9%A0%E5%92%8C%E7%BB%83%E4%B9%A0.html</url>
    
    <content type="html"><![CDATA[<h2 id="cess、ceed、cede、gress、gred、grad"><a href="#cess、ceed、cede、gress、gred、grad" class="headerlink" title="cess、ceed、cede、gress、gred、grad"></a>cess、ceed、cede、gress、gred、grad</h2><p><img src="/blog/./assets/image-16770729768207360.jpg" alt="词汇复习课01 思维导图"></p><h3 id="练习"><a href="#练习" class="headerlink" title="练习"></a>练习</h3><ol><li>多选:下列哪几组词根表示“走（to go）”？</li></ol><p>A. -cess；-ceed</p><p>B. -cede；-gress</p><p>C. -grade; -cret</p><p>D. -gred; -grad</p><details>  <summary>答案</summary>  ABD   解析：C选项-grade无此词根；-cret词根表示“增长；产生”；其他三个选项均表示“走”；因此答案为ABD。</details><ol start="2"><li>多选：“process” 的含义有 ________.</li></ol><p>A. 处理器 </p><p>B. 加工过的</p><p>C. 过程; 进程</p><p>D. 加工; 处理</p><details>  <summary>答案</summary>  CD  解析： pro（向前）+ cess（走）→（一步一步地）向前走→过程；程序（n.）；加工；处理 (v.)；A选项对应的词为processor；B选项对应的词为processed；因此答案为CD。</details><ol start="3"><li>下列表示“原料、要素、组成部分”的是 ________。</li></ol><p>A. ingredient</p><p>B. aggressor</p><p>C. procession</p><p>D. accessory</p><details>  <summary>答案</summary> A 解析：B选项意思是“侵略者；挑衅者”；C选项意思为“队伍，行列；一列，一排；列队行进”；D选项的含义为“附件、配件、从犯”。因此答案选A。</details>4. “aggressive” 的含义是 ________。<p>A. 加工过的；处理的</p><p>B. 侵略性的；激进的</p><p>C. 进步的；先进的</p><p>D. 过分的；过多的</p><details>  <summary>答案</summary> B 解析：A选项对应的词为processed；B选项ag（加强语气）+gress（=go：走）+ive（形容词后缀）→强行走进去的→侵略性的、激进的；C选项对应的词为progressive；D选项对应的词为excessive；因此答案为B。 </details><ol start="5"><li>下列选项中表示“法律诉讼”的短语是 ________。</li></ol><p>A. legal procedures</p><p>B. legal preceding</p><p>C. legal proceedings</p><p>D. legal proceeds</p><details>  <summary>答案</summary> C 解析：A选项为法律程序；B选项无此表达；preceding为领先的；在前的；D选项无此表达；proceeds为收入；收益；实收款项；因此答案选C。</details><ol start="6"><li>下列表示 “接近、进入；使用、获取”含义的一词是 ________。</li></ol><p>A. aggress</p><p>B. access</p><p>C. excess</p><p>D. process</p><details>  <summary>答案</summary> B 解析：A选项表示“侵略”; B选项ac（加强语气）+cess（走）→走过去→接近、进入；获取、使用；C选项表示过量；超过；D选项表示过程、进程；处理；加工。因此答案选B。</details><ol start="7"><li>后缀“-ive”的含义不包括下列哪个选项？</li></ol><p>A. 形容词后缀，表“多；大”</p><p>B. 形容词后缀，表“…的“</p><p>C. 名词后缀，表“人”或“物”</p><p>D. 动词后缀，表一种动作</p><details>  <summary>答案</summary> D 解析：-ive不做动词后缀；其他三个选项均是-ive的含义。因此答案选D。</details><ol start="8"><li>请将短语补充完整：数据处理data ________。</li></ol><p>A. behavior </p><p>B. procedure</p><p>C. proceed</p><p>D. processing</p><details>  <summary>答案</summary> D 解析：选项A表示“行为”；选项B proceeds表示 “程序；步骤”；选项C表示 “v. 前进；继续进行；开始”; 选项D表示“处理；加工”。选项D符合题意，因此答案选D。</details><ol start="9"><li>A(n) ________ is a student at a university who has not yet taken a first degree .</li></ol><p>A. graduate </p><p>B. graduation</p><p>C. graduated</p><p>D. undergraduate</p><details>  <summary>答案</summary> D 解析：题干部分a student at a university who has not yet taken a first degree 表示“大学里尚未取得学士学位的学生”；A 选项：大学毕业生；B选项为动词graduate 的名词形式；表示毕业；C选项为动词graduate 的过去分词形式；表示毕了业的；D选项为大学本科生；大学肄业生under（下、未达到）+graduate（本科毕业）→还未本科毕业生→大学本科生；因此选D。</details><ol start="10"><li>You need a password to get ________ to the computer system. 使用这个计算机系统需要密码。</li></ol><p>A. access</p><p>B. proceeds</p><p>C. graduate</p><p>D. precedent</p><details>  <summary>答案</summary> A 解析：选项A access= ac（加强语气）+cess（走）→走过去→接近，进入；获取，使用；选项B proceeds表示 “n.实收款项；收入，收益”；选项C表示 “v. 毕业；n.（本科）毕业生”; 选项D表示“n. 先例；前例；a. 先前的”。选项A符合题意，因此答案选A。</details><h2 id="sub、sup、suc、sus"><a href="#sub、sup、suc、sus" class="headerlink" title="sub、sup、suc、sus"></a>sub、sup、suc、sus</h2><p><img src="/blog/./assets/image-16770860629263360.jpg" alt="词汇复习课02 思维导图"></p><h3 id="练习-1"><a href="#练习-1" class="headerlink" title="练习"></a>练习</h3><ol><li>多选:前缀sub-, sup-, suc-, sus-的功能包括哪几项？</li></ol><p>A. 下，向下</p><p>B. 从下往上</p><p>C. 亚于，次于</p><p>D. 后，后面</p><details>  <summary>答案</summary>ABCD 解析：前缀sub-, sup-, suc-, sus-的具体功能包括：（1）下，向下；（2）从下往上（3）亚于，次于（4）后，后面。因此答案选ABCD。</details><ol start="2"><li>多选：“successor” 的含义为 ________.</li></ol><p>A. 继承者 </p><p>B. 成功者</p><p>C. 后续的事物</p><p>D. 继承权</p><details>  <summary>答案</summary>AC解析： success（继承、接任）+or（名词后缀;表人）→继承人; 继任者；B选项对应的词为successful people/men；D选项对应的词为succession；因此答案为AC。</details><ol start="3"><li>She saw books as a ________, not a luxury. 她视书籍为必需品而非奢侈品。</li></ol><p>A. necessary</p><p>B. necessity</p><p>C. necessarily</p><p>D. necessitate</p><details>  <summary>答案</summary>B解析：A选项表示必要的；必然的；必需的；B选项表示需要；必需品；必然性；C选项表示必要地；必定地，必然地；D选项为动词，表示使成为必需，需要；迫使。选项B符合题意，因此答案选B。</details><ol start="4"><li>前缀de-的含义是________？</li></ol><p>A. 向上</p><p>B. 向下</p><p>C. 高</p><p>D. 走</p><details>  <summary>答案</summary>B解析： up-表示“向上”；de-表示“向下”；-anc表示“以前/老”；“高” “-cess、-ceed、-cede、-gress、-gred、-grad” 全部表示“走”。因此答案选B。</details><ol start="5"><li>“degrade” 的含义<strong>不</strong>包括 ________。</li></ol><p>A. 使……丢脸</p><p>B. 使……降级</p><p>C. 贬低</p><p>D. 退位</p><details>  <summary>答案</summary>D解析：de（向下）+grade（级别）→级别向下→降级，引申出贬低；使……丢脸D选项对应的词为concession；因此答案为D。 </details><ol start="6"><li>下列选项中表示“国会；会议；代表大会”含义的词是 ________。</li></ol><p>A. congressman</p><p>B. ancestry</p><p>C. congress</p><p>D. ancestor </p><details>  <summary>答案</summary>C解析：A选项为国会议员；众议院议员；B选项表示祖先；血统；C选项con（共同、一起）+gress（走）→走到一起→开会（代表大会；国会）；D选项表示祖先;祖宗；因此答案选C。</details><ol start="7"><li>多选：“concede” 一词的含义是 ________。</li></ol><p>A. 让步；退让</p><p>B. 承认</p><p>C. 特许权</p><p>D. 就任</p><details>  <summary>答案</summary>AB解析：con（共同；一起）+ced (走) + e →一起走的人，每人各往回走一步→让步；退让；C选项对应的词为concession；D选项对应的词为accede。因此答案选AB。</details><ol start="8"><li>后缀“-ate; -ite; -ute”的含义不包括下列哪个选项？</li></ol><p>A. 用作动词后缀；表示“使”或不翻译</p><p>B. 用作形容词后缀；</p><p>C. 多数情况下为名词后缀</p><p>D. 可用作名词后缀，表“人”或“物”</p><details>  <summary>答案</summary>C解析：后缀“-ate; -ite; -ute”极少数情况下，可做名词后缀。因此答案选C。</details><ol start="9"><li>“When a member of a royal family <strong>accedes</strong> to the throne, they become king or queen.”加粗部分的含义是________？</li></ol><p>A. 同意</p><p>B. 加入</p><p>C. 就任</p><p>D. 退位</p><details>  <summary>答案</summary>C解析：ac- (=to; 表方向) + cede （走）→朝…走去（字面意思）→就任；就任（根据不同语境决定）。根据此句表达的情景，该词此时应翻译为“就任”。因此答案选C。</details><ol start="10"><li>表示“离题、岔道”含义的一词是________？</li></ol><p>A. regress</p><p>B. digress</p><p>C. ingress</p><p>D. congress</p><details>  <summary>答案</summary>B解析：A选项re-（返回）+gress（走）→往回走→逆行，倒退；B选项di-（=dis; 分开）+gress（走）→分开走→离题；岔道；C选项in-（向内）+gress（走）→向内走→进入；入口；D选项con（共同、一起）+gress（走）→走到一起→开会（代表大会；国会）。因此答案选B。</details>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>英语</category>
      
    </categories>
    
    
    <tags>
      
      <tag>英语</tag>
      
      <tag>词汇</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>少吃或不吃的食物</title>
    <link href="/blog/2024/03/%E5%B0%91%E5%90%83%E6%88%96%E4%B8%8D%E5%90%83%E7%9A%84%E9%A3%9F%E7%89%A9.html"/>
    <url>/blog/2024/03/%E5%B0%91%E5%90%83%E6%88%96%E4%B8%8D%E5%90%83%E7%9A%84%E9%A3%9F%E7%89%A9.html</url>
    
    <content type="html"><![CDATA[<p>以下食物并不是完全禁止摄入，而是要减少摄入量和摄入次数。</p><h2 id="含酒精类"><a href="#含酒精类" class="headerlink" title="含酒精类"></a>含酒精类</h2><ul><li>酒类</li><li>腐乳</li></ul><h2 id="食用油-含Omega6"><a href="#食用油-含Omega6" class="headerlink" title="食用油(含Omega6)"></a>食用油(含Omega6)</h2><ul><li>棕榈油</li><li>葡萄籽油</li><li>葵花籽油</li><li>小麦胚芽油</li><li>玉米油</li><li>大豆油</li><li>芝麻油</li><li>花生油</li><li>火鸡脂肪</li><li>鸡油</li><li>鸭油</li><li>猪油</li></ul><h2 id="肉类-含Omega6"><a href="#肉类-含Omega6" class="headerlink" title="肉类(含Omega6)"></a>肉类(含Omega6)</h2><ul><li>五花肉</li><li>培根</li><li>蛋黄</li><li>肌肉</li></ul><h2 id=""><a href="#" class="headerlink" title=""></a></h2><h2 id="包装食品"><a href="#包装食品" class="headerlink" title="包装食品"></a>包装食品</h2><ul><li>蛋黄酱</li><li></li></ul><h2 id="糖类"><a href="#糖类" class="headerlink" title="糖类"></a>糖类</h2><ul><li>糖果类</li></ul><h2 id="盐类"><a href="#盐类" class="headerlink" title="盐类"></a>盐类</h2><ul><li>腌制类</li></ul><h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2><ul><li><a href="https://mp.weixin.qq.com/s/xdaLhyD7vHWEnPDBdRx6HA">如何饲养好一只「大脑」</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>生活</category>
      
      <category>健康</category>
      
    </categories>
    
    
    <tags>
      
      <tag>食物</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>美军两分钟睡眠法</title>
    <link href="/blog/2024/03/%E7%BE%8E%E5%86%9B%E4%B8%A4%E5%88%86%E9%92%9F%E7%9D%A1%E7%9C%A0%E6%B3%95.html"/>
    <url>/blog/2024/03/%E7%BE%8E%E5%86%9B%E4%B8%A4%E5%88%86%E9%92%9F%E7%9D%A1%E7%9C%A0%E6%B3%95.html</url>
    
    <content type="html"><![CDATA[<h2 id="睡眠周期"><a href="#睡眠周期" class="headerlink" title="睡眠周期"></a>睡眠周期</h2><p><img src="/blog/./assets/f8cda0eb43508714b1cb3d6a19ba1ac7.jpg" alt="睡眠周期"></p><h2 id="第一步"><a href="#第一步" class="headerlink" title="第一步"></a>第一步</h2><p>脸朝上平躺，放松你的面部肌肉（包括舌头&#x2F;下巴&#x2F;眼部周围肌肉），你应该感觉到你的额头是平的，眼窝无力。如果意识到自己在皱眉，可以把注意力集中在额头中心，把压力释放掉，达到放松的状态。</p><p><img src="/blog/./assets/c2f5de68eb4ec36f0fead86c8510b319cb7078e9.gif" alt="第一步"></p><h2 id="第二步"><a href="#第二步" class="headerlink" title="第二步"></a>第二步</h2><p>肩膀尽可能降低，这会帮助你延展并释放肩颈的压力。接着放松你的上手臂和下手臂，如果觉得有困难，可以试着从手臂到手掌再到手指逐次用力然后再放松。</p><p><img src="/blog/./assets/3117dd33f75fc74f90491ba951c10b1f3e95b87b.gif" alt="第二步"></p><h2 id="第三步"><a href="#第三步" class="headerlink" title="第三步"></a>第三步</h2><p> 呼气，放松胸腔；吸气，让肺部充满空气。</p><p><img src="/blog/./assets/f363ea707e72329a71281a6f18d4211dc2b2a1b2.gif" alt="第三步"></p><h2 id="第四步"><a href="#第四步" class="headerlink" title="第四步"></a>第四步</h2><p>从大腿到小腿逐步放松，感觉压力的释放，最后将注意力集中在足部和脚踝。</p><p><img src="/blog/./assets/14d7795c6e23d0e7020e78c2f5c1c71daf911486.gif" alt="第四步"></p><h2 id="第五步"><a href="#第五步" class="headerlink" title="第五步"></a>第五步</h2><p>全身放松后，可以开始清理你的思绪，想象一个放松的场景，让你的思绪清醒10秒。</p><p>这时你的全身肌肉应该都已放松，是时候清空思绪了。尽量保证周围环境安静，不受外界干扰而分心。然后想象这样的画面：</p><p>画面一： 你躺在独木舟上，漂泊于平静的湖面，没有外界纷扰，只有一片纯净的蓝天。 </p><p>画面二： 舒服的依偎在黑色的天鹅绒吊床里，置身于黑暗的房间。</p><p><img src="/blog/./assets/e6becaf424db0bc8bc34748489049c5d10af7c4d.gif" alt="第五步"></p><h2 id="第六步"><a href="#第六步" class="headerlink" title="第六步"></a>第六步</h2><p> 如果这两个画面都对你无效，试着对自己说“不要想、不要想、不要想”（英文原版为”don’t think”）这样持续10秒，你会很快就睡着了！</p><p>一定要注意的是，美军两分钟睡眠法需要时间练习，第一次不一定有效果，美军训练6周，成功率达到96%以上。</p><p>这个方法不说百试百灵，但绝大多数时候可以做到10分钟以内入眠，方法关键是要严格按照上述步骤并且投入进去，不能下意识抗拒或者将信将疑。</p><p>（完）</p>]]></content>
    
    
    <categories>
      
      <category>生活</category>
      
      <category>健康</category>
      
    </categories>
    
    
    <tags>
      
      <tag>睡眠</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>健康食物清单</title>
    <link href="/blog/2024/03/%E5%81%A5%E5%BA%B7%E9%A3%9F%E7%89%A9%E6%B8%85%E5%8D%95.html"/>
    <url>/blog/2024/03/%E5%81%A5%E5%BA%B7%E9%A3%9F%E7%89%A9%E6%B8%85%E5%8D%95.html</url>
    
    <content type="html"><![CDATA[<h2 id="膳食指南"><a href="#膳食指南" class="headerlink" title="膳食指南"></a>膳食指南</h2><p>《中国居民膳食指南》建议，<strong>正常成年人每日需要2200毫克钠。</strong>而当钠摄入越多体内潴留的水分就越多，易使血压就升高，<strong>当伴随水肿的出现，产生脑血管意外或心力衰竭的可能性往往会增加。</strong></p><p>最后需要注意的是，<strong>超加工食物摄入更多，也意味着营养素缺乏。</strong></p><p>大脑对重口味的成瘾，也在于超加工食物摄入过量。区分这种超加工食物，有通用的NOVA分类系统，区分食物加工程度，具体如下：</p><p><img src="/blog/./assets/f7bbacfe080a291e714f35488173334c.jpg" alt="NOVA分类系统"></p><h2 id="五星系列"><a href="#五星系列" class="headerlink" title="五星系列"></a>五星系列</h2><p>没有经过加工或最少加工的食品，主要指自然界中天然存在的动物、植物等的可食用部位，以及经过干燥、研磨、煮沸、巴氏灭菌、冷藏冷冻等工业处理的没有加工过的食品，比如水、新鲜蔬果、豆类、谷物、新鲜或冷冻的肉类、没有添加糖或盐的坚果等。</p><h3 id="饮用水"><a href="#饮用水" class="headerlink" title="饮用水"></a>饮用水</h3><ul><li>山泉水</li><li>过滤水</li></ul><h3 id="新鲜蔬果"><a href="#新鲜蔬果" class="headerlink" title="新鲜蔬果"></a>新鲜蔬果</h3><ul><li>西红柿</li><li>黄瓜</li><li>苹果</li><li>香蕉</li><li>西兰花</li><li>蓝莓</li></ul><h3 id="主食类"><a href="#主食类" class="headerlink" title="主食类"></a>主食类</h3><ul><li>燕麦</li></ul><h3 id="肉类蛋白"><a href="#肉类蛋白" class="headerlink" title="肉类蛋白"></a>肉类蛋白</h3><ul><li>鸡蛋</li><li>鸭蛋</li><li>鹌鹑蛋</li></ul><h3 id="坚果"><a href="#坚果" class="headerlink" title="坚果"></a>坚果</h3><ul><li>杏仁</li><li>核桃</li><li>亚麻籽</li></ul><h2 id="四星系列"><a href="#四星系列" class="headerlink" title="四星系列"></a>四星系列</h2><p>少加工食物。</p><h3 id="包装类食品"><a href="#包装类食品" class="headerlink" title="包装类食品"></a>包装类食品</h3><p>主要是经过加工处理过的视频，尽量买加工工序少的食品。</p><ul><li>即食燕麦</li><li>牛奶</li><li>豆腐</li><li>坚果</li><li>橄榄油</li><li>沙丁鱼罐头</li><li>金枪鱼罐头</li></ul><h3 id="桂格经典原味麦片"><a href="#桂格经典原味麦片" class="headerlink" title="桂格经典原味麦片"></a>桂格经典原味麦片</h3><p><strong>配料</strong> ：燕麦</p><table><thead><tr><th>项目</th><th>每100克</th><th>营养素参考值%</th></tr></thead><tbody><tr><td>能量</td><td>1575千焦</td><td>19%</td></tr><tr><td>蛋白质</td><td>11.0克</td><td>18%</td></tr><tr><td>脂肪</td><td>9.3克</td><td>16%</td></tr><tr><td>- 饱和脂肪酸</td><td>1.9克</td><td>10%</td></tr><tr><td>碳水化合物</td><td>55.7克</td><td>19%</td></tr><tr><td>膳食纤维</td><td>12.1克</td><td>48%</td></tr><tr><td>钠</td><td>8毫克</td><td>0%</td></tr><tr><td>维生素B1</td><td>0.26毫克</td><td>19%</td></tr><tr><td>镁</td><td>120毫克</td><td>40%</td></tr><tr><td>铁</td><td>2.3毫克</td><td>15%</td></tr><tr><td>锌</td><td>2.00毫克</td><td>13%</td></tr></tbody></table><h3 id="桂格五黑燕麦片"><a href="#桂格五黑燕麦片" class="headerlink" title="桂格五黑燕麦片"></a>桂格五黑燕麦片</h3><p><strong>配料</strong>:黑小麦、燕麦、黑米片、黑豆片、黑麦、黑芝麻。</p><p><strong>平均添加量</strong>:黑小麦33.5%,燕麦29%,黑米片25.8%,黑豆片6.3%,黑麦1.5%,黑芝麻1%。</p><table><thead><tr><th>项目</th><th>每100克</th><th>营养素参考值%</th></tr></thead><tbody><tr><td>能量</td><td>1492千焦</td><td>18%</td></tr><tr><td>蛋白质</td><td>12.0克</td><td>20%</td></tr><tr><td>脂肪</td><td>7.2克</td><td>12%</td></tr><tr><td>- 饱和脂肪酸</td><td>1.9克</td><td>10%</td></tr><tr><td>碳水化合物</td><td>55.4克</td><td>18%</td></tr><tr><td>膳食纤维</td><td>10.0克</td><td>40%</td></tr><tr><td>钠</td><td>8毫克</td><td>0%</td></tr><tr><td>烟酸(烟酰胺)</td><td>2.10毫克</td><td>15%</td></tr><tr><td>磷</td><td>210毫克</td><td>30%</td></tr><tr><td>钾</td><td>300毫克</td><td>15%</td></tr><tr><td>镁</td><td>90毫克</td><td>30%</td></tr><tr><td>铁</td><td>2.3毫克</td><td>15%</td></tr></tbody></table><h3 id="桂格五红燕麦片"><a href="#桂格五红燕麦片" class="headerlink" title="桂格五红燕麦片"></a>桂格五红燕麦片</h3><p><strong>配料</strong>:燕麦、营养谷蔬粉(冲调谷物制品)、红豆、红米、枸杞(经辐照处理)、桂圆肉丁(桂圆肉、葵花籽油)、红枣粉。<br><strong>平均添加量</strong>:燕麦76.5%,红豆6.8%,红米5.5%,枸杞0.7%,桂圆肉0.5%,红枣粉0.5%。</p><table><thead><tr><th>项目</th><th>每100克</th><th>营养素参考值%</th></tr></thead><tbody><tr><td>能量</td><td>1544千焦</td><td>18%</td></tr><tr><td>蛋白质</td><td>10.1克</td><td>17%</td></tr><tr><td>脂肪</td><td>8.4克</td><td>14%</td></tr><tr><td>- 饱和脂肪酸</td><td>2.1克</td><td>11%</td></tr><tr><td>碳水化合物</td><td>58.1克</td><td>19%</td></tr><tr><td>膳食纤维</td><td>9.2克</td><td>37%</td></tr><tr><td>钠</td><td>53毫克</td><td>3%</td></tr><tr><td>镁</td><td>90毫克</td><td>30%</td></tr><tr><td>铁</td><td>2.3毫克</td><td>15%</td></tr></tbody></table><h3 id="桂格五白燕麦片"><a href="#桂格五白燕麦片" class="headerlink" title="桂格五白燕麦片"></a>桂格五白燕麦片</h3><p><strong>配料</strong>:燕麦、茯苓大米片(冲调谷物制品)、椰子粉、白芸豆、薏苡仁、山药、烟酸(烟酰胺)、锌(硫酸锌)。<br><strong>平均添加量</strong>:燕麦73%,茯苓大米片10.0%,椰子粉9.3%,白芸豆5.0%,薏苡仁1.5%,山药1.1%。</p><table><thead><tr><th>项目</th><th>每100克</th><th>营养素参考值%</th></tr></thead><tbody><tr><td>能量</td><td>1624千焦</td><td>19%</td></tr><tr><td>蛋白质</td><td>11.0克</td><td>18%</td></tr><tr><td>脂肪</td><td>12.5克</td><td>21%</td></tr><tr><td>- 饱和脂肪酸</td><td>6.8克</td><td>34%</td></tr><tr><td>碳水化合物</td><td>53.0克</td><td>18%</td></tr><tr><td>膳食纤维</td><td>9.2克</td><td>37%</td></tr><tr><td>钠</td><td>20毫克</td><td>1%</td></tr><tr><td>烟酰胺</td><td>10.00毫克</td><td>71%</td></tr><tr><td>镁</td><td>90毫克</td><td>30%</td></tr><tr><td>铁</td><td>2.3毫克</td><td>15%</td></tr><tr><td>锌</td><td>9.00毫克</td><td>60%</td></tr></tbody></table><h2 id="三星系列"><a href="#三星系列" class="headerlink" title="三星系列"></a>三星系列</h2><p>原因见营养成本表<strong>加粗</strong>部分。</p><h3 id="桂格玉米鸡肉燕麦片"><a href="#桂格玉米鸡肉燕麦片" class="headerlink" title="桂格玉米鸡肉燕麦片"></a>桂格玉米鸡肉燕麦片</h3><p><strong>配料</strong>:燕麦片、桂格高纤谷物粉(冲调谷物制品)、青裸片、冻干玉米粒、海苔、 鸡胸肉粒、羽衣甘蓝粉、白芸豆粉、魔芋粉、食用盐、白胡椒粉(经辐照处理)。 </p><p><strong>平均添加量</strong>:青裸片5.5%，冻干玉米粒2.25%，海苔0.78%，鸡胸肉粒0.5%，魔 芋粉0.2%，羽衣甘蓝粉0.15%，白芸豆粉0.1%。 </p><p><strong>燕麦片添加量</strong>:不低于50%。</p><table><thead><tr><th>项目</th><th>每100克</th><th>营养素参考值%</th></tr></thead><tbody><tr><td>能量</td><td>1484千焦</td><td>18%</td></tr><tr><td>蛋白质</td><td>9.0克</td><td>15%</td></tr><tr><td>脂肪</td><td>9.9克</td><td>17%</td></tr><tr><td>- 饱和脂肪酸</td><td>2.0克</td><td>10%</td></tr><tr><td>碳水化合物</td><td>48.3克</td><td>16%</td></tr><tr><td><strong>- 糖</strong></td><td>2.6克</td><td></td></tr><tr><td>膳食纤维</td><td>18.0克</td><td>72%</td></tr><tr><td>钠</td><td>4.80毫克</td><td>24%</td></tr><tr><td>维生素Br</td><td>0.16毫克</td><td>11%</td></tr><tr><td>磷</td><td>198毫克</td><td>28%</td></tr><tr><td>钾</td><td>249毫克</td><td>12%</td></tr><tr><td>镁</td><td>78毫克</td><td>26%</td></tr><tr><td>铁</td><td>2.3毫克</td><td>15%</td></tr></tbody></table><h3 id="桂格贝贝南瓜燕麦片"><a href="#桂格贝贝南瓜燕麦片" class="headerlink" title="桂格贝贝南瓜燕麦片"></a>桂格贝贝南瓜燕麦片</h3><p><strong>配料</strong>:燕麦片、桂格高纤谷物粉(冲调谷物制品)、魔芋南瓜麦片、南瓜粉、蔓越莓干、冻千贝贝南瓜丁、白芸豆粉、赤藓糖醇。</p><p><strong>平均添加量</strong>:蔓越莓干3.6%，冻千贝贝南瓜丁2.55%，白芸豆粉0.2%，魔芋0.08%。</p><p><strong>燕麦片添加量</strong>:不低于50%。</p><table><thead><tr><th>项目</th><th>每100克</th><th>营养素参考值%</th></tr></thead><tbody><tr><td>能量</td><td>1503千焦</td><td>18%</td></tr><tr><td>蛋白质</td><td>7.3克</td><td>12%</td></tr><tr><td>脂肪</td><td>9.4克</td><td>16%</td></tr><tr><td>- 饱和脂肪酸</td><td>1.8克</td><td>9%</td></tr><tr><td>碳水化合物</td><td>53 克</td><td>18%</td></tr><tr><td><strong>- 糖</strong></td><td>10.4克</td><td></td></tr><tr><td>膳食纤维</td><td>16.3克</td><td>65%</td></tr><tr><td>钠</td><td>20毫克</td><td>1%</td></tr><tr><td>维生素Br</td><td>0.15毫克</td><td>11%</td></tr><tr><td>磷</td><td>160毫克</td><td>23%</td></tr><tr><td>钾</td><td>238毫克</td><td>12%</td></tr><tr><td>镁</td><td>65毫克</td><td>22%</td></tr><tr><td>铁</td><td>1.9毫克</td><td>13%</td></tr></tbody></table><h3 id="桂格五润燕麦片"><a href="#桂格五润燕麦片" class="headerlink" title="桂格五润燕麦片"></a>桂格五润燕麦片</h3><p><strong>配料</strong>:燕麦片、桂格高纤谷物粉(冲调谷物制品)、猴头菇山药麦片、橘皮红豆米片(冲调谷物制品)、赤小豆片、营养粉(红豆粉,橘皮粉,茯苓粉)、橙皮丁。<br><strong>平均添加量</strong>:燕麦片53%,猴头菇山药麦片8.7%,赤小豆片6%,橘皮粉0.65%,茯苓粉0.04%。</p><table><thead><tr><th>项目</th><th>每100克</th><th>营养素参考值%</th></tr></thead><tbody><tr><td>能量</td><td>1434千焦</td><td>17%</td></tr><tr><td>蛋白质</td><td>9.0克</td><td>15%</td></tr><tr><td>脂肪</td><td>7.0克</td><td>12%</td></tr><tr><td>- 饱和脂肪酸</td><td>1.6克</td><td>8%</td></tr><tr><td>碳水化合物</td><td>52.6克</td><td>18%</td></tr><tr><td>- 糖</td><td>6.5克</td><td></td></tr><tr><td>膳食纤维</td><td>16.0克</td><td>64%</td></tr><tr><td>钠</td><td>8毫克</td><td>0%</td></tr><tr><td>维生素B1</td><td>0.17毫克</td><td>12%</td></tr><tr><td>镁</td><td>90毫克</td><td>30%</td></tr><tr><td>铁</td><td>2.3毫克</td><td>15%</td></tr></tbody></table><h2 id="二星系列"><a href="#二星系列" class="headerlink" title="二星系列"></a>二星系列</h2><p>原因见营养成本表<strong>加粗</strong>部分。</p><h3 id="优形新奥尔良味沙拉鸡胸肉"><a href="#优形新奥尔良味沙拉鸡胸肉" class="headerlink" title="优形新奥尔良味沙拉鸡胸肉"></a>优形新奥尔良味沙拉鸡胸肉</h3><table><thead><tr><th>项目</th><th>每100克</th><th>NRV%</th></tr></thead><tbody><tr><td>能量</td><td>501千焦</td><td>6%</td></tr><tr><td>蛋白质</td><td>24.0克</td><td>40%</td></tr><tr><td>脂肪</td><td>1.6克</td><td>3%</td></tr><tr><td>碳水化合物</td><td>2.0克</td><td>1%</td></tr><tr><td><strong>钠</strong></td><td>596毫克</td><td>30%</td></tr></tbody></table><h2 id="一星系列"><a href="#一星系列" class="headerlink" title="一星系列"></a>一星系列</h2><h3 id="补剂"><a href="#补剂" class="headerlink" title="补剂"></a>补剂</h3><p>主要是用来补充营养元素的。</p><ul><li>复合维生素</li><li>高纯度Omega3</li><li>蛋白粉</li></ul><h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2><ul><li><a href="https://mp.weixin.qq.com/s/xdaLhyD7vHWEnPDBdRx6HA">如何饲养好一只「大脑」</a></li></ul><p>（完）</p>]]></content>
    
    
    <categories>
      
      <category>生活</category>
      
      <category>健康</category>
      
    </categories>
    
    
    <tags>
      
      <tag>食物</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Git客户端工具GitUi安装及使用</title>
    <link href="/blog/2024/03/Git%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%B7%A5%E5%85%B7GitUi%E5%AE%89%E8%A3%85%E5%8F%8A%E4%BD%BF%E7%94%A8.html"/>
    <url>/blog/2024/03/Git%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%B7%A5%E5%85%B7GitUi%E5%AE%89%E8%A3%85%E5%8F%8A%E4%BD%BF%E7%94%A8.html</url>
    
    <content type="html"><![CDATA[<h2 id="GitUi介绍"><a href="#GitUi介绍" class="headerlink" title="GitUi介绍"></a>GitUi介绍</h2><blockquote><p>GitUI provides you with the comfort of a git GUI but right in your terminal.<br>GitUI是一个Git GUI客户端，但是它直接在终端中运行。</p></blockquote><h3 id="特性"><a href="#特性" class="headerlink" title="特性"></a>特性</h3><ul><li><p>快速而直观的纯键盘操作控制<br>提供了一个针对高效用户优化的流线型界面，所有操作都可以通过键盘快捷键高效完成，从而最大程度减少对鼠标或触控板的依赖。</p></li><li><p>基于上下文的帮助<br>无需记忆大量热键，应用会根据当前操作场景自动提供相关帮助信息。</p></li><li><p>查看、提交与修订变更<br>（包含钩子功能：pre-commit, commit-msg, post-commit, prepare-commit-msg）：能够查看工作区状态，提交版本更新，并在必要时修订已提交的变更，同时支持预提交和提交后的各种脚本钩子功能。</p></li><li><p>暂存、取消暂存、还原与重置文件、块和行<br>可以灵活管理暂存区，实现文件部分或全部内容的暂存、取消暂存，以及回滚到某个历史版本的状态。</p></li><li><p>储藏功能<br>（保存、弹出、应用、丢弃及检查）：支持临时存储工作区未提交的变化，并能在之后随时恢复或应用这些变化。</p></li><li><p>向远程仓库推送与从远程仓库拉取<br>进行版本同步操作，包括将本地分支的变更推送到远程仓库，以及从远程仓库获取最新的提交。</p></li><li><p>分支列表管理<br>（创建、重命名、删除、检出、处理远程分支）：提供全面的分支管理功能，包括新建、改名、删除分支，切换分支以及与远程分支的交互。</p></li><li><p>浏览与搜索提交日志、比较已提交的差异<br>允许用户查看项目的历史提交记录，搜索特定提交，并能可视化比较不同提交之间的差异。</p></li><li><p>响应式终端用户界面<br>界面设计为适应不同终端尺寸和分辨率，确保良好的用户体验。</p></li><li><p>异步 Git API 实现流畅控制<br>通过异步处理 Git 操作来提升应用性能，使得用户操作更加流畅无阻。</p></li><li><p>子模块支持<br>内置对 Git 子模块的支持，能够方便地管理和跟踪项目中的嵌套 Git 仓库。</p></li><li><p>GPG 提交签名<br>支持使用 GPG 对提交进行数字签名以保证提交者的身份验证和数据完整性，但同时也指出在某些情况下可能存在问题或限制。</p></li></ul><h2 id="安装使用"><a href="#安装使用" class="headerlink" title="安装使用"></a>安装使用</h2><p>进入GitUi的下载地址，根据操作系统选择对应的安装包进行安装。<br><a href="https://github.com/extrawurst/gitui/releases">GitUi下载</a></p><p>以Windows为例：<br><img src="/blog/./assets/image-16768202869359616.png" alt="gitui制品包"></p><p>下载gitui.msi文件，双击安装即可。安装完成后新建一个终端，进入一个Git仓库目录，在命令行中输入<code>gitui</code>打开GitUi界面。<br><img src="/blog/./assets/image-16768202914071552.png" alt="gitui界面"></p><h3 id="GitUi常用快捷键"><a href="#GitUi常用快捷键" class="headerlink" title="GitUi常用快捷键"></a>GitUi常用快捷键</h3><p>GItUi默认的快捷键是基于键盘上下左右键的，可以通过<code>F1</code>键查看快捷键列表。你可以自定义快捷键，具体操作可以参考<a href="https://github.com/extrawurst/gitui/blob/master/KEY_CONFIG.md">GitUi文档</a>。</p><p>这里将GitUi快捷键修改为Vim风格为例：</p><p>下载<a href="https://raw.githubusercontent.com/extrawurst/gitui/master/vim_style_key_config.ron">vim_style_key_config.ron</a>文件修改名称为<code>key_bindings.ron</code>。</p><p>打开资源管理器目录，在地址栏输入<code>%appdata%\gitui</code>，找到<code>key_bindings.ron</code>文件，将文件复制到<code>%appdata%\gitui</code>目录下。</p><p><img src="/blog/./assets/image-16768202949673984.png" alt="key_bindings.ron"></p><p>配置完成后，在GitUi中按<code>F1</code>键查看快捷键列表，可以看到快捷键已经修改为Vim风格。</p><h3 id="编辑文件"><a href="#编辑文件" class="headerlink" title="编辑文件"></a>编辑文件</h3><p>在GitUi中，可以通过<code>I</code>键进入编辑模式，此时可以编辑文件。默认的编辑器为<code>vi</code>，但在Windows下，可能会出现<code>vi</code>命令无法使用的情况。</p><p><img src="/blog/./assets/image-16768202733110272.png" alt="vi命令报错"></p><p>需要手动指定编辑器。可以通过设置<code>GIT_EDITOR</code>、 <code>VISUAL</code>或 <code>EDITOR</code>环境变量的方式生效。</p><p>设置临时环境变量:</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd"><span class="hljs-built_in">set</span> EDITOR=nvim<br></code></pre></td></tr></table></figure><p>设置永久环境变量:</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">setx EDITOR nvim<br></code></pre></td></tr></table></figure><p>设置完环境变量后，新建一个终端，进入一个Git仓库目录，在命令行中输入<code>gitui</code>打开GitUi界面。再次编辑文件，可以看到编辑器已经切换为<code>nvim</code>。</p><h3 id="提交到暂存区"><a href="#提交到暂存区" class="headerlink" title="提交到暂存区"></a>提交到暂存区</h3><p>当修改了一个已经被Git追踪的文件，该文件处于”modified”（已修改）状态。如果想要将这些更改包含在下一次提交中，需要先将它们添加到暂存区域（也称为索引），此时文件就进入了”staged”状态。在GitUi中，可以通过<code>回车</code>键将选中的文件添加到暂存区，通过<code>a</code>键将所有文件文件添加到暂存区。对应的Git命令为<code>git add &lt;file&gt;</code>。</p><p><img src="/blog/./assets/image-16768202668049408.png" alt="暂存区"></p><h3 id="提交本地历史"><a href="#提交本地历史" class="headerlink" title="提交本地历史"></a>提交本地历史</h3><p>在GitUi中，可以通过<code>c</code>键提交本地历史，此时会弹出提交信息输入框，输入提交信息后，可以通过<code>ctrl+d</code>键提交，也可以通过<code>esc</code>键取消提交。对应的Git命令为<code>git commit -m &lt;message&gt;</code>。<br><img src="/blog/./assets/image-16768202776347648.png" alt="commit"></p><h3 id="查看提交日志"><a href="#查看提交日志" class="headerlink" title="查看提交日志"></a>查看提交日志</h3><p>在GitUi中，可以通过数字<code>2</code>键查看提交日志，此时会切换到log栏，可以数据<code>1</code>键回到Status栏。对应的Git命令为<code>git log</code>。</p><p><img src="/blog/./assets/image-16768202814080000.png" alt="Log"></p><h3 id="推送到远程仓库"><a href="#推送到远程仓库" class="headerlink" title="推送到远程仓库"></a>推送到远程仓库</h3><p>在GitUi中，可以通过<code>p</code>键推送到远程仓库。对应的Git命令为<code>git push &lt;remote&gt; &lt;branch&gt;</code>。</p><p>在推送的时候可能会遇到认证失败的问题。</p><p><img src="/blog/./assets/image-20240331120735204.png" alt="push failed"></p><p>需要配置ssh代理。参考配置<a href="https://docs.github.com/en/authentication/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent#adding-your-ssh-key-to-the-ssh-agent">Adding your SSH key to the ssh-agent</a>。</p><p>步骤：</p><ol><li>打开命令行窗口，执行下面的命令生成ssh key。</li></ol><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">ssh-keygen -t ed25519 -C &quot;your_email@example.com&quot;<br></code></pre></td></tr></table></figure><ol start="2"><li>以管理员身份运行powershell,并执行下面的命令。</li></ol><figure class="highlight ps1"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ps1"><span class="hljs-comment"># start the ssh-agent in the background</span><br><span class="hljs-built_in">Get-Service</span> <span class="hljs-literal">-Name</span> ssh<span class="hljs-literal">-agent</span> | <span class="hljs-built_in">Set-Service</span> <span class="hljs-literal">-StartupType</span> Manual<br><span class="hljs-built_in">Start-Service</span> ssh<span class="hljs-literal">-agent</span><br></code></pre></td></tr></table></figure><ol start="3"><li>新建一个普通命令行窗口，并执行下面的命令。</li></ol><figure class="highlight ps1"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ps1">ssh<span class="hljs-literal">-add</span> c:/Users/YOU/.ssh/id_ed25519<br></code></pre></td></tr></table></figure><ol start="4"><li>新建一个命令行窗口，打开GitUi，通过<code>p</code>键推送到远程仓库。</li></ol><p>（完）</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>Git</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Git</tag>
      
      <tag>GitUi</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>技能证书合集</title>
    <link href="/blog/2024/03/%E6%8A%80%E8%83%BD%E8%AF%81%E4%B9%A6%E5%90%88%E9%9B%86.html"/>
    <url>/blog/2024/03/%E6%8A%80%E8%83%BD%E8%AF%81%E4%B9%A6%E5%90%88%E9%9B%86.html</url>
    
    <content type="html"><![CDATA[<h2 id="Kubernetes管理员"><a href="#Kubernetes管理员" class="headerlink" title="Kubernetes管理员"></a>Kubernetes管理员</h2><p><img src="/blog/./assets/CKA.png" alt="CKA"></p><h2 id="Kubernetes应用开发者"><a href="#Kubernetes应用开发者" class="headerlink" title="Kubernetes应用开发者"></a>Kubernetes应用开发者</h2><p><img src="/blog/./assets/CKAD.png" alt="CKAD"></p><h2 id="Kubernetes安全专家"><a href="#Kubernetes安全专家" class="headerlink" title="Kubernetes安全专家"></a>Kubernetes安全专家</h2><p><img src="/blog/./assets/CKS.png" alt="CKS"></p><h2 id="Prometheus工程师"><a href="#Prometheus工程师" class="headerlink" title="Prometheus工程师"></a>Prometheus工程师</h2><p><img src="/blog/./assets/PCA.png" alt="PCA"></p><h2 id="红帽系统管理员"><a href="#红帽系统管理员" class="headerlink" title="红帽系统管理员"></a>红帽系统管理员</h2><p><img src="/blog/./assets/RHCSA.png" alt="RHCSA"></p><h2 id="红帽系统工程师"><a href="#红帽系统工程师" class="headerlink" title="红帽系统工程师"></a>红帽系统工程师</h2><p><img src="/blog/./assets/RHCE.png" alt="RHCE"></p><h2 id="MeterSphere持续测试工程师"><a href="#MeterSphere持续测试工程师" class="headerlink" title="MeterSphere持续测试工程师"></a>MeterSphere持续测试工程师</h2><p><img src="/blog/./assets/MeterSphere.png" alt="MeterSphere"></p><h2 id="数据分析L1"><a href="#数据分析L1" class="headerlink" title="数据分析L1"></a>数据分析L1</h2><p><img src="/blog/./assets/Data_Science-L1.png" alt="Data Science -L1"></p><h2 id="WPS文字专家"><a href="#WPS文字专家" class="headerlink" title="WPS文字专家"></a>WPS文字专家</h2><p><img src="/blog/./assets/WPS%E6%96%87%E5%AD%97.jpg" alt="WPS文字"></p><h2 id="WPS演示专家"><a href="#WPS演示专家" class="headerlink" title="WPS演示专家"></a>WPS演示专家</h2><p><img src="/blog/./assets/WPS%E6%BC%94%E7%A4%BA.jpg" alt="WPS演示"></p><h2 id="WPS表格专家"><a href="#WPS表格专家" class="headerlink" title="WPS表格专家"></a>WPS表格专家</h2><p><img src="/blog/./assets/WPS%E8%A1%A8%E6%A0%BC.jpg" alt="WPS表格"></p><h2 id="WPS大师"><a href="#WPS大师" class="headerlink" title="WPS大师"></a>WPS大师</h2><p><img src="/blog/./assets/WPS%E5%A4%A7%E5%B8%88.jpg" alt="WPS大师"></p><h2 id="阿里巴巴编码规范"><a href="#阿里巴巴编码规范" class="headerlink" title="阿里巴巴编码规范"></a>阿里巴巴编码规范</h2><p><img src="/blog/./assets/%E9%98%BF%E9%87%8C%E5%B7%B4%E5%B7%B4%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83.jpg" alt="阿里巴巴编码规范"></p><h2 id="函数计算的功能与使用入门"><a href="#函数计算的功能与使用入门" class="headerlink" title="函数计算的功能与使用入门"></a>函数计算的功能与使用入门</h2><p><img src="/blog/./assets/%E5%87%BD%E6%95%B0%E8%AE%A1%E7%AE%97%E7%9A%84%E5%8A%9F%E8%83%BD%E4%B8%8E%E4%BD%BF%E7%94%A8%E5%85%A5%E9%97%A8.png" alt="函数计算的功能与使用入门"></p><h2 id="函数计算入门和实战"><a href="#函数计算入门和实战" class="headerlink" title="函数计算入门和实战"></a>函数计算入门和实战</h2><p><img src="/blog/./assets/%E5%87%BD%E6%95%B0%E8%AE%A1%E7%AE%97%E5%85%A5%E9%97%A8%E5%92%8C%E5%AE%9E%E6%88%98.png" alt="函数计算入门和实战"></p><h2 id="Serverless应用快速体验"><a href="#Serverless应用快速体验" class="headerlink" title="Serverless应用快速体验"></a>Serverless应用快速体验</h2><p><img src="/blog/./assets/Serverless%E5%BA%94%E7%94%A8%E5%BF%AB%E9%80%9F%E4%BD%93%E9%AA%8C.png" alt="Serverless应用快速体验"></p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>考试</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>Kubernates</tag>
      
      <tag>Prometheus</tag>
      
      <tag>Word</tag>
      
      <tag>Excel</tag>
      
      <tag>PPT</tag>
      
      <tag>Metersphere</tag>
      
      <tag>Ansible</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>英语学习需要掌握的基本时态语态</title>
    <link href="/blog/2024/01/%E8%8B%B1%E8%AF%AD%E5%AD%A6%E4%B9%A0%E9%9C%80%E8%A6%81%E6%8E%8C%E6%8F%A1%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%97%B6%E6%80%81%E8%AF%AD%E6%80%81.html"/>
    <url>/blog/2024/01/%E8%8B%B1%E8%AF%AD%E5%AD%A6%E4%B9%A0%E9%9C%80%E8%A6%81%E6%8E%8C%E6%8F%A1%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%97%B6%E6%80%81%E8%AF%AD%E6%80%81.html</url>
    
    <content type="html"><![CDATA[<h2 id="5大基本时态-2大基本语态-2种人称"><a href="#5大基本时态-2大基本语态-2种人称" class="headerlink" title="5大基本时态+2大基本语态+2种人称"></a>5大基本时态+2大基本语态+2种人称</h2><table><thead><tr><th></th><th>时态语态</th><th>动词</th><th>以get为例</th><th>be动词</th></tr></thead><tbody><tr><td>5大基本时态</td><td>一般现在时</td><td>do</td><td>get</td><td>am&#x2F;is&#x2F;are</td></tr><tr><td></td><td>一般过去时</td><td>did</td><td>got</td><td>was&#x2F;were</td></tr><tr><td></td><td>一般将来时</td><td>will do</td><td>will get</td><td>will be</td></tr><tr><td></td><td>现在完成时</td><td>hava&#x2F;has done</td><td>hava&#x2F;has gotten</td><td>hava&#x2F;has been</td></tr><tr><td></td><td>现在进行时</td><td>am&#x2F;is&#x2F;are doing</td><td>am&#x2F;is&#x2F;are geting</td><td>&#x2F;</td></tr><tr><td>2大基本语态</td><td>主动语态</td><td>do</td><td>get</td><td>am&#x2F;is&#x2F;are</td></tr><tr><td></td><td>被动语态</td><td>be+done</td><td>be+gotten</td><td>&#x2F;</td></tr><tr><td>2种人称</td><td>第三人称单数(非你非我)</td><td>does</td><td>gets</td><td>is</td></tr><tr><td></td><td>其他</td><td>do</td><td>get</td><td>be</td></tr></tbody></table><h2 id="情态动词-do组成谓语"><a href="#情态动词-do组成谓语" class="headerlink" title="情态动词+do组成谓语"></a>情态动词+do组成谓语</h2><p>常用来表示推测，请求，命令等语气，用在谓语动词前，后面加动词原形+do</p><ol><li>can;could(可以)</li><li>may;might(可能)</li><li>shall;should(应该)</li><li>will;would(将会)</li><li>must(必须；一定)</li></ol><h2 id="8种被动语态，以give为例"><a href="#8种被动语态，以give为例" class="headerlink" title="8种被动语态，以give为例"></a>8种被动语态，以give为例</h2><table><thead><tr><th></th><th>主动</th><th>被动</th></tr></thead><tbody><tr><td>一般现在</td><td>give&#x2F;gives</td><td>be given</td></tr><tr><td>一般过去</td><td>gave</td><td>was&#x2F;were given</td></tr><tr><td>一般将来</td><td>will give</td><td>will be given</td></tr><tr><td>过去将来</td><td>would give</td><td>would be given</td></tr><tr><td>现在进行</td><td>am&#x2F;is&#x2F;were giving</td><td>am&#x2F;is&#x2F;are being given</td></tr><tr><td>过去进行</td><td>was&#x2F;were giving</td><td>was&#x2F;were being given</td></tr><tr><td>现在完成</td><td>has&#x2F;have given</td><td>have&#x2F;has been given</td></tr><tr><td>过去完成</td><td>had given</td><td>had been given</td></tr></tbody></table><p>动词</p><ul><li>及物动词(vt)</li></ul><p>I love English</p><ul><li>不及物动词(vi)</li></ul><p>I work at home</p><p>（完）</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>英语</category>
      
    </categories>
    
    
    <tags>
      
      <tag>英语</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Cookie、Session、Token的区别</title>
    <link href="/blog/2023/11/Cookie%E3%80%81Session%E3%80%81Token%E7%9A%84%E5%8C%BA%E5%88%AB.html"/>
    <url>/blog/2023/11/Cookie%E3%80%81Session%E3%80%81Token%E7%9A%84%E5%8C%BA%E5%88%AB.html</url>
    
    <content type="html"><![CDATA[<h2 id="区别"><a href="#区别" class="headerlink" title="区别"></a>区别</h2><p>Cookie、Session和Token是用于身份验证和用户状态管理的不同机制。它们在Web应用程序中的使用有一些关键区别：</p><ol><li><p>Cookie（HTTP Cookie）：</p><ul><li>Cookie是一种客户端存储数据的机制，通常是一个小的文本文件，Key和Value的字符串格式。</li><li>服务器可以通过HTTP响应的<code>Set-Cookie</code>头将Cookie发送给客户端浏览器，然后浏览器将Cookie保存并在后续请求中自动包含在<code>Cookie</code>头中。</li><li>Cookie通常用于跟踪用户会话、存储用户首选项和其他客户端相关的数据。</li><li>Cookie可以设置过期时间，可以是会话级别的（浏览器关闭后失效）或持久的（在指定过期日期之前有效）。</li><li>Cookie是与域名绑定的，无法跨域访问，但可以在一级域名和二级域名之间共享。同时，浏览器对每个域名下的Cookie数量有限制（单个Cookei大小4KB）。跨域数据共享通常需要使用其他机制，如CORS。这些规则和限制有助于确保用户隐私和安全。</li></ul></li><li><p>Session（会话）：</p><ul><li>会话是服务器端的机制，用于跟踪和管理用户状态。</li><li>会话通常使用Cookie或URL参数来维护一个唯一的会话标识符（Session ID），该标识符关联到服务器端存储的用户数据。</li><li>会话允许服务器存储和检索与特定用户相关的数据，以保持用户的身份认证状态和其他用户特定的信息。</li><li>会话数据通常存储在服务器内存、数据库或分布式缓存中，因此对于服务器来说是可控的。</li><li>Session和Cookie是协同工作的。Session存储在服务器端，但Session ID 存储在客户端的Cookie中，通过Session ID，服务器可以识别和恢复与特定用户相关的会话数据。</li></ul></li><li><p>Token（令牌）：</p><ul><li><p>令牌通常是一串长字符串，用于身份验证和授权。</p></li><li><p>令牌通常使用一种独立于会话状态的机制来实现，如JSON Web Tokens（JWT）。</p></li><li><p>令牌通常包含有关用户身份的信息，可以包括用户ID、权限、过期时间等。</p></li><li><p>令牌通常在客户端和服务器之间传递，并用于授权访问受保护的资源，如API端点。</p></li></ul></li></ol><h2 id="对比"><a href="#对比" class="headerlink" title="对比"></a>对比</h2><table><thead><tr><th></th><th align="center">Cookie</th><th align="center">Session</th><th align="center">Token</th></tr></thead><tbody><tr><td>数据存储</td><td align="center">客户端存储</td><td align="center">服务器端生成</td><td align="center">服务器端生成</td></tr><tr><td>认证授权</td><td align="center">保存用户数据</td><td align="center">跟踪用户状态和保存用户数据</td><td align="center">身份验证和授权</td></tr><tr><td>跨域支持</td><td align="center">不支持</td><td align="center">不支持</td><td align="center">支持</td></tr></tbody></table><p>（本文完）</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>网络</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Cookie</tag>
      
      <tag>Session</tag>
      
      <tag>Token</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Vim修改Dos文件格式为Unix</title>
    <link href="/blog/2023/11/Vim%E4%BF%AE%E6%94%B9Dos%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F%E4%B8%BAUnix.html"/>
    <url>/blog/2023/11/Vim%E4%BF%AE%E6%94%B9Dos%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F%E4%B8%BAUnix.html</url>
    
    <content type="html"><![CDATA[<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs vim"># 查看当前文本的文件格式<br>:<span class="hljs-keyword">set</span> ff<br># 修改为unix的文本格式<br>:<span class="hljs-keyword">set</span> ff=unix<br># 修改为dos的文本格式<br>:<span class="hljs-keyword">set</span> ff=dos<br></code></pre></td></tr></table></figure><p>（完）</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>Vim</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Vim</tag>
      
      <tag>Nvim</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SpringBoot可以直接运行Jar的原理</title>
    <link href="/blog/2023/11/SpringBoot%E5%8F%AF%E4%BB%A5%E7%9B%B4%E6%8E%A5%E8%BF%90%E8%A1%8CJar%E7%9A%84%E5%8E%9F%E7%90%86.html"/>
    <url>/blog/2023/11/SpringBoot%E5%8F%AF%E4%BB%A5%E7%9B%B4%E6%8E%A5%E8%BF%90%E8%A1%8CJar%E7%9A%84%E5%8E%9F%E7%90%86.html</url>
    
    <content type="html"><![CDATA[<h2 id="SpringBoot可以直接运行Jar的原理"><a href="#SpringBoot可以直接运行Jar的原理" class="headerlink" title="SpringBoot可以直接运行Jar的原理"></a>SpringBoot可以直接运行Jar的原理</h2><p>Spring Boot的Jar包可以直接运行，主要是因为它内置了嵌入式的Servlet容器（例如Tomcat、Jetty或Undertow），并且使用了可执行的JAR文件格式，这使得应用程序可以作为独立的Java进程运行。</p><p>那么Spring Boot如何创建可执行的Jar文件以及如何启动应用程序：</p><ol><li><p>Spring Boot Maven插件：<code>spring-boot-maven-plugin</code>是用于将Spring Boot应用程序打包成可执行的Jar文件的插件。它允许你执行<code>mvn clean install</code> 或 <code>mvn package</code> 命令来创建一个包含应用程序代码和依赖项的Jar文件。</p></li><li><p>Fat Jar：生成的Jar文件通常被称为”Fat Jar”，因为它包含了应用程序的代码和所有依赖的Jar文件。这使得Jar文件可以独立运行，无需额外的类路径配置。</p></li><li><p>Manifest文件：在生成的Fat Jar中，通常包含一个特殊的Manifest文件，其中包含了应用程序的启动类信息。这是因为Java命令需要知道应用程序的入口点，而Manifest文件指定了启动类。</p></li><li><p>JarLauncher：Spring Boot的Fat Jar中通常包含了一个名为<code>JarLauncher</code>的类，它负责创建一个<code>LaunchedURLClassLoader</code>来加载应用程序的依赖Jar，然后以一个新线程启动应用程序的Main函数。这个过程使得应用程序可以在独立的Java进程中运行。</p></li></ol><p>（本文完）</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>服务框架</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SpringBoot</tag>
      
      <tag>Jar</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTTPS的原理</title>
    <link href="/blog/2023/11/HTTPS%E7%9A%84%E5%8E%9F%E7%90%86.html"/>
    <url>/blog/2023/11/HTTPS%E7%9A%84%E5%8E%9F%E7%90%86.html</url>
    
    <content type="html"><![CDATA[<h2 id="HTTPS的原理"><a href="#HTTPS的原理" class="headerlink" title="HTTPS的原理"></a>HTTPS的原理</h2><p>HTTPS（Hypertext Transfer Protocol Secure）是一种用于安全传输数据的通信协议，它基于HTTP协议，并通过加密和认证机制提供了数据保护和隐私保护。HTTPS的工作原理可以概括为以下几个步骤：</p><ol><li><p>握手阶段（Handshake Phase）：</p><ul><li>客户端向服务器发送一个加密连接请求，即HTTPS请求。</li><li>服务器会响应客户端的请求，并发送一个包含公钥、加密方法和证书的信息。</li><li>客户端验证服务器的证书是否有效，通常是通过证书颁发机构（Certificate Authority，CA）的数字签名进行验证。</li><li>客户端生成一个随机的对称密钥(随机码KEY），用于在通信中加密和解密数据，然后使用服务器的公钥对该密钥进行加密，将其发送给服务器。</li></ul></li><li><p>密钥交换阶段（Key Exchange Phase）：</p><ul><li>服务器使用自己的私钥解密客户端发送过来的加密的对称密钥。</li><li>现在，客户端和服务器都拥有了相同的对称密钥，用于在通信中进行加密和解密操作。</li></ul></li><li><p>安全通信阶段（Secure Communication Phase）：</p><ul><li>客户端和服务器使用共享的对称密钥对数据进行加密和解密。这意味着数据在传输过程中会被加密，从而保护了数据的隐私和完整性。</li></ul></li></ol><p>通过这些步骤，HTTPS实现了以下关键原理：</p><ul><li><p><strong>数据加密</strong>：HTTPS使用对称密钥加密来保护数据的机密性，只有具有正确密钥的双方才能解密和理解数据。这使得窃听者难以解密传输的数据。</p></li><li><p><strong>身份认证</strong>：服务器的证书由可信的证书颁发机构签发，这意味着客户端可以验证服务器的身份。这有助于防止中间人攻击，确保客户端正在与正确的服务器通信。</p></li><li><p><strong>数据完整性</strong>：HTTPS还提供了数据完整性，确保传输的数据在传输过程中没有被篡改。这是通过在数据上应用消息认证码（MAC）来实现的。</p></li></ul><p>总之，HTTPS通过加密、认证和数据完整性保护了数据的隐私和安全，使得网站和应用程序能够安全地进行敏感信息的传输，如登录凭据、支付信息等。这使得用户能够信任网站，并减少了潜在的安全威胁。</p><p><img src="/blog/./assets/image-20231104222418466.png" alt="HTTPS原理"></p><p>（本文完）</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>网络</category>
      
    </categories>
    
    
    <tags>
      
      <tag>HTTP</tag>
      
      <tag>HTTPS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>网络编程</title>
    <link href="/blog/2023/11/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B.html"/>
    <url>/blog/2023/11/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B.html</url>
    
    <content type="html"><![CDATA[<h2 id="网络编程"><a href="#网络编程" class="headerlink" title="网络编程"></a>网络编程</h2><p> TCP&#x2F;IP 的应用层对应了 OSI 的应用层、表示层和会话层；TCP&#x2F;IP 的网络接口层对应了 OSI 的数据链路层和物理层。</p><p><img src="/blog/./assets/image-20240414174116891.png" alt="协议模型"></p><p>摄像头推送视频流到流媒体服务器（基于TCP传输），理论传输速度是3M&#x2F;S，实际测试发现是2M&#x2F;S</p><blockquote><p>网卡，交换机，应用程序，都可能是瓶颈</p></blockquote><p>用vagarant+virtualbox，完美搞定Linux虚拟机环境</p><p><strong>无论是客户端，还是服务器端，它们运行的单位都是进程（process），而不是机器</strong>。</p><p>一个连接可以通过客户端 - 服务器端的 IP 和端口唯一确定，这叫做套接字对</p><p>TCP，又被叫做字节流套接字（Stream Socket），注意我们这里先引入套接字 socket，套接字 socket 在后面几讲中将被反复提起，因为它实际上是网络编程的核心概念。当然，UDP 也有一个类似的叫法, 数据报套接字（Datagram Socket），一般分别以“SOCK_STREAM”与“SOCK_DGRAM”分别来表示 TCP 和 UDP 套接字。</p><p>网络编程核心逻辑：</p><p><img src="/blog/./assets/image-20240414180739038.png" alt="核心逻辑"></p><h3 id="更好地理解-socket：一个更直观的解释"><a href="#更好地理解-socket：一个更直观的解释" class="headerlink" title="更好地理解 socket：一个更直观的解释"></a>更好地理解 socket：一个更直观的解释</h3><p>你可以把整个 TCP 的网络交互和数据传输想象成打电话，顺着这个思路想象，socket 就好像是我们手里的电话机，connect 就好比拿着电话机拨号，而服务器端的 bind 就好比是去电信公司开户，将电话号码和我们家里的电话机绑定，这样别人就可以用这个号码找到你，listen 就好似人们在家里听到了响铃，accept 就好比是被叫的一方拿起电话开始应答。至此，三次握手就完成了，连接建立完毕。</p><p>接下来，拨打电话的人开始说话：“你好。”这时就进入了 write，接收电话的人听到的过程可以想象成 read（听到并读出数据），并且开始应答，双方就进入了 read&#x2F;write 的数据传输过程。</p><p>最后，拨打电话的人完成了此次交流，挂上电话，对应的操作可以理解为 close，接听电话的人知道对方已挂机，也挂上电话，也是一次 close。</p><p>在整个电话交流过程中，电话是我们可以和外面通信的设备，对应到网络编程的世界里，socket 也是我们可以和外界进行网络通信的途径。</p><p>（本文完）</p><p>汇报工作说结果<br>请示工作说方案<br>总结工作说流程<br>布置工作说标准</p><p>1、Java基础技术体系、JVM内存分配、垃圾回收、类装载机制、性能优化、反射机制、多线程、网络编程、常用数据结构和相关算法。<br>2、对面向对象的软件开发思想有清晰的认识、熟悉掌握常用的设计模式。<br>3、熟练掌握目前流行开源框架（spring／springmvc／ibatis）， 并且对其核心思想、实现原理有一定认知。</p><p>4、熟悉Oracle、MySQL等数据库开发与设计以及缓存系统Redis或 Memcached的设计和研发。<br>5、熟悉底层中间件、分布式技术（包括缓存、消息系统、热部署）、消息中间件：ActiveMQ、RabbitMQ、工作流中间 件：JBPM。<br>6、精通shell编程，熟练应用awk、sed、grep、strace、 tcudump、gdb等常用命令。</p><p>7、有大型分布式、高并发、高负载（大数据量）、高可用性系统设计开发经验。<br>8、对配置管理和敏捷研发模式有所了解（svn，git）。<br>9、熟悉常见的一些解决方案及其原理：单点登录、分布式缓存、SOA、全文检索、消息中间件，负载均衡、连接池、流计算等。<br>10、能大概知道市面上主流技术的特点及业务瓶颈。</p><p>11、大数据，非关系型数据库；数据整理，数据分析，数据挖掘<br>12、云计算，微服务框架（SpringBoot，SpringCloud）<br>13、数据安全和网络安全及加密</p><p>七要素：<br>形象气质<br>声音素质<br>情商<br>沟通力<br>演讲力<br>领导力<br>说服力（销售技能）</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>网络</category>
      
    </categories>
    
    
    <tags>
      
      <tag>HTTP</tag>
      
      <tag>HTTPS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Remnote常用快捷键和指令</title>
    <link href="/blog/2023/11/Remnote%E5%B8%B8%E7%94%A8%E5%BF%AB%E6%8D%B7%E9%94%AE%E5%92%8C%E6%8C%87%E4%BB%A4.html"/>
    <url>/blog/2023/11/Remnote%E5%B8%B8%E7%94%A8%E5%BF%AB%E6%8D%B7%E9%94%AE%E5%92%8C%E6%8C%87%E4%BB%A4.html</url>
    
    <content type="html"><![CDATA[<h2 id="快捷键"><a href="#快捷键" class="headerlink" title="快捷键"></a>快捷键</h2><p>搜索文档Ctrl + P<br>搜索文档（其他窗格）Ctrl + Shift + P<br>转到文档表Ctrl + Alt + O<br>快速添加Ctrl +’<br>显示键盘快捷键Ctrl + Alt + Shift + H<br>切换侧栏Alt + S<br>添加文档Alt + N<br>添加今天的文档Alt + D<br>向前导航Alt + 右<br>向后导航Alt + 左<br>打开知识库切换器Ctrl + Shift + Alt + O<br>操作系统：快速添加笔记到目前笔记下 Ctrl + Alt + Shift +’ Desktop<br>操作系统：专注于RemNote（从别的软件切换到RN） Ctrl + Alt + R Desktop </p><h2 id="指令"><a href="#指令" class="headerlink" title="指令"></a>指令</h2><figure class="highlight wren"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs wren">标签 <span class="hljs-string">&quot;##&quot;</span><br>双向链接 <span class="hljs-string">&quot;&#123;&#123;&quot;</span> 或者 <span class="hljs-string">&quot;<span class="hljs-char escape_">\r</span>ef&quot;</span><span class="hljs-operator">+</span><span class="hljs-string">&quot;Enter&quot;</span><br><span class="hljs-title class_">Emoji</span>表情 <span class="hljs-string">&quot;%%&quot;</span> 或者 <span class="hljs-string">&quot;<span class="hljs-char escape_">\e</span>moji&quot;</span> <span class="hljs-operator">+</span> <span class="hljs-string">&quot;Enter&quot;</span><br>日期 <span class="hljs-string">&quot;!!&quot;</span> 或者 <span class="hljs-string">&quot;\date&quot;</span><span class="hljs-operator">+</span><span class="hljs-string">&quot;Enter&quot;</span><br>别名 <span class="hljs-string">&quot;<span class="hljs-char escape_">\a</span>lias&quot;</span><span class="hljs-operator">+</span><span class="hljs-string">&quot;Enter&quot;</span> 或者 <span class="hljs-string">&quot;alt&quot;</span><span class="hljs-operator">+</span><span class="hljs-string">&quot;A&quot;</span><br>按照字母排序 <span class="hljs-string">&quot;\sort&quot;</span><span class="hljs-operator">+</span><span class="hljs-string">&quot;Enter&quot;</span><br>创建<span class="hljs-variable">TO</span><span class="hljs-operator">-</span><span class="hljs-variable">DO</span> <span class="hljs-string">&quot;<span class="hljs-char escape_">\t</span>odo&quot;</span> <span class="hljs-operator">+</span> <span class="hljs-string">&quot;Enter&quot;</span><br></code></pre></td></tr></table></figure><p>（完）</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>Remnote</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Remnote</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Docker安装Mysql</title>
    <link href="/blog/2023/11/Docker%E5%AE%89%E8%A3%85Mysql.html"/>
    <url>/blog/2023/11/Docker%E5%AE%89%E8%A3%85Mysql.html</url>
    
    <content type="html"><![CDATA[<p>mysql官方DockerHub地址：<a href="https://hub.docker.com/_/mysql">https://hub.docker.com/_/mysql</a></p><p>可选的环境变量：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sh">MYSQL_ROOT_PASSWORD<br>MYSQL_DATABASE<br>MYSQL_USER, MYSQL_PASSWORD<br>MYSQL_ALLOW_EMPTY_PASSWORD<br>MYSQL_RANDOM_ROOT_PASSWORD<br>MYSQL_ONETIME_PASSWORD<br>MYSQL_INITDB_SKIP_TZINFO<br></code></pre></td></tr></table></figure><p>创建一个环境变量配置文件，<code>vim env_file</code>，添加以下内容：</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">MYSQL_ROOT_PASSWORD</span>=root<br><span class="hljs-attr">MYSQL_DATABASE</span>=hello_world<br><span class="hljs-attr">MYSQL_USER</span>=foo<br><span class="hljs-attr">MYSQL_PASSWORD</span>=bar<br></code></pre></td></tr></table></figure><p>创建一个docker运行脚本，<code>vim docker_run.sh</code>,添加以下内容:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">docker run --name=mysql -d -p 3306:3306 --env_file=./env_file mysql<br></code></pre></td></tr></table></figure><p>编写完脚本运行:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">sh docekr_run.sh<br></code></pre></td></tr></table></figure><p>（完）</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>Docker</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Docker</tag>
      
      <tag>Mysql</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Java本地锁在分布式下存在的问题</title>
    <link href="/blog/2023/11/Java%E6%9C%AC%E5%9C%B0%E9%94%81%E5%9C%A8%E5%88%86%E5%B8%83%E5%BC%8F%E4%B8%8B%E5%AD%98%E5%9C%A8%E7%9A%84%E9%97%AE%E9%A2%98.html"/>
    <url>/blog/2023/11/Java%E6%9C%AC%E5%9C%B0%E9%94%81%E5%9C%A8%E5%88%86%E5%B8%83%E5%BC%8F%E4%B8%8B%E5%AD%98%E5%9C%A8%E7%9A%84%E9%97%AE%E9%A2%98.html</url>
    
    <content type="html"><![CDATA[<h3 id="本地锁的问题"><a href="#本地锁的问题" class="headerlink" title="本地锁的问题"></a>本地锁的问题</h3><p> 现象:本地锁在多节点下失效(集群分布式) </p><p> 原因:本地锁它只能锁住本地JVM进程中的多个线程，对于多个JVM进程的不同线程间是锁不住的 </p><p>怎么办？ </p><p>我们需要一种分布式锁，期望能在分布式环境下提供锁服务，并且达到本地锁的效果:不仅能锁住同一jvm进程下的不同线程，更要能锁住不同vm进程下的不同线程 </p><p>为什么需要分布式锁: </p><ol><li>为了效率:防止不同节点之间做相同的事情，浪费资源 (定时任务) </li><li>为了安全:有些事情在同一时间只允许一个线程去做</li></ol><p>分布式锁的特点: </p><ol><li>互斥性:不仅要在同一jvm进程下的不同线程间互斥， 更要在不同jvm进程下的不同线程间互斥 </li><li>锁超时:支持锁的自动释放，防止死锁 </li><li>正确，高效，高可用:解铃还须系铃人(加锁和解锁必须是同一个线程)，加锁和解锁操作一定要高效，提供锁的服务要具备容错性 </li><li>可重入:如果一个线程拿到了锁之后继续去获取锁还能获取到，我们称锁是可重入的方法的递归调用) </li><li>阻塞&#x2F;非阻塞:如果获取不到直接返回视为非阻塞的，如果获取不到会等待锁的释放直到获取锁或者等待超时，视为阻塞的</li><li>公平&#x2F;非公平:按照请求的顺序获取锁视为公平的</li></ol>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Debug</tag>
      
      <tag>SSH</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>使用SSH本地端口转发调试远程环境</title>
    <link href="/blog/2023/11/%E4%BD%BF%E7%94%A8SSH%E6%9C%AC%E5%9C%B0%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E8%B0%83%E8%AF%95%E8%BF%9C%E7%A8%8B%E7%8E%AF%E5%A2%83.html"/>
    <url>/blog/2023/11/%E4%BD%BF%E7%94%A8SSH%E6%9C%AC%E5%9C%B0%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91%E8%B0%83%E8%AF%95%E8%BF%9C%E7%A8%8B%E7%8E%AF%E5%A2%83.html</url>
    
    <content type="html"><![CDATA[<h2 id="本地开发环境配置"><a href="#本地开发环境配置" class="headerlink" title="本地开发环境配置"></a>本地开发环境配置</h2><p>SSH -L是SSH命令中的一个选项，用于在SSH连接中设置本地端口转发。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">ssh -L <span class="hljs-selector-attr">[本地地址:]</span>本地端口:目标地址:目标端口 用户@远程主机<br></code></pre></td></tr></table></figure><ul><li><p><code>[本地地址:]本地端口</code>：这是本地端口转发的设置。你可以选择性地指定本地地址（通常是”localhost”或”127.0.0.1”），然后指定一个本地端口。这个本地端口将会被SSH客户端监听，用于接收来自本地系统的连接。</p></li><li><p><code>目标地址:目标端口</code>：这是你希望将本地连接转发到的远程目标地址和端口。当本地端口接收到连接时，SSH客户端将会将这些连接转发到目标地址和端口上。</p></li><li><p><code>用户@远程主机</code>：SSH连接的目标远程主机和用户。</p></li></ul><p>SSH -L选项允许你在本地系统和远程系统之间创建一个安全的通道，以便将本地端口上的流量转发到远程主机的指定端口。这对于访问受限制的资源或者建立安全的连接非常有用，例如在本地计算机上运行一个服务，但需要通过SSH连接到远程服务器来访问该服务。</p><p>例如，以下是一个使用SSH -L进行本地端口转发的示例：</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ssh</span> -L <span class="hljs-number">8081</span>:example.com:<span class="hljs-number">8080</span> user@remote-server<br></code></pre></td></tr></table></figure><p>这将会在本地主机上的端口8081上创建一个监听，当有连接时，它将把连接转发到远程服务器example.com的端口8080上。这样，你可以通过访问本地主机的端口8080来访问远程服务器上的8080端口Web服务。</p><p><img src="/blog/./assets/image-20231104094159914.png" alt="SSH本地端口转发"></p><h2 id="线上预发环境配置"><a href="#线上预发环境配置" class="headerlink" title="线上预发环境配置"></a>线上预发环境配置</h2><p><img src="/blog/./assets/image-20231104095120831.png" alt="预发环境java配置参数"></p><p>通过IDEA工具生成的配置参数做为JVM选项设置到线上的机器中。其中：</p><p><code>-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=*:8080</code> 是一个Java虚拟机（JVM）调试选项，用于启用Java远程调试协议（JDWP）的调试代理，并指定了监听的端口号为8080。这个选项的各个部分的含义如下：</p><ul><li><p><code>-agentlib:jdwp</code>：这部分表示要启用JDWP调试代理库。</p></li><li><p><code>transport=dt_socket</code>：这部分指定了JDWP调试代理的通信传输协议，这里使用的是Socket通信。</p></li><li><p><code>server=y</code>：这部分表示JDWP代理将作为服务器运行，等待调试器连接。</p></li><li><p><code>suspend=n</code>：这部分表示应用程序在启动时不会挂起，即不会等待调试器连接。</p></li><li><p><code>address=*:8080</code>：这部分指定了JDWP代理监听的地址和端口。在这个示例中，<code>*</code> 表示监听所有可用的网络接口，而 <code>8080</code> 是监听的端口号。这意味着JDWP代理将在所有网络接口上的8080端口上等待调试器连接。</p></li></ul><p>这个选项用于启用Java应用程序的远程调试功能，允许你连接到正在运行的Java应用程序，以进行代码调试、观察变量和跟踪应用程序的执行。确保在使用这个选项时谨慎操作，只应该在开发和调试阶段使用。不要在生产环境中启用JDWP调试代理，以避免潜在的安全漏洞。</p><p>（本文完）</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Debug</tag>
      
      <tag>SSH</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Maven问题定位及解决</title>
    <link href="/blog/2023/11/Maven%E9%97%AE%E9%A2%98%E5%AE%9A%E4%BD%8D%E5%8F%8A%E8%A7%A3%E5%86%B3.html"/>
    <url>/blog/2023/11/Maven%E9%97%AE%E9%A2%98%E5%AE%9A%E4%BD%8D%E5%8F%8A%E8%A7%A3%E5%86%B3.html</url>
    
    <content type="html"><![CDATA[<h2 id="Since-Maven-3-8-1-http-repositories-are-blocked"><a href="#Since-Maven-3-8-1-http-repositories-are-blocked" class="headerlink" title="Since Maven 3.8.1 http repositories are blocked"></a>Since Maven 3.8.1 http repositories are blocked</h2><p>在使用Idea时，已经默认带了Maven插件，所以无需单独安装Maven即能使用。</p><p>进入Idea的Maven插件目录：</p><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vbnet"><span class="hljs-symbol">C:</span>\Program Files\JetBrains\IntelliJ IDEA Community Edition <span class="hljs-number">2023.1</span>\plugins\maven\<span class="hljs-keyword">lib</span>\maven3\conf<br></code></pre></td></tr></table></figure><p>编辑setting.xml文件，并注释以下内容：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs xml"> <span class="hljs-comment">&lt;!-- </span><br><span class="hljs-comment">  &lt;mirror&gt;</span><br><span class="hljs-comment">    &lt;id&gt;maven-default-http-blocker&lt;/id&gt;</span><br><span class="hljs-comment">    &lt;mirrorOf&gt;external:http:*&lt;/mirrorOf&gt;</span><br><span class="hljs-comment">    &lt;name&gt;Pseudo repository to mirror external repositories initially using HTTP.&lt;/name&gt;</span><br><span class="hljs-comment">    &lt;url&gt;http://0.0.0.0/&lt;/url&gt;</span><br><span class="hljs-comment">    &lt;blocked&gt;true&lt;/blocked&gt;</span><br><span class="hljs-comment">  &lt;/mirror&gt;</span><br><span class="hljs-comment">--&gt;</span><br></code></pre></td></tr></table></figure><p>保存后，在Idea刷新并下载Maven依赖不再报错。</p><p>（完）</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>Maven</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>Maven</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ConcurrentHashMap的键和值都不能为空</title>
    <link href="/blog/2023/11/ConcurrentHashMap%E7%9A%84%E9%94%AE%E5%92%8C%E5%80%BC%E9%83%BD%E4%B8%8D%E8%83%BD%E4%B8%BA%E7%A9%BA.html"/>
    <url>/blog/2023/11/ConcurrentHashMap%E7%9A%84%E9%94%AE%E5%92%8C%E5%80%BC%E9%83%BD%E4%B8%8D%E8%83%BD%E4%B8%BA%E7%A9%BA.html</url>
    
    <content type="html"><![CDATA[<h2 id="ConcurrentHashMap的键和值都不能为空"><a href="#ConcurrentHashMap的键和值都不能为空" class="headerlink" title="ConcurrentHashMap的键和值都不能为空"></a>ConcurrentHashMap的键和值都不能为空</h2><p>查看源码，在 put 方法里面，如果 key 或者 value 为空，则抛出空指针异常。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">final</span> V <span class="hljs-title function_">putVal</span><span class="hljs-params">(K key, V value, <span class="hljs-type">boolean</span> onlyIfAbsent)</span> &#123;<br>    <span class="hljs-keyword">if</span> (key == <span class="hljs-literal">null</span> || value == <span class="hljs-literal">null</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NullPointerException</span>();<br>    <span class="hljs-type">int</span> <span class="hljs-variable">hash</span> <span class="hljs-operator">=</span> spread(key.hashCode());<br>    <span class="hljs-type">int</span> <span class="hljs-variable">binCount</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>    ...<br>&#125;<br></code></pre></td></tr></table></figure><p>这是为了避免在多线程环境下出现歧义问题。</p><h3 id="key不能为null的原因"><a href="#key不能为null的原因" class="headerlink" title="key不能为null的原因"></a>key不能为null的原因</h3><p>线程 t1 调用 containsKey 方法判断 key 是否存在，假设当前这个 key 不存在，本来应该返回 false。</p><p>但是在 T1 线程返回之前，正好有一个 T2 线程插入了这个 key，但是 value 为 null。</p><p>这就导致原本 T1 线程返回的结果有可能是 true，有可能是 false，取决于 T1 和 T2 线程的执行顺序。</p><p><img src="/blog/./assets/image-20231103162609717.png" alt="image-20231103162609717"></p><h3 id="value不能为null的原因"><a href="#value不能为null的原因" class="headerlink" title="value不能为null的原因"></a>value不能为null的原因</h3><p>到底是插入的 null值，还是集合中不存在才返回的 null值。这就产生了歧义问题。</p><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p> ConcurrentHashMap 又是一个线程安全的集合，所以自然就不允许 key 或者 value 为 null。</p><p>而 HashMap 中是允许存 null 的，因为它不需要考虑到线程安全性问题。</p><p>ConcurrentHashMap 的作者 Doug Lea对于 ConcurrentHashMap 不允许插入 null 值的回答。</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs text">The main reason that nulls aren&#x27;t allowed in ConcurrentMaps<br><br>(ConcurrentHashMaps, ConcurrentSkipListMaps) is that ambiguities that may<br>be just barely tolerable in non-concurrent maps can&#x27;t be accommodated. The<br>main one is that if map.get(key) returns null, you can&#x27;t detect whether the key<br>explicitly maps to null vs the key isn&#x27;t mapped.In a non-concurrent map, you<br>can check this via map.contains(key),but in a concurrent one, the map might<br>have changed between calls. <br><br>Further digressing: I personally think that allowingnulls in Maps (also Sets) is an<br>open invitation for programsto contain errors that remain undetected untilthey<br>break at just the wrong time. (Whether to allow nulls evenin non-concurrent<br>Maps/Sets is one of the few design issues surroundingCollections that Josh<br>Bloch and I have long disagreed about.)<br><br>It is very difficult to check for null keys and valuesin my entire application . Would it be easier to declare somewherestatic final Object NULL = new<br>Object();and replace all use of nulls in uses of maps with NULL?<br>-Dougv<br></code></pre></td></tr></table></figure><p>（本文完）</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>并发编程</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>ConcurrentHashMap</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>栈</title>
    <link href="/blog/2023/11/%E6%A0%88.html"/>
    <url>/blog/2023/11/%E6%A0%88.html</url>
    
    <content type="html"><![CDATA[<h2 id="栈"><a href="#栈" class="headerlink" title="栈"></a>栈</h2><p>栈这种数据结构，在计算机中有着广泛地运用，比如编程语言中函数的调用、操作系统中从用户态到内核态寄存器的保存、网络消息的处理等都会用到栈。</p><p>栈是先进后出（LIFO）顺序。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java">Stack&lt;Character&gt; stack = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Stack</span>&lt;&gt;();<br>t.push(<span class="hljs-string">&#x27;a&#x27;</span>);<br>t.push(<span class="hljs-string">&#x27;b&#x27;</span>);<br><span class="hljs-comment">// 这里得到栈顶元素&#x27;b&#x27;</span><br>t.peek(); <br><span class="hljs-comment">// 这里将栈顶元素&#x27;b&#x27;弹出</span><br>t.pop();  <br><span class="hljs-comment">// 此时栈顶元素为&#x27;a&#x27;</span><br>t.peek(); <br><span class="hljs-comment">// 这里将栈顶元素&#x27;a&#x27;弹出</span><br>t.pop();  <br></code></pre></td></tr></table></figure><p>对应的代码动画演示：</p><p><img src="/blog/./assets/Cgp9HWA4jJaAMKH7ADCb3Og8L1Q358.gif" alt="栈动画演示"></p><h2 id="判断字符括号是否合法"><a href="#判断字符括号是否合法" class="headerlink" title="判断字符括号是否合法"></a>判断字符括号是否合法</h2><p>【题目】字符串中只有字符’(‘和’)’。合法字符串需要括号可以配对。比如：<br>输入：”()”<br>输出：true<br>解释：()，()()，(())是合法的。)(，()(，(()是非法的。<br>请你实现一个函数，来判断给定的字符串是否合法。<br>boolean isValid(String s);</p><p>通过四步分析法：</p><ol><li><p>模拟：模拟题目的运行。</p></li><li><p>规律：尝试总结出题目的一般规律和特点。</p></li><li><p>匹配：找到符合这些特点的数据结构与算法。</p></li><li><p>边界：考虑特殊情况。</p></li></ol><h3 id="模拟"><a href="#模拟" class="headerlink" title="模拟"></a>模拟</h3><p>首先我们以字符串 s &#x3D; “()()(())”，进行模拟，如下动图所示：</p><p><img src="/blog/./assets/CioPOWA4jh2AHCJwACmFB7AcuZA768.gif" alt="括号匹配动画演示"></p><h3 id="规律"><a href="#规律" class="headerlink" title="规律"></a>规律</h3><ul><li>每个左括号’(‘或者右括号’)’都完成配对，才是合法的。</li><li>配对可以通过消除法来消掉合法的括号，如果最后没有任何字符了，那么就是合法字符串。</li><li>奇数长度的字符串总是非法的。</li></ul><h3 id="匹配"><a href="#匹配" class="headerlink" title="匹配"></a>匹配</h3><p>可以用栈来进行消除法的模拟。</p><h3 id="边界"><a href="#边界" class="headerlink" title="边界"></a>边界</h3><p>找到问题匹配的算法或者数据结构之后，并不是马上写代码，而是要考虑一些边界问题，也就是一些特殊情况：</p><ul><li><p>字符串为空</p></li><li><p>字符串只有 1 个或者奇数个</p></li><li><p>字符串是”(((())))”嵌套很多层的是否可以处理</p></li></ul><p><img src="/blog/./assets/Cgp9HWA4kDOANTojAGASkY8p8QQ593.gif" alt="栈模拟消除"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isValid</span><span class="hljs-params">(String s)</span> &#123;<br>    <span class="hljs-keyword">if</span> (s == <span class="hljs-literal">null</span> || s.length() == <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (s.length() % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br><br>    Stack&lt;Character&gt; t = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Stack</span>&lt;Character&gt;();<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; s.length(); i++) &#123;<br>        <span class="hljs-type">char</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> s.charAt(i);<br>        <span class="hljs-keyword">if</span> (c == <span class="hljs-string">&#x27;(&#x27;</span>) &#123;<br>            <span class="hljs-comment">// 如果是&#x27;(&#x27;，那么压栈</span><br>            t.push(c);<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (c == <span class="hljs-string">&#x27;)&#x27;</span>) &#123;<br>            <span class="hljs-comment">// 如果是&#x27;)&#x27;，那么就尝试弹栈</span><br>            <span class="hljs-keyword">if</span> (t.empty()) &#123;<br>                <span class="hljs-comment">// 如果弹栈失败，那么返回false</span><br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>            &#125;<br>            t.pop();<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> t.empty();<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="复杂度分析"><a href="#复杂度分析" class="headerlink" title="复杂度分析"></a>复杂度分析</h3><p>每个字符只入栈一次，出栈一次，所以时间复杂度为 $O(N)$，而空间复杂度为 $O(N)$，因为最差情况下可能会把整个字符串都入栈。<br>我们还需要从两个角度进行深度思考：</p><h4 id="深度，比如这种解法还可以怎么优化呢？"><a href="#深度，比如这种解法还可以怎么优化呢？" class="headerlink" title="深度，比如这种解法还可以怎么优化呢？"></a>深度，比如这种解法还可以怎么优化呢？</h4><p>栈中元素都相同时，实际上没有必要使用栈，只需要记录栈中元素个数。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isValid2</span><span class="hljs-params">(String s)</span> &#123;<br>    <span class="hljs-keyword">if</span> (s == <span class="hljs-literal">null</span> || s.length() == <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>    <span class="hljs-keyword">if</span> (s.length() % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br><br>    <span class="hljs-type">int</span> <span class="hljs-variable">leftBraceNumber</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; s.length(); i++) &#123;<br>        <span class="hljs-type">char</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> s.charAt(i);<br>        <span class="hljs-keyword">if</span> (c == <span class="hljs-string">&#x27;(&#x27;</span>) &#123;<br>            ++leftBraceNumber;<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (c == <span class="hljs-string">&#x27;)&#x27;</span>) &#123;<br>            <span class="hljs-keyword">if</span> (leftBraceNumber &lt;= <span class="hljs-number">0</span>) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>            &#125;<br>            --leftBraceNumber;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> leftBraceNumber == <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="广度，比如这种解法具有普适性吗？"><a href="#广度，比如这种解法具有普适性吗？" class="headerlink" title="广度，比如这种解法具有普适性吗？"></a>广度，比如这种解法具有普适性吗？</h4><p>拓展：给出一个仅包含字符’(‘,’)’,’{‘,’}’,’[‘和’]’,的字符串，判断给出的字符串是否是合法的括号序列<br>括号必须以正确的顺序关闭，”()”和”()[]{}”都是合法的括号序列，但”(]”和”([)]”不合法。</p><p>方法一：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java">Stack&lt;Character&gt; stk = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Stack</span>&lt;&gt;();<br><br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; s.length(); i++) &#123;<br>    <span class="hljs-comment">// 根据字符类型，执行不同的操作</span><br>    <span class="hljs-keyword">switch</span> (s.charAt(i)) &#123;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;(&#x27;</span>:<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;[&#x27;</span>:<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;&#123;&#x27;</span>:<br>            <span class="hljs-comment">// 将该左括号入栈，表示待匹配</span><br>            stk.push(s.charAt(i));<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;)&#x27;</span>:<br>            <span class="hljs-comment">// 检查堆栈是否为空，或者堆栈顶部的字符不是左括号 &#x27;(&#x27;</span><br>            <span class="hljs-keyword">if</span> (stk.empty() || stk.peek() != <span class="hljs-string">&#x27;(&#x27;</span>)<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">// 括号不匹配，返回 false</span><br>            stk.pop();<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;]&#x27;</span>:<br>            <span class="hljs-keyword">if</span> (stk.empty() || stk.peek() != <span class="hljs-string">&#x27;[&#x27;</span>)<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>            stk.pop();<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;&#125;&#x27;</span>:<br>            <span class="hljs-keyword">if</span> (stk.empty() || stk.peek() != <span class="hljs-string">&#x27;&#123;&#x27;</span>)<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>            stk.pop();<br>            <span class="hljs-keyword">break</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 如果所有字符都遍历完并且堆栈为空，表示括号匹配成功，返回 true，否则返回 false</span><br><span class="hljs-keyword">return</span> stk.empty();<br></code></pre></td></tr></table></figure><p>方法二：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// 使用HashMap存储括号的对应关系</span><br>Map&lt;Character, Character&gt; bracketPairs = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br>bracketPairs.put(<span class="hljs-string">&#x27;)&#x27;</span>, <span class="hljs-string">&#x27;(&#x27;</span>);<br>bracketPairs.put(<span class="hljs-string">&#x27;]&#x27;</span>, <span class="hljs-string">&#x27;[&#x27;</span>);<br>bracketPairs.put(<span class="hljs-string">&#x27;&#125;&#x27;</span>, <span class="hljs-string">&#x27;&#123;&#x27;</span>);<br><br>Stack&lt;Character&gt; stk = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Stack</span>&lt;&gt;();<br><br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; s.length(); i++) &#123;<br>    <span class="hljs-type">char</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> s.charAt(i);<br>    <span class="hljs-comment">// 如果字符是右括号</span><br>    <span class="hljs-keyword">if</span> (bracketPairs.containsKey(c)) &#123;<br>        <span class="hljs-type">char</span> <span class="hljs-variable">topElement</span> <span class="hljs-operator">=</span> stk.empty() ? <span class="hljs-string">&#x27;#&#x27;</span> : stk.pop();<br>        <span class="hljs-keyword">if</span> (topElement != bracketPairs.get(c)) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-comment">// 如果字符是左括号，直接入栈</span><br>        stk.push(c);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 最后只需检查堆栈是否为空即可</span><br><span class="hljs-keyword">return</span> stk.isEmpty();<br></code></pre></td></tr></table></figure><h2 id="大鱼吃小鱼"><a href="#大鱼吃小鱼" class="headerlink" title="大鱼吃小鱼"></a>大鱼吃小鱼</h2><p>【题目】在水中有许多鱼，可以认为这些鱼停放在 x 轴上。再给定两个数组 Size，Dir，Size[i] 表示第 i 条鱼的大小，Dir[i] 表示鱼的方向 （0 表示向左游，1 表示向右游）。这两个数组分别表示鱼的大小和游动的方向，并且两个数组的长度相等。鱼的行为符合以下几个条件:</p><p>所有的鱼都同时开始游动，每次按照鱼的方向，都游动一个单位距离；</p><p>当方向相对时，大鱼会吃掉小鱼；</p><p>鱼的大小都不一样。</p><p>输入：Size &#x3D; [4, 2, 5, 3, 1], Dir &#x3D; [1, 1, 0, 0, 0]<br>输出：3<br>请完成以下接口来计算还剩下几条鱼？<br>int solution(int[] Size, int[] Dir);</p><h3 id="模拟-1"><a href="#模拟-1" class="headerlink" title="模拟"></a>模拟</h3><p>Size &#x3D; [4, 3, 2, 1, 5], Dir &#x3D; [0, 1, 0, 0, 0]</p><pre><code class=" mermaid">timeline    title  大鱼吃小鱼    初始 : [4, 3, 2, 1, 5]    第一次 : [4, 3, 1, 5]    第二次 : [4, 3, 5]    第三次 : [4, 5]</code></pre><h3 id="规律-1"><a href="#规律-1" class="headerlink" title="规律"></a>规律</h3><p>通过模拟，可以发现如下规律:</p><ul><li><p>如果两条鱼相对而游时，那么较小的鱼会被吃掉；</p></li><li><p>其他情况没有鱼被吃掉。</p></li></ul><h3 id="匹配-1"><a href="#匹配-1" class="headerlink" title="匹配"></a>匹配</h3><p>我们发现，活下来的鱼的行为就是一个栈。每当有新的鱼要进来的时候，就会与栈顶的鱼进行比较。那么我们匹配到的算法就是栈了。</p><h3 id="边界-1"><a href="#边界-1" class="headerlink" title="边界"></a>边界</h3><ul><li><p>所有的鱼都朝着一个方向游；</p></li><li><p>一条鱼吃掉了其他的所有鱼。</p></li></ul><p>代码：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">solution</span><span class="hljs-params">(<span class="hljs-type">int</span>[] fishSize, <span class="hljs-type">int</span>[] fishDirection)</span> &#123;<br>    <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">fishNumber</span> <span class="hljs-operator">=</span> fishSize.length;<br>    <span class="hljs-keyword">if</span> (fishNumber &lt;= <span class="hljs-number">1</span>) &#123;<br>        <span class="hljs-keyword">return</span> fishNumber; <span class="hljs-comment">// 如果只有一个或没有鱼，直接返回鱼的数量，不需要模拟碰撞</span><br>    &#125;<br><br>    <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">left</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;  <span class="hljs-comment">// 定义常量来表示鱼的方向，0 表示向左游</span><br>    <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">right</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; <span class="hljs-comment">// 1 表示向右游</span><br><br>    Stack&lt;Integer&gt; stack = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Stack</span>&lt;&gt;(); <span class="hljs-comment">// 创建一个栈来模拟鱼的相遇和碰撞情况</span><br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; fishNumber; i++) &#123;<br>        <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">curFishDirection</span> <span class="hljs-operator">=</span> fishDirection[i]; <span class="hljs-comment">// 获取当前鱼的方向</span><br>        <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">curFishSize</span> <span class="hljs-operator">=</span> fishSize[i]; <span class="hljs-comment">// 获取当前鱼的大小</span><br><br>        <span class="hljs-type">boolean</span> <span class="hljs-variable">hasEat</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">// 标志当前鱼是否已经吃掉了其他鱼</span><br><br>        <span class="hljs-keyword">while</span> (!stack.empty() &amp;&amp; fishDirection[stack.peek()] == right &amp;&amp; curFishDirection == left) &#123;<br>            <span class="hljs-comment">// 如果栈不为空，栈顶鱼的方向是向右游，当前鱼的方向是向左游，它们可能相遇</span><br>            <span class="hljs-keyword">if</span> (fishSize[stack.peek()] &gt; curFishSize) &#123;<br>                hasEat = <span class="hljs-literal">true</span>; <span class="hljs-comment">// 如果栈顶鱼的大小大于当前鱼，当前鱼被吃掉</span><br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br>            stack.pop(); <span class="hljs-comment">// 否则栈顶鱼被吃掉，从栈中弹出</span><br>        &#125;<br>        <span class="hljs-keyword">if</span> (!hasEat) &#123;<br>            stack.push(i); <span class="hljs-comment">// 如果当前鱼没有被吃掉，将其加入栈中</span><br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> stack.size(); <span class="hljs-comment">// 返回栈中剩下的鱼的数量，它们是不会被吃掉的鱼</span><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="复杂度分析-1"><a href="#复杂度分析-1" class="headerlink" title="复杂度分析"></a>复杂度分析</h3><p>每只鱼只入栈一次，出栈一次，所以时间复杂度 为 $O(N)$，而空间复杂度为 $O(N)$，因为最差情况下可能把所有的鱼都入栈。</p><p><strong>在线题库</strong></p><ul><li><a href="https://app.codility.com/programmers/lessons/7-stacks_and_queues/fish/start/">7-stacks_and_queues&#x2F;fish</a></li></ul><h2 id="单调栈"><a href="#单调栈" class="headerlink" title="单调栈"></a>单调栈</h2><p>单调栈就是指栈中的元素必须是按照升序排列的栈，或者是降序排列的栈。对于这两种排序方式的栈，升序排列的栈称为递增栈，降序排列的栈称为递减栈。</p><h3 id="找出数组中右边比我小的元素"><a href="#找出数组中右边比我小的元素" class="headerlink" title="找出数组中右边比我小的元素"></a>找出数组中右边比我小的元素</h3><p>【题目】一个整数数组 A，找到每个元素：右边第一个比我小的下标位置，没有则用 -1 表示。<br>输入：[5, 2]<br>输出：[1, -1]<br>解释：因为元素 5 的右边离我最近且比我小的位置应该是 A[1]，最后一个元素 2 右边没有比 2 小的元素，所以应该输出 -1。<br>接口：int[] findRightSmall(int[] A);</p><h3 id="模拟-2"><a href="#模拟-2" class="headerlink" title="模拟"></a>模拟</h3><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-string">[1, 2, 4, 9, 4, 0, 5]</span><br></code></pre></td></tr></table></figure><h3 id="规律-2"><a href="#规律-2" class="headerlink" title="规律"></a>规律</h3><ul><li><p>小的数要与大的数配对</p></li><li><p>小的数会消除大的数</p></li></ul><h3 id="匹配-2"><a href="#匹配-2" class="headerlink" title="匹配"></a>匹配</h3><p>单调栈</p><p>图示：</p><p><img src="/blog/./assets/Cgp9HWA4qkaALlpRAHsvPijzTIg101.gif" alt="递增栈动画演示"></p><ol><li>首先将 A[0] &#x3D; 1 的下标 0 入栈。</li><li>将 A[1] &#x3D; 2 的下标 1 入栈。满足单调栈。</li><li>将 A[2] &#x3D; 4 的下标 2 入栈。满足单调栈。</li><li>将 A[3] &#x3D; 9 的下标 3 入栈。满足单调栈。</li><li>将 A[4] &#x3D; 4 的下标 4 入栈时，不满足单调性，需要将 A[3] &#x3D; 9 从栈中弹出去。下标 4 将栈中下标 3 弹出栈，记录 A[3] 右边更小的是 index &#x3D; 4。</li><li>将 A[5] &#x3D; 0 的下标 5 入栈时，不满足单调性，需要将 A[4] &#x3D; 4 从栈中弹出去。下标 5 将下标 4 弹出栈，记录 A[4] 右边更小的是 index &#x3D; 5。A[5] &#x3D; 0 会将栈中的下标 0, 1, 2 都弹出栈，因此也需要记录相应下标右边比其小的下标为 5，再将 A[5] &#x3D; 0 的下标 5 放入栈中。</li><li>将 A[6] &#x3D; 5 的下标 6 放入栈中。满足单调性。</li><li>此时，再也没有元素要入栈了，那么栈中的元素右边没有比其更小的元素。因此设置为 -1.</li></ol><p>代码如下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span>[] findRightSmall(<span class="hljs-type">int</span>[] A) &#123;<br>    <span class="hljs-type">int</span>[] ans = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[A.length]; <span class="hljs-comment">// 创建一个数组来存储结果，初始值为0</span><br><br>    Stack&lt;Integer&gt; stack = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Stack</span>&lt;&gt;(); <span class="hljs-comment">// 创建一个栈，用于跟踪元素的索引</span><br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; A.length; i++) &#123;<br>        <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">x</span> <span class="hljs-operator">=</span> A[i]; <span class="hljs-comment">// 获取当前数组元素的值</span><br>        <span class="hljs-keyword">while</span> (!stack.empty() &amp;&amp; A[stack.peek()] &gt; x) &#123;<br>            <span class="hljs-comment">// 当栈不为空且栈顶元素的值大于当前元素的值时，表示找到了右边第一个比当前元素小的元素</span><br>            ans[stack.peek()] = i; <span class="hljs-comment">// 更新结果数组，将栈顶元素对应的位置设置为当前索引 i</span><br>            stack.pop(); <span class="hljs-comment">// 弹出栈顶元素，因为它已经找到了右边第一个比它小的元素</span><br>        &#125;<br>        stack.push(i); <span class="hljs-comment">// 将当前索引 i 压入栈，以便后续比较</span><br>    &#125;<br><br>    <span class="hljs-keyword">while</span> (!stack.empty()) &#123;<br>        <span class="hljs-comment">// 处理剩下的栈中元素，它们没有右边比自己小的元素</span><br>        ans[stack.peek()] = -<span class="hljs-number">1</span>; <span class="hljs-comment">// 将结果数组中对应位置设置为 -1</span><br>        stack.pop(); <span class="hljs-comment">// 弹出栈顶元素</span><br>    &#125;<br>    <span class="hljs-keyword">return</span> ans; <span class="hljs-comment">// 返回包含每个元素右边第一个比它小的元素索引的结果数组</span><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="复杂度分析-2"><a href="#复杂度分析-2" class="headerlink" title="复杂度分析"></a>复杂度分析</h3><p>每个元素只入栈一次，出栈一次，所以时间复杂度为$O(N)$，而空间复杂度为$O(N)$，因为最差情况可能会把所有的元素都入栈。</p><h2 id="字典序最小的-k-个数的子序列"><a href="#字典序最小的-k-个数的子序列" class="headerlink" title="字典序最小的 k 个数的子序列"></a>字典序最小的 k 个数的子序列</h2><h3 id="模拟-3"><a href="#模拟-3" class="headerlink" title="模拟"></a>模拟</h3><h3 id="规律-3"><a href="#规律-3" class="headerlink" title="规律"></a>规律</h3><h3 id="匹配-3"><a href="#匹配-3" class="headerlink" title="匹配"></a>匹配</h3><h3 id="边界-2"><a href="#边界-2" class="headerlink" title="边界"></a>边界</h3><ul><li>假设数组右边有一个最小的数，这个最小的数会把左边的数全部都消掉，然后递增栈里面就只剩下这 1 个数了。这跟题意有点不符合，题意需要的是找到 k &#x3D; 2 个出来。<ul><li>解决：当剩下的数字个数与栈中的元素刚好能凑够 k 个数时，就不能再消除了，代码如下 :rightLeftNumber + stack.size() &#x3D;&#x3D; k</li></ul></li><li>如果数组是一个升序的数组，那么此时所有的元素都会被压栈。栈中的数目有可能远远超出 k 个。<ul><li>解决：只需要把栈中的多出来的数字弹出来即可。</li></ul></li></ul><h2 id="栈总结"><a href="#栈总结" class="headerlink" title="栈总结"></a>栈总结</h2><p><img src="/blog/./assets/CioPOWA4q6qASB-UAADhj7uzOwg933.png" alt="栈zsj"></p><p>(完)</p><p><strong>在线题库</strong></p><ul><li><a href="https://www.nowcoder.com/practice/37548e94a270412c8b9fb85643c8ccc2">有效括号序列</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>数据结构和算法</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>栈</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>解决Git在终端中文乱码的问题</title>
    <link href="/blog/2023/11/%E8%A7%A3%E5%86%B3Git%E5%9C%A8%E7%BB%88%E7%AB%AF%E4%B8%AD%E6%96%87%E4%B9%B1%E7%A0%81%E7%9A%84%E9%97%AE%E9%A2%98.html"/>
    <url>/blog/2023/11/%E8%A7%A3%E5%86%B3Git%E5%9C%A8%E7%BB%88%E7%AB%AF%E4%B8%AD%E6%96%87%E4%B9%B1%E7%A0%81%E7%9A%84%E9%97%AE%E9%A2%98.html</url>
    
    <content type="html"><![CDATA[<h2 id="解决Git在命令行中文显示乱码"><a href="#解决Git在命令行中文显示乱码" class="headerlink" title="解决Git在命令行中文显示乱码"></a>解决Git在命令行中文显示乱码</h2><p>将git配置文件 <code>core.quotepath</code>项设置为<code>false</code>。<code>quotepath</code>表示引用路径，加上<code>--global</code>表示全局配置:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">git config --global core.quotepath <span class="hljs-literal">false</span><br></code></pre></td></tr></table></figure><p>（本文完）</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>Git</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Git</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Redis大Key怎么处理</title>
    <link href="/blog/2023/11/Redis%E5%A4%A7Key%E6%80%8E%E4%B9%88%E5%A4%84%E7%90%86.html"/>
    <url>/blog/2023/11/Redis%E5%A4%A7Key%E6%80%8E%E4%B9%88%E5%A4%84%E7%90%86.html</url>
    
    <content type="html"><![CDATA[<h2 id="什么是大Key"><a href="#什么是大Key" class="headerlink" title="什么是大Key"></a>什么是大Key</h2><p>BigKey称为大Key，通常以Key对应Value的存储大小，或者Key对应Value的数量来进行综合判断。对于大Key也没有严格的定义区分，针对String与非String结构，给出如下定义：</p><ul><li>String：String类型的 Key 对应的 Value 超过 10KB</li><li>非String结构（Hash，Set，ZSet，List）：Value的数量达到10000个，或者Vaule的总大小为100KB</li><li>集群中Key的总数超过1亿</li></ul><h2 id="产生原因"><a href="#产生原因" class="headerlink" title="产生原因"></a>产生原因</h2><ol><li>数据结构设置不合理，例如集合中元素唯一时，应该使用Set替换List；</li><li>针对业务缺少预估性，没有预见Value动态增长；</li><li>Key没有设置过期时间，把缓存当成垃圾桶，一直再往里面扔，但是从不处理</li></ol><h2 id="存在危害"><a href="#存在危害" class="headerlink" title="存在危害"></a>存在危害</h2><ul><li>数据倾斜</li></ul><p>redis数据倾斜分为<strong>数据访问倾斜和数据量倾</strong>斜，会导致该Key所在的数据分片节点CPU使用率、带宽使用率升高，从而影响该分片上所有Key的处理。</p><p><strong>数据访问倾斜</strong>：某节点中key的QPS高于其他节点中的Key</p><p><strong>数据量倾斜</strong>：某节点中key的大小高于其他节点中的Key</p><ul><li>网络传输延迟</li></ul><p>当有大key时，单次操作时间延长，导致网络阻塞。</p><ul><li>慢查询</li></ul><p>严重影响 QPS 、TP99 等指标，对大Key进行的慢操作会导致后续的命令被阻塞，从而导致一系列慢查询。</p><ul><li>CPU压力</li></ul><p>内存中数据量过大，就会造成CPU负载过高。单个分片cpu占用率过高，其他分片无法拥有cpu资源，从而被影响。</p><ul><li>持久化备份</li></ul><p>大 key 对持久化也有些影响。fork 操作会拷贝父进程的页表项，如果过大，会占用更多页表，主线程阻塞拷贝需要一定的时间。</p><h2 id="检测大Key"><a href="#检测大Key" class="headerlink" title="检测大Key"></a>检测大Key</h2><ul><li><p>redis-cli –bigkeys</p><p>执行redis-cli的–bigkeys选项</p></li><li><p>redis-rdb-tools</p></li></ul><p>​<a href="https://github.com/sripathikrishnan/redis-rdb-tools">https://github.com/sripathikrishnan/redis-rdb-tools</a></p><h2 id="应对策略"><a href="#应对策略" class="headerlink" title="应对策略"></a>应对策略</h2><ul><li>设置过期时间，尽量过期时间分散，防止大Key同一时间过期</li><li>把大Key分割成小key来处理，比如存储为String类型的JSON，可以删除不使用的Filed；</li></ul><p>例如对象为{“userName”:”张三”,”ciyt”:”北京”}，如果只需要用到userName属性，那就定义新对象，只具有userName属性{“userName”:”张三”}，精简缓存中数据。</p><ul><li>搭建redist集群，把key分配到不同的hash slot槽所在的分片上</li><li>采用压缩算法，利用时间换空间，进行序列化与反序列化。同时也存在缓存数据识别性低的缺点</li><li>在业务上进行干预，设置阈值。比如用户购物车的商品数量，或者领券的数量，不能无限的增大；</li></ul><h2 id="删除大Key"><a href="#删除大Key" class="headerlink" title="删除大Key"></a>删除大Key</h2><h3 id="DEL命令"><a href="#DEL命令" class="headerlink" title="DEL命令"></a>DEL命令</h3><ul><li>redis &lt; 4.0 版本时，在主线程中同步删除，删除大Key会阻塞主线程。</li><li>4.0 版本 &lt; redis&lt; 6.0 版本：引入lazy-free，手动开启lazy-free时，有4个选项可以控制，分别对应不同场景下，是否开启异步释放内存机制：<ul><li>lazyfree-lazy-expire：key在过期删除时尝试异步释放内存</li><li>lazyfree-lazy-eviction：内存达到maxmemory并设置了淘汰策略时尝试异步释放内存</li><li>lazyfree-lazy-server-del：执行RENAME&#x2F;MOVE等命令或需要覆盖一个key时，删除旧key尝试异步释放内存</li><li>replica-lazy-flush：主从全量同步，从库清空数据库时异步释放内存</li></ul></li></ul><p>开启lazy-free后，Redis在释放一个key的内存时，首先会评估代价，如果释放内存的代价很小，那么就直接在主线程中操作了，没必要放到异步线程中执行</p><p>redis &gt;&#x3D; 6.0 版本：引入lazyfree-lazy-user-del，只要开启了，del直接可以异步删除key，不会阻塞主线程。</p><h3 id="SCAN命令"><a href="#SCAN命令" class="headerlink" title="SCAN命令"></a>SCAN命令</h3><p>SCAN命令可以帮助在不阻塞主线程的情况下逐步遍历大量的键，以及避免对数据库的阻塞。</p><h3 id="UNLINK命令"><a href="#UNLINK命令" class="headerlink" title="UNLINK命令"></a>UNLINK命令</h3><p>Redis 4.0 提供了 lazy delete (unlink命令) </p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ul><li>当Hash&#x2F;Set底层采用哈希表存储（非ziplist&#x2F;int编码存储）时，并且元素数量超过64个</li><li>当ZSet底层采用跳表存储（非ziplist编码存储）时，并且元素数量超过64个</li><li>当List链表节点数量超过64个（注意，不是元素数量，而是链表节点的数量，List的实现是在每个节点包含了若干个元素的数据，这些元素采用ziplist存储）</li><li>refcount &#x3D;&#x3D; 1 就是在没有引用这个Key时</li></ul><p>只有以上这些情况，在删除key释放内存时，才会真正放到异步线程中执行，其他情况一律还是在主线程操作。也就是说String（不管内存占用多大）、List（少量元素）、Set（int编码存储）、Hash&#x2F;ZSet（ziplist编码存储）这些情况下的key在释放内存时，依旧在主线程中操作。</p><p><strong>参考链接</strong></p><ul><li><a href="https://mp.weixin.qq.com/s/L9ozOPivbM1SjhoTfjHgaw">浅析Redis大Key</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>Redis</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Redis</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JavaScript经典算法题</title>
    <link href="/blog/2023/11/Javascript%E7%BB%8F%E5%85%B8%E7%AE%97%E6%B3%95%E9%A2%98%E7%9B%AE.html"/>
    <url>/blog/2023/11/Javascript%E7%BB%8F%E5%85%B8%E7%AE%97%E6%B3%95%E9%A2%98%E7%9B%AE.html</url>
    
    <content type="html"><![CDATA[<h2 id="两数之和"><a href="#两数之和" class="headerlink" title="两数之和"></a>两数之和</h2><p>给定一个整数数组 <code>nums</code> 和一个整数目标值 <code>target</code>，请你在该数组中找出和为目标值 target 的那<strong>两个</strong>整数，并返回它们的数组下标。</p><p>你可以假设每种输入只会对应一个答案。但是，数组中同一个元素在答案里不能重复出现。</p><p>你可以按任意顺序返回答案。</p><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">twoSum</span>(<span class="hljs-params">nums, target</span>) &#123;<br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; nums.<span class="hljs-property">length</span>; i++) &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = i + <span class="hljs-number">1</span>; j &lt; nums.<span class="hljs-property">length</span>; j++) &#123;<br>      <span class="hljs-keyword">if</span> (nums[i] + nums[j] == target) &#123;<br>        <span class="hljs-keyword">return</span> [i, j]<br>      &#125;<br>    &#125;<br>  &#125;<br>&#125;<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = twoSum;<br></code></pre></td></tr></table></figure><h2 id="二维数组中查找数字"><a href="#二维数组中查找数字" class="headerlink" title="二维数组中查找数字"></a>二维数组中查找数字</h2><p>在一个 <code>n * m</code> 的二维数组中，每一行都按照从左到右递增的顺序排序，每一列都按照从上到下递增的顺序排序。请完成一个高效的函数，输入这样的一个二维数组和一个整数，判断数组中是否含有该整数。</p><p>示例：</p><p>现有矩阵 matrix 如下：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js">[<br>  [<span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">7</span>, <span class="hljs-number">11</span>, <span class="hljs-number">15</span>],<br>  [<span class="hljs-number">2</span>, <span class="hljs-number">5</span>, <span class="hljs-number">8</span>, <span class="hljs-number">12</span>, <span class="hljs-number">19</span>],<br>  [<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">9</span>, <span class="hljs-number">16</span>, <span class="hljs-number">22</span>],<br>  [<span class="hljs-number">10</span>, <span class="hljs-number">13</span>, <span class="hljs-number">14</span>, <span class="hljs-number">17</span>, <span class="hljs-number">24</span>],<br>  [<span class="hljs-number">18</span>, <span class="hljs-number">21</span>, <span class="hljs-number">23</span>, <span class="hljs-number">26</span>, <span class="hljs-number">30</span>],<br>];<br></code></pre></td></tr></table></figure><p>给定 <code>target = 5</code>，返回 true。 给定 <code>target = 20</code>，返回 false。</p><h3 id="题解-1"><a href="#题解-1" class="headerlink" title="题解"></a>题解</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">findNumberIn2DArray</span>(<span class="hljs-params">matrix, target</span>) &#123;<br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; matrix.<span class="hljs-property">length</span>; i++) &#123;<br>    <span class="hljs-keyword">if</span> (matrix[i].<span class="hljs-title function_">indexOf</span>(target) !== -<span class="hljs-number">1</span>) &#123;<br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = findNumberIn2DArray;<br><br></code></pre></td></tr></table></figure><h2 id="找出数组中重复的数字"><a href="#找出数组中重复的数字" class="headerlink" title="找出数组中重复的数字"></a>找出数组中重复的数字</h2><p>新建一个 <code>findRepeatNumber.js</code> 文件，在文件里写一个名为 <code>findRepeatNumber</code> 的函数。找出数组中重复的数字。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">findRepeatNumber</span>(<span class="hljs-params">nums</span>) &#123;<br>  <span class="hljs-comment">// 补充代码</span><br>&#125;<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = findRepeatNumber;<br></code></pre></td></tr></table></figure><h3 id="题解-2"><a href="#题解-2" class="headerlink" title="题解"></a>题解</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">findRepeatNumber</span>(<span class="hljs-params">nums</span>) &#123;<br>    <span class="hljs-keyword">const</span> set = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>(nums)<br>    <span class="hljs-keyword">return</span> nums.<span class="hljs-title function_">find</span>(<span class="hljs-function"><span class="hljs-params">x</span> =&gt;</span> !set.<span class="hljs-title function_">delete</span>(x))<br>&#125;<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = findRepeatNumber<br></code></pre></td></tr></table></figure><h2 id="替换空格"><a href="#替换空格" class="headerlink" title="替换空格"></a>替换空格</h2><p>请实现一个函数，把字符串 <code>s</code> 中的每个空格替换成”%20”。</p><h3 id="题解-3"><a href="#题解-3" class="headerlink" title="题解"></a>题解</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">replaceSpace</span>(<span class="hljs-params">s</span>) &#123;<br>  <span class="hljs-keyword">return</span> s.<span class="hljs-title function_">split</span>(<span class="hljs-string">&quot; &quot;</span>).<span class="hljs-title function_">join</span>(<span class="hljs-string">&quot;%20&quot;</span>);<br>&#125;<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = replaceSpace;<br><br></code></pre></td></tr></table></figure><p>(完)</p><p><strong>在线题库</strong></p><ul><li><a href="https://www.lanqiao.cn/problems/2495/learning/">两数之和</a></li><li><a href="https://www.lanqiao.cn/problems/2497/learning">二维数组中查找数字</a></li><li><a href="https://www.lanqiao.cn/problems/2494/learning/">数组中重复的数字 </a></li><li><a href="https://www.lanqiao.cn/problems/2494/learning/">替换空格</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>数据结构和算法</category>
      
    </categories>
    
    
    <tags>
      
      <tag>数据结构和算法</tag>
      
      <tag>JavaScript</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>基于顺序存储（数组）实现List集合</title>
    <link href="/blog/2023/10/%E5%9F%BA%E4%BA%8E%E9%A1%BA%E5%BA%8F%E5%AD%98%E5%82%A8%E6%9D%A5%E5%AE%9E%E7%8E%B0%E7%BA%BF%E6%80%A7%E8%A1%A8.html"/>
    <url>/blog/2023/10/%E5%9F%BA%E4%BA%8E%E9%A1%BA%E5%BA%8F%E5%AD%98%E5%82%A8%E6%9D%A5%E5%AE%9E%E7%8E%B0%E7%BA%BF%E6%80%A7%E8%A1%A8.html</url>
    
    <content type="html"><![CDATA[<h2 id="场景"><a href="#场景" class="headerlink" title="场景"></a>场景</h2><p>使用顺序存储来实现线性表。</p><h3 id="接口定义"><a href="#接口定义" class="headerlink" title="接口定义"></a>接口定义</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.Iterator;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 线性表（列表）的接口定义</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">MyList</span>&lt;T&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Iterator</span>&lt;T&gt; &#123;<br>  <span class="hljs-comment">/**新增一个元素*/</span><br>  <span class="hljs-keyword">void</span> <span class="hljs-title function_">add</span><span class="hljs-params">(T element)</span>;<br><br>  <span class="hljs-comment">/**删除相同元素*/</span><br>  <span class="hljs-keyword">void</span> <span class="hljs-title function_">delete</span><span class="hljs-params">(T element)</span>;<br><br>  <span class="hljs-comment">/**根据索引删除元素*/</span><br>  <span class="hljs-keyword">void</span> <span class="hljs-title function_">delete</span><span class="hljs-params">(<span class="hljs-type">int</span> index)</span>;<br><br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">   * 将指定索引位置的元素替换成新元素</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@param</span> index</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@param</span> newElement</span><br><span class="hljs-comment">   */</span><br>  <span class="hljs-keyword">void</span> <span class="hljs-title function_">update</span><span class="hljs-params">(<span class="hljs-type">int</span> index, T newElement)</span>;<br><br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">   * 当前列表中是否含有target这个元素</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@param</span> target</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment">   */</span><br>  <span class="hljs-type">boolean</span> <span class="hljs-title function_">contains</span><span class="hljs-params">(T target)</span>;<br><br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">   * 返回指定索引处的元素</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@param</span> index</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment">   */</span><br>  T <span class="hljs-title function_">at</span><span class="hljs-params">(<span class="hljs-type">int</span> index)</span>;<br><br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">   * 查找element的索引，如果没有返回-1</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@param</span> element</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment">   */</span><br>  <span class="hljs-type">int</span> <span class="hljs-title function_">indexOf</span><span class="hljs-params">(T element)</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="实现类"><a href="#实现类" class="headerlink" title="实现类"></a>实现类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 用顺序存储（数组）方式来实现列表</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyArrayList</span>&lt;T&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title class_">MyList</span>&lt;T&gt; &#123;<br>  <span class="hljs-keyword">private</span> T[] elements;<span class="hljs-comment">//真正存储元素的底层结构</span><br><br>  <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">size</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<span class="hljs-comment">//元素个数</span><br><br>  <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">capacity</span> <span class="hljs-operator">=</span> <span class="hljs-number">10</span>;<span class="hljs-comment">//容量</span><br><br>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">MyArrayList</span><span class="hljs-params">(<span class="hljs-type">int</span> capacity)</span> &#123;<br>    <span class="hljs-built_in">this</span>.capacity = capacity;<br><br>    elements = (T[]) <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[capacity];<br>  &#125;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">MyArrayList</span><span class="hljs-params">()</span> &#123;<br>    elements = (T[]) <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[capacity];<br>  &#125;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">add</span><span class="hljs-params">(T element)</span> &#123;<br>    <span class="hljs-keyword">if</span> (size == capacity) &#123;<span class="hljs-comment">//扩容</span><br>      capacity *= <span class="hljs-number">2</span>;<span class="hljs-comment">//增加一倍的容量</span><br>      T[] newArr = (T[]) <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[capacity];<span class="hljs-comment">//新建一个数组</span><br>      <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; size; i++) &#123;<br>        newArr[i] = elements[i];<br>      &#125;<br>      elements = newArr;<span class="hljs-comment">//把旧的那个柜子扔掉</span><br>    &#125;<br>    elements[size++] = element;<br>  &#125;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">delete</span><span class="hljs-params">(T element)</span> &#123;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">index</span> <span class="hljs-operator">=</span> indexOf(element);<br>    <span class="hljs-keyword">if</span> (index &gt;= <span class="hljs-number">0</span>) &#123;<br>      delete(index);<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">delete</span><span class="hljs-params">(<span class="hljs-type">int</span> index)</span> &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> index; i &lt; size - <span class="hljs-number">1</span>; i++) &#123;<br>      elements[i] = elements[i + <span class="hljs-number">1</span>];<br>    &#125;<br>    elements[size - <span class="hljs-number">1</span>] = <span class="hljs-literal">null</span>;<br>    size--;<br>  &#125;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">update</span><span class="hljs-params">(<span class="hljs-type">int</span> index, T newElement)</span> &#123;<br>    elements[index] = newElement;<br>  &#125;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">contains</span><span class="hljs-params">(T target)</span> &#123;<br>    <span class="hljs-keyword">return</span> indexOf(target) &gt;= <span class="hljs-number">0</span>;<br>  &#125;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> T <span class="hljs-title function_">at</span><span class="hljs-params">(<span class="hljs-type">int</span> index)</span> &#123;<br>    <span class="hljs-keyword">return</span> elements[index];<br>  &#125;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">indexOf</span><span class="hljs-params">(T element)</span> &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; size; i++) &#123;<br>      <span class="hljs-keyword">if</span> (elements[i].equals(element)) &#123;<br>        <span class="hljs-keyword">return</span> i;<br>      &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;<br>  &#125;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> String <span class="hljs-title function_">toString</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">StringBuilder</span> <span class="hljs-variable">sb</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>(<span class="hljs-string">&quot;[&quot;</span>);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; size; i++) &#123;<br>      sb.append(elements[i] + (i == size - <span class="hljs-number">1</span> ? <span class="hljs-string">&quot;&quot;</span> : <span class="hljs-string">&quot; , &quot;</span>));<br>    &#125;<br>    sb.append(<span class="hljs-string">&quot;]&quot;</span>);<br>    <span class="hljs-keyword">return</span> sb.toString();<br>  &#125;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">hasNext</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>  &#125;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> T <span class="hljs-title function_">next</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>（完）</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>数据结构和算法</category>
      
    </categories>
    
    
    <tags>
      
      <tag>数据结构</tag>
      
      <tag>编程</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>数据结构入门</title>
    <link href="/blog/2023/10/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84.html"/>
    <url>/blog/2023/10/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84.html</url>
    
    <content type="html"><![CDATA[<h2 id="逻辑结构"><a href="#逻辑结构" class="headerlink" title="逻辑结构"></a>逻辑结构</h2><ul><li><p>集合</p><ul><li>元素罗列在一起</li></ul></li><li><p>线性结构</p><ul><li>元素前后相继（一一对应）</li></ul></li><li><p>树形结构</p><ul><li>元素存在一对多的关系</li></ul></li><li><p>图结构或网状结构</p><ul><li>元素之间存在多对多关系</li></ul></li></ul><h2 id="存储结构"><a href="#存储结构" class="headerlink" title="存储结构"></a>存储结构</h2><ul><li>顺序存储<ul><li>地址连续，用数组</li></ul></li><li>链式存储<ul><li>地址不连续，用指针（引用，面向对象）</li></ul></li></ul>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>数据结构和算法</category>
      
    </categories>
    
    
    <tags>
      
      <tag>数据结构</tag>
      
      <tag>编程</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linux操作练习题目</title>
    <link href="/blog/2023/10/Linux%E6%93%8D%E4%BD%9C%E7%BB%83%E4%B9%A0%E9%A2%98%E7%9B%AE.html"/>
    <url>/blog/2023/10/Linux%E6%93%8D%E4%BD%9C%E7%BB%83%E4%B9%A0%E9%A2%98%E7%9B%AE.html</url>
    
    <content type="html"><![CDATA[<h2 id="文件备份"><a href="#文件备份" class="headerlink" title="文件备份"></a>文件备份</h2><p>遍历&#x2F;test&#x2F;目录下的txt文件做一个备份，备份的文件名增加一个年月日的后缀，比如将a.txt备份为a.txt20231020</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-meta">#!/bin/sh</span><br><span class="hljs-comment"># author: maojunxyz</span><br><span class="hljs-comment"># version: 1.0</span><br><span class="hljs-comment"># date: 2023-10-20</span><br> <br>suffix=`<span class="hljs-built_in">date</span> +%Y%m%d`<br><span class="hljs-keyword">for</span> f <span class="hljs-keyword">in</span> `find ./test -<span class="hljs-built_in">type</span> f -name <span class="hljs-string">&quot;*.txt&quot;</span>`<br><span class="hljs-keyword">do</span><br>  <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;start backup<span class="hljs-variable">$f</span>&quot;</span><br>  <span class="hljs-built_in">cp</span> <span class="hljs-variable">$&#123;f&#125;</span> <span class="hljs-variable">$&#123;f&#125;</span>_<span class="hljs-variable">$&#123;suffix&#125;</span><br><span class="hljs-keyword">done</span> <br></code></pre></td></tr></table></figure><h2 id="打印正方形"><a href="#打印正方形" class="headerlink" title="打印正方形"></a>打印正方形</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-meta">#!/bin/sh</span><br><span class="hljs-comment"># author: maojunxyz</span><br><span class="hljs-comment"># version: 1.0</span><br><span class="hljs-comment"># date: 2023-10-21</span><br> <br><span class="hljs-built_in">read</span> -p <span class="hljs-string">&quot;please input a number: &quot;</span> count<br>num=`<span class="hljs-built_in">echo</span> <span class="hljs-variable">$count</span> |sed <span class="hljs-string">&#x27;s/[0-9]//g&#x27;</span>`<br><span class="hljs-keyword">if</span> [ -n <span class="hljs-string">&quot;<span class="hljs-variable">$num</span>&quot;</span> ]<br><span class="hljs-keyword">then</span><br>  <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;请输入一个纯数字&quot;</span><br>  <span class="hljs-built_in">exit</span> 1<br><span class="hljs-keyword">fi</span><br> <br><span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> `<span class="hljs-built_in">seq</span> <span class="hljs-variable">$count</span>`<br><span class="hljs-keyword">do</span><br>  <span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> `<span class="hljs-built_in">seq</span> <span class="hljs-variable">$count</span>`<br>  <span class="hljs-keyword">do</span><br>    <span class="hljs-keyword">if</span> [ <span class="hljs-variable">$n</span> -lt <span class="hljs-variable">$count</span> ]<br>    <span class="hljs-keyword">then</span> <br>      <span class="hljs-built_in">echo</span> -n <span class="hljs-string">&quot;* &quot;</span><br>    <span class="hljs-keyword">else</span><br>      <span class="hljs-built_in">echo</span>  <span class="hljs-string">&quot;*&quot;</span><br>    <span class="hljs-keyword">fi</span><br>  <span class="hljs-keyword">done</span><br><span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure><h2 id="创建多个用户并保存记录"><a href="#创建多个用户并保存记录" class="headerlink" title="创建多个用户并保存记录"></a>创建多个用户并保存记录</h2><ol><li>创建10个用户，并给他们设置随机密码，密码记录到一个文件里，文件名userinfo.txt。</li><li>用户从user00到user09。</li><li>密码要求：包含大小写字母以及数字，密码长度15位。</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-meta">#!/bin/sh</span><br><span class="hljs-comment"># author: maojunxyz</span><br><span class="hljs-comment"># version: 1.0</span><br><span class="hljs-comment"># date: 2023-10-22</span><br><br><span class="hljs-comment"># 判断文件是否已经存在</span><br><span class="hljs-keyword">if</span> [ -f /tmp/userinfo.txt ];<span class="hljs-keyword">then</span><br>  <span class="hljs-built_in">rm</span> -rf /tmp/userinfo.txt;<br><span class="hljs-keyword">fi</span> <br>   <br><span class="hljs-comment"># seq队列</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> `<span class="hljs-built_in">seq</span> -w 0 09`<br><span class="hljs-keyword">do</span> <br>  <span class="hljs-comment"># 生成不包含特殊符号的密码</span><br>  pass=$(openssl rand -<span class="hljs-built_in">base64</span> 15)<br>   <br><span class="hljs-comment"># 检查用户是否已经存在</span><br><span class="hljs-keyword">if</span> <span class="hljs-built_in">id</span> <span class="hljs-string">&quot;user_<span class="hljs-variable">$&#123;i&#125;</span>&quot;</span> &amp;&gt;/dev/null; <span class="hljs-keyword">then</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;用户 user_<span class="hljs-variable">$&#123;i&#125;</span> 已存在.&quot;</span> &gt;&gt; /tmp/userinfo.txt<br><span class="hljs-keyword">else</span><br>  useradd user_<span class="hljs-variable">$&#123;i&#125;</span> &amp;&amp; <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;p&#125;</span>&quot;</span> | passwd --stdin user_<span class="hljs-variable">$&#123;i&#125;</span><br>  <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;user_<span class="hljs-variable">$&#123;i&#125;</span> <span class="hljs-variable">$&#123;pass&#125;</span>&quot;</span> &gt;&gt; /tmp/userinfo.txt<br><span class="hljs-keyword">fi</span> <br><span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure><h2 id="Linux判断磁盘分区读写是否正常"><a href="#Linux判断磁盘分区读写是否正常" class="headerlink" title="Linux判断磁盘分区读写是否正常"></a>Linux判断磁盘分区读写是否正常</h2><p>判断磁盘分区读写是否正常，并打印信息</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-meta">#!/bin/sh</span><br><span class="hljs-comment"># author: maojunxyz</span><br><span class="hljs-comment"># version: 1.0</span><br><span class="hljs-comment"># date: 2023-10-23</span><br><br><span class="hljs-keyword">for</span> mount_p <span class="hljs-keyword">in</span> `<span class="hljs-built_in">df</span> -h | sed <span class="hljs-string">&#x27;1d&#x27;</span> | grep -v <span class="hljs-string">&#x27;tmpfs&#x27;</span>  |awk <span class="hljs-string">&#x27;&#123;print $NF&#125;&#x27;</span>`;<span class="hljs-keyword">do</span><br>  <span class="hljs-built_in">touch</span> <span class="hljs-variable">$mount_p</span>/testfile &amp;&amp; <span class="hljs-built_in">rm</span> -rf <span class="hljs-variable">$mount_p</span>/testfile<br>  <span class="hljs-keyword">if</span> [ $? -ne 0 ];<span class="hljs-keyword">then</span><br>     <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$mount_p</span> 读写有问题&quot;</span> <br>  <span class="hljs-keyword">else</span> <br>     <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$mount_p</span> 读写正常&quot;</span> <br>  <span class="hljs-keyword">fi</span><br><span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure><h2 id="修改目录下的文件权限和属组"><a href="#修改目录下的文件权限和属组" class="headerlink" title="修改目录下的文件权限和属组"></a>修改目录下的文件权限和属组</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-meta">#!/bin/sh</span><br><span class="hljs-comment"># author: maojunxyz</span><br><span class="hljs-comment"># version: 1.0</span><br><span class="hljs-comment"># date: 2023-10-24</span><br><span class="hljs-keyword">for</span> f <span class="hljs-keyword">in</span> `find <span class="hljs-built_in">test</span>`<br><span class="hljs-keyword">do</span><br><span class="hljs-comment"># 查看文件权限</span><br>f_p=`<span class="hljs-built_in">stat</span> -c %a <span class="hljs-variable">$f</span>`<br><span class="hljs-comment"># 查看文件所有者</span><br>f_u=`<span class="hljs-built_in">stat</span> -c %U <span class="hljs-variable">$f</span>`<br><span class="hljs-comment"># 查看文件所属组</span><br>f_g=`<span class="hljs-built_in">stat</span> -c %G <span class="hljs-variable">$f</span>`<br><br>  <span class="hljs-comment"># 判断是否为目o</span><br>  <span class="hljs-keyword">if</span> [ -d <span class="hljs-variable">$f</span> ];<span class="hljs-keyword">then</span><br>    [ <span class="hljs-variable">$f_p</span> != <span class="hljs-string">&#x27;755&#x27;</span> ] &amp;&amp; <span class="hljs-built_in">chmod</span> 755 <span class="hljs-variable">$f</span><br>  <span class="hljs-keyword">else</span><br>    [ <span class="hljs-variable">$f_p</span> != <span class="hljs-string">&#x27;644&#x27;</span> ] &amp;&amp; <span class="hljs-built_in">chmod</span> 644 <span class="hljs-variable">$f</span><br>  <span class="hljs-keyword">fi</span><br>  <br>  <span class="hljs-comment"># 修改文件的属主和属组</span><br>  [ <span class="hljs-variable">$f_u</span> != <span class="hljs-string">&#x27;www&#x27;</span> ] &amp;&amp; <span class="hljs-built_in">chown</span>  www <span class="hljs-variable">$f</span><br>  [ <span class="hljs-variable">$f_g</span> != <span class="hljs-string">&#x27;root&#x27;</span> ] &amp;&amp; <span class="hljs-built_in">chown</span> :root <span class="hljs-variable">$f</span><br><span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure><h2 id="判断输入的日期是否符合要求"><a href="#判断输入的日期是否符合要求" class="headerlink" title="判断输入的日期是否符合要求"></a>判断输入的日期是否符合要求</h2><p>判断用户输入的日期，要求符合<code>yyyymmdd</code>的格式，并输出校验结果。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#/bin/bash</span><br><br><span class="hljs-comment"># author: maojunxyz</span><br><span class="hljs-comment"># version: 1.0</span><br><span class="hljs-comment"># date: 2023-10-29</span><br><br><span class="hljs-keyword">if</span> [ <span class="hljs-variable">$#</span> -ne 1 ] || [ <span class="hljs-variable">$&#123;#1&#125;</span> -ne 8 ];<span class="hljs-keyword">then</span><br>  <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Usage: bash <span class="hljs-variable">$0</span> yyyymmdd&quot;</span><br>  <span class="hljs-built_in">exit</span> 1<br><span class="hljs-keyword">fi</span> <br><br>mydate=<span class="hljs-variable">$1</span><br>year=<span class="hljs-variable">$&#123;mydate:0:4&#125;</span><br>month=<span class="hljs-variable">$&#123;mydate:4:2&#125;</span><br>day=<span class="hljs-variable">$&#123;mydate:6:2&#125;</span><br><br><span class="hljs-comment"># 将正确和错误的输出都不打印出来</span><br><span class="hljs-keyword">if</span> cal <span class="hljs-string">&quot;<span class="hljs-variable">$day</span>&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$month</span>&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$year</span>&quot;</span> &gt;/dev/null 2&gt;/dev/null<br><span class="hljs-keyword">then</span><br>  <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;The data is OK. The date is <span class="hljs-variable">$&#123;year&#125;</span>年<span class="hljs-variable">$&#123;month&#125;</span>月<span class="hljs-variable">$&#123;day&#125;</span>日&quot;</span><br><span class="hljs-keyword">else</span> <br>  <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;The data is Error.&quot;</span><br><span class="hljs-keyword">fi</span><br></code></pre></td></tr></table></figure><h2 id="去掉文件的空行"><a href="#去掉文件的空行" class="headerlink" title="去掉文件的空行"></a>去掉文件的空行</h2><p>写一个 bash脚本以去掉一个文本文件nowcoder.txt中的空行<br>示例:<br>假设nowcoder.txt 内容如下：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs cpp">abc<br><br><span class="hljs-number">567</span><br><br><br>aaa<br>bbb<br><br><br><br>ccc<br></code></pre></td></tr></table></figure><p>你的脚本应当输出：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c">abc<br><span class="hljs-number">567</span><br>aaa<br>bbb<br>ccc<br></code></pre></td></tr></table></figure><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 方法 1</span><br>sed -n <span class="hljs-string">&#x27;/^$/!p&#x27;</span> nowcoder.txt<br><br><span class="hljs-comment"># 方法2</span><br>awk -n <span class="hljs-string">&#x27;&#123;if ($0 != &quot;&quot;) print $0&#125;&#x27;</span> nowcoder.txt<br><br><span class="hljs-comment"># 方法 3</span><br>awk <span class="hljs-string">&#x27;!/^$/ &#123;print $0&#125;&#x27;</span> nowcoder.txt<br><br><span class="hljs-comment"># 方法 4</span><br>grep -v <span class="hljs-string">&#x27;^$&#x27;</span> nowcoder.txt<br><br><br><br><span class="hljs-comment">## 备份目录并创建软链接</span><br><br>1. 有一个目录/tmp/data/,该目录下有数百个子目录。<br>2. 需要将老文件（365天前的）挪到另外一个目录/tmp/data1下，还需要做软链接。<br>3. 要确保老文件成功挪到/tmp/data1下之后才能做软链接，需要有日志。<br><br>```sh<br><span class="hljs-comment">#!/bin/sh</span><br><span class="hljs-comment"># author: maojunxyz</span><br><span class="hljs-comment"># version: 1.0</span><br><span class="hljs-comment"># date: 2023-10-25</span><br><br><span class="hljs-function"><span class="hljs-title">main</span></span>()&#123;<br><span class="hljs-built_in">cd</span> /tmp/data<br><span class="hljs-keyword">for</span> <span class="hljs-built_in">dir</span> <span class="hljs-keyword">in</span> `<span class="hljs-built_in">ls</span>`<br><span class="hljs-keyword">do</span><br>  <span class="hljs-built_in">echo</span> <span class="hljs-variable">$dir</span><br>  <span class="hljs-keyword">for</span> old_data <span class="hljs-keyword">in</span> `find <span class="hljs-variable">$dir</span> -maxdepth 1 -<span class="hljs-built_in">type</span> d -mtime +365`<br>  <span class="hljs-keyword">do</span><br>     rsync -aR <span class="hljs-variable">$old_data</span>  /tmp/data1/<br>     <span class="hljs-keyword">if</span> [ $? -eq 0 ];<span class="hljs-keyword">then</span><br>       <span class="hljs-built_in">rm</span> -rf <span class="hljs-variable">$old_data</span> &amp;&amp; <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;/tmp/<span class="hljs-variable">$old_data</span> 移动成功&quot;</span><br>       <span class="hljs-built_in">ln</span> -s /tmp/data1/<span class="hljs-variable">$old_data</span> /tmp/data/<span class="hljs-variable">$old_data</span> &amp;&amp; \<br>       <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;/tmp/data/<span class="hljs-variable">$old_data</span> 创建软链成功&quot;</span><br>     <span class="hljs-keyword">else</span><br>       <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;/tmp/<span class="hljs-variable">$old_data</span> 未移动成功&quot;</span><br>     <span class="hljs-keyword">fi</span><br>  <span class="hljs-keyword">done</span><br><span class="hljs-keyword">done</span><br>&#125;<br><br>main &amp;&gt; /tmp/move_old_data_`<span class="hljs-built_in">date</span> +%F`.<span class="hljs-built_in">log</span><br></code></pre></td></tr></table></figure><h2 id="打印字母数小于8的单词"><a href="#打印字母数小于8的单词" class="headerlink" title="打印字母数小于8的单词"></a>打印字母数小于8的单词</h2><p>写一个bash脚本以统计一个文本文件nowcoder.txt中字母数小于8的单词。<br>示例:<br>假设 nowcoder.txt 内容如下：</p><p>how they are implemented and applied in computer</p><p>你的脚本应当输出：<br>how<br>they<br>are</p><p>and</p><p>applied</p><p>in</p><p>说明:<br>不用担心你输出的空格以及换行的问题</p><h3 id="题解-1"><a href="#题解-1" class="headerlink" title="题解"></a>题解</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 方法 1</span><br>awk -F <span class="hljs-string">&quot; &quot;</span> <span class="hljs-string">&#x27;&#123;for(i=1;i&lt;=NF;i++) &#123; if(length($i) &lt; 8) &#123; print($i) &#125;&#125;&#125;&#x27;</span> nowcoder.txt<br><br><span class="hljs-comment"># 方法 2</span><br>words=$(<span class="hljs-built_in">cat</span> nowcoder.txt)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-variable">$&#123;words[*]&#125;</span>; <span class="hljs-keyword">do</span><br>    <span class="hljs-keyword">if</span> [ <span class="hljs-variable">$&#123;#i&#125;</span> -lt 8 ]; <span class="hljs-keyword">then</span><br>        <span class="hljs-built_in">echo</span> <span class="hljs-variable">$&#123;i&#125;</span><br>    <span class="hljs-keyword">fi</span><br><span class="hljs-keyword">done</span><br><br><span class="hljs-comment"># 方法 3</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> $(<span class="hljs-built_in">cat</span> nowcoder.txt); <span class="hljs-keyword">do</span><br>    <span class="hljs-keyword">if</span> [ <span class="hljs-variable">$&#123;#i&#125;</span> -lt 8 ]; <span class="hljs-keyword">then</span><br>        <span class="hljs-built_in">echo</span> <span class="hljs-variable">$&#123;i&#125;</span><br>    <span class="hljs-keyword">fi</span><br><span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure><h2 id="打印文件的最后5行"><a href="#打印文件的最后5行" class="headerlink" title="打印文件的最后5行"></a>打印文件的最后5行</h2><p>查看日志的时候，经常会从文件的末尾往前查看，请你写一个bash shell脚本以输出一个文本文件nowcoder.txt中的最后5行。<br>示例:<br>假设 nowcoder.txt 内容如下：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-type">int</span> a = <span class="hljs-number">10</span>;<br><span class="hljs-type">int</span> b = <span class="hljs-number">100</span>;<br>cout &lt;&lt; <span class="hljs-string">&quot;a + b:&quot;</span> &lt;&lt; a + b &lt;&lt; endl;<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>你的脚本应当输出：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-type">int</span> a = <span class="hljs-number">10</span>;<br><span class="hljs-type">int</span> b = <span class="hljs-number">100</span>;<br>cout &lt;&lt; <span class="hljs-string">&quot;a + b:&quot;</span> &lt;&lt; a + b &lt;&lt; endl;<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="题解-2"><a href="#题解-2" class="headerlink" title="题解"></a>题解</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 方法1</span><br>end=$(<span class="hljs-built_in">wc</span> -l &lt; nowcoder.txt)<br>start=$(( end - <span class="hljs-number">5</span> + <span class="hljs-number">1</span>))<br><span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$start</span> -lt 1 ]]; <span class="hljs-keyword">then</span><br>start=1<br><span class="hljs-keyword">fi</span><br>sed -n <span class="hljs-string">&quot;<span class="hljs-variable">$start</span>,<span class="hljs-variable">$end</span> p&quot;</span> nowcoder.txt<br><br><span class="hljs-comment"># 方法 2</span><br><span class="hljs-built_in">tail</span> -n 5 nowcoder.txt<br><br><span class="hljs-comment"># 方法 3</span><br><span class="hljs-built_in">tac</span> nowcoder.txt | <span class="hljs-built_in">head</span> -n 5 | <span class="hljs-built_in">tac</span><br><br><span class="hljs-comment"># 方法 4</span><br>awk <span class="hljs-string">&#x27;BEGIN &#123;</span><br><span class="hljs-string">s=1</span><br><span class="hljs-string">&#125; &#123;</span><br><span class="hljs-string">lines[s]=$0;</span><br><span class="hljs-string">s++</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">END &#123;</span><br><span class="hljs-string">    for(i=NR-4; i&lt;=NR; i++) &#123;</span><br><span class="hljs-string">        print(lines[i])</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">&#125;&#x27;</span> nowcoder.txt<br><br><span class="hljs-comment"># 方法 5</span><br><span class="hljs-keyword">function</span> <span class="hljs-function"><span class="hljs-title">count_lines</span></span>() &#123;<br>number=0<br>filename=<span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-built_in">read</span> p;<br>        <span class="hljs-keyword">do</span><br>            number=$((number + <span class="hljs-number">1</span>))<br>    <span class="hljs-keyword">done</span> &lt; <span class="hljs-variable">$filename</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-variable">$number</span><br>&#125;<br><span class="hljs-comment"># 获取文件的行数</span><br>end=`count_lines nowcoder.txt`<br>start=$((end - <span class="hljs-number">5</span> + <span class="hljs-number">1</span>))<br><span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$start</span> -lt 1 ]]; <span class="hljs-keyword">then</span><br>start=1<br><span class="hljs-keyword">fi</span><br>sed -n <span class="hljs-string">&quot;<span class="hljs-variable">$start</span>,<span class="hljs-variable">$end</span> p&quot;</span> nowcoder.txt<br></code></pre></td></tr></table></figure><h2 id="打印空行的行号"><a href="#打印空行的行号" class="headerlink" title="打印空行的行号"></a>打印空行的行号</h2><p>编写一个shell脚本以输出一个文本文件nowcoder.txt中空行的行号（空行可能连续，从1开始输出）</p><p>示例:<br>假设 nowcoder.txt 内容如下：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs cpp">a<br>b<br><br>c<br><br>d<br><br>e<br><br><br>f<br></code></pre></td></tr></table></figure><p>你的脚本应当输出：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-number">3</span><br><span class="hljs-number">5</span><br><span class="hljs-number">7</span><br><span class="hljs-number">9</span><br><span class="hljs-number">10</span><br></code></pre></td></tr></table></figure><h3 id="题解-3"><a href="#题解-3" class="headerlink" title="题解"></a>题解</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 方法 1</span><br>awk -n <span class="hljs-string">&#x27;/^$/ &#123;print NR&#125;&#x27;</span> nowcoder.txt<br><br><span class="hljs-comment"># 方法 2</span><br>sed -n <span class="hljs-string">&#x27;/^$/=&#x27;</span> nowcoder.txt<br><br><span class="hljs-comment"># 方法 3</span><br>i=1<br><span class="hljs-keyword">while</span> <span class="hljs-built_in">read</span> line; <span class="hljs-keyword">do</span><br><span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$line</span> =~ ^$ ]]; <span class="hljs-keyword">then</span><br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$i</span><br><span class="hljs-keyword">fi</span><br>i=$((i+<span class="hljs-number">1</span>))<br><span class="hljs-keyword">done</span>&lt;<span class="hljs-variable">$1</span><br></code></pre></td></tr></table></figure><h2 id="抽奖程序给人员分配唯一的数字"><a href="#抽奖程序给人员分配唯一的数字" class="headerlink" title="抽奖程序给人员分配唯一的数字"></a>抽奖程序给人员分配唯一的数字</h2><ol><li>多人抽签游戏，给人员分配<code>1-99</code>的随机整数。</li><li>相同名字的如果之前分配过随机数，则和之前一致。</li><li>已经分配过的数字不能重复分配。</li><li>循环执行，直到<kbd>Ctrl-C</kbd>键终止运行。</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br><br><span class="hljs-comment"># author: maojunxyz</span><br><span class="hljs-comment"># version: 1.0</span><br><span class="hljs-comment"># date: 2023-10-30</span><br><br>&lt;&lt;<span class="hljs-string">&#x27;COMMENT&#x27;</span><br>1. 多人抽签游戏，给人员分配1-99的随机整数。<br>2. 相同名字的如果之前分配过随机数，则和之前一致。<br>3. 已经分配过的数字不能重复分配。<br>4. 循环执行，直到&lt;kbd&gt;Ctrl-C&lt;/kbd&gt;键终止运行。<br>COMMENT<br><br><span class="hljs-comment"># 生成1-99的数字，并校验已生成的数字</span><br><span class="hljs-keyword">function</span> <span class="hljs-function"><span class="hljs-title">create_number</span></span>()&#123;<br><span class="hljs-keyword">while</span> :<br><span class="hljs-keyword">do</span><br>  num=$((RANDOM%<span class="hljs-number">99</span>+<span class="hljs-number">1</span>))<br>  n=$(awk -F <span class="hljs-string">&#x27;:&#x27;</span> -v NUMBER=<span class="hljs-string">&quot;<span class="hljs-variable">$num</span>&quot;</span> <span class="hljs-string">&#x27;$2 == NUMBER&#x27;</span> /tmp/name.log | <span class="hljs-built_in">wc</span> -l)<br>  <span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$n</span>&quot;</span> -gt 0 ];<span class="hljs-keyword">then</span><br>    <span class="hljs-built_in">continue</span><br>  <span class="hljs-keyword">else</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$num</span>&quot;</span><br>    <span class="hljs-built_in">break</span><br>  <span class="hljs-keyword">fi</span><br><span class="hljs-keyword">done</span><br>&#125;<br><br><br><span class="hljs-keyword">while</span> :<br><span class="hljs-keyword">do</span><br>  <span class="hljs-built_in">read</span> -p <span class="hljs-string">&quot;Please input a name:&quot;</span> name<br>  <span class="hljs-comment"># 若抽奖名单不存在，则根据名称生成数字并保存名单</span><br>  <span class="hljs-keyword">if</span> [ ! -f /tmp/name.log ];<span class="hljs-keyword">then</span><br>  num=$((RANDOM%<span class="hljs-number">99</span>+<span class="hljs-number">1</span>))<br>  <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Your number is: <span class="hljs-variable">$num</span>&quot;</span><br>  <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$name</span>:<span class="hljs-variable">$num</span>&quot;</span> &gt; /tmp/name.log<br>  <span class="hljs-keyword">else</span><br>    <span class="hljs-comment"># 抽奖名单已存在，判断名称是否存在，存在直接打印抽奖名字和数字;不存在则创建名单。</span><br>    n=$(awk -F <span class="hljs-string">&#x27;:&#x27;</span> -v NAME=<span class="hljs-string">&quot;<span class="hljs-variable">$name</span>&quot;</span> <span class="hljs-string">&#x27;$1 == NAME&#x27;</span> /tmp/name.log | <span class="hljs-built_in">wc</span> -l)<br>    <span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$n</span>&quot;</span> -gt 0 ];<span class="hljs-keyword">then</span><br>      <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;The name already exist.&quot;</span><br>      awk -F <span class="hljs-string">&#x27;:&#x27;</span> -v NAME=<span class="hljs-string">&quot;<span class="hljs-variable">$name</span>&quot;</span> <span class="hljs-string">&#x27;$1 == NAME&#x27;</span> /tmp/name.log<br>      <span class="hljs-built_in">continue</span><br>    <span class="hljs-keyword">else</span><br>      number=$(create_number)<br>    <span class="hljs-keyword">fi</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Your number is: <span class="hljs-variable">$number</span>&quot;</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$name</span>:<span class="hljs-variable">$number</span>&quot;</span> &gt;&gt; /tmp/name.log<br>  <span class="hljs-keyword">fi</span><br><span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure><h2 id="机器存活状态检测"><a href="#机器存活状态检测" class="headerlink" title="机器存活状态检测"></a>机器存活状态检测</h2><p>给定一批服务器IP，判断机器是否存活。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-meta">#!/bin/sh</span><br><span class="hljs-comment"># author: maojunxyz</span><br><span class="hljs-comment"># version: 1.0</span><br><span class="hljs-comment"># date: 2023-10-24</span><br> <br><span class="hljs-comment"># 服务器IP列表</span><br>IPS=(baidu.com qq.com)<br><span class="hljs-keyword">for</span> IP <span class="hljs-keyword">in</span> <span class="hljs-variable">$&#123;IPS[@]&#125;</span><br><span class="hljs-keyword">do</span><br>n=`ping -c5 <span class="hljs-variable">$IP</span> | grep <span class="hljs-string">&quot;packet&quot;</span> |awk -F <span class="hljs-string">&#x27;%&#x27;</span> <span class="hljs-string">&#x27;&#123;print $1&#125;&#x27;</span> |awk <span class="hljs-string">&#x27;&#123;print $NF&#125;&#x27;</span>`<br><span class="hljs-keyword">if</span> [ -z <span class="hljs-string">&quot;<span class="hljs-variable">$n</span>&quot;</span> ];<span class="hljs-keyword">then</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;执行失败&quot;</span><br><span class="hljs-built_in">exit</span> <br><span class="hljs-keyword">else</span><br>  n1=`<span class="hljs-built_in">echo</span> <span class="hljs-variable">$n</span>|sed <span class="hljs-string">&#x27;s/[0-9]//g&#x27;</span>`<br>  <span class="hljs-keyword">if</span> [ -n <span class="hljs-string">&quot;<span class="hljs-variable">$n1</span>&quot;</span> ];<span class="hljs-keyword">then</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;执行失败了&quot;</span><br>    <span class="hljs-built_in">exit</span> 1<br>  <span class="hljs-keyword">fi</span><br><span class="hljs-keyword">fi</span><br><br><span class="hljs-keyword">if</span> [ <span class="hljs-variable">$n</span> -ge 20 ];<span class="hljs-keyword">then</span><br>  <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;机器<span class="hljs-variable">$&#123;IP&#125;</span>宕机，丢包率是<span class="hljs-variable">$&#123;n&#125;</span>%&quot;</span><br><span class="hljs-keyword">else</span><br>  <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;机器<span class="hljs-variable">$&#123;IP&#125;</span>正常，丢包率是<span class="hljs-variable">$&#123;n&#125;</span>%&quot;</span><br><span class="hljs-keyword">fi</span><br><span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure><h2 id="查找指定目录5分钟内有修改的文件"><a href="#查找指定目录5分钟内有修改的文件" class="headerlink" title="查找指定目录5分钟内有修改的文件"></a>查找指定目录5分钟内有修改的文件</h2><ol><li>使用脚本查找指定目录5分钟内有修改的文件并重定向文件列表到一个文件中。</li><li>如果重定向的文件列表内容不为空，则修改文件名称为时间格式的名称。</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-meta">#!/bin/bash</span><br><span class="hljs-comment"># author: maojunxyz</span><br><span class="hljs-comment"># version: 1.0</span><br><span class="hljs-comment"># date: 2023-10-26</span><br><br><span class="hljs-built_in">date</span>=`<span class="hljs-built_in">date</span> +%Y%m%d%H%M`<br>base_dir=/opt<br><br>find <span class="hljs-variable">$base_dir</span> -<span class="hljs-built_in">type</span> f -mmin -5 &gt; /tmp/newf.txt<br><br><span class="hljs-keyword">if</span> [ -s /tmp/newf.txt ];<span class="hljs-keyword">then</span><br>  <span class="hljs-built_in">mv</span> /tmp/newf.txt /tmp/<span class="hljs-variable">$&#123;date&#125;</span>.txt<br><span class="hljs-keyword">fi</span><br></code></pre></td></tr></table></figure><h2 id="检查进程和端口服务是否正常"><a href="#检查进程和端口服务是否正常" class="headerlink" title="检查进程和端口服务是否正常"></a>检查进程和端口服务是否正常</h2><ol><li>检查进程服务是否存在</li><li>检查进程端口是否存在</li><li>当2者都存活时，判定服务正常。</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br><br><span class="hljs-comment"># author: maojunxyz</span><br><span class="hljs-comment"># version: 1.0</span><br><span class="hljs-comment"># date: 2023-10-31</span><br><br><span class="hljs-comment"># 定义一个函数，用于检查必需的工具是否已安装</span><br><span class="hljs-keyword">function</span> <span class="hljs-function"><span class="hljs-title">check_tools</span></span>()&#123;<br>    <span class="hljs-keyword">if</span> ! <span class="hljs-built_in">which</span> pgrep &amp;&gt;/dev/null; <span class="hljs-keyword">then</span><br>        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;没有安装pgrep命令&quot;</span><br>        <span class="hljs-built_in">exit</span> 1<br>    <span class="hljs-keyword">fi</span><br><br>    <span class="hljs-keyword">if</span> ! <span class="hljs-built_in">which</span> ss &amp;&gt;/dev/null; <span class="hljs-keyword">then</span><br>        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;没有安装ss命令&quot;</span><br>        <span class="hljs-built_in">exit</span> 1<br>    <span class="hljs-keyword">fi</span><br>&#125;<br><br><span class="hljs-comment"># 定义一个函数，用于检查特定进程是否在运行</span><br><span class="hljs-keyword">function</span> <span class="hljs-function"><span class="hljs-title">check_ps</span></span>()&#123;<br>    <span class="hljs-keyword">if</span> pgrep <span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span> &amp;&gt;/dev/null; <span class="hljs-keyword">then</span><br>        <span class="hljs-built_in">return</span> 0  <span class="hljs-comment"># 进程存在，返回0表示真</span><br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-built_in">return</span> 1  <span class="hljs-comment"># 进程不存在，返回1表示假</span><br>    <span class="hljs-keyword">fi</span><br>&#125;<br><br><span class="hljs-comment"># 定义一个函数，用于检查特定端口是否在监听</span><br><span class="hljs-keyword">function</span> <span class="hljs-function"><span class="hljs-title">check_port</span></span>()&#123;<br>    port_num=$(ss -lnp | grep -c <span class="hljs-string">&quot;:<span class="hljs-variable">$1</span> &quot;</span>)<br>    <span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$port_num</span>&quot;</span> -ne 0 ]; <span class="hljs-keyword">then</span><br>        <span class="hljs-built_in">return</span> 0  <span class="hljs-comment"># 端口在监听，返回0表示真</span><br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-built_in">return</span> 1  <span class="hljs-comment"># 端口不在监听，返回1表示假</span><br>    <span class="hljs-keyword">fi</span><br>&#125;<br><br><span class="hljs-comment"># 定义一个函数，用于检查特定服务（进程和端口）</span><br><span class="hljs-keyword">function</span> <span class="hljs-function"><span class="hljs-title">check_srv</span></span>()&#123;<br>    check_ps <span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span> &amp;&amp; check_port <span class="hljs-string">&quot;<span class="hljs-variable">$2</span>&quot;</span><br>    <span class="hljs-keyword">if</span> check_ps <span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span> &amp;&amp; check_port <span class="hljs-string">&quot;<span class="hljs-variable">$2</span>&quot;</span>; <span class="hljs-keyword">then</span><br>        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$1</span>服务正常&quot;</span><br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$1</span>服务不正常&quot;</span><br>    <span class="hljs-keyword">fi</span><br>&#125;<br><br><span class="hljs-comment"># 调用函数检查必需工具是否已安装</span><br>check_tools<br><br><span class="hljs-comment"># 分别检查指定服务的状态</span><br>check_srv nginx 443<br>check_srv mysql 3306<br>check_srv redis 6379<br>check_srv java 8080<br></code></pre></td></tr></table></figure><h2 id="监控站点状态"><a href="#监控站点状态" class="headerlink" title="监控站点状态"></a>监控站点状态</h2><ol><li>写一个脚本监控网站的可用性，访问网站放回<code>2xx</code>，<code>3xx</code>状态码则代表可正常访问，其他状态码为不可正常访问。</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-meta">#!/bin/sh</span><br><br><span class="hljs-comment"># author: maojunxyz</span><br><span class="hljs-comment"># version: 1.0</span><br><span class="hljs-comment"># date: 2023-10-28</span><br><br>code=$(curl --connect-timeout 3 -I <span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span> 2&gt;/dev/null |grep  <span class="hljs-string">&#x27;HTTP&#x27;</span> |awk <span class="hljs-string">&#x27;&#123;print $2&#125;&#x27;</span>)<br><span class="hljs-keyword">if</span> <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$code</span>&quot;</span> |grep -qE <span class="hljs-string">&#x27;^2[0-9][0-9]|3[0-9][0-9]&#x27;</span>;<span class="hljs-keyword">then</span><br>   <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$1</span>可正常访问&quot;</span><br><span class="hljs-keyword">else</span><br>   <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$1</span>不可正常访问&quot;</span><br><span class="hljs-keyword">fi</span><br></code></pre></td></tr></table></figure><h2 id="监控系统负载并定时记录状态信息"><a href="#监控系统负载并定时记录状态信息" class="headerlink" title="监控系统负载并定时记录状态信息"></a>监控系统负载并定时记录状态信息</h2><ol><li>监控系统负载，如果系统负载超过10，需要记录系统状态信息。</li><li>要求每隔20s监控一次。</li><li>系统状态信息需要保存到&#x2F;opt&#x2F;logs&#x2F;下面，保留一个月。</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-meta">#!/bin/sh</span><br><span class="hljs-comment"># author: maojunxyz</span><br><span class="hljs-comment"># version: 1.0</span><br><span class="hljs-comment"># date: 2023-10-25</span><br><br><span class="hljs-comment"># 如果/opt/logs目录不存在则创建目录</span><br>[ -d /opt/logs ] || <span class="hljs-built_in">mkdir</span> -p /opt/logs<br><br><span class="hljs-keyword">while</span> :<br><span class="hljs-keyword">do</span><br>  <span class="hljs-comment"># 获取系统1分钟的负责，只保留最前面的值。</span><br>  load=`<span class="hljs-built_in">uptime</span> |awk -F <span class="hljs-string">&#x27;average:&#x27;</span> <span class="hljs-string">&#x27;&#123;print $2&#125;&#x27;</span> |<span class="hljs-built_in">cut</span> -d<span class="hljs-string">&#x27;,&#x27;</span> -f1 |sed <span class="hljs-string">&#x27;s/ //g&#x27;</span> |<span class="hljs-built_in">cut</span> -d. -f1`<br>  <span class="hljs-keyword">if</span> [ <span class="hljs-variable">$load</span> -gt 0 ];<span class="hljs-keyword">then</span><br>  top -bn1 | <span class="hljs-built_in">head</span> -n 100 &gt; /opt/logs/top.`<span class="hljs-built_in">date</span> +%s`<br>  vmstat 1 10 &gt; /opt/logs/vmstat.`<span class="hljs-built_in">date</span> +%s`<br>  ss -an &gt; /opt/logs/ss.`<span class="hljs-built_in">date</span> +%s`<br>  <span class="hljs-keyword">fi</span><br>  <span class="hljs-built_in">sleep</span> 20<br>  find /opt/logs \( -name <span class="hljs-string">&quot;top*&quot;</span> -o -name <span class="hljs-string">&quot;vmstat*&quot;</span> -o -name <span class="hljs-string">&quot;ss*&quot;</span> \) -mtime +30 |xargs <span class="hljs-built_in">rm</span> -rf <br><span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure><h2 id="监控网卡流量"><a href="#监控网卡流量" class="headerlink" title="监控网卡流量"></a>监控网卡流量</h2><p>监控<code>eth0</code>的网卡流量，如果接收量和请求量都为<code>0</code>,则重启网卡。</p><h3 id="题解-4"><a href="#题解-4" class="headerlink" title="题解"></a>题解</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br><br><span class="hljs-comment"># author: maojunxyz</span><br><span class="hljs-comment"># version: 1.0</span><br><span class="hljs-comment"># date: 2023/11/01</span><br><br><span class="hljs-comment"># 设置系统语言为英文</span><br>LANG=en<br><br><span class="hljs-comment"># 检查是否已经安装了sar命令</span><br><span class="hljs-keyword">if</span> ! <span class="hljs-built_in">command</span> -v sar &amp;&gt;/dev/null; <span class="hljs-keyword">then</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;sar 没有安装在系统中。&quot;</span><br>    <span class="hljs-comment"># 获取系统包管理器类型</span><br>    <span class="hljs-keyword">if</span> [ -x <span class="hljs-string">&quot;<span class="hljs-subst">$(command -v apt-get)</span>&quot;</span> ]; <span class="hljs-keyword">then</span><br>        <span class="hljs-comment"># 使用apt安装sar命令</span><br>        sudo apt-get update<br>        sudo apt-get install sysstat<br>    <span class="hljs-keyword">elif</span> [ -x <span class="hljs-string">&quot;<span class="hljs-subst">$(command -v yum)</span>&quot;</span> ]; <span class="hljs-keyword">then</span><br>        <span class="hljs-comment"># 使用yum安装sar命令</span><br>        sudo yum install sysstat<br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;无法确定系统包管理器类型。请手动安装sar命令。&quot;</span><br>        <span class="hljs-built_in">exit</span> 1<br>    <span class="hljs-keyword">fi</span><br><br>    <span class="hljs-comment"># 检查安装结果</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">command</span> -v sar &amp;&gt;/dev/null; <span class="hljs-keyword">then</span><br>        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;sar 已成功安装在系统中。&quot;</span><br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;sar 安装失败，请手动安装。&quot;</span><br>        <span class="hljs-built_in">exit</span> 1<br>    <span class="hljs-keyword">fi</span><br><span class="hljs-keyword">fi</span><br><br><br><span class="hljs-comment"># 使用sar命令获取网络设备性能统计信息，每秒输出1次，共输出60次，然后筛选eth0的信息并将其保存到文件</span><br>sar -n DEV 1 60 | grep eth0 &gt; /tmp/eth0.<span class="hljs-built_in">log</span><br><br><span class="hljs-comment"># 从保存的性能统计信息文件中提取平均接收流量数据（第5列），并移除小数点</span><br>n1=$(grep -i average /tmp/eth0.<span class="hljs-built_in">log</span> | awk <span class="hljs-string">&#x27;&#123;print $5&#125;&#x27;</span> | sed <span class="hljs-string">&#x27;s/\.//g&#x27;</span>)<br><br><span class="hljs-comment"># 从保存的性能统计信息文件中提取平均发送流量数据（第6列），并移除小数点</span><br>n2=$(grep -i average /tmp/eth0.<span class="hljs-built_in">log</span> | awk <span class="hljs-string">&#x27;&#123;print $6&#125;&#x27;</span> | sed <span class="hljs-string">&#x27;s/\.//g&#x27;</span>)<br><br><span class="hljs-comment"># 删除临时文件，清理残留的性能统计信息</span><br><span class="hljs-built_in">rm</span> -f /tmp/eth0.<span class="hljs-built_in">log</span><br><br><span class="hljs-comment"># 检查接收流量和发送流量是否都为零</span><br><span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$n1</span>&quot;</span> == <span class="hljs-string">&quot;000&quot;</span> ] &amp;&amp; [ <span class="hljs-string">&quot;<span class="hljs-variable">$n2</span>&quot;</span> == <span class="hljs-string">&quot;000&quot;</span> ]; <span class="hljs-keyword">then</span><br>  <span class="hljs-comment"># 如果接收和发送流量都为零，显示消息并重启eth0网卡</span><br>  <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;eth0网卡没有流量，需要重启网卡&quot;</span><br>  ifdown eth0 &amp;&amp; ifup eth0<br><span class="hljs-keyword">fi</span><br></code></pre></td></tr></table></figure><h2 id="统计文件的行数"><a href="#统计文件的行数" class="headerlink" title="统计文件的行数"></a>统计文件的行数</h2><ol><li>编写一个<code>shell</code>脚本以输出一个文本文件<code>nowcoder.txt</code>中的行数<br>示例:<br>假设<code>nowcoder.txt</code>内容如下：</li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">int</span> a = <span class="hljs-number">10</span>;<br>    <span class="hljs-type">int</span> b = <span class="hljs-number">100</span>;<br>    cout &lt;&lt; <span class="hljs-string">&quot;a + b:&quot;</span> &lt;&lt; a + b &lt;&lt; endl;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>你的脚本应当输出：<br>9</p><h3 id="题解-5"><a href="#题解-5" class="headerlink" title="题解"></a>题解</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 方法 1</span><br><span class="hljs-built_in">wc</span> -l nowcoder.txt | awk <span class="hljs-string">&#x27;&#123;print $1&#125;&#x27;</span><br><span class="hljs-comment"># 方法 2-1</span><br><span class="hljs-built_in">cat</span> nowcoder.txt | <span class="hljs-built_in">wc</span> -l<br><span class="hljs-comment"># 方法 2-2</span><br><span class="hljs-built_in">wc</span> -l &lt; nowcoder.txt<br><br><span class="hljs-comment"># 方法 3-1</span><br><span class="hljs-built_in">cat</span> -n nowcoder.txt | awk <span class="hljs-string">&#x27;&#123;print $1&#125;&#x27;</span> | <span class="hljs-built_in">tail</span> -n 1<br><span class="hljs-comment"># 方法 3-2</span><br><span class="hljs-built_in">cat</span> -n nowcoder.txt | <span class="hljs-built_in">tail</span> -n 1 | awk <span class="hljs-string">&#x27;&#123;print $1&#125;&#x27;</span><br><br><span class="hljs-comment"># 方法 4</span><br>i=0<br><span class="hljs-keyword">while</span> <span class="hljs-built_in">read</span> p;<span class="hljs-keyword">do</span><br>  i=$((i + <span class="hljs-number">1</span>))<br><span class="hljs-keyword">done</span> &lt; nowcoder.txt<br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$i</span><br></code></pre></td></tr></table></figure><h2 id="统计文本中每行数字的个数"><a href="#统计文本中每行数字的个数" class="headerlink" title="统计文本中每行数字的个数"></a>统计文本中每行数字的个数</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br><br><span class="hljs-comment"># author: maojunxyz</span><br><span class="hljs-comment"># version: 1.0</span><br><span class="hljs-comment"># date: 2023-11-03</span><br><br><span class="hljs-keyword">if</span> [ <span class="hljs-variable">$#</span> -ne 1 ]; <span class="hljs-keyword">then</span><br>  <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;输入的参数个数只能是1&quot;</span> <br>  <span class="hljs-built_in">exit</span> 1<br><span class="hljs-keyword">fi</span><br><br><span class="hljs-built_in">sum</span>=0  <br><br><span class="hljs-keyword">while</span> <span class="hljs-built_in">read</span> -r line; <span class="hljs-keyword">do</span><br>  <span class="hljs-comment"># 使用sed命令将每行中的非数字字符替换为空格，然后使用wc -L统计字符数，将结果赋给变量num。</span><br>  num=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$line</span>&quot;</span> | sed <span class="hljs-string">&#x27;s/[^0-9]//g&#x27;</span> | <span class="hljs-built_in">wc</span> -L)<br>  <span class="hljs-built_in">sum</span>=$((sum + num)) <br><span class="hljs-keyword">done</span> &lt; <span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span> <br><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;sum: <span class="hljs-variable">$sum</span>&quot;</span> <br></code></pre></td></tr></table></figure><h2 id="菜单脚本根据输入指令来执行命令"><a href="#菜单脚本根据输入指令来执行命令" class="headerlink" title="菜单脚本根据输入指令来执行命令"></a>菜单脚本根据输入指令来执行命令</h2><ol><li>编写一个脚本根据输入指令来执行命令。</li><li>当输入<code>1</code>或<code>d</code>时，输出系统时间。</li><li>当输入<code>2</code>时，列出文件列表。</li><li>当输入<code>3</code>时，打印当前登入用户。</li><li>当输入<code>4</code>时，打印当前目录。</li><li>当输入<code>q</code>时，退出菜单。</li><li>当输入指令时，提示错误信息<code>Wrong input, try again!</code>并继续。</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-meta">#!/bin/bash</span><br><span class="hljs-comment"># author: maojunxyz</span><br><span class="hljs-comment"># version: 1.0</span><br><span class="hljs-comment"># date: 2023-10-26</span><br><br><span class="hljs-keyword">while</span> :<br><span class="hljs-keyword">do</span><br> <span class="hljs-built_in">read</span> -p <span class="hljs-string">&quot;please input a number 1-4: &quot;</span> n<br> <span class="hljs-keyword">case</span> <span class="hljs-variable">$n</span> <span class="hljs-keyword">in</span> <br>   1|d)<br>     <span class="hljs-built_in">date</span><br>     <span class="hljs-built_in">continue</span><br>     ;;<br>   2)  <br>     <span class="hljs-built_in">ls</span><br>     <span class="hljs-built_in">continue</span><br>     ;;<br>   3)  <br>     <span class="hljs-built_in">who</span><br>     <span class="hljs-built_in">continue</span><br>     ;;<br>   4)  <br>     <span class="hljs-built_in">pwd</span><br>     <span class="hljs-built_in">continue</span><br>     ;;<br>   q)  <br>     <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Exit&quot;</span><br>     <span class="hljs-built_in">exit</span> 1<br>     <span class="hljs-built_in">break</span><br>     ;;<br>   *)  <br>     <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Wrong input, try again!&quot;</span><br>     <span class="hljs-built_in">continue</span><br>     ;;<br> <span class="hljs-keyword">esac</span><br><span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure><h2 id="输入数字并循环执行"><a href="#输入数字并循环执行" class="headerlink" title="输入数字并循环执行"></a>输入数字并循环执行</h2><ol><li>提示用户输入数字，并打印出输入的数字。</li><li>当用户输入不是数字时提示报错信息。</li><li>当用户输入字母<code>q</code>时，退出脚本。</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-meta">#!/bin/bash</span><br><span class="hljs-comment"># author: maojunxyz</span><br><span class="hljs-comment"># version: 1.0</span><br><span class="hljs-comment"># date: 2023-10-27</span><br><br><span class="hljs-keyword">while</span> :<br><span class="hljs-keyword">do</span><br>  <span class="hljs-built_in">read</span> -p <span class="hljs-string">&quot;请输入数字，当输入q时退出!&quot;</span> n<br>  num=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$n</span>&quot;</span> |sed -r <span class="hljs-string">&#x27;s/[0-9]//g&#x27;</span> |  <span class="hljs-built_in">wc</span> -c)<br>  <span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$n</span>&quot;</span> == <span class="hljs-string">&quot;q&quot;</span> ]<br>  <span class="hljs-keyword">then</span><br>    <span class="hljs-built_in">exit</span> 0<br>  <span class="hljs-keyword">fi</span><br>  <span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$num</span>&quot;</span> -ne 1 ]<br>  <span class="hljs-keyword">then</span> <br>     <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;输入的不是数字，请重试!&quot;</span><br>  <span class="hljs-keyword">else</span><br>     <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;你输入的数字是：<span class="hljs-variable">$n</span>&quot;</span><br>  <span class="hljs-keyword">fi</span><br><span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure><h2 id="输出-0-到-500-中-7-的倍数"><a href="#输出-0-到-500-中-7-的倍数" class="headerlink" title="输出 0 到 500 中 7 的倍数"></a>输出 0 到 500 中 7 的倍数</h2><h3 id="题解-6"><a href="#题解-6" class="headerlink" title="题解"></a>题解</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br><br><span class="hljs-comment"># author: maojunxyz</span><br><span class="hljs-comment"># version: 1.0</span><br><span class="hljs-comment"># date: 2023-11-02</span><br><br><span class="hljs-comment"># 方法 1</span><br>start=0<br>end=500<br>step=7<br><span class="hljs-keyword">while</span> [ <span class="hljs-variable">$start</span> -lt <span class="hljs-variable">$end</span> ]; <span class="hljs-keyword">do</span><br>    <span class="hljs-keyword">if</span> !(( <span class="hljs-variable">$start</span> % <span class="hljs-variable">$step</span> )); <span class="hljs-keyword">then</span><br>         <span class="hljs-built_in">echo</span> <span class="hljs-variable">$start</span><br>         start=$(( start + <span class="hljs-number">1</span> ))<br>    <span class="hljs-keyword">else</span><br>         start=$(( start + <span class="hljs-number">1</span> ))<br>    <span class="hljs-keyword">fi</span><br><span class="hljs-keyword">done</span><br><br><span class="hljs-comment"># 方法 2</span><br><span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> &#123;0..500..7&#125;; <span class="hljs-keyword">do</span> <br>   <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;num&#125;</span>&quot;</span><br><span class="hljs-keyword">done</span><br><br><span class="hljs-comment"># 方法 3</span><br><span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> &#123;0..500&#125;;<span class="hljs-keyword">do</span><br>   [[ <span class="hljs-string">&quot;((num%7))&quot;</span> -eq 0 ]] &amp;&amp; <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;num&#125;</span>&quot;</span><br><span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure><h2 id="输出第5行的内容"><a href="#输出第5行的内容" class="headerlink" title="输出第5行的内容"></a>输出第5行的内容</h2><p>编写一个bash脚本以输出一个文本文件nowcoder.txt中第5行的内容。</p><p>示例:<br>假设 nowcoder.txt 内容如下：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c">welcome<br>to<br>nowcoder<br>this<br>is<br>shell<br>code<br></code></pre></td></tr></table></figure><p>你的脚本应当输出：<br>is。</p><h3 id="题解-7"><a href="#题解-7" class="headerlink" title="题解"></a>题解</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 方法 1</span><br>sed -n <span class="hljs-string">&#x27;5p&#x27;</span> nowcoder.txt<br><br><span class="hljs-comment"># 方法 2 </span><br><span class="hljs-built_in">head</span> -n 5 nowcoder.txt | <span class="hljs-built_in">tail</span> -n 1<br><br><span class="hljs-comment"># 方法 3 </span><br>awk <span class="hljs-string">&#x27;&#123; if(NR==5) &#123;print($0)&#125; &#125;&#x27;</span> nowcoder.txt<br></code></pre></td></tr></table></figure><p><strong>在线题目</strong></p><ul><li><a href="https://www.nowcoder.com/practice/0372acd5725d40669640fd25e9fb7b0f">去掉文件的空行</a></li><li><a href="https://www.nowcoder.com/practice/bd5b5d4b93a04226a81afbabf0be797d">打印字母数小于8的单词</a></li><li><a href="https://www.nowcoder.com/practice/ff6f36d357d24ce5a0eb817a0ef85ee2">打印文件的最后5行</a></li><li><a href="https://www.nowcoder.com/practice/030fc368e42e44b8b1f8985a8d6ad255">打印空行的行号</a></li><li><a href="https://www.nowcoder.com/practice/205ccba30b264ae697a78f425f276779">统计文件的行数</a></li><li><a href="https://www.nowcoder.com/practice/8b85768394304511b0eb887244e51872">输出 0 到 500 中 7 的倍数</a></li><li><a href="https://www.nowcoder.com/practice/1d5978c6136d4252904757b4fa0c9296">输出第5行的内容</a></li></ul><p>（完）</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>Shell</tag>
      
      <tag>数据结构和算法</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Java经典算法题</title>
    <link href="/blog/2023/10/Java%E7%BB%8F%E5%85%B8%E7%AE%97%E6%B3%95%E9%A2%98.html"/>
    <url>/blog/2023/10/Java%E7%BB%8F%E5%85%B8%E7%AE%97%E6%B3%95%E9%A2%98.html</url>
    
    <content type="html"><![CDATA[<h2 id="二分查找法"><a href="#二分查找法" class="headerlink" title="二分查找法"></a>二分查找法</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">search</span><span class="hljs-params">(<span class="hljs-type">int</span>[] nums, <span class="hljs-type">int</span> target)</span> &#123;<br>      <span class="hljs-type">int</span> <span class="hljs-variable">min</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>      <span class="hljs-type">int</span> <span class="hljs-variable">max</span> <span class="hljs-operator">=</span> nums.length - <span class="hljs-number">1</span>;<br>      <br>      <span class="hljs-keyword">while</span>(min &lt;= max)&#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">mid</span> <span class="hljs-operator">=</span> min + (max - min) / <span class="hljs-number">2</span>;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">midVal</span> <span class="hljs-operator">=</span> nums[mid];<br>        <span class="hljs-keyword">if</span>(midVal &lt; target)&#123;<br>          min = mid + <span class="hljs-number">1</span>;<br>        &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(midVal &gt; target)&#123;<br>          max = mid -<span class="hljs-number">1</span>;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>          <span class="hljs-keyword">return</span> mid;<br>        &#125;<br>      &#125;<br><br>      <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>注意：第4行使用 int mid &#x3D; min + (max - min) &#x2F; 2;避免数值溢出（min+max)&#x2F;2 问题。</p></blockquote><h3 id="源码实现"><a href="#源码实现" class="headerlink" title="源码实现"></a>源码实现</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">binarySearch0</span><span class="hljs-params">(<span class="hljs-type">int</span>[] a, <span class="hljs-type">int</span> fromIndex, <span class="hljs-type">int</span> toIndex,</span><br><span class="hljs-params">                                 <span class="hljs-type">int</span> key)</span> &#123;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">low</span> <span class="hljs-operator">=</span> fromIndex;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">high</span> <span class="hljs-operator">=</span> toIndex - <span class="hljs-number">1</span>;<br><br>    <span class="hljs-keyword">while</span> (low &lt;= high) &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">mid</span> <span class="hljs-operator">=</span> (low + high) &gt;&gt;&gt; <span class="hljs-number">1</span>;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">midVal</span> <span class="hljs-operator">=</span> a[mid];<br><br>        <span class="hljs-keyword">if</span> (midVal &lt; key)<br>            low = mid + <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (midVal &gt; key)<br>            high = mid - <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">else</span><br>            <span class="hljs-keyword">return</span> mid; <span class="hljs-comment">// key found</span><br>    &#125;<br>    <span class="hljs-keyword">return</span> -(low + <span class="hljs-number">1</span>);  <span class="hljs-comment">// key not found.</span><br>&#125;<br></code></pre></td></tr></table></figure><p><code>Arrays.binarySearch</code> 是 Java 中用于在有序数组中执行二分查找的方法。它接受一个有序数组和要查找的元素作为参数，并返回元素在数组中的索引（如果找到）或应该插入的索引位置（如果未找到）。</p><p>以下是 <code>Arrays.binarySearch</code> 方法的签名：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">binarySearch</span><span class="hljs-params">(Object[] a, Object key)</span><br></code></pre></td></tr></table></figure><p><code>Arrays.binarySearch</code> 方法有以下几个重要特点：</p><ol><li><p><strong>有序数组要求</strong>：传递给 <code>binarySearch</code> 方法的数组必须是有序的。如果数组无序，结果是不确定的。</p></li><li><p><strong>返回值说明</strong>：如果找到元素 <code>key</code>，它将返回元素的索引。如果未找到元素 <code>key</code>，则返回一个负数值，该值是应该插入元素 <code>key</code> 以维持数组的有序性的位置。负数值的计算方式为：- (插入点索引 + 1)。这是一个将元素插入到有序数组的标准方式。</p></li></ol><h3 id="使用示例"><a href="#使用示例" class="headerlink" title="使用示例"></a>使用示例</h3><p>下面是一个示例，演示如何使用 <code>Arrays.binarySearch</code> 方法：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.Arrays;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BinarySearchExample</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">int</span>[] numbers = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>, <span class="hljs-number">10</span>&#125;;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">target</span> <span class="hljs-operator">=</span> <span class="hljs-number">6</span>;<br>        <br>        <span class="hljs-comment">// 使用binarySearch查找元素</span><br>        <span class="hljs-type">int</span> <span class="hljs-variable">index</span> <span class="hljs-operator">=</span> Arrays.binarySearch(numbers, target);<br>        <br>        <span class="hljs-keyword">if</span> (index &gt;= <span class="hljs-number">0</span>) &#123;<br>            System.out.println(target + <span class="hljs-string">&quot; found at index &quot;</span> + index);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            System.out.println(target + <span class="hljs-string">&quot; not found. It should be inserted at index &quot;</span> + (-index - <span class="hljs-number">1</span>));<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>在这个示例中，我们将 <code>target</code>（要查找的元素）设为6，并使用 <code>Arrays.binarySearch</code> 在有序数组 <code>numbers</code> 中查找它。如果找到，它将返回该元素的索引；如果未找到，它将返回应该插入该元素的位置。</p><p>要注意的是，如果数组中有多个相同的元素，<code>binarySearch</code> 方法只返回最前面匹配的索引。</p><h2 id="冒泡排序"><a href="#冒泡排序" class="headerlink" title="冒泡排序"></a>冒泡排序</h2><p>冒泡排序（Bubble Sort）是一种简单的排序算法，它反复地遍历要排序的列表，比较相邻元素并交换它们，直到整个列表按照升序或降序排列。</p><p>其时间复杂度和空间复杂度如下：</p><ol><li><p>时间复杂度：</p><ul><li>最好情况：$O(n)$</li><li>平均情况：$O(n^2)$</li><li>最坏情况：$O(n^2)$</li></ul><p>冒泡排序的最好情况发生在输入数组本身已经有序的情况下，此时只需要进行一次遍历，时间复杂度为O(n)。然而，最坏情况发生在输入数组完全逆序的情况下，需要进行n-1轮比较和交换，每轮比较需要遍历整个数组，因此时间复杂度为O(n^2)。平均情况下，冒泡排序的时间复杂度也是O(n^2)。</p></li><li><p>空间复杂度：</p><ul><li>冒泡排序是一种原地排序算法，不需要额外的内存空间，因此空间复杂度为O(1)。</li></ul></li></ol><p>尽管冒泡排序的时间复杂度在最坏情况下较高，但它是一种简单的排序算法，适用于小型数据集或在特殊情况下。在实际应用中，通常会使用更高效的排序算法，如快速排序或归并排序，以提高排序性能。</p><h3 id="Java实现"><a href="#Java实现" class="headerlink" title="Java实现"></a>Java实现</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sortColors</span><span class="hljs-params">(<span class="hljs-type">int</span>[] nums)</span> &#123;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; nums.length - <span class="hljs-number">1</span>; i++)&#123;<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; j &lt; nums.length - <span class="hljs-number">1</span> - i; j++)&#123;<br>                <span class="hljs-type">int</span> <span class="hljs-variable">l</span> <span class="hljs-operator">=</span> nums[j];<br>                <span class="hljs-type">int</span> <span class="hljs-variable">r</span> <span class="hljs-operator">=</span> nums[j + <span class="hljs-number">1</span>];<br>                <span class="hljs-keyword">if</span>(l &gt; r)&#123;<br>                    nums[j + <span class="hljs-number">1</span>] = l;<br>                    nums[j] = r;<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>在这段代码中，外层循环的次数是 <code>nums.length - 1</code>，内层循环的次数也是 <code>nums.length - 1 - i</code>，其中<code>i</code>是外层循环的迭代变量。内层循环中执行了比较和可能的元素交换操作。</p><h3 id="优化实现"><a href="#优化实现" class="headerlink" title="优化实现"></a>优化实现</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sortColors</span><span class="hljs-params">(<span class="hljs-type">int</span>[] nums)</span> &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> nums.length - <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">while</span>(<span class="hljs-literal">true</span>)&#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">last</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; j &lt; n; j++)&#123;<br>                <span class="hljs-type">int</span> <span class="hljs-variable">l</span> <span class="hljs-operator">=</span> nums[j];<br>                <span class="hljs-type">int</span> <span class="hljs-variable">r</span> <span class="hljs-operator">=</span> nums[j + <span class="hljs-number">1</span>];<br>                <span class="hljs-keyword">if</span>(l &gt; r)&#123;<br>                    nums[j + <span class="hljs-number">1</span>] = l;<br>                    nums[j] = r;<br>                    last = j;<br>                &#125;<br>            &#125;<br>            <span class="hljs-comment">// 记录最后交换时的索引</span><br>            n = last;<br>            <span class="hljs-keyword">if</span> (n == <span class="hljs-number">0</span>)&#123;<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>在这段代码中，有一个外层while循环和一个内层for循环。外层while循环的终止条件是 <code>n == 0</code>，即没有发生交换的情况下终止。内层for循环遍历数组，并在需要的情况下进行元素交换。</p><h3 id="源码实现-1"><a href="#源码实现-1" class="headerlink" title="源码实现"></a>源码实现</h3><p>Java标准库中没有使用冒泡排序算法来实现排序方法。标准库中提供了<code>java.util.Arrays</code>类，其中包含了用于对数组进行排序的方法，最常见的是<code>Arrays.sort</code>方法，它使用更高效的排序算法，如快速排序和归并排序，而不是冒泡排序。</p><h2 id="在线题库"><a href="#在线题库" class="headerlink" title="在线题库"></a>在线题库</h2><ul><li><a href="https://leetcode.com/problems/binary-search/description/">Binary Search - LeetCode</a></li><li><a href="https://leetcode.com/problems/sort-colors/">Sort Colors - LeetCode</a></li></ul><p>（本文完）</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>数据结构和算法</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>数据结构和算法</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Docker介绍和使用</title>
    <link href="/blog/2023/10/Docker%E4%BB%8B%E7%BB%8D%E5%92%8C%E4%BD%BF%E7%94%A8.html"/>
    <url>/blog/2023/10/Docker%E4%BB%8B%E7%BB%8D%E5%92%8C%E4%BD%BF%E7%94%A8.html</url>
    
    <content type="html"><![CDATA[<h2 id="Docker和虚拟机区别"><a href="#Docker和虚拟机区别" class="headerlink" title="Docker和虚拟机区别"></a>Docker和虚拟机区别</h2><p>Docker 是轻量级的沙盒，在其中运行的只是应用，虚拟机里面还有额外的系统。</p><h2 id="Docker-安全"><a href="#Docker-安全" class="headerlink" title="Docker 安全"></a>Docker 安全</h2><p>Docker 利用了 Linux 内核中很多安全特性来保证不同容器之间的隔离，并且通过签名机制来对镜像进行验证。大量生产环境的部署证明，Docker 虽然隔离性无法与虚拟机相比，但仍然具有极高的安全性。</p><h2 id="Docker清理后台容器"><a href="#Docker清理后台容器" class="headerlink" title="Docker清理后台容器"></a>Docker清理后台容器</h2><p>可以使用docker rm $sudo( docker ps -a -q) 命令。</p><h2 id="Docker查看镜像支持的环境变量？"><a href="#Docker查看镜像支持的环境变量？" class="headerlink" title="Docker查看镜像支持的环境变量？"></a>Docker查看镜像支持的环境变量？</h2><p>可以使用 docker run IMAGE env 命令。</p><h2 id="Docker提示：exec-format-error"><a href="#Docker提示：exec-format-error" class="headerlink" title="Docker提示：exec format error"></a>Docker提示：exec format error</h2><p>检查启动命令是否有可执行权限，进入容器手工运行脚本进行排查。</p><h2 id="Docker本地的镜像文件都存放在哪里？"><a href="#Docker本地的镜像文件都存放在哪里？" class="headerlink" title="Docker本地的镜像文件都存放在哪里？"></a>Docker本地的镜像文件都存放在哪里？</h2><p>与 Docker 相关的本地资源都存放在&#x2F;var&#x2F;lib&#x2F;docker&#x2F;目录下，其中 container 目录存放容器信息，graph 目录存放镜像信息，aufs 目录下存放具体的内容文件。</p><h2 id="Docker退出一个镜像的-bash，而不终止它？"><a href="#Docker退出一个镜像的-bash，而不终止它？" class="headerlink" title="Docker退出一个镜像的 bash，而不终止它？"></a>Docker退出一个镜像的 bash，而不终止它？</h2><p>按 Ctrl-p Ctrl-q。</p><h2 id="Docker退出容器时候自动删除"><a href="#Docker退出容器时候自动删除" class="headerlink" title="Docker退出容器时候自动删除?"></a>Docker退出容器时候自动删除?</h2><p>使用 –rm 选项，例如  docker run –rm -it ubuntu</p><h2 id="Docker快速查看本地的镜像和容器？"><a href="#Docker快速查看本地的镜像和容器？" class="headerlink" title="Docker快速查看本地的镜像和容器？"></a>Docker快速查看本地的镜像和容器？</h2><p>可以通过 docker images 来快速查看本地镜像；通过 docker ps -a 快速查看本地容器。</p><h2 id="镜像相关"><a href="#镜像相关" class="headerlink" title="镜像相关"></a>镜像相关</h2><h3 id="批量清理临时镜像文件"><a href="#批量清理临时镜像文件" class="headerlink" title="批量清理临时镜像文件"></a>批量清理临时镜像文件</h3><p>可以使用 sudo docker rmi $(sudo docker images -q -f danging&#x3D;true)命令</p><h3 id="如何查看镜像支持的环境变量"><a href="#如何查看镜像支持的环境变量" class="headerlink" title="如何查看镜像支持的环境变量"></a>如何查看镜像支持的环境变量</h3><p>使用 sudo docker run IMAGE env</p><h3 id="本地的镜像文件都存放在哪里"><a href="#本地的镜像文件都存放在哪里" class="headerlink" title="本地的镜像文件都存放在哪里"></a>本地的镜像文件都存放在哪里</h3><p>Docker 相关的本地资源存放在&#x2F;var&#x2F;lib&#x2F;docker&#x2F;目录下，其中 container 目录存放容器信息，graph 目录存放镜像信息，aufs 目录下存放具体的镜像底层文件。</p><h3 id="构建-Docker-镜像应该遵循的原则"><a href="#构建-Docker-镜像应该遵循的原则" class="headerlink" title="构建 Docker 镜像应该遵循的原则"></a>构建 Docker 镜像应该遵循的原则</h3><p>整体原则上，尽量保持镜像功能的明确和内容的精简，要点包括：</p><ul><li>尽量选取满足需求但较小的基础系统镜像，比如选择 debian:wheezy 镜像，仅有86MB 大小</li><li>清理编译生成文件、安装包的缓存等临时文件</li><li>安装各个软件时候要指定准确的版本号，并避免引入不需要的依赖</li><li>从安全的角度考虑，应用尽量使用系统的库和依赖</li><li>使用 Dockerfile 创建镜像时候要添加.dockerignore 文件或使用干净的工作目录</li></ul><h2 id="容器相关"><a href="#容器相关" class="headerlink" title="容器相关"></a>容器相关</h2><h3 id="容器退出后，数据持久化问题"><a href="#容器退出后，数据持久化问题" class="headerlink" title="容器退出后，数据持久化问题"></a>容器退出后，数据持久化问题</h3><p>容器退出后会处于终止（exited）状态，此时可以通过 docker ps -a 查看，其中数据不会丢失，还可以通过 docker start 来启动，只有删除容器才会清除数据。</p><h3 id="如何停止所有正在运行的容器？"><a href="#如何停止所有正在运行的容器？" class="headerlink" title="如何停止所有正在运行的容器？"></a>如何停止所有正在运行的容器？</h3><p>使用 docker kill $(sudo docker ps -q)</p><h3 id="如何清理批量后台停止的容器？"><a href="#如何清理批量后台停止的容器？" class="headerlink" title="如何清理批量后台停止的容器？"></a>如何清理批量后台停止的容器？</h3><p>使用 docker rm $（sudo docker ps -a -q）</p><h3 id="如何临时退出一个正在交互的容器的终端，而不终止它"><a href="#如何临时退出一个正在交互的容器的终端，而不终止它" class="headerlink" title="如何临时退出一个正在交互的容器的终端，而不终止它"></a>如何临时退出一个正在交互的容器的终端，而不终止它</h3><p>按 Ctrl+p，后按 Ctrl+q，如果按 Ctrl+c 会使容器内的应用进程终止，进而会使容器终止。</p><h3 id="容器应用查看日志信息"><a href="#容器应用查看日志信息" class="headerlink" title="容器应用查看日志信息"></a>容器应用查看日志信息</h3><p>使用 docker logs，后面跟容器的名称或者 ID 信息</p><h3 id="系统报错-Error-No-public-port-‘80’-published-for-…，是什么意思？"><a href="#系统报错-Error-No-public-port-‘80’-published-for-…，是什么意思？" class="headerlink" title="系统报错 Error: No public port ‘80’ published for …，是什么意思？"></a>系统报错 Error: No public port ‘80’ published for …，是什么意思？</h3><p>创建镜像时 Dockerfile 要指定正确的 EXPOSE 的端口，容器启动时指定PublishAllport&#x3D;true</p><h3 id="一个容器中可以同时运行多个应用进程吗"><a href="#一个容器中可以同时运行多个应用进程吗" class="headerlink" title="一个容器中可以同时运行多个应用进程吗"></a>一个容器中可以同时运行多个应用进程吗</h3><p>可以但不推荐在同一个容器内运行多个应用进程，如果有类似需求，可以通过额外的进程管理机制，比如 supervisord 来管理所运行的进程</p><h3 id="如何控制容器占用系统资源（CPU，内存）的份额"><a href="#如何控制容器占用系统资源（CPU，内存）的份额" class="headerlink" title="如何控制容器占用系统资源（CPU，内存）的份额"></a>如何控制容器占用系统资源（CPU，内存）的份额</h3><p>在使用 docker create 命令创建容器或使用 docker run 创建并运行容器的时候，可以使用-c|–cpu-shares[&#x3D;0]参数来调整同期使用 CPU 的权重，使用-m|–memory参数来调整容器使用内存的大小。</p><h2 id="仓库相关"><a href="#仓库相关" class="headerlink" title="仓库相关"></a>仓库相关</h2><h3 id="仓库（Repository）、注册服务器（Registry）、注册索引（Index）关系？"><a href="#仓库（Repository）、注册服务器（Registry）、注册索引（Index）关系？" class="headerlink" title="仓库（Repository）、注册服务器（Registry）、注册索引（Index）关系？"></a>仓库（Repository）、注册服务器（Registry）、注册索引（Index）关系？</h3><ul><li>仓库是存放一组关联镜像的集合，比如同一个应用的不同版本的镜像;</li><li>注册服务器是存放实际的镜像的地方，注册索引则负责维护用户的账号，权限，搜索，标签等管理；</li><li>注册服务器利用注册索引来实现认证等管理。</li></ul><h3 id="从非官方仓库下载镜像的时候提示“Error：Invaild-registry-endpoint"><a href="#从非官方仓库下载镜像的时候提示“Error：Invaild-registry-endpoint" class="headerlink" title="从非官方仓库下载镜像的时候提示“Error：Invaild registry endpoint"></a>从非官方仓库下载镜像的时候提示“Error：Invaild registry endpoint</h3><p>Docker 自 1.3.0 版本往后以来，加强了对镜像安全性的验证，需要手动添加对非官方仓库的信任。</p><p>DOCKER_OPTS&#x3D;”–insecure-registry dl.dockerpool.com:5000”</p><p>重启 docker 服务</p><h2 id="配置相关"><a href="#配置相关" class="headerlink" title="配置相关"></a>配置相关</h2><h3 id="Docker-的配置文件放在那里。如何修改配置？"><a href="#Docker-的配置文件放在那里。如何修改配置？" class="headerlink" title="Docker 的配置文件放在那里。如何修改配置？"></a>Docker 的配置文件放在那里。如何修改配置？</h3><p>Ubuntu 系统下 Docker 的配置文件是&#x2F;etc&#x2F;default&#x2F;docker，CentOS 系统配置文件存放在&#x2F;etc&#x2F;sysconfig&#x2F;docker</p><h3 id="如何更改-Docker-的默认存储设置？"><a href="#如何更改-Docker-的默认存储设置？" class="headerlink" title="如何更改 Docker 的默认存储设置？"></a>如何更改 Docker 的默认存储设置？</h3><p>Docker 的默认存放位置是&#x2F;var&#x2F;lib&#x2F;docker,如果希望将 Docker 的本地文件存储到其他分区，可以使用 Linux 软连接的方式来做。</p><h2 id="Docker-与虚拟化"><a href="#Docker-与虚拟化" class="headerlink" title="Docker 与虚拟化"></a>Docker 与虚拟化</h2><h3 id="Docker-与-LXC（Linux-Container）有何不同"><a href="#Docker-与-LXC（Linux-Container）有何不同" class="headerlink" title="Docker 与 LXC（Linux Container）有何不同"></a>Docker 与 LXC（Linux Container）有何不同</h3><p>LXC 利用 Linux 上相关技术实现容器，Docker 则在如下的几个方面进行了改进：</p><ul><li>移植性：通过抽象容器配置，容器可以实现一个平台移植到另一个平台；</li><li>镜像系统：基于 AUFS 的镜像系统为容器的分发带来了很多的便利，同时共同的镜像层只需要存储一份，实现高效率的存储；</li><li>版本管理：类似于 GIT 的版本管理理念，用户可以更方面的创建、管理镜像文件；</li><li>仓库系统：仓库系统大大降低了镜像的分发和管理的成本；</li><li>周边工具：各种现有的工具（配置管理、云平台）对 Docker 的支持，以及基于Docker 的 Pass、CI 等系统，让 Docker 的应用更加方便和多样化。</li></ul><h3 id="Docker-与-Vagrant-区别"><a href="#Docker-与-Vagrant-区别" class="headerlink" title="Docker 与 Vagrant 区别"></a>Docker 与 Vagrant 区别</h3><ul><li>Vagrant 类似于 Boot2Docker（一款运行 Docker 的最小内核），是一套虚拟机的管理环境，Vagrant 可以在多种系统上和虚拟机软件中运行，可以在 Windows。Mac等非 Linux 平台上为 Docker 支持，自身具有较好的包装性和移植性。</li><li>原生 Docker 自身只能运行在 Linux 平台上，但启动和运行的性能都比虚拟机要快，往往更适合快速开发和部署应用的场景。</li></ul><h3 id="开发环境中-Docker-与-Vagrant-如何选择"><a href="#开发环境中-Docker-与-Vagrant-如何选择" class="headerlink" title="开发环境中 Docker 与 Vagrant 如何选择"></a>开发环境中 Docker 与 Vagrant 如何选择</h3><p>Docker 不是虚拟机，而是进程隔离，对于资源的消耗很少，单一开发环境下Vagrant 是虚拟机上的封装，虚拟机本身会消耗资源。</p><h3 id="如何将一台宿主机的-docker-环境迁移到另外一台宿主机"><a href="#如何将一台宿主机的-docker-环境迁移到另外一台宿主机" class="headerlink" title="如何将一台宿主机的 docker 环境迁移到另外一台宿主机"></a>如何将一台宿主机的 docker 环境迁移到另外一台宿主机</h3><p>停止 Docker 服务，将整个 docker 存储文件复制到另外一台宿主机上，然后调整另外一台宿主机的配置即可</p><h3 id="Docker-容器创建后，删除了-var-run-netns-目录下的网络名字空间文件，如何手动恢复"><a href="#Docker-容器创建后，删除了-var-run-netns-目录下的网络名字空间文件，如何手动恢复" class="headerlink" title="Docker 容器创建后，删除了&#x2F;var&#x2F;run&#x2F;netns 目录下的网络名字空间文件，如何手动恢复"></a>Docker 容器创建后，删除了&#x2F;var&#x2F;run&#x2F;netns 目录下的网络名字空间文件，如何手动恢复</h3><p>查看容器进程 ID，比如 1234</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">docker inspect --format=<span class="hljs-string">&#x27;&#123;&#123;. State.pid&#125;&#125;&#x27;</span> <span class="hljs-variable">$container_id</span> 1234 <br></code></pre></td></tr></table></figure><p>到 proc 目录下，把对应的网络名字空间文件链接到&#x2F;var&#x2F;run&#x2F;netns,然后通过正常的系统命令查看操作容器的名字空间。</p><p>（完）</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>Docker</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Docker</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>值得一听的音乐</title>
    <link href="/blog/2023/10/%E5%80%BC%E5%BE%97%E4%B8%80%E5%90%AC%E7%9A%84%E9%9F%B3%E4%B9%90.html"/>
    <url>/blog/2023/10/%E5%80%BC%E5%BE%97%E4%B8%80%E5%90%AC%E7%9A%84%E9%9F%B3%E4%B9%90.html</url>
    
    <content type="html"><![CDATA[<h2 id="流行"><a href="#流行" class="headerlink" title="流行"></a>流行</h2><ul><li>《曾经我也想过一了百了》中岛美嘉</li></ul><h2 id="钢琴曲"><a href="#钢琴曲" class="headerlink" title="钢琴曲"></a>钢琴曲</h2><ul><li>Daydreaming - Piano Solo Collection</li></ul>]]></content>
    
    
    <categories>
      
      <category>生活</category>
      
      <category>经验</category>
      
    </categories>
    
    
    <tags>
      
      <tag>清单</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>值得一看的视频</title>
    <link href="/blog/2023/10/%E5%80%BC%E5%BE%97%E4%B8%80%E7%9C%8B%E7%9A%84%E8%A7%86%E9%A2%91.html"/>
    <url>/blog/2023/10/%E5%80%BC%E5%BE%97%E4%B8%80%E7%9C%8B%E7%9A%84%E8%A7%86%E9%A2%91.html</url>
    
    <content type="html"><![CDATA[<h2 id="心理类"><a href="#心理类" class="headerlink" title="心理类"></a>心理类</h2><ul><li>哈佛大学的公开课《幸福课》 也叫《积极心理学》</li></ul><h2 id="纪录片"><a href="#纪录片" class="headerlink" title="纪录片"></a>纪录片</h2><ul><li>美丽中国  </li><li>地球脉动</li><li>蓝色星球</li><li>像乌鸦一样思考</li><li>微观世界</li><li>此话怎讲</li><li>迁徙的鸟</li><li>河西走廊</li><li>中国唱诗班</li><li>典籍里的中国</li><li>故宫100</li><li>汉字五千年</li><li>大国崛起</li><li>小小少年</li><li>书简阅中国</li><li>人类星球</li><li>猫咪物语</li></ul><p>（完）</p>]]></content>
    
    
    <categories>
      
      <category>生活</category>
      
      <category>经验</category>
      
    </categories>
    
    
    <tags>
      
      <tag>清单</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>学习资源推荐</title>
    <link href="/blog/2023/10/%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%BA%90%E6%8E%A8%E8%8D%90.html"/>
    <url>/blog/2023/10/%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%BA%90%E6%8E%A8%E8%8D%90.html</url>
    
    <content type="html"><![CDATA[<h2 id="网络类"><a href="#网络类" class="headerlink" title="网络类"></a>网络类</h2><ul><li><a href="https://speed.cloudflare.com/">https://speed.cloudflare.com/</a></li></ul><blockquote><p>测速</p></blockquote><ul><li><a href="https://chat.openai.com/">https://chat.openai.com/</a></li></ul><blockquote><p>chatgpt</p></blockquote><ul><li><a href="https://filezilla-project.org/prodownload.php">https://filezilla-project.org/prodownload.php</a></li></ul><blockquote><p>FileZilla Pro下载地址</p></blockquote><h2 id="工具类"><a href="#工具类" class="headerlink" title="工具类"></a>工具类</h2><ul><li><a href="https://excalidraw.com/">https://excalidraw.com/</a></li></ul><blockquote><p>手绘白板</p></blockquote><ul><li><a href="https://hashcat.net/hashcat/">https://hashcat.net/hashcat/</a></li></ul><blockquote><p>密码碰撞破解</p></blockquote><ul><li><a href="https://workout.lol/">https://workout.lol/</a></li></ul><blockquote><p>健身计划和演示</p></blockquote><ul><li><a href="https://scorpionfree98.github.io/fetch_address_detail/Geocoder.html">https://scorpionfree98.github.io/fetch_address_detail/Geocoder.html</a></li></ul><blockquote><p>根据地址获取街道信息</p></blockquote><h2 id="表达式"><a href="#表达式" class="headerlink" title="表达式"></a>表达式</h2><ul><li><a href="https://crontab.guru/">https://crontab.guru/</a></li></ul><blockquote><p>crontab表达式</p></blockquote><h2 id="博客论坛"><a href="#博客论坛" class="headerlink" title="博客论坛"></a>博客论坛</h2><ul><li><a href="https://insights.thoughtworks.cn/">https://insights.thoughtworks.cn/</a></li></ul><blockquote><p>洞见</p></blockquote><h2 id="学习资源列表"><a href="#学习资源列表" class="headerlink" title="学习资源列表"></a>学习资源列表</h2><ul><li><a href="https://learn.lianglianglee.com/">https://learn.lianglianglee.com/</a></li></ul><blockquote><p>极客时间资源整合</p></blockquote><h2 id="考证清单"><a href="#考证清单" class="headerlink" title="考证清单"></a>考证清单</h2><ul><li><a href="https://www.miiteec.org.cn/plus/list.php?tid=247">https://www.miiteec.org.cn/plus/list.php?tid=247</a></li></ul><blockquote><p>工信和信息化人才培养证书</p></blockquote><p>（完）</p>]]></content>
    
    
    <categories>
      
      <category>生活</category>
      
      <category>经验</category>
      
    </categories>
    
    
    <tags>
      
      <tag>清单</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>值得一读的书单</title>
    <link href="/blog/2023/10/%E5%80%BC%E5%BE%97%E4%B8%80%E8%AF%BB%E7%9A%84%E4%B9%A6%E5%8D%95.html"/>
    <url>/blog/2023/10/%E5%80%BC%E5%BE%97%E4%B8%80%E8%AF%BB%E7%9A%84%E4%B9%A6%E5%8D%95.html</url>
    
    <content type="html"><![CDATA[<h2 id="思维成长"><a href="#思维成长" class="headerlink" title="思维成长"></a>思维成长</h2><ul><li><p>失控</p></li><li><p>思考快与慢</p></li><li><p>终身成长</p></li><li><p>高效能人士的思维方式</p></li><li><p>高效能人士的七个习惯</p></li><li><p>从为什么开始</p></li><li><p>赋能</p></li><li><p>敏捷革命</p></li><li><p>创建敏捷团队</p></li><li><p>高绩效教练</p></li><li><p>结构化研讨</p></li><li><p>团队协作的五大障碍</p></li><li><p>拥抱变革</p></li><li><p>管理者的意识进化</p></li><li><p>你的灯亮着吗</p></li><li><p>探索需求-设计前的质量</p></li><li><p>麦肯锡教我的思考武器</p></li><li><p>咨询的奥秘</p></li><li><p>系统思维</p></li><li><p>金字塔原理</p></li><li><p>《思维导图》 —陈国钦</p></li></ul><p>思维导图法就是一种生活的心法及技法，陈国钦著的《思维导图（提升你的职场核心竞争力）》是其任跨国企业副总经理、HP亚洲经理人等的经验浓缩。通过学习后，工作效率提升很快，不论在消化大量信息、团队沟通、演讲或学习上都能快速抓到重点，并为公司带来百亿业绩。本书对思维能力的锻炼帮助很大，让你在提前面试中侃侃而谈，脱颖而出。</p><ul><li>《疯狂的简洁》—肯·西格尔</li></ul><p>这本书关注的是创意和流程。它不仅关注如何创造最好的作品，如何为它争得发展空间，也关注如何高效运作以获得更圆满的结果。作者曾担任宝马、IBM、NeXT和苹果公司的创意总监，与史蒂夫·乔布斯共事17年，参与了苹果“不同凡想”广告的制作、iMac的命名等苹果历史。</p><ul><li>《从0到1》—彼得·蒂尔、布莱克·马斯特斯</li></ul><p>《从0到1》无疑是最近最棒的创业思维书! 硅谷创投教父、PayPal创始人彼得·蒂尔、布莱克·马斯特斯写了这本人人都能看懂的资本、创业专著!在这里你会明白：从0到1，就是创新;从1到N，是不断的模仿。创新：不是从1到N，而是从0到1。</p><ul><li>《异类》—马尔科姆·格拉德威尔</li></ul><p>了解成功的真正奥秘，以及人们成功的方式。马尔科姆·格拉德威尔揭示了10,000小时定律。书中提到努力和运气（家庭出身、出生地、甚至出生日期）在成功的公式当中都是划等号的。</p><ul><li>《引爆点》—马尔科姆·格拉德威尔</li></ul><p>马尔科姆·格拉德威尔向我们揭示了当一个趋势或者一个想法到达了神奇的“引爆点”以后，会像火山一样喷发出来。</p><ul><li>《从优秀到卓越》—吉姆·柯林斯</li></ul><p>作者用了长达5年的时间去研究优秀的公司和卓越的公司的差别。这本书能教会你从长远的角度运营公司而不是给公司寻找偏方。</p><ul><li>《习惯的力量》—查尔斯·都希格</li></ul><p>通过学习习惯养成的科学原理，可以改掉你的一些坏习惯。书中同样讲到了公司是如何使用习惯来销售产品的故事。</p><ul><li>《管理学》 —罗宾斯</li></ul><p>世界上最畅销的管理学教科书，自出版以来，持续畅销数十年，受到世界各地管理学界师生和企业界管理者的普遍好评。作者罗宾斯博士是世界上管理学与组织行为学领域最畅销教科书的作者，他的书被1000多所美国高校选用，并被译为16种文字在世界各地广泛使用。</p><ul><li>《每周工作4小时》—蒂姆·费里斯</li></ul><p>通过更少地工作挣更多的钱这一新奇的想法，不论你是不是企业家，你都应该读读这本书。</p><ul><li>《复合效应》—达伦·海迪</li></ul><p>这本书是引领卓越人生的指南，里面的公式值得一用。</p><ul><li>《80&#x2F;20法则》—理查德·科赫</li></ul><p>这本书提到集中20%的努力到关键的任务上，能够产生80%的结果。</p><ul><li>《商业的本质》—杰克·韦尔奇</li></ul><p>这是“全球第一CEO”杰克·韦尔奇继管理圣经《赢》之后，潜心十年的封笔之作，是对过去十几年商业变革的反思和总结。他指出，科技革命给市场带来了巨大变化和诸多杂音，但作为管理者，不能迷失商业中最核心的东西。在如今的新商业环境下，要想“赢”，就必须遵从商业的规则，回归商业的本质。</p><ul><li>《大败局》—吴晓波</li></ul><p>本书被评为“影响中国商业界的20本图书”之一，是关于中国企业失败的MBA式教案！吴晓波通过对近百位影响中国企业发展的重要人物的专访，探寻中国企业“中国式失败”的基因。</p><ul><li>《精益创业:新创企业的成长思维》—埃里克・莱斯</li></ul><p>《精益创业》是创业管理领域的重磅之作，也绝对有潜质经受时间的考验，成为创业管理的经典图书。这本书被誉为市面上最为正确描写硅谷的书籍，它提供了不同于传统管理理论的、针对新创公司或大企业新创业务的科学管理模式。</p><ul><li>《终极问题：创造好利润，促进真成长》—赖克哈尔德</li></ul><p>本书是写给那些希望摆脱公司两难困境、真正获取利润，并实现企业成长的企业领导的。是一本阐述客户关系和利润增长之间关系的书，本书透彻地阐述了良性利润和不良利润之间的区别，它将改变我们衡量企业成功与否的看法。</p><ul><li>《在家就能读MBA》—乔希·考夫曼</li></ul><p>这本书包含了创业需要知道的大部分知识（或许还有更多），书中全部都是干货，语言通俗易懂。</p><h2 id="软件工程"><a href="#软件工程" class="headerlink" title="软件工程"></a>软件工程</h2><ul><li>敏捷软件开发</li><li>软件开发本质论</li><li>Scrum敏捷软件开发</li><li>用户故事与敏捷方法</li><li>敏捷估计与规划</li><li>Scrum精髓</li><li>敏捷回顾</li><li>敏捷整洁之道</li><li>代码整洁之道</li><li>解析极限编程</li><li>测试驱动开发</li><li>持续集成</li><li>重构</li><li>持续交付</li><li>人月神话</li><li>凤凰项目</li></ul><h2 id="心理类"><a href="#心理类" class="headerlink" title="心理类"></a>心理类</h2><ul><li><p>伯恩斯新情绪疗法</p></li><li><p>被讨厌的勇气</p></li><li><p>治疗好了我的精神内耗</p></li><li><p>存在主义心理治疗</p></li><li><p>蛤蟆先生去看心理医生</p></li><li><p>原生家庭–如何修补自己的性格缺陷</p></li><li><p>贫困的本质</p></li><li><p>了不起的我</p></li><li><p>少有人走的路</p></li><li><p>拥抱你的抑郁情绪</p></li><li><p>为何爱会伤人</p></li><li><p>非暴力沟通</p></li><li><p>当下的力量</p></li><li><p>《幸福的勇气》</p></li><li><p>《 5%的改变》</p></li><li><p>生命的重建</p></li><li><p>自卑与超越</p></li><li><p>《人性的优点》</p></li><li><p>《人性的弱点》</p></li><li><p>《以幽默的方式过一生》</p></li><li><p>《人生的智慧》叔本华</p></li><li><p>《身份的焦虑》阿兰·德波顿</p></li><li><p>《社会性动物》埃利奥特·阿伦森</p></li><li><p>《亲密关系》罗兰·米勒</p></li><li><p>《等待我的离去》</p></li><li><p>阿德勒：个体心理学</p></li><li><p>《活出生命的意义》</p></li><li><p>《法的医疗》</p></li><li><p>《身体从未忘记》</p></li><li><p>《你经历了什么》</p></li><li><p>《如何吵架》</p></li><li><p>《也许你该找个人聊聊》</p></li></ul><p>（完）</p>]]></content>
    
    
    <categories>
      
      <category>生活</category>
      
      <category>经验</category>
      
    </categories>
    
    
    <tags>
      
      <tag>清单</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>接口测试工具Insomnia入门使用</title>
    <link href="/blog/2023/09/%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7Insomnia%E5%85%A5%E9%97%A8%E4%BD%BF%E7%94%A8.html"/>
    <url>/blog/2023/09/%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7Insomnia%E5%85%A5%E9%97%A8%E4%BD%BF%E7%94%A8.html</url>
    
    <content type="html"><![CDATA[<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>打开官网的下载地址：<a href="https://insomnia.rest/download">Download - Insomnia</a></p><p>下载对应平台的安装包，然后安装完打开界面，新建一个<strong>文档类型</strong>的项目空间。</p><p><img src="/blog/./assets/image-20230927222418466.png" alt="新建项目空间"></p><p>进入项目空间后，默认是在DESIGN菜单的，先点击DEBUG菜单进入调试工作区。</p><p><img src="/blog/./assets/image-20230927222704484.png" alt="空间布局"></p><h2 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h2><p>下面以一个接口为例进行演示。下图中，除了标记③是需要借助插件来实现自己校验功能，其余的功能都是通过Insomnia自带实现的。</p><p><img src="/blog/./assets/image-20230927222942034.png" alt="image-20230927222942034"></p><blockquote><p>标记③借助的插件是：Response Validator Unit Test Plugin</p></blockquote><h3 id="安装插件"><a href="#安装插件" class="headerlink" title="安装插件"></a>安装插件</h3><ul><li><p>Response Validator Unit Test Plugin</p><ul><li>根据 Jsonpath 校验响应结果（已二开开源，支持区间和集合校验）</li></ul></li><li><p>faker </p><ul><li>测试数据 Mock（底层是 faker.js）</li></ul></li><li><p>mockchineseidcard Plugin </p><ul><li>生成符合校验的大陆身份证(可根据是否成年和性别区分（每次请求都会变化）</li></ul></li><li><p>response parse json </p><ul><li>将结果响应中 Json 字符串转成 Json 对象</li></ul></li><li><p>Runner </p><ul><li>支持批量执行目录下的用例</li></ul></li><li><p>SM3 Plugin </p><ul><li>支持SM3散列而开发的插件（已开源）</li></ul></li><li><p>Postman Export</p><ul><li>导出 Postman 格式</li></ul></li></ul><p><img src="/blog/./assets/image-20230927223310137.png" alt="插件列表"></p><h4 id="Response-Validator-Unit-Test-Plugin使用"><a href="#Response-Validator-Unit-Test-Plugin使用" class="headerlink" title="Response Validator Unit Test Plugin使用"></a>Response Validator Unit Test Plugin使用</h4><p>在请求的接口 Headers 上，添加一个Header</p><ul><li>key是固定值，表示要开始自动校验。</li><li>value是要校验的JsonPath规则。</li></ul><p>示例：Key:INSOMNIA-RESPONSE-VALIDATOR   value:校验规则的JsonPath</p><p><img src="/blog/./assets/image-20230927223458593.png" alt="校验规则"></p><p><img src="/blog/./assets/image-20230927223552194.png" alt="校验说明"></p><blockquote><p>JsonPath示例说明：两个标记数字相同则是一处校验点。</p></blockquote><p>下面是JsonPath校验对应的解释：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br> <span class="hljs-attr">&quot;$.respBody.flag&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1&quot;</span><span class="hljs-punctuation">,</span> #固定值校验<br> <span class="hljs-attr">&quot;$.respBody.psce_fraud_jsrcu_score&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br> <span class="hljs-string">&quot;range&quot;</span><span class="hljs-punctuation">,</span> #range，范围校验(<span class="hljs-number">300</span>到<span class="hljs-number">850</span>这种），这里表示校验在<span class="hljs-punctuation">[</span><span class="hljs-number">300</span><span class="hljs-punctuation">,</span><span class="hljs-number">850</span><span class="hljs-punctuation">]</span>的区间 <span class="hljs-string">&quot;300&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;850&quot;</span> <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br> <span class="hljs-attr">&quot;$.respBody.ppre_fraud_jsrcu_label&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br> <span class="hljs-string">&quot;valid&quot;</span><span class="hljs-punctuation">,</span> #valid<span class="hljs-punctuation">,</span>集合校验(校验非连续<span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span><span class="hljs-number">7</span>这种），这里表示校验<span class="hljs-punctuation">&#123;</span><span class="hljs-number">0</span>，<span class="hljs-number">1</span><span class="hljs-punctuation">&#125;</span>，连续 <span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span> <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br> <span class="hljs-attr">&quot;$.respHead.resp_cd&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;000000&quot;</span><span class="hljs-punctuation">,</span> #固定值校验 <span class="hljs-attr">&quot;$.respHead.resp_msg&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br> <span class="hljs-string">&quot;valid&quot;</span><span class="hljs-punctuation">,</span> #集合校验，单个值可用固定值校验代替<br> <span class="hljs-string">&quot;处理成功&quot;</span> <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br> <span class="hljs-attr">&quot;$.respHead.comprs&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;0&quot;</span> #固定值校验<br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>(本文完)</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>操作演示</category>
      
    </categories>
    
    
    <tags>
      
      <tag>软件测试</tag>
      
      <tag>测试工具</tag>
      
      <tag>Insomnia</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Windows 11 使用技巧</title>
    <link href="/blog/2023/09/Windows%2011%20%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7.html"/>
    <url>/blog/2023/09/Windows%2011%20%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7.html</url>
    
    <content type="html"><![CDATA[<h2 id="实用技巧"><a href="#实用技巧" class="headerlink" title="实用技巧"></a>实用技巧</h2><ul><li><p>按 Win + E 打开文件资源管理器。</p></li><li><p>资源管理器(或网页浏览器) 按 Ctrl + L 或 Alt+ D 或 F4&#x2F;F6 可快速切换到地址栏。</p></li><li><p>在资源管理器按住 Shift 键点右键可以显示隐藏菜单项，例如：“复制文件地址”。</p></li></ul><blockquote><p>注意：复制的路径首尾是带双引号的。</p></blockquote><ul><li><p>资源管理器右键点选一个或多个图片，可在弹出菜单中直接旋转图片。</p></li><li><p>连续重命名文件：在资源管理器按 F2 命名文件，修改名称后不要按回车 —— 直接按 tab 键可以跳到下一个文件并切换到重命名输入。</p></li><li><p>按住 Ctrl 拖动文件 —— 复制文件，按住 Shift 拖动文件 —— 移动文件，按住 Alt 拖动文件 —— 创建快捷方式。</p></li><li><p>在资源管理器地址栏（按 Win + R 打开运行对话框也可以）可输入系统目录环境变量回车可直接打开对应目录，例如输入 %temp% 可以打开临时目录，输入 %localappdata% 可以打开 AppData 目录。</p></li><li><p>按 Win + D 最小化所有程序并返回桌面，再按一次 Win + D 又可以回到原来的窗口。</p></li><li><p>按 Alt + F4 关闭窗口，在桌面窗口按 Alt + F4 会弹出关机对话框。</p></li><li><p>按 Win + L 锁定计算机。</p></li><li><p>按 Win + P 可以快速切换多屏显示方式。</p></li><li><p>按 Alt + Esc 将当前活动窗口移动到最后面。</p></li><li><p>按 Ctrl + W 或 ALT + F4快速关闭窗口。</p></li><li><p>在弹出的错误对话框上按 Ctrl + C 可以复制内容。</p></li><li><p>连续按 Win + → 或 ← 窗口可以切换屏幕左、屏幕右、屏幕中间。</p></li><li><p>连续按 Win + ↑ 或 ↓ 当前窗口可以切换最大化、屏幕中间、最小化状态。</p></li><li><p>按 Win + 数字键可以切换到任务栏的第 n 个程序。</p></li><li><p>Windows 10 &#x2F; 11 系统控制台程序可按 Alt + Enter 切换全屏。</p></li><li><p>在命令行窗口可以按 tab 键自动完成输入，按 F7 可以显示历史记录</p></li><li><p>在资源管理器地址栏直接输入 cmd 回车，可在当前目录打开命令行。</p></li><li><p>按 Win + Shift + S 可以打开系统自带截图工具。</p></li><li><p>按 Win + G 可以打开系统自带录屏工具。</p></li><li><p>按 Win + . 可打开系统自带表情符号面板。</p></li><li><p>Ctrl + C &#x2F; Ctrl + Insert 都可以复制。</p></li><li><p>Ctrl + V &#x2F; Shift + Insert 都可以粘贴。</p></li><li><p>Ctrl + Z &#x2F; Alt + Backspace 都可以撤消。</p></li><li><p>大多数输入法都支持的常用快键键：</p><ul><li>「Shift」切换中&#x2F;英输入；</li><li>「Ctrl + . 」切换中&#x2F;英标点；</li><li>「Shift + 空格 」切换全&#x2F;半角；</li></ul></li></ul><h3 id="运行程序"><a href="#运行程序" class="headerlink" title="运行程序"></a>运行程序</h3><p>按 Win 弹出开始菜单后直接打字可打开搜索窗口（ 或按 Win + S ），这里也可以输入系统能搜索到的程序文件名。支持在注册表路径下添加的应用程序文件名。</p><figure class="highlight moonscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs moonscript">HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths<br></code></pre></td></tr></table></figure><ul><li>按 Ctrl + Shift + Esc 可直接打开任务管理器。</li><li>按 Win + V 可以查看剪贴板历史</li><li>按 Win + Pause 可查看系统属性。</li></ul><h3 id="重启进入bios"><a href="#重启进入bios" class="headerlink" title="重启进入bios"></a>重启进入bios</h3><ol><li>以管理员身份打开“命令提示符”。</li><li>键入：shutdown &#x2F;r &#x2F;fw，然后按 Enter 键。</li><li>系统将在一分钟后自动重新启动至 BIOS。</li></ol><h3 id="常用命令和含义"><a href="#常用命令和含义" class="headerlink" title="常用命令和含义"></a>常用命令和含义</h3><table><thead><tr><th>命令</th><th>含义</th></tr></thead><tbody><tr><td>cmd</td><td>打开命令行</td></tr><tr><td>calc</td><td>计算器</td></tr><tr><td>control</td><td>控制面板</td></tr><tr><td>drivers</td><td>打开C:\Windows\System32\drivers目录</td></tr><tr><td>shell:Downloads</td><td>打开下载目录</td></tr></tbody></table><p>（完）</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>Windows</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Windows</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Jmeter安装和介绍</title>
    <link href="/blog/2023/09/Jmeter%E5%AE%89%E8%A3%85%E5%92%8C%E4%BB%8B%E7%BB%8D.html"/>
    <url>/blog/2023/09/Jmeter%E5%AE%89%E8%A3%85%E5%92%8C%E4%BB%8B%E7%BB%8D.html</url>
    
    <content type="html"><![CDATA[<h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>Apache JMeter是一个Apache项目，可以用作负载测试工具，用于分析和测量各种服务的性能，可用于 Web 应用程序的接口测试、自动化测试、性能测试。</p><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>Jmeter 依赖 Java运行时，所以需要在本机安装 JRE 或 JDK。</p><h3 id="安装步骤"><a href="#安装步骤" class="headerlink" title="安装步骤"></a>安装步骤</h3><p>首先下载 Jmeter，然后解压zip包。</p><ul><li>Windows<ul><li>进入解压后文件夹 \bin 文件夹中，双击  jmeter.ba t，启动图形界面GUI。</li></ul></li></ul><ul><li>Unix&#x2F;Linux<ul><li>进入解压后文件夹 \bin 的命令行，执行.&#x2F;jmeter.sh 命令启动图形界面GUI。</li></ul></li></ul><blockquote><p> 注意：不需要配置<strong>JMETER_HOME环境变量</strong>，如果配置了，那么你的电脑就有且仅能运行一个Jmeter。其他版本的 Jmeter可能直接闪退，因为不配置时会读取 Jmeter当前目录下的环境变量，不同 Jmeter 版本下的环境变量会有所不同。</p></blockquote><h3 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h3><ul><li>bin  启动 配置文件</li><li>lib   jar包  工具自身jar， 以及第三方jar<ul><li>ext   第三方插件管理</li></ul></li><li>docs   文档  用于jmeter进行二次开发调用的api  接口文档</li><li>printable_docs   离线帮助文档</li><li>extras  扩展   CICD 性能测试持续集成</li></ul><h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><ul><li>设置语言：<ul><li>以.properties结尾的文件，都是jmeter的<strong>属性</strong>配置文件</li><li>属性配置文件   jmeter.properties</li></ul></li></ul><blockquote><p>注意：修改<strong>属性配置文件</strong>中的信息，一定要重启才能生效</p></blockquote><p>在图形界面的options  &gt; choose language 修改语言后会临时切换gui界面语言，一旦关闭gui，就会被还原。如果要永久生效，需要修改properties文件。</p><h3 id="图形界面"><a href="#图形界面" class="headerlink" title="图形界面"></a>图形界面</h3><ul><li>测试计划<ul><li>元件<ul><li>线程组： 接口、自动化测试时，基本不会去改动<ul><li>性能测试，这个是用于<strong>进行性能场景设计</strong>的</li><li>线程组：进行性能场景设计 </li><li>setup线程组<ul><li>前置</li></ul></li><li>teardown线程组<ul><li>后置</li></ul></li></ul></li><li>配置元件<ul><li>优先级是最高的</li><li><strong>用户定义变量</strong></li></ul></li><li>监听器<ul><li>性能结果进行监控，展示结果数据</li><li>不同的元件，是从不同的角度，展示结果数据</li></ul></li><li>取样器： 根据不同的协议，使用不同的取样器<strong>编写脚本</strong></li><li>逻辑控制</li><li>前置<ul><li><strong>用户参数</strong></li></ul></li><li>后置<ul><li>对 取样器进行控制</li></ul></li><li>定时器</li></ul></li></ul></li></ul><p>（本文完）</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>操作演示</category>
      
    </categories>
    
    
    <tags>
      
      <tag>软件测试</tag>
      
      <tag>测试工具</tag>
      
      <tag>Jmeter</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>浅谈性能测试</title>
    <link href="/blog/2023/09/%E6%B5%85%E8%B0%88%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95.html"/>
    <url>/blog/2023/09/%E6%B5%85%E8%B0%88%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95.html</url>
    
    <content type="html"><![CDATA[<h2 id="测试划分"><a href="#测试划分" class="headerlink" title="测试划分"></a>测试划分</h2><p>软件测试可以分为功能测试和非功能测试，功能测试根据测试金字塔可以分为单元测试、接口测试、UI测试、探索测试。更多的功能测试包含以下：</p><ul><li>单元测试(Unit testing)</li><li>集成测试(Integration testing)</li><li>系统测试(System testing)</li><li>健全性测试(Sanity testing)</li><li>冒烟测试(Smoke testing)</li><li>接口测试(Interface testing)</li><li>回归测试(Regression testing)</li><li>Beta&#x2F;验收测试(Beta&#x2F;Acceptance testing)</li></ul><p>非功能测试包含以下：</p><ul><li>性能测试(Performance Testing)</li><li>负载测试(Load testing)</li><li>压力测试(Stress testing)</li><li>容量测试(Volume testing)</li><li>安全测试(Security testing)</li><li>兼容性测试(Compatibility testing)</li><li>安装测试(Install testing)</li><li>恢复测试(Recovery testing)</li><li>可靠性测试(Reliability testing)</li><li>可用性测试(Usability testing)</li><li>一致性测试(Compliance testing)</li><li>本地化测试(Localization testing)</li></ul><h2 id="测试思维"><a href="#测试思维" class="headerlink" title="测试思维"></a>测试思维</h2><p>不同的测试之间，使用到的测试思维是不同的。</p><p>功能测试是<strong>对输出结果的校验</strong>，都是模拟单用户的操作，对比预期结果和实际的输出结果。</p><p>性能测试是同时模拟多个用户同时操作，关注服务端的响应时间。</p><h2 id="性能测试"><a href="#性能测试" class="headerlink" title="性能测试"></a>性能测试</h2><p>通过工具模拟多用户发起请求的行为，获取<strong>性能指标值</strong>。</p><p>常见模拟工具分类：</p><ul><li>使用线程<ul><li>线程是使用进程的资源。工具：Jmeter、LoadRunner</li></ul></li><li>使用进程<ul><li>资源拥有者，资源销毁会更大。工具：LoadRunner</li></ul></li><li>使用进程+ 线程<ul><li>工具：ngrinder</li></ul></li><li>使用协程<ul><li>虚拟线程。工具： python+locust</li></ul></li></ul><h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><ul><li>满意度指数</li></ul><p>多用户同时访问登入接口，性能中的avgRT应该在1.5s可以被接受的。因为1.5秒 是APDEX 用户满意度指数。</p><ul><li>事务</li></ul><p>一个请求行为，并不一定只有一个接口，所以，一个事务可能是多个接口。</p><blockquote><p>注意：在Jmeter中，默认1个接口请求一次，即每次请求行为是一个事务，可以通过事务控制器，挂载多个接口请求，合并成为1个事务。</p></blockquote><ul><li><p>性能指标： </p><ul><li><p>平均响应时间（avgRT）</p><ul><li>比如 rt90%,rt95%,rt99%</li></ul></li><li><p>服务器每秒处理的事务数(TPS)</p><ul><li>衡量<strong>服务器</strong>处理能力的最主要的指标</li><li>50tps： 服务器每秒能处理50个事务，1小时是50 t&#x2F;s  * 60 * 60 &#x3D; 18w</li></ul></li><li><p>用户请求频率(RPS)</p><ul><li>100个并发数发起请求，一秒钟会发起多少请求？</li></ul><p>如果每个并发都消耗1秒（即请求频率是是1），则请求总量是100。</p><p>如果每个并发都消耗200毫秒（即请求频率是是5），则请求总量是500。</p><p>当请求的频率不清楚时，无法计算1秒钟总请求量。</p></li></ul><ul><li>每秒查询率（QPS)<ul><li>如果把1个事务，当做只查询1次，则QPS&#x3D;TPS。</li><li>实际请求可能是 1个TPS: N个QPS，即1 个完整事务请求会包含多个查询的请求。</li></ul></li><li>每秒用户点击率（HPS）<ul><li>更侧重页面上的点击。</li></ul></li></ul></li><li><p>吞吐量</p><ul><li><strong>网络</strong>中每秒传输的事务数<ul><li>没有网络瓶颈：tps 数值 &#x3D; 吞吐量数值</li><li>如果网络有瓶颈: tps 数值 !&#x3D; 吞吐量数值</li></ul></li></ul></li><li><p>吞吐率  </p><ul><li>每秒钟能通过多少kb数据</li></ul></li><li><p>服务器资源利用率</p><ul><li>cpu、内存、io的利用率</li></ul></li><li><p>并发用户数：</p><ul><li><p>同一时间发起请求的用户数</p><ul><li><p>广义并发： 同一时间发起请求(相同和不相同)</p><ul><li>针对整个产品的请求</li></ul></li><li><p>狭义并发：同一时间发起相同请求</p><ul><li><p>集合点：集合多个人在同一时间发起相同请求</p></li><li><p>比如秒杀接口。</p></li></ul></li></ul></li></ul></li></ul><h3 id="性能测试流程"><a href="#性能测试流程" class="headerlink" title="性能测试流程"></a>性能测试流程</h3><ul><li>性能测试准备</li><li>搭建性能测试环境</li><li>性能测试脚本开发</li><li>性能测试脚本执行</li><li>结果分析与调优</li><li>测试报告与结果跟踪</li></ul><h2 id="负载测试"><a href="#负载测试" class="headerlink" title="负载测试"></a>负载测试</h2><p>负载测试是通过逐步增加并发用户数，找出性能的最大拐点区间。</p><ul><li>逐步增加并发用户数</li><li>区间判断<ul><li>有没有报错</li><li>tps下降</li><li>响应时间变长</li></ul></li></ul><h2 id="压力测试"><a href="#压力测试" class="headerlink" title="压力测试"></a>压力测试</h2><p>使用<strong>一定量</strong>的并发用户数，持续<strong>比较长时间</strong>向服务器发起请求，查看服务器的<strong>稳定性</strong>。</p><p>一定量访问会小于最大并发用户数  ，比如20% 或 80%。</p><p>前者20%为了更快收集数据便于统计分析。</p><p>后者80%是为了观测服务器的稳定性。</p><h2 id="容量测试"><a href="#容量测试" class="headerlink" title="容量测试"></a>容量测试</h2><p>比如测试环境和生成环境所使用的测试数据容量。</p><p>在性能测试时，如果数据库的数据量级是不一致的，性能指标值，也可能存在差异。 所以在测试中要使用和生产相应的数据量级。同时要保证机器资源配置是和生产完全一样（硬件配置一样、数量一样、网络一样、架构参数一样）。</p><h2 id="测试顺序"><a href="#测试顺序" class="headerlink" title="测试顺序"></a>测试顺序</h2><p>在性能测试之前，最好先进行负责测试，分析性能的最大拐点。在根据拐点值进行性能测试，分析性能指标和调优。最后做压力测试查看服务器的稳定性。</p><ol><li>负载测试</li><li>性能测试</li><li>压力测试</li></ol><p>（本文完）</p>]]></content>
    
    
    <categories>
      
      <category>工作</category>
      
      <category>业务架构</category>
      
    </categories>
    
    
    <tags>
      
      <tag>性能测试</tag>
      
      <tag>软件测试</tag>
      
      <tag>负载测试</tag>
      
      <tag>压力测试</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>国产Linux软件清单</title>
    <link href="/blog/2023/09/%E5%9B%BD%E4%BA%A7Linux%E8%BD%AF%E4%BB%B6%E6%B8%85%E5%8D%95.html"/>
    <url>/blog/2023/09/%E5%9B%BD%E4%BA%A7Linux%E8%BD%AF%E4%BB%B6%E6%B8%85%E5%8D%95.html</url>
    
    <content type="html"><![CDATA[<h2 id="输入法"><a href="#输入法" class="headerlink" title="输入法"></a>输入法</h2><ul><li><a href="https://srf.baidu.com/site/guanwang_linux/index.html">百度输入法</a></li><li><a href="https://pinyin.sogou.com/linux?r=pinyin">搜狗输入法</a></li><li><a href="https://pinyin.thunisoft.com/index.html#/sy">华宇输入法</a></li><li><a href="http://www.znwb.com/linuxxz.html">智能陈桥输入法</a></li><li><a href="http://ime.onon.cn/zh-CN/download">Onon输入法</a></li></ul><h2 id="通讯"><a href="#通讯" class="headerlink" title="通讯"></a>通讯</h2><ul><li><a href="https://im.qq.com/linuxqq/index.html">腾讯tim</a></li><li><a href="https://www.feishu.cn/download">飞书</a></li><li><a href="http://www.ipmsg.org.cn/home/index/download">飞鸽传书</a></li><li><a href="https://page.dingtalk.com/wow/z/dingtalk/default/dddownload-index">钉钉</a></li></ul><h2 id="图像处理"><a href="#图像处理" class="headerlink" title="图像处理"></a>图像处理</h2><ul><li><a href="https://pc.meitu.com/download">美图秀秀</a></li></ul><h2 id="影音"><a href="#影音" class="headerlink" title="影音"></a>影音</h2><ul><li><a href="http://v.qq.com/download.html#Linux">腾讯视频</a></li><li><a href="https://y.qq.com/download/download.html">QQ音乐</a></li><li><a href="https://music.163.com/#/download">网易云音乐</a></li></ul><h2 id="办公软件"><a href="#办公软件" class="headerlink" title="办公软件"></a>办公软件</h2><ul><li><a href="https://linux.wps.cn/">WPS</a></li><li><a href="http://www.yozosoft.com/product-officelinux.html">永中Office</a></li><li><a href="https://www.wiz.cn/zh-cn/download.html">为知笔记</a></li><li><a href="https://www.xmind.net/download/">XMind</a></li><li><a href="https://www.edrawsoft.cn/download/">亿图图示&#x2F;脑图&#x2F;项目管理</a></li><li><a href="https://www.foxitsoftware.cn/pdf-reader/">福昕阅读器</a></li><li><a href="https://www.gstarcad.com/download">浩辰CAD</a></li><li><a href="https://www.zwsoft.cn/product/zwcad/download">中望CAD</a></li><li><a href="https://meeting.tencent.com/download-center.html">腾讯会议</a></li><li><a href="https://zoom.cn/download?os=linux">Zoon</a></li><li><a href="https://hsk.oray.com/download/">花生壳</a></li><li><a href="https://sunlogin.oray.com/download">向日葵</a></li><li><a href="http://cajviewer.cnki.net/download.html">CAJViewer</a></li><li><a href="https://modao.cc/downloads/#sec-desktop">墨刀</a></li></ul><h2 id="外语学习"><a href="#外语学习" class="headerlink" title="外语学习"></a>外语学习</h2><ul><li><a href="http://cidian.youdao.com/multi.html">有道词典</a></li><li><a href="https://www.eudic.net/v4/en/app/ting">每日英语听力</a></li></ul><h2 id="浏览器"><a href="#浏览器" class="headerlink" title="浏览器"></a>浏览器</h2><ul><li><a href="https://www.maxthon.cn/mx6/history/">遨游浏览器</a></li><li><a href="https://browser.360.cn/se/linux/index.html">360安全浏览器</a></li></ul><h2 id="网盘"><a href="#网盘" class="headerlink" title="网盘"></a>网盘</h2><ul><li><a href="https://166c6b.link.yunpan.360.cn/index/download">360安全云盘</a></li><li><a href="https://www.jianguoyun.com/s/downloads">坚果云</a></li><li><a href="https://pc.115.com/index.html#linux">115电脑版</a></li><li><a href="https://pan.baidu.com/download">百度网盘</a></li></ul><p>（完）</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>软件</tag>
      
      <tag>清单</tag>
      
      <tag>linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>在线查询打印个人社会保险缴费证明</title>
    <link href="/blog/2023/09/%E5%9C%A8%E7%BA%BF%E6%9F%A5%E8%AF%A2%E6%89%93%E5%8D%B0%E4%B8%AA%E4%BA%BA%E7%A4%BE%E4%BC%9A%E4%BF%9D%E9%99%A9%E7%BC%B4%E8%B4%B9%E8%AF%81%E6%98%8E.html"/>
    <url>/blog/2023/09/%E5%9C%A8%E7%BA%BF%E6%9F%A5%E8%AF%A2%E6%89%93%E5%8D%B0%E4%B8%AA%E4%BA%BA%E7%A4%BE%E4%BC%9A%E4%BF%9D%E9%99%A9%E7%BC%B4%E8%B4%B9%E8%AF%81%E6%98%8E.html</url>
    
    <content type="html"><![CDATA[<h2 id="办理步骤"><a href="#办理步骤" class="headerlink" title="办理步骤"></a>办理步骤</h2><ol><li>登录“北京市人力资源和社会保障局”网站 <a href="http://rsj.beijing.gov.cn/">(http://rsj.beijing.gov.cn/</a>，点击移动窗口“社会保险查询服务”。或者直接访问“社会保险权益查询服务” <a href="http://fuwu.rsj.beijing.gov.cn/bjdkhy/sbqycx/sbRights/sbRightsHome">http://fuwu.rsj.beijing.gov.cn/bjdkhy/sbqycx/sbRights/sbRightsHome</a></li></ol><p><img src="/blog/./assets/W020220129527829406680.png" alt="1.png"></p><ol start="2"><li>在“城镇职工”版块，点击【职工年度对账单查询】按钮。</li></ol><p><img src="/blog/./assets/W020220129527829517510.png" alt="2.png"></p><ol start="3"><li>选择您要查询的“年度”，点击【查询】按钮进行查阅，并点击【下载打印】按钮下载缴费证明。</li></ol><p><img src="/blog/./assets/W020220129527829565664.jpg" alt="42.jpg"></p><p>（本文完）</p>]]></content>
    
    
    <categories>
      
      <category>生活</category>
      
      <category>经验</category>
      
    </categories>
    
    
    <tags>
      
      <tag>技巧</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>京东营销类电话和短信关闭通道</title>
    <link href="/blog/2023/09/%E4%BA%AC%E4%B8%9C%E8%90%A5%E9%94%80%E7%B1%BB%E7%94%B5%E8%AF%9D%E5%92%8C%E7%9F%AD%E4%BF%A1%E5%85%B3%E9%97%AD%E9%80%9A%E9%81%93.html"/>
    <url>/blog/2023/09/%E4%BA%AC%E4%B8%9C%E8%90%A5%E9%94%80%E7%B1%BB%E7%94%B5%E8%AF%9D%E5%92%8C%E7%9F%AD%E4%BF%A1%E5%85%B3%E9%97%AD%E9%80%9A%E9%81%93.html</url>
    
    <content type="html"><![CDATA[<h2 id="关闭通道"><a href="#关闭通道" class="headerlink" title="关闭通道"></a>关闭通道</h2><p>打开京东 - 我的 - 设置 </p><ul><li><p>营销类电话管理</p><ul><li>隐私设置 - 商业性电话管理</li></ul></li><li><p>营销短信管理</p><ul><li>消息通知设置 - 营销短信</li></ul></li></ul><p><img src="/blog/./assets/p82L6Hmj.png" alt="img"></p><p>（本文完）</p>]]></content>
    
    
    <categories>
      
      <category>生活</category>
      
      <category>经验</category>
      
    </categories>
    
    
    <tags>
      
      <tag>技巧</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>《雀刀门传奇》观后感</title>
    <link href="/blog/2023/09/%E3%80%8A%E9%9B%80%E5%88%80%E9%97%A8%E4%BC%A0%E5%A5%87%E3%80%8B%E8%A7%82%E5%90%8E%E6%84%9F.html"/>
    <url>/blog/2023/09/%E3%80%8A%E9%9B%80%E5%88%80%E9%97%A8%E4%BC%A0%E5%A5%87%E3%80%8B%E8%A7%82%E5%90%8E%E6%84%9F.html</url>
    
    <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>导演: <a href="https://movie.douban.com/celebrity/1450668/">唐铁军</a> &#x2F; <a href="https://movie.douban.com/celebrity/1461871/">吴迪</a><br>编剧: <a href="https://movie.douban.com/celebrity/1497951/">彭旭</a> &#x2F; <a href="https://movie.douban.com/celebrity/1497952/">陈薪竹</a> &#x2F; <a href="https://movie.douban.com/celebrity/1497953/">金壳贝贝</a> &#x2F; <a href="https://movie.douban.com/celebrity/1497954/">孙瑜</a> &#x2F; <a href="https://movie.douban.com/celebrity/1359072/">赵明畅</a> &#x2F; <a href="https://movie.douban.com/celebrity/1476730/">潘疼疼</a> &#x2F; <a href="https://movie.douban.com/celebrity/1497955/">高冰</a> &#x2F; <a href="https://movie.douban.com/celebrity/1497956/">六耳圆圆</a> &#x2F; <a href="https://movie.douban.com/celebrity/1497957/">倪运博</a><br>主演: <a href="https://movie.douban.com/celebrity/1274296/">赵本山</a> &#x2F; <a href="https://movie.douban.com/celebrity/1314704/">宋小宝</a> &#x2F; <a href="https://movie.douban.com/celebrity/1355097/">宋晓峰</a> &#x2F; <a href="https://movie.douban.com/celebrity/1351426/">文松</a> &#x2F; <a href="https://movie.douban.com/celebrity/1276009/">程野</a> &#x2F; <a href="javascript:;">更多…</a><br>类型: 剧情 &#x2F; 喜剧 &#x2F; 动作 &#x2F; 武侠 &#x2F; 古装<br>制片国家&#x2F;地区: 中国大陆<br>语言: 汉语普通话<br>首播: 2023-08-18(中国大陆)<br>集数: 40<br>单集片长: 25分钟<br>又名: 象牙门传奇<br>IMDb: tt28658451</p><h2 id="本山归来"><a href="#本山归来" class="headerlink" title="本山归来"></a>本山归来</h2><p>在腾讯视频首页看到了《雀刀门传奇》，当时以为是部电影。看了海报封面有赵本山，回想上次看赵本山的作品已经过去很久了，最熟悉不过的是春晚小品。本是抱着下饭的心态去看的，毕竟单集在20分钟左右，每集都是一个剧情，但每个剧情前后又有些关联。对于看过赵本山春晚的人而言，能够很好的通过这部《雀刀门传奇》勾唤起早年的回忆。</p><p>剧集中出现的演员，对于我而言是有些陌生的。虽然看简介都属于赵家班，但赵家班最有名的还属于东北 F4。看完这剧后，有评论说除了赵本山外，其他演员把平日二人转的形象也带到了电视剧中来了，使角色无法在电视剧中重新塑造形象。这对我而言，就不是什么问题了，因为我正是从这部剧开始熟悉赵家班演员的。</p><p>所以也是抱着满满的期望，去看本山归来的作品。</p><h2 id="情景武侠"><a href="#情景武侠" class="headerlink" title="情景武侠"></a>情景武侠</h2><p>吸引追剧的动力来源与开片的动作打斗场景，对于从小看金庸作品长大的 90 后而言。武侠算是刻在我脑子里的记忆了，曾经还幻想着像武侠里面的人物一样有轻功和各种武功。正如《雀刀门传奇》的名字一样，会让人有一种好奇心，雀刀门和传奇之间有什么关联呢？正是带着这些疑问，也让自己保持着有时间就追更，跟随着剧情的发展，这些疑惑最终得到了解释。</p><p>作为情景剧，要在有限的空间范围内将人员演绎和刻画出来，同时也要保持剧情的起伏，把武侠穿插在剧情当中。</p><p>一是满足了看武侠长大的用户群体，将侠义和家国精神通过剧情衬托了出来。同时在剧中以另外 “身份” 厨师，彰显小家的爱和平凡的伟大。</p><p>二是通过剧情铺垫着后续的发展，将传奇的过程不断铺张开，让人得以明白雀刀门背后的故事。</p><h2 id="拥抱时事"><a href="#拥抱时事" class="headerlink" title="拥抱时事"></a>拥抱时事</h2><p>这部剧很好的结合了时事的热点和趋势，将很多耳熟能详的事件，通过自嘲或无厘头的方式演绎了出来，同时也借机讽刺了当下一些圈层的乱像，让人捧腹大笑之余还能有些思考。</p><p>做为喜剧，能从故事情节让人会心一笑，也能用无厘头方式滑稽得让人大笑。</p><p>做为武侠片，能有家国情怀，师徒关怀，也带儿女私情。</p><p>做为情景剧，故事能够快速演绎，不拖泥带水，场景切换和故事可以相互衔接。</p><h2 id="喜剧收尾"><a href="#喜剧收尾" class="headerlink" title="喜剧收尾"></a>喜剧收尾</h2><p>喜剧的内核是悲剧，《雀刀门传奇》是圆满收尾的，最终惩恶扬善。</p><p>看完这部剧后，记忆仿佛回到了春晚赵本山时刻，欢笑之余又觉得意犹未尽。</p><p>（本文完）</p>]]></content>
    
    
    <categories>
      
      <category>生活</category>
      
      <category>娱乐</category>
      
    </categories>
    
    
    <tags>
      
      <tag>观后感</tag>
      
      <tag>国产剧</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>修复 Ubuntu 下 “门” 或 “复” 字显示错误</title>
    <link href="/blog/2023/09/%E4%BF%AE%E5%A4%8D%20Ubuntu%20%E4%B8%8B%E9%97%A8%E5%92%8C%E5%A4%8D%E5%AD%97%E6%98%BE%E7%A4%BA%E9%94%99%E8%AF%AF.html"/>
    <url>/blog/2023/09/%E4%BF%AE%E5%A4%8D%20Ubuntu%20%E4%B8%8B%E9%97%A8%E5%92%8C%E5%A4%8D%E5%AD%97%E6%98%BE%E7%A4%BA%E9%94%99%E8%AF%AF.html</url>
    
    <content type="html"><![CDATA[<h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><p>在使用 Ubuntu 系统时，当输入  “门”或“复”字时，显示的文字有些别扭。认为是 Linux 字体原因显示的不正常，后来才发现这是日文汉字，可以通过修改配置文件显示为中文汉字。</p><h2 id="原因"><a href="#原因" class="headerlink" title="原因"></a>原因</h2><p>Ubuntu 在当前所使用的字体中不包含某个字符时，会按照顺序从一系列候选字体中选择包含字符的字体。候选列表配置文件 ：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">/etc/fonts/conf.d/64-language-selector-prefer.conf<br></code></pre></td></tr></table></figure><p> 分为：</p><ul><li>衬线字体</li><li>非衬线字体</li><li>等宽字体</li></ul><p>Ubuntu 在安装了中文语言的情况下将 <a href="https://www.google.com/get/noto">Noto</a> 系列字体添加到字体候选</p><p>例如衬线字体优先度如下：</p><ol><li>Noto Sans CJK JP</li><li>Noto Sans CJK KR</li><li>Noto Sans CJK SC</li><li>Noto Sans CJK TC</li><li>Noto Sans CJK HK</li></ol><p>这样的配置导致日文字体包含的字符以日文字体显示。例如 “门”或“复”字，日文中存在这个汉字所以就会用日文字体显示。</p><p>其他在日文中不存在的汉字，或在 <code>Noto Sanas CJK JP</code> 和 <code>Noto Sans CJK SC</code> 字型相同的汉字则显示正常。</p><h2 id="修复"><a href="#修复" class="headerlink" title="修复"></a>修复</h2><p>修改配置文件 :</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">vim /etc/fonts/conf.d/64-language-selector-prefer.conf<br></code></pre></td></tr></table></figure><p>将中文字体的优先度提高( 带有<code>SC</code>的提到第一位 )：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span>?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">fontconfig</span> <span class="hljs-keyword">SYSTEM</span> <span class="hljs-string">&quot;fonts.dtd&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">fontconfig</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">alias</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">family</span>&gt;</span>sans-serif<span class="hljs-tag">&lt;/<span class="hljs-name">family</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">prefer</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">family</span>&gt;</span>Noto Sans CJK SC<span class="hljs-tag">&lt;/<span class="hljs-name">family</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">family</span>&gt;</span>Noto Sans CJK TC<span class="hljs-tag">&lt;/<span class="hljs-name">family</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">family</span>&gt;</span>Noto Sans CJK HK<span class="hljs-tag">&lt;/<span class="hljs-name">family</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">family</span>&gt;</span>Noto Sans CJK JP<span class="hljs-tag">&lt;/<span class="hljs-name">family</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">family</span>&gt;</span>Noto Sans CJK KR<span class="hljs-tag">&lt;/<span class="hljs-name">family</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">family</span>&gt;</span>Lohit Devanagari<span class="hljs-tag">&lt;/<span class="hljs-name">family</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">prefer</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">alias</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">alias</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">family</span>&gt;</span>serif<span class="hljs-tag">&lt;/<span class="hljs-name">family</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">prefer</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">family</span>&gt;</span>Noto Serif CJK SC<span class="hljs-tag">&lt;/<span class="hljs-name">family</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">family</span>&gt;</span>Noto Serif CJK TC<span class="hljs-tag">&lt;/<span class="hljs-name">family</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">family</span>&gt;</span>Noto Serif CJK JP<span class="hljs-tag">&lt;/<span class="hljs-name">family</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">family</span>&gt;</span>Noto Serif CJK KR<span class="hljs-tag">&lt;/<span class="hljs-name">family</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">family</span>&gt;</span>Lohit Devanagari<span class="hljs-tag">&lt;/<span class="hljs-name">family</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">prefer</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">alias</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">alias</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">family</span>&gt;</span>monospace<span class="hljs-tag">&lt;/<span class="hljs-name">family</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">prefer</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">family</span>&gt;</span>Noto Sans Mono CJK SC<span class="hljs-tag">&lt;/<span class="hljs-name">family</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">family</span>&gt;</span>Noto Sans Mono CJK TC<span class="hljs-tag">&lt;/<span class="hljs-name">family</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">family</span>&gt;</span>Noto Sans Mono CJK HK<span class="hljs-tag">&lt;/<span class="hljs-name">family</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">family</span>&gt;</span>Noto Sans Mono CJK JP<span class="hljs-tag">&lt;/<span class="hljs-name">family</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">family</span>&gt;</span>Noto Sans Mono CJK KR<span class="hljs-tag">&lt;/<span class="hljs-name">family</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">prefer</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">alias</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">fontconfig</span>&gt;</span><br></code></pre></td></tr></table></figure><p>更新字体缓存：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">fc-cache -fv<br></code></pre></td></tr></table></figure><p>执行以下命令检查，如果出现 <code>NotoSansCJK-Regular.ttc: &quot;Noto Sans CJK SC&quot; &quot;Regular&quot;</code> 则表示设置成功：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">fc-match -s | grep <span class="hljs-string">&#x27;Noto Sans CJK&#x27;</span><br></code></pre></td></tr></table></figure><p>(本文完)</p><p><strong>参考链接：</strong></p><ul><li><a href="https://bediverezero.github.io/ubuntu/2021/06/04/ubunt-fonts.html">Ubuntu 下 “门” 和 “复” 显示错误</a></li><li><a href="https://blog.csdn.net/yi0322/article/details/113699524">Ubuntu Linux ‘门’ ‘复’ 显示不标准</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>操作系统</tag>
      
      <tag>Ubuntu</tag>
      
      <tag>字体</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>《我的家里空无一物》观后感</title>
    <link href="/blog/2023/09/%E3%80%8A%E6%88%91%E7%9A%84%E5%AE%B6%E9%87%8C%E7%A9%BA%E6%97%A0%E4%B8%80%E7%89%A9%E3%80%8B%E8%A7%82%E5%90%8E%E6%84%9F.html"/>
    <url>/blog/2023/09/%E3%80%8A%E6%88%91%E7%9A%84%E5%AE%B6%E9%87%8C%E7%A9%BA%E6%97%A0%E4%B8%80%E7%89%A9%E3%80%8B%E8%A7%82%E5%90%8E%E6%84%9F.html</url>
    
    <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>导演: <a href="https://movie.douban.com/celebrity/1342375/">新井友香</a><br>编剧: <a href="https://movie.douban.com/subject_search?search_text=%E6%96%B0%E4%BA%95%E5%8F%8B%E9%A6%99">新井友香</a><br>主演: <a href="https://movie.douban.com/celebrity/1274311/">夏帆</a> &#x2F; <a href="https://movie.douban.com/celebrity/1029875/">近藤公园</a> &#x2F; <a href="https://movie.douban.com/celebrity/1344658/">趣里</a> &#x2F; <a href="https://movie.douban.com/subject_search?search_text=%E5%A4%A7%E4%B9%85%E4%BF%9D%E8%81%A1%E7%BE%8E">大久保聡美</a> &#x2F; <a href="https://movie.douban.com/subject_search?search_text=%E9%9D%92%E5%B1%B1%E6%84%9B%E4%BE%9D">青山愛依</a> &#x2F; <a href="javascript:;">更多…</a><br>类型: 剧情 &#x2F; 喜剧<br>制片国家&#x2F;地区: 日本<br>语言: 日语<br>首播: 2016-02-06(日本)<br>集数: 6<br>单集片长: 30分钟<br>又名: 我家啥都没有<br>IMDb: tt5362450</p><h2 id="起因"><a href="#起因" class="headerlink" title="起因"></a>起因</h2><p>今年换工作搬家时发现，在整理打包物品时，很多物品虽然伴随着自己，但是使用的频率不高。有些使用频率高的日耗品，由于囤积的数量也增加了搬家时的负担。在之后，开始精简物品，将多余的物品送人或者丢弃。在这次搬家中告知房东不要衣柜，衣柜对我而言实用性不高，反而容易用来囤积物品占用室内空间。由于健身房距离上班的地方远了，除了周末外，其他时间都计划在室内健身了，刚好衣柜的空间可以用做健身区域。</p><p>在观看《我的家里空无一物》前，我先学习了《断舍离》和空间整理相关的书籍和资料，也算是带着理论知识来观看这部断舍离实践剧。</p><h2 id="断舍离"><a href="#断舍离" class="headerlink" title="断舍离"></a>断舍离</h2><p>“断”即不买不需要的东西。</p><p>“舍”即舍弃堆放在家里没用的东西。</p><p>“离”即脱离对物品的欲望。</p><p>接触断舍离，可以追溯到多年前，在当时并没有重视。在一个物欲横流的社会，面对诱惑想要独善其身是需要很高的自律性的。所以最早的时候也是间断性的实践断舍离，直到这次搬家过程中，整理和发现了很多自己平时频率不高的设置是长期没有使用的物品。这让我想到的围棋中的“气”，这些不常使用的物品占据着生活的空间，物品占用的空间越多，自己的“气”就相对越少。所以开始复习断舍离的精髓以及和断舍离相关的实践，在期间发现了《我的家里空无一物》，于是开始追剧，并在观看后学习主角“麻衣”的变态扔东西法则。</p><h2 id="实践空无一物"><a href="#实践空无一物" class="headerlink" title="实践空无一物"></a>实践空无一物</h2><p>麻衣的空无一物，是多年实践的成果，是对早期垃圾屋的反抗。</p><p>我对空无一物的理解也在不断的实践中总结和改进。</p><p>首先是囤积。以前很喜欢囤积日耗品，比如纸巾，洗衣液，洗手液等。觉既然是日耗品，我可以一次性囤积到房租到期日为止，后续我都不需要再次考虑购买了。 并且量贩装购买会相对更便宜一些。后续想这次想法是错误的，囤积日耗品会占用大量的空间，会抢占自身的”气“。同时在使用物品时难免会浪费物品，心想反正囤积了很多，多用一些也没什么问题。</p><p>其次是收纳。我并不喜欢做收纳。即使收纳了，表面上看起来整洁了，在寻找一个物品时也是很困难，经常要翻箱倒柜。除非收纳要配合物品检索，但是为了收纳而收纳本身就是有问题的，现在更多会去考虑我需要这些东西吗？收纳起来后还会去用他们吗？同样只做收纳而不做精简物品同样存在囤积的问题。所以在收纳之前，学习麻衣将家中的物品列为“需要或不需要”，不需要的东西不再收纳，而是送人或者丢弃。</p><p>接着是收藏。比如车票、门票、说明书等。这些东西存留了也不会去翻阅他们，只是偶尔回忆或使用时去查阅。收藏这些东西的初衷是为了回忆，但是拼命留存这些记忆的意思又是什么呢？在想明白后，我把一些实用类的说明书使用电子化存档，然后把曾经收藏的纸质资料都一一丢弃。</p><p>最后是舍得。有舍才有得，为了让自己的物品不断增多，限制物品的数量上限，只有先清理原有的数量才能新增物品。</p><h2 id="方法摘记"><a href="#方法摘记" class="headerlink" title="方法摘记"></a>方法摘记</h2><p>在《我的家里空无一物》提供了很多实用的实践原则和方法。下面是对应的方法和解释。</p><h3 id="一进一出法"><a href="#一进一出法" class="headerlink" title="一进一出法"></a>一进一出法</h3><p>先将家中的一件物品丢掉，再去入手一件新的物品。</p><h3 id="减少收纳盒"><a href="#减少收纳盒" class="headerlink" title="减少收纳盒"></a>减少收纳盒</h3><p>借助加法实现减法的生活实际上是错误的，没有什么物品是必须要放进盒子里才是整洁的。</p><h3 id="避免收藏"><a href="#避免收藏" class="headerlink" title="避免收藏"></a>避免收藏</h3><p>物品藏着而舍不得拿出来用，甚至任凭它们积灰尘、发霉。这才是对它们的不尊重。</p><h3 id="假装购物法"><a href="#假装购物法" class="headerlink" title="假装购物法"></a>假装购物法</h3><p>假装到自己的衣柜购物，你愿意再用原价买这件衣服吗？</p><h3 id="推进式代替法"><a href="#推进式代替法" class="headerlink" title="推进式代替法"></a>推进式代替法</h3><p>赋予东西的第二个使用方法，进而扔掉一个别的东西。比如把自己喜欢的盘子（不舍得扔的东西）代替宠物现在用的碗，但一定要把现在用的那个宠物盘子扔掉，这就是推进式替代法。</p><p>喜欢其实没用，只是白白占用了地方。</p><h3 id="和物品对话"><a href="#和物品对话" class="headerlink" title="和物品对话"></a>和物品对话</h3><p>学会清点物品，与物品进行对话，了解物品是否是自己真正需要的。</p><p>只留下自己最喜欢的东西，并且进行认真保养。</p><p>大多数东西，有了会很好，没有也无妨。</p><p>越是不会收拾的人，应当尽量少的拥有物品。</p><h3 id="同色间距分隔法"><a href="#同色间距分隔法" class="headerlink" title="同色间距分隔法"></a>同色间距分隔法</h3><p>依照物品的颜色，分别按相同间距分开放置。最好分成三种颜色，同时间距相同，不要混入杂色物品。</p><h3 id="一物两用法"><a href="#一物两用法" class="headerlink" title="一物两用法"></a>一物两用法</h3><p>买东西的时候，尽量选择可以一物两用的商品，从而可以节约空间，减少物品。</p><h3 id="隐藏物品法"><a href="#隐藏物品法" class="headerlink" title="隐藏物品法"></a>隐藏物品法</h3><p>东西不知道该不该扔，将物品藏起来放一段时间，确认对物品的需求度，如果在限定的时间内一次也没有想到那个东西，那么说明需求度低，可以扔掉。</p><h3 id="局域限制法"><a href="#局域限制法" class="headerlink" title="局域限制法"></a>局域限制法</h3><p>把东西放在方便使用的地方。共用区域不能放置私人物品，同时要保持物品的整洁，定期确定是否物品的需要性。</p><h3 id="固定位置法"><a href="#固定位置法" class="headerlink" title="固定位置法"></a>固定位置法</h3><p>给家里的东西规定好固定位置，用完后，物归原位，防止再次变乱。</p><h3 id="物品保养法"><a href="#物品保养法" class="headerlink" title="物品保养法"></a>物品保养法</h3><p>通过对旧物品的保养，重新恢复对其的喜爱，从而达到不增加新物品的目的。</p><p>（本文完）</p>]]></content>
    
    
    <categories>
      
      <category>生活</category>
      
      <category>娱乐</category>
      
    </categories>
    
    
    <tags>
      
      <tag>观后感</tag>
      
      <tag>日剧</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>多关键字过滤并多色高亮日志内容脚本</title>
    <link href="/blog/2023/09/%E5%A4%9A%E5%85%B3%E9%94%AE%E5%AD%97%E8%BF%87%E6%BB%A4%E5%B9%B6%E5%A4%9A%E8%89%B2%E9%AB%98%E4%BA%AE%E6%97%A5%E5%BF%97%E5%86%85%E5%AE%B9%E8%84%9A%E6%9C%AC.html"/>
    <url>/blog/2023/09/%E5%A4%9A%E5%85%B3%E9%94%AE%E5%AD%97%E8%BF%87%E6%BB%A4%E5%B9%B6%E5%A4%9A%E8%89%B2%E9%AB%98%E4%BA%AE%E6%97%A5%E5%BF%97%E5%86%85%E5%AE%B9%E8%84%9A%E6%9C%AC.html</url>
    
    <content type="html"><![CDATA[<h2 id="痛点"><a href="#痛点" class="headerlink" title="痛点"></a>痛点</h2><p>在服务器直接通过 <code>tail</code>  命令滚动输出查看日志内容时，会存在以下的问题：</p><ul><li>共用一套测试环境时 ，存在交叉调用的日志内容;</li><li>大多Shell工具搜索只能高亮单个关键字;</li><li>日志内容杂乱，多个关键字需肉眼定位和比对。</li></ul><h2 id="手写脚本"><a href="#手写脚本" class="headerlink" title="手写脚本"></a>手写脚本</h2><p>针对上述的问题，可以通过 <code>grep</code> 的多关键字过滤，加上 <code>perl</code> 对指定关键字输出对应的颜色。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">tail</span> -f /export/log/biz/biz_detail.log | grep -E -B8 -A11 <span class="hljs-string">&#x27;江苏省联社设备反欺诈预测评分\(标准版\)jar 包入参&#x27;</span> --line-buffered | perl -pe <span class="hljs-string">&#x27;s/(江苏省联社设备反欺诈预测评分\(标准版\))|(数据源中文名:设备信用模型分\（换签版\）)|(633004529412624)|(01028898029254162532035)|(&quot;1.0&quot;)|(bj_score)|(label)|(psce_fraud_jsrcu_score)|(ppre_fraud_jsrcu_label)|(0721d10b33c188d8e45c1369a8b3b01de194a4c9862d486c9d27c3a35845118a)|(hash_type)|(response=&#123;tags=&#123;)|(jar 包入参)|(sm3)|(8a67f57383173fb1176492184d16d1a4)|(md5)|(5948f86545d42883837ef15e6aa75c5f82c24c25a1bc5de0109b310877afac6d)|(sha256)/\e[1;31m$1\e[1;31m$2\e[1;31m$3\e[1;31m$4\e[1;31m$5\e[1;34m$6\e[1;35m$7\e[1;34m$8\e[1;35m$9\e\e[1;32m$10\e[1;32m$11\e[1;32m$12\e[1;32m$13\e[1;32m$14\e[1;32m$15\e[1;32m$16\e[1;32m$17\e[1;32m$18\e[1;32m$19\e[1;32m$20\e[0m/g&#x27;</span><br></code></pre></td></tr></table></figure><blockquote><p>注意： 空格需要使用反斜线(<code>\</code>)转义</p></blockquote><h3 id="脚本说明"><a href="#脚本说明" class="headerlink" title="脚本说明"></a>脚本说明</h3><p>需要高亮的关键字：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">perl -pe <span class="hljs-string">&#x27;s/(江苏省联社设备反欺诈预测评分\(标准版\))|(数据源中文名:设备信用模型分\（换签版\）)|(633004529412624)|(01028898029254162532035)|(&quot;1.0&quot;)|(bj_score)|(label)|(psce_fraud_jsrcu_score)|(ppre_fraud_jsrcu_label)|(0721d10b33c188d8e45c1369a8b3b01de194a4c9862d486c9d27c3a35845118a)|(hash_type)|(response=&#123;tags=&#123;)|(jar 包入参)|(sm3)|(8a67f57383173fb1176492184d16d1a4)|(md5)|(5948f86545d42883837ef15e6aa75c5f82c24c25a1bc5de0109b310877afac6d)|(sha256)</span><br></code></pre></td></tr></table></figure><blockquote><p>注意：每个括号里的关键字对应下面的$1到$n。</p></blockquote><p>需要高亮的关键字颜色:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">\e[1;31m<span class="hljs-variable">$1</span>\e[1;31m<span class="hljs-variable">$2</span>\e[1;31m<span class="hljs-variable">$3</span>\e[1;31m<span class="hljs-variable">$4</span>\e[1;31m<span class="hljs-variable">$5</span>\e[1;34m<span class="hljs-variable">$6</span>\e[1;35m<span class="hljs-variable">$7</span>\e[1;34m<span class="hljs-variable">$8</span>\e[1;35m<span class="hljs-variable">$9</span>\e\e[1;32m<span class="hljs-variable">$10</span>\e[1;32m<span class="hljs-variable">$11</span>\e[1;32m<span class="hljs-variable">$12</span>\e[1;32m<span class="hljs-variable">$13</span>\e[1;32m<span class="hljs-variable">$14</span>\e[1;32m<span class="hljs-variable">$15</span>\e[1;32m<span class="hljs-variable">$16</span>\e[1;32m<span class="hljs-variable">$17</span>\e[1;32m<span class="hljs-variable">$18</span>\e[1;32m<span class="hljs-variable">$19</span>\e[1;32m<span class="hljs-variable">$20</span>\e[0m/g<br></code></pre></td></tr></table></figure><blockquote><p>注意：$1即匹配关键字的第1个，$2即匹配关键字的第2个，以此类推。$n是根据实际匹配上的顺序定义的。</p></blockquote><p>如果关键字未匹配到，$n的颜色会去匹配第 (n+1) 的关键字。</p><p>在Linux终端中，可以使用ANSI转义序列来设置文本的颜色和样式。下面是一些常用的颜色代码：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sh">红色：\e[1;31m<br>绿色：\e[1;32m<br>黄色：\e[1;33m<br>蓝色：\e[1;34m<br>紫色：\e[1;35m<br>青色：\e[1;36m<br>白色：\e[1;37m<br></code></pre></td></tr></table></figure><p>默认颜色（通常是终端默认的前景和背景颜色）：<code>\e[0m</code></p><p>这些颜色代码可以与其他样式代码一起使用，例如：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh">粗体：\e[1m<br>斜体：\e[3m<br>下划线：\e[4m<br>反显（文本颜色与背景颜色互换）：\e[7m<br>删除线：\e[9m<br></code></pre></td></tr></table></figure><p>使用这些颜色和样式代码，将它们插入到文本之前，在文本之后添加 <code>\e[0m</code> 来恢复默认设置。</p><p>比如，将文本设置为红色粗体，可以使用以下代码：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">\e[1;31m\e[1m这是红色粗体文本\e[0m<br></code></pre></td></tr></table></figure><p>这将使文本以红色粗体显示，并在文本后面添加 <code>\e[0m</code> 以恢复默认设置。</p><h2 id="生成脚本"><a href="#生成脚本" class="headerlink" title="生成脚本"></a>生成脚本</h2><p>上面使用了手动编辑的方式来生成脚本，当修改内容多时容易修改错了，并且高亮颜色值也不容易被记忆住。</p><p>所以可以将脚本需要修改的内容提取出来，通过页面配置，并自动生成可用的过滤高亮脚本。</p><p><img src="/blog/./assets/image-20230903193704427.png" alt="过滤并高亮脚本生成工具"></p><p>上述的页面中，通过将 6 个变量内容提取出来在页面可视化配置：</p><ol><li>日志地址</li><li>过滤关键字</li><li>上色关键字</li><li>颜色配置</li></ol><blockquote><p>每行匹配1个定义的上色关键字，如果不设置颜色默认是白色：\e[1;37m</p></blockquote><ol start="5"><li>显示过滤关键字前面几行</li><li>显示过滤关键字后面几行</li></ol><p>通过页面生成直接能在命令行粘贴使用的脚本，简化了编辑脚本的难度，提高了可用性。体验地址：日志多关键字过滤+高亮脚本生成器<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="[日志多关键字过滤+高亮脚本生成器 ](https://maojun.xyz/html/tools/Log_Multi-Keyword_Filtering_Highlighting_Script_Generator.html)">[1]</span></a></sup></p><h2 id="使用效果"><a href="#使用效果" class="headerlink" title="使用效果"></a>使用效果</h2><p>在使用脚本后，日志的内容得到了过滤并对特定关键字使用了多色高亮来区分。</p><p><img src="/blog/./assets/%E5%A4%9A%E5%85%B3%E9%94%AE%E5%AD%97%E8%BF%87%E6%BB%A4%E5%B9%B6%E5%A4%9A%E8%89%B2%E9%AB%98%E4%BA%AE%E6%95%88%E6%9E%9C.png" alt="使用效果"></p><p>(本文完)</p><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://maojun.xyz/html/tools/Log_Multi-Keyword_Filtering_Highlighting_Script_Generator.html">日志多关键字过滤+高亮脚本生成器 </a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>操作演示</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Shell</tag>
      
      <tag>Grep</tag>
      
      <tag>Perl</tag>
      
      <tag>日志</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>《风骚律师》观后感</title>
    <link href="/blog/2023/08/%E3%80%8A%E9%A3%8E%E9%AA%9A%E5%BE%8B%E5%B8%88%E3%80%8B%E8%A7%82%E5%90%8E%E6%84%9F.html"/>
    <url>/blog/2023/08/%E3%80%8A%E9%A3%8E%E9%AA%9A%E5%BE%8B%E5%B8%88%E3%80%8B%E8%A7%82%E5%90%8E%E6%84%9F.html</url>
    
    <content type="html"><![CDATA[<h2 id="衍生剧"><a href="#衍生剧" class="headerlink" title="衍生剧"></a>衍生剧</h2><p>《风骚律师》作为口碑炸裂的《绝命毒师》衍生剧，自然受到了不少的关注。而我是在 好评榜+美剧 的双关键字索引下找到它的。初看时还没发现这是毒师的衍生聚，直到看评论中的讨论才恍然大悟。</p><p>关注《绝命毒师》应该是在5年前了，追了大约2季左右就忙于其他事停追了。做为一个不怎么追剧的人，今年趁着年初追完了《狂飙》和《三体》，趁着多巴胺的余热，继而在好评榜单上锁定了《风骚律师》。</p><h2 id="风骚何来"><a href="#风骚何来" class="headerlink" title="风骚何来"></a>风骚何来</h2><p>实际上这部剧集应该是叫《绝命律师》，我在追《绝命毒师》的时候听说过这个剧集，当时并没有留意。直到好评榜上出现名字的时候已经叫《风骚律师》了，翻译也很有意思。英文名叫《Better Call Saul》，直译就是《最好打给索尔》。它的名字在看完剧集后会更加容易理解，我对风骚的理解是：</p><h3 id="行为风骚"><a href="#行为风骚" class="headerlink" title="行为风骚"></a>行为风骚</h3><p>行为风骚，在剧集前面的时候介绍了主角吉米的一系列骚操作：</p><ul><li>与好友共同蒙骗路人</li><li>和滑板青年合伙诈骗</li><li>和影视学生拍创意广告</li><li>各种恶作剧和无厘头等</li></ul><h3 id="物品风骚"><a href="#物品风骚" class="headerlink" title="物品风骚"></a>物品风骚</h3><ul><li>想从律所被开除时的五彩穿搭</li><li>衣服、领带、金色马桶</li></ul><h3 id="言语风骚"><a href="#言语风骚" class="headerlink" title="言语风骚"></a>言语风骚</h3><ul><li>伪装背后的言辞</li><li>怂恿人心的欺骗</li></ul><h2 id="黑白律师"><a href="#黑白律师" class="headerlink" title="黑白律师"></a>黑白律师</h2><p>吉米受他哥的影响，自考拿到了律师从业资格证。向往成为一名真正的律师，为那些需要法律帮助的人提供服务。在一开始，他的确是这样的，从他在做白律师前的为敬老院的老人收集证据，到后来的从事老年法咨询等。由白律师向黑律师转向我认为有2个原因：</p><ol><li>始于风骚</li></ol><p>正是应为前面的风骚动作让吉米接触了一些让其<strong>变坏</strong>的因素，比如和滑板请求合伙诈骗时，误打误撞碰上的黑帮势力的奶奶。前面的因引发了后面黑环境带来的果，被动转黑。</p><ol start="2"><li>不被承认</li></ol><p>吉米有一个优秀的哥哥，我认为他是向往成为他哥那样的人的，有自己的小事业，同时受人尊敬和爱戴。但是无奈的是，他哥哥查克认为自己花了那么努力才有的法律事业，吉米仅靠自学就能从事法律行业，其内心是不平衡的。同时用吉米的过去否定了他的现在和未来，为吉米后续的主动转黑做了铺垫。</p><h2 id="压抑与释放"><a href="#压抑与释放" class="headerlink" title="压抑与释放"></a>压抑与释放</h2><p>整观全剧，在查克自杀去世前。吉米内心的幽暗是被压抑住的，他想表现更好，得到查克的认可。虽然多年的习惯让其很难真正让查克满意，但至少维持了一个正常且有正义观念的吉米。直到哥哥去世了，吉米也不需要被谁认可了，他可以做自己了。很多善恶也更多的遵循利益关系，而非正义。伴随的每次得手后的多巴胺释放，得以让风骚操作不断升级，直到后续的黑化。</p><p>在最终季时，吉米凭借自身的经验，本可以将刑期减到7年。但他最终选择了坦白，可能是多年的压抑后，让他在从事黑律师的时候得到了集聚的放纵，直到事发过起逃亡生活。可能是人生的大起大落让其顿悟，也可能是想结束颠沛流离的生活，更可能是为了Kim，想重新让她相信自己依旧是当初的吉米。吉米坦然的说出了一切事实，他可能是在赎罪，想释放并结束过往的一切。</p><h2 id="环境影响"><a href="#环境影响" class="headerlink" title="环境影响"></a>环境影响</h2><p>Kim和吉米都是受环境深刻影响的2个人。正是2人有着相同之处，所以2个的关系发展快速且密切。但正如Kim所说的，并不是吉米影响了她，而是他们两人相互影响着彼此。同时他们也影响了周围的人，不论是查克还是霍华德。</p><p>所以吉米和Kim可以称为同质的人，而不是互补的人。对彼此的问题都没有很好的约束和制止，甚至是合伙密谋一些欺骗的事。所以当查克在世的时候，还能约束下吉米。当吉米和Kim结婚后，两人就将各自内心的幽暗借助彼此放大了。在剧中吉米和Kim看适都有一个不错的结局，至少没有提前领盒饭。但回过头来，他们本可以过得更好，哪怕是普通且充实的生活。可见环境被人的塑造是非常之大，正如 “勿以恶小而为之”。</p><h2 id="结尾"><a href="#结尾" class="headerlink" title="结尾"></a>结尾</h2><p>《风骚律师》有很多人物的形象塑造和精彩线路，但无疑主角吉米和Kim给我的印象是最深刻的。他们穿插了全剧的情节，从白到黑的过渡，以及由黑转白的历程都让我印象深刻。所以在人生中的十字路口，一定要妥善抉择，真的是一念天堂，一念地狱，比如纳乔是否可以有更好的结局？</p><p>（本文完）</p>]]></content>
    
    
    <categories>
      
      <category>生活</category>
      
      <category>娱乐</category>
      
    </categories>
    
    
    <tags>
      
      <tag>观后感</tag>
      
      <tag>美剧</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CKA、CKAD、CKS、PCA认证考试总结</title>
    <link href="/blog/2023/08/CKA%E3%80%81CKAD%E3%80%81CKS%E3%80%81PCA%E8%AE%A4%E8%AF%81%E8%80%83%E8%AF%95%E6%80%BB%E7%BB%93.html"/>
    <url>/blog/2023/08/CKA%E3%80%81CKAD%E3%80%81CKS%E3%80%81PCA%E8%AE%A4%E8%AF%81%E8%80%83%E8%AF%95%E6%80%BB%E7%BB%93.html</url>
    
    <content type="html"><![CDATA[<h2 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h2><p>在去年的 7 月份购买了 Kubernetes 的 CKA、CKAD、CKS 认证套餐，今年 4 月份购买了 Promethus 的认证考试。</p><p>从购买后起有为期一年的预约考试以及一次的补考机会（需在一年有效期内完成补考）。</p><p>备考和考试顺序一致，一次专注备考一门认证，目前所有认证都一次性通过。</p><ol><li>CKA </li><li>CKAD</li><li>CKS</li><li>PCA</li></ol><p>备考主要是熟悉考试的流程和考试大纲，内容均为实操作类型，通过远程桌面连接并做题。在考试前需要对基础知识和命令有个熟练的操作，因为远程操作容易受网络影响，不像在本地操作那么流畅，所以需要非常熟悉基础知识，比如 kubectl、docker、yaml、k8s 架构等。避免紧张造成考试失败。</p><p>考试时 CKA、CKAD、CKS可以选择英文或切换成中文题目，所有题目都是实操题需在终端上完成。</p><p>PCA 目前只有英文题目，所有题目都是选择题。</p><h3 id="CKA"><a href="#CKA" class="headerlink" title="CKA"></a>CKA</h3><p>CKA（系统管理员） 的考试时间为 2 个小时，考试题目在 16 道左右。主要涉及到权限、容器、网络、集群等知识点。考试时是可以查阅且仅能访问 Kubernets 在线文档。建议熟练的使用和查询文档，避免消耗过多的时间。</p><p>总分：100分。</p><p>合格分：66分。</p><p>有效期：3年。</p><p>通过后的证书：</p><p><img src="/blog/./assets/CKA.png" alt="CKA"></p><h3 id="CKAD"><a href="#CKAD" class="headerlink" title="CKAD"></a>CKAD</h3><p>CKA（应用开发者） 的考试时间为 2 个小时，考试题目在 16 道左右。主要涉及到Cronjob、Dockerfile、Pod、Deployment等知识点。同CKA考试，要练习到非常熟练，做到心中有数。</p><p>总分：100分。</p><p>合格分：66分。</p><p>有效期：3年。</p><p>通过后的证书：</p><p><img src="/blog/./assets/CKAD.png" alt="CKAD"></p><h3 id="CKS"><a href="#CKS" class="headerlink" title="CKS"></a>CKS</h3><p>CKS（安全专家） 的考试时间为 2 个小时，考试题目在 16 道左右。主要涉及到安全策略、漏洞扫描、日志审计等知识点。<br>相对与CKA、CKAD，需要掌握更多的知识，需要多练习。也算较难的一个实操考试。</p><p>总分：100分。</p><p>合格分：67分。</p><p>有效期：2年。</p><p>通过后的证书：</p><p><img src="/blog/./assets/CKS.png" alt="CKS"></p><h3 id="PCA"><a href="#PCA" class="headerlink" title="PCA"></a>PCA</h3><p>PCA（认证专员） 的考试时间为 90 分钟，考试题目在 60 道左右。主要涉及到安 Prometheus 配置、PromeQL、Exporter等知识点。</p><p>总分：100分。</p><p>合格分：75分。</p><p>有效期：3年。</p><p>通过后的证书：</p><p><img src="/blog/./assets/PCA.png" alt="PCA"></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>在上面的认证难度中，PCA 属于初级，CKA、CKAD、CKS属于中级。所以只要认证准备，做到多练多理解，通过考试的难度不大。<br>这是一个重实操的考试，就像工作中的问题是不断变化的，需要理论结合实践不断巩固这项技能。<br>正如认证的有效期一样，知识需不断推陈出新和更新迭代。<br>伴随的版本的迭代，对应的技术和知识也要不断同步，以不至于我们当下通过认证学习到的知识会和证书有效期那样变得过时。</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>考试</category>
      
    </categories>
    
    
    <tags>
      
      <tag>云原生</tag>
      
      <tag>Kubernates</tag>
      
      <tag>Prometheus</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Highlight This!实操手册</title>
    <link href="/blog/2023/08/Highlight%20This!%E5%AE%9E%E6%93%8D%E6%89%8B%E5%86%8C.html"/>
    <url>/blog/2023/08/Highlight%20This!%E5%AE%9E%E6%93%8D%E6%89%8B%E5%86%8C.html</url>
    
    <content type="html"><![CDATA[<h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>Highlight This！, 在其官网<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Highlight This!](https://highlightthis.net/)">[1]</span></a></sup>的描述是：</p><p>Highlight This 是 Chrome 浏览器和 Firefox 浏览器的一个浏览器扩展，可以在访问页面时高亮显示你选择的单词。你可以设置不同的单词列表，为它们指定颜色，并指定要在哪些网页上突出显示这些单词。</p><h2 id="下载安装"><a href="#下载安装" class="headerlink" title="下载安装"></a>下载安装</h2><p>可以分为谷歌插件市场在线安装和离线安装两种方式。</p><h3 id="谷歌插件市场"><a href="#谷歌插件市场" class="headerlink" title="谷歌插件市场"></a>谷歌插件市场</h3><p>打开Highlight This！插件市场地址<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Highlight This: finds and marks words](https://chrome.google.com/webstore/detail/highlight-this-finds-and/fgmbnmjmbjenlhbefngfibmjkpbcljaj)">[2]</span></a></sup>，直接点击安装即可。</p><h3 id="离线安装"><a href="#离线安装" class="headerlink" title="离线安装"></a>离线安装</h3><ol><li>借助 Crx 在线下载工具<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="[CRX Downloader](https://standaloneinstaller.com/online-tools/crx-downloader)">[3]</span></a></sup>，先插件下载到本地,接着解压到本地目录。</li></ol><p><img src="/blog/./assets/wps1.png" alt="离线拓展包"> </p><ol start="2"><li>打开谷歌浏览器的扩展管理，或者直接在浏览器地址栏输入下面的内容并回车：</li></ol> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs url">chrome://extensions/<br></code></pre></td></tr></table></figure><p>点击右上角启用开发者模式，然后点击加载已解压的，选择之前下载并解压的 Highlight This! 文件夹。看到如下插件加载完成即成功。</p><p><img src="/blog/./assets/wps2.png" alt="加载已解压的插件"> </p><h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><p>要让 Highlight This! 发挥出最大的效果，首先要进行配置，推荐根据分组结合颜色的方式来进行划分。</p><p>点击扩展图标，并点击右下角的****+****号来新建列表分组。</p><p><img src="/blog/./assets/wps3.png" alt="创建分组"> </p><h3 id="创建列表"><a href="#创建列表" class="headerlink" title="创建列表"></a>创建列表</h3><p>选择非同步和标准列表即可。</p><p><img src="/blog/./assets/wps4.png" alt="新建列表"> </p><h3 id="高亮关键字"><a href="#高亮关键字" class="headerlink" title="高亮关键字"></a>高亮关键字</h3><p>配置关键字高亮内容和要校验的规则。</p><p><img src="/blog/./assets/wps5.jpg" alt="高亮关键字配置"></p><p>增加多组关键字高亮配置，当配置完后可以看到如下的效果。</p><p><img src="/blog/./assets/wps7.png" alt="配置效果"> </p><p>当页面显示的内容有匹配到关键字时，页面中的关键字会使用匹配的规则列表来显示。</p><p><img src="/blog/./assets/wps8.png" alt="页面使用效果"> </p><p>（本文完）</p><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://highlightthis.net/">Highlight This!</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://chrome.google.com/webstore/detail/highlight-this-finds-and/fgmbnmjmbjenlhbefngfibmjkpbcljaj">Highlight This: finds and marks words</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://standaloneinstaller.com/online-tools/crx-downloader">CRX Downloader</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>操作演示</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Chrome</tag>
      
      <tag>Extension</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Windows 下使用 Rime 和小鹤音形输入法</title>
    <link href="/blog/2023/08/windows%E4%B8%8B%E4%BD%BF%E7%94%A8rime+%E5%B0%8F%E9%B9%A4%E9%9F%B3%E5%BD%A2%E8%BE%93%E5%85%A5%E6%B3%95.html"/>
    <url>/blog/2023/08/windows%E4%B8%8B%E4%BD%BF%E7%94%A8rime+%E5%B0%8F%E9%B9%A4%E9%9F%B3%E5%BD%A2%E8%BE%93%E5%85%A5%E6%B3%95.html</url>
    
    <content type="html"><![CDATA[<h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>Rime, 官网<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="[RIME | 中州韻輸入法引擎](https://rime.im/)">[1]</span></a></sup>的介绍只有一句话：聪明的输入法懂我心意。</p><p>相比智能输入法而言，我真心喜欢它这个聪明。你可以每天使用它，但又感觉不到它的存在。</p><p>Rime 最为一个跨平台的输入法，可以让你在不同的终端使用到相同的输入体验。更重要的是它内置了完善的输入方案及支持自定义方案，这些内容都可以离线使用。这意味着你可以控制所有的数据和隐私。</p><h2 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h2><p>Rime 的下载地址可以在其官网的下载页面<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="[下載及安裝 | RIME | 中州韻輸入法引擎](https://rime.im/download/)">[2]</span></a></sup>看到，不过它的安装包是托管在 GitHub上的，对于国内网速不好的用户。可以在其官方复制下载包的地址：</p><p>比如：<a href="https://github.com/rime/weasel/releases/download/0.15.0/weasel-0.15.0.0-installer.exe">https://github.com/rime/weasel/releases/download/0.15.0/weasel-0.15.0.0-installer.exe</a></p><p>然后再其前面拼接：<a href="https://ghproxy.com/">https://ghproxy.com/</a></p><p>完整的地址如下：<a href="https://ghproxy.com/https://github.com/rime/weasel/releases/download/0.15.0/weasel-0.15.0.0-installer.exe">https://ghproxy.com/https://github.com/rime/weasel/releases/download/0.15.0/weasel-0.15.0.0-installer.exe</a></p><p>这样可对 GitHub 上的制品包实现加速下载。     </p><h2 id="安装和配置"><a href="#安装和配置" class="headerlink" title="安装和配置"></a>安装和配置</h2><p>下载安装包后，Windows 下双击安装包即可打开安装。使用默认配置即可，安装时必须选择一个输入方案，可勾选 <strong>明月拼音-简化字</strong>。</p><p><img src="/blog/./assets/image-20230806173853130.png" alt="image-20230806173853130"></p><p>安装后即可使用简体全拼输入法。</p><h3 id="配置小鹤音形"><a href="#配置小鹤音形" class="headerlink" title="配置小鹤音形"></a>配置小鹤音形</h3><p>在安装完 Rime 后，继续配置小鹤音形输入法。让输入的体验更加快速便捷。在右下角的托盘处右键，在弹出的选项面板中，点击用户文件夹即可打开 Rime 的用户配置文件管理器窗口。</p><p><img src="/blog/./assets/image-20230806174213507.png" alt="image-20230806174213507"></p><p>接着去小鹤双拼的网盘<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="[小鹤双拼 & 小鹤音形](http://flypy.ysepan.com/))">[3]</span></a></sup>下载挂接音形码，下载小鹤音形 “鼠须管” for macOS.zip 。</p><p><img src="/blog/./assets/image-20230806175034774.png" alt="image-20230806175034774"></p><blockquote><p>注：小鹤音形只提供了鼠须管 MacOS 下的音形方案。</p></blockquote><p>下载后将压缩包解压，删除 squirrel 的配置文件，这样默认会使用 default.custom.yaml 和 default.yaml 配置文件。将剩余的文件全部拷贝到 Rime 的用户文件夹，如果提示已经存在文件，则点击覆盖。</p><p><img src="/blog/./assets/image-20230806175407772.png" alt="image-20230806175407772"></p><blockquote><p>squirrel 是 MacOS 下的配置文件。</p></blockquote><h3 id="重选方案-重新部署"><a href="#重选方案-重新部署" class="headerlink" title="重选方案 &amp; 重新部署"></a>重选方案 &amp; 重新部署</h3><p>增加小鹤音形的配置文件后，需要重新选择输入方案生效，右键在托盘位置中 Rime ，在菜单选项中点击输入法设定：</p><p><img src="/blog/./assets/image-20230806180002246.png" alt="image-20230806180002246"></p><p>在方案设定中，选中小鹤音形输入方案，其他方案根据需要选择。</p><p><img src="/blog/./assets/image-20230806180101920.png" alt="image-20230806180101920"></p><p>如果修改了 Rime 用户文件夹中的配置文件，需要重新部署 Rime 后生效。右键在托盘位置中 Rime ，在菜单选项中点击重新部署。 </p><p><img src="/blog/./assets/image-20230806175722294.png" alt="image-20230806175722294"></p><p>（本文完）</p><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://rime.im/">RIME | 中州韻輸入法引擎</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://rime.im/download/">下載及安裝 | RIME | 中州韻輸入法引擎</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="http://flypy.ysepan.com/">小鹤双拼 &amp; 小鹤音形</a>)<a href="#fnref:3" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>操作演示</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Windows</tag>
      
      <tag>输入法</tag>
      
      <tag>Rime</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JSON 数据验证和测试注意项</title>
    <link href="/blog/2023/08/json%E6%95%B0%E6%8D%AE%E9%AA%8C%E8%AF%81%E5%92%8C%E6%B5%8B%E8%AF%95%E6%B3%A8%E6%84%8F%E9%A1%B9.html"/>
    <url>/blog/2023/08/json%E6%95%B0%E6%8D%AE%E9%AA%8C%E8%AF%81%E5%92%8C%E6%B5%8B%E8%AF%95%E6%B3%A8%E6%84%8F%E9%A1%B9.html</url>
    
    <content type="html"><![CDATA[<h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>在接口调用中，JSON 是主流的数据传输交换格式。 JSON 官方对其的介绍内容是：</p><blockquote><p>JSON(JavaScript Object Notation) 是一种轻量级的数据交换格式。 易于人阅读和编写。同时也易于机器解析和生成。 它基于JavaScript Programming Language, Standard ECMA-262 3rd Edition - December 1999的一个子集。 JSON采用完全独立于语言的文本格式，但是也使用了类似于C语言家族的习惯（包括C, C++, C#, Java, JavaScript, Perl, Python等）。 这些特性使JSON成为理想的数据交换语言。</p></blockquote><h2 id="JSON数据测试"><a href="#JSON数据测试" class="headerlink" title="JSON数据测试"></a>JSON数据测试</h2><p>JSON 的数据类型包括以下6类：</p><ol><li>对象（Object）：用花括号 <code>&#123;&#125;</code> 表示，表示一组键值对的集合。</li><li>数组（Array）：用方括号 <code>[]</code> 表示，表示一组值的有序集合。</li><li>字符串（String）：用双引号 <code>&quot;&quot;</code> 或单引号 <code>&#39;&#39;</code> 包裹的字符序列。</li><li>数值（Number）：表示数字，可以是整数或浮点数。</li><li>布尔值（Boolean）：表示真或假，只有两个可能的取值：<code>true</code> 或 <code>false</code>。</li><li>空值（null）：表示空值，只有一个取值：<code>null</code>。</li></ol><p>所以，在对 JSON 数据测试时，可以依据 <strong>等价类分析</strong> 和 <strong>边界值分析</strong> 设计测试数据和用例。</p><p>例如,等价类测试数据：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;string_example&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Hello, World!&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;number_example&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">42</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;boolean_example&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;null_example&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;array_example&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;nested_object_example&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;key1&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;value1&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;key2&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">123</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;key3&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;key4&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>边界值，以 Java 的数据边界值为例：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;empty_string_example&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;large_string_example&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;abcdefghijklmnopqretuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span><br>  <span class="hljs-attr">&quot;max_long_example&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">9223372036854775807</span><span class="hljs-punctuation">,</span> <br>  <span class="hljs-attr">&quot;min_long_example&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">-9223372036854775808</span> <br>  <span class="hljs-attr">&quot;max_double_example&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1.7976931348623157e+308</span><span class="hljs-punctuation">,</span> <br>  <span class="hljs-attr">&quot;min_double_example&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">4.9e-324</span><span class="hljs-punctuation">,</span> <br>  <span class="hljs-attr">&quot;large_array_example&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> <span class="hljs-number">4</span><span class="hljs-punctuation">,</span> <span class="hljs-number">5</span><span class="hljs-punctuation">,</span> <span class="hljs-number">6</span><span class="hljs-punctuation">,</span> <span class="hljs-number">7</span><span class="hljs-punctuation">,</span> <span class="hljs-number">8</span><span class="hljs-punctuation">,</span> <span class="hljs-number">9</span><span class="hljs-punctuation">,</span> <span class="hljs-number">10</span><span class="hljs-punctuation">,</span> <span class="hljs-number">11</span><span class="hljs-punctuation">,</span> <span class="hljs-number">12</span><span class="hljs-punctuation">,</span> <span class="hljs-number">13</span><span class="hljs-punctuation">,</span> <span class="hljs-number">14</span><span class="hljs-punctuation">,</span> <span class="hljs-number">15</span><span class="hljs-punctuation">]</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><blockquote><p>注意：Java 基本数据类型不存在越界，只会溢出。它们取值范围的最大值+1的结果都是它们取值范围的最小值，反之相同。</p></blockquote><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>在对 JSON 数据类型进行分析设计后，还可以针对业务场景进行测试数据设计。比如需求和技术文档中明确了 <strong>foo</strong> 字段是 <strong>Object</strong> 类型，但如果传了 <strong>String</strong> 类型，会有什么异常或兜底逻辑，反之相同。在测试过程中需不断分析使用场景，以便提高系统的 <strong>鲁棒性</strong> 和用户的 <strong>体验性</strong>。</p><blockquote><p>鲁棒是Robust的音译，也就是健壮和强壮的意思。 它也是在异常和危险情况下系统生存的能力。</p></blockquote><p>（本文完）</p>]]></content>
    
    
    <categories>
      
      <category>工作</category>
      
      <category>业务架构</category>
      
    </categories>
    
    
    <tags>
      
      <tag>软件测试</tag>
      
      <tag>JSON</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>安装 Ubuntu 并做相关配置</title>
    <link href="/blog/2023/07/%E5%AE%89%E8%A3%85ubuntu%E5%B9%B6%E5%81%9A%E7%9B%B8%E5%85%B3%E9%85%8D%E7%BD%AE.html"/>
    <url>/blog/2023/07/%E5%AE%89%E8%A3%85ubuntu%E5%B9%B6%E5%81%9A%E7%9B%B8%E5%85%B3%E9%85%8D%E7%BD%AE.html</url>
    
    <content type="html"><![CDATA[<h2 id="折腾"><a href="#折腾" class="headerlink" title="折腾"></a>折腾</h2><p>在不断尝试折腾过以下的Linux桌面系统：</p><ul><li>Deepin</li><li>Centos</li><li>Mint</li><li>Manjaro</li><li>ArchLinux</li><li>Fedora</li><li>Xubuntu</li></ul><p>最终选择 Ubuntu 做为最终的 Linux 桌面归宿。主要看中以下几个方面：</p><ol><li>有商业公司的支撑，笔记本产家对 Ubuntu 相对兼容，软件包大多支持 Ubuntu 系统和 deb 格式，文档资源丰富。</li><li>软件兼容性好，很多软件公司的产品就是在 Ubuntu 系统上开发的，比如 Docker。</li><li>企业服务器大多是 Centos, 桌面使用 Ubuntu 可以更好的互补。</li><li>不想继续折腾了，想以 Ubuntu 做为工作、学习、娱乐的备用机。</li><li>…或许是图个新鲜</li></ol><h2 id="安装系统"><a href="#安装系统" class="headerlink" title="安装系统"></a>安装系统</h2><h3 id="下载系统"><a href="#下载系统" class="headerlink" title="下载系统"></a>下载系统</h3><p>进入 Ubuntu 的官方网站，在下载页面选择桌面版系统下载。快捷链接：<a href="https://ubuntu.com/download/desktop">Ubuntu桌面版</a></p><p>目前最新的长期稳定版本是：Ubuntu 22.04.2 LTS(Jammy Jellyfish ),长期支持截止日期为：2027 年 4 月。</p><h3 id="安装系统-1"><a href="#安装系统-1" class="headerlink" title="安装系统"></a>安装系统</h3><p>首先制作系统启动盘，插入 U 盘后，使用 fdisk 命令查看磁盘分区。注意下面的操作都是在 Linux 上完成的，如果是 Windows 系统，可以使用 refus</p><p> 来刻录系统。快捷链接：<a href="https://rufus.ie/zh/">refus</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">sudo fdisk -l</span><br></code></pre></td></tr></table></figure><p>查看到 U 盘的分区地址后，使用 dd 命令刻录刚下载的系统到 U 盘。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">sudo <span class="hljs-built_in">dd</span> <span class="hljs-keyword">if</span>=/Downloads/ubuntu-22.04.2-desktop-amd64.iso of=/dev/sda bs=4M</span><br></code></pre></td></tr></table></figure><p>待刻录完后，重启电脑并根据不同的笔记本厂家来通过按键来触发开机引导项，联想 Yoga 笔记本可通过 F12 来进入引导选项。</p><p>选择 U 盘作为引导盘后，等待加载系统并根据系统的提示进行设置。Ubuntu 安装时会检测是否存在系统引导和旧的系统，会给予提示是删除、保留或更新的操作，根据个人需求选择即可。后续的磁盘分区设置都可以采取默认，几乎是一键安装，待系统完成安装重起系统，会提示拔掉引导 U 盘，重新完成后系统就安装完了。</p><h3 id="安装和配置软件"><a href="#安装和配置软件" class="headerlink" title="安装和配置软件"></a>安装和配置软件</h3><p>本着不折腾的原则，系统基本上采用了默认配置和软件，优先从 Ubuntu 自带的软件仓库下载，没有再从软件官网下载对应的安装包。为了符合个人的使用习惯，安装了以下软件并相应的进行配置：</p><ul><li>Microsoft Edge浏览器</li><li>Enpass密码管理</li><li>Typora编辑器</li><li>termius终端</li><li>kate编辑器</li><li>Fcitx5+Rime输入法</li><li>Zetero</li><li>Vim</li><li>…后续会根据使用做适当增减</li></ul><p>软件基本上采用了默认的配置，部分软件是有同步功能的，登入账同步后也无需额外配置。仅对输入法做了相应的配置调整，</p><p>安装完 Fcitx5+Rime 后，自带的输入方案是不带小鹤双拼输入法的，需要自行配置。同时，部分软件不能调用 Fcitx5 输入法，也需要做环境做些配置。</p><h4 id="将-Fcitx5-写入环境变量："><a href="#将-Fcitx5-写入环境变量：" class="headerlink" title="将 Fcitx5 写入环境变量："></a>将 Fcitx5 写入环境变量：</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">编辑 /etc/systemd/user.conf，找到DefaultEnvironment这行</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">sudo vim /etc/systemd/user.conf</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">取消注释追加以下内容：</span><br>DefaultEnvironment=XMODIFIERS=&quot;@im=fcitx&quot; XIM=fcitx XIM_PROGRAM=fcitx GTK_IM_MODULE=fcitx QT_IM_MODULE=fcitx<br></code></pre></td></tr></table></figure><h4 id="增加小鹤双拼输入法"><a href="#增加小鹤双拼输入法" class="headerlink" title="增加小鹤双拼输入法"></a>增加小鹤双拼输入法</h4><p>下载小鹤双拼在 Linux 下的配置文件：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">克隆仓库地址</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">git <span class="hljs-built_in">clone</span> https://github.com/maojunxyz/flypy-linux.git</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">进入下载后的目录</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">cd</span> flypy-linux/rime-data</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">将目录下的文件内容都复制到fcitx5的rime目录里，然后重启fcitx5</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">cp</span> -r  * ~/.local/share/fcitx5/rime</span><br></code></pre></td></tr></table></figure><h3 id="使用系统"><a href="#使用系统" class="headerlink" title="使用系统"></a>使用系统</h3><p>在做完以上的配置后，就能将 Ubuntu做为辅助生产力来使用了。Ubuntu 中不乏自带了一些好用的软件和小游戏:</p><ul><li>Sudoku</li><li>To Do</li></ul><h2 id="归宿"><a href="#归宿" class="headerlink" title="归宿"></a>归宿</h2><p>折腾的最终归宿就是默认配置。Ubuntu 还有很多值得分享的内容，需要在后续的使用中逐渐去发现和探索。</p><p>最终，我将 Ubuntu 作为折腾后的桌面 Linux 归宿了，毕竟年纪大了。</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>操作系统</tag>
      
      <tag>Ubuntu</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>使用GitHub Pages 部署 Hexo</title>
    <link href="/blog/2023/07/%E4%BD%BF%E7%94%A8GitHub%20Pages%20%E9%83%A8%E7%BD%B2%20Hexo.html"/>
    <url>/blog/2023/07/%E4%BD%BF%E7%94%A8GitHub%20Pages%20%E9%83%A8%E7%BD%B2%20Hexo.html</url>
    
    <content type="html"><![CDATA[<h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><ol><li>建立名为 <code>maojunxyz.github.io</code> 的储存库。</li><li>将 Hexo 文件夹中的文件 push 到储存库的默认分支，默认分支通常名为 <code>main</code>。</li></ol><ul><li><p>将 <code>main</code> 分支 push 到 GitHub：</p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs maxima">$ git <span class="hljs-built_in">push</span> -u <span class="hljs-built_in">origin</span> main<br></code></pre></td></tr></table></figure></li><li><p>默认情况下 <code>public/</code> 不会被上传(也不该被上传)，确保 <code>.gitignore</code> 文件中包含一行 <code>public/</code>。</p></li></ul><ol start="3"><li>使用 <code>node --version</code> 指令检查你电脑上的 Node.js 版本，并记下该版本 (例如：<code>v16.y.z</code>)</li><li>在储存库中前往 <code>Settings &gt; Pages &gt; Source</code>，并将 <code>Source</code> 改为 <code>GitHub Actions</code>。</li></ol><blockquote><p>注意：如果本地已经有了workflow配置文件pages.yml，推送代码到仓库执行actions后，再将 <code>Source</code> 改为 <code>Deploy from a branch</code>，并切换到构建后的<code>gh-pages</code>分支。</p></blockquote><ol start="3"><li>在储存库中建立 <code>.github/workflows/pages.yml</code>，并填入以下内容 (将 20行的版本<code>16</code> 替换为上个步骤中记下的版本)：</li></ol><figure class="highlight nestedtext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs nestedtext"><span class="hljs-attribute">.github/workflows/pages.ymlname</span><span class="hljs-punctuation">:</span> <span class="hljs-string">Pages</span><br><br><span class="hljs-attribute">on</span><span class="hljs-punctuation">:</span><br>  <span class="hljs-attribute">push</span><span class="hljs-punctuation">:</span><br>    <span class="hljs-attribute">branches</span><span class="hljs-punctuation">:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">main # default branch</span><br><br><span class="hljs-attribute">jobs</span><span class="hljs-punctuation">:</span><br>  <span class="hljs-attribute">build</span><span class="hljs-punctuation">:</span><br>    <span class="hljs-attribute">runs-on</span><span class="hljs-punctuation">:</span> <span class="hljs-string">ubuntu-latest</span><br>    <span class="hljs-attribute">steps</span><span class="hljs-punctuation">:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">uses: actions/checkout@v3</span><br>        <span class="hljs-attribute">with</span><span class="hljs-punctuation">:</span><br>          <span class="hljs-attribute">token</span><span class="hljs-punctuation">:</span> <span class="hljs-string">$&#123;&#123; secrets.GITHUB_TOKEN &#125;&#125;</span><br>          <span class="hljs-comment"># If your repository depends on submodule, please see: https://github.com/actions/checkout</span><br>          <span class="hljs-attribute">submodules</span><span class="hljs-punctuation">:</span> <span class="hljs-string">recursive</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">name: Use Node.js 16.x</span><br>        <span class="hljs-attribute">uses</span><span class="hljs-punctuation">:</span> <span class="hljs-string">actions/setup-node@v2</span><br>        <span class="hljs-attribute">with</span><span class="hljs-punctuation">:</span><br>          <span class="hljs-attribute">node-version</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&#x27;16&#x27;</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">name: Cache NPM dependencies</span><br>        <span class="hljs-attribute">uses</span><span class="hljs-punctuation">:</span> <span class="hljs-string">actions/cache@v2</span><br>        <span class="hljs-attribute">with</span><span class="hljs-punctuation">:</span><br>          <span class="hljs-attribute">path</span><span class="hljs-punctuation">:</span> <span class="hljs-string">node_modules</span><br>          <span class="hljs-attribute">key</span><span class="hljs-punctuation">:</span> <span class="hljs-string">$&#123;&#123; runner.OS &#125;&#125;-npm-cache</span><br>          <span class="hljs-attribute">restore-keys</span><span class="hljs-punctuation">:</span> <span class="hljs-string">|</span><br>            <span class="hljs-attribute">$&#123;&#123; runner.OS &#125;&#125;-npm-cache</span><br><span class="hljs-attribute">      - name</span><span class="hljs-punctuation">:</span> <span class="hljs-string">Install Dependencies</span><br>        <span class="hljs-attribute">run</span><span class="hljs-punctuation">:</span> <span class="hljs-string">npm install</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">name: Build</span><br>        <span class="hljs-attribute">run</span><span class="hljs-punctuation">:</span> <span class="hljs-string">npm run build</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">name: Upload Pages artifact</span><br>        <span class="hljs-attribute">uses</span><span class="hljs-punctuation">:</span> <span class="hljs-string">actions/upload-pages-artifact@v2</span><br>        <span class="hljs-attribute">with</span><span class="hljs-punctuation">:</span><br>          <span class="hljs-attribute">path</span><span class="hljs-punctuation">:</span> <span class="hljs-string">./public</span><br>  <span class="hljs-attribute">deploy</span><span class="hljs-punctuation">:</span><br>    <span class="hljs-attribute">needs</span><span class="hljs-punctuation">:</span> <span class="hljs-string">build</span><br>    <span class="hljs-attribute">permissions</span><span class="hljs-punctuation">:</span><br>      <span class="hljs-attribute">pages</span><span class="hljs-punctuation">:</span> <span class="hljs-string">write</span><br>      <span class="hljs-attribute">id-token</span><span class="hljs-punctuation">:</span> <span class="hljs-string">write</span><br>    <span class="hljs-attribute">environment</span><span class="hljs-punctuation">:</span><br>      <span class="hljs-attribute">name</span><span class="hljs-punctuation">:</span> <span class="hljs-string">github-pages</span><br>      <span class="hljs-attribute">url</span><span class="hljs-punctuation">:</span> <span class="hljs-string">$&#123;&#123; steps.deployment.outputs.page_url &#125;&#125;</span><br>    <span class="hljs-attribute">runs-on</span><span class="hljs-punctuation">:</span> <span class="hljs-string">ubuntu-latest</span><br>    <span class="hljs-attribute">steps</span><span class="hljs-punctuation">:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">name: Deploy to GitHub Pages</span><br>        <span class="hljs-attribute">id</span><span class="hljs-punctuation">:</span> <span class="hljs-string">deployment</span><br>        <span class="hljs-attribute">uses</span><span class="hljs-punctuation">:</span> <span class="hljs-string">actions/deploy-pages@v2</span><br></code></pre></td></tr></table></figure><ol start="6"><li>部署完成后，前往 <code>https://maojunxyz.github.io</code> 查看网站。</li></ol><blockquote><p>CNAME：若你使用了一个带有 <code>CNAME</code> 的自定义域名，你需要在 <code>source/</code> 文件夹中新增 <code>CNAME</code> 文件。</p></blockquote><h2 id="项目页面"><a href="#项目页面" class="headerlink" title="项目页面"></a>项目页面</h2><p>如果你希望网站部署在 <code>maojunxyz.github.io</code> 的子目录中：</p><ol><li>建立名为 <code>blog</code> 的储存库，这样你的博客网址为 <code>maojunxyz.github.io/blog</code>。</li><li>编辑你的 <code>_config.yml</code>，将 <code>url:</code> 更改为 <code>maojunxyz.github.io/blog</code>。</li><li>在储存库中前往 <code>Settings &gt; Pages &gt; Source</code>，并将 <code>Source</code> 改为 <code>GitHub Actions</code>。</li><li>Commit 并 push 到默认分支上。</li><li>部署完成后，前往 <code>https://maojunxyz.github.io/blog</code> 查看网站。</li></ol><h2 id="Hexo-常用命令"><a href="#Hexo-常用命令" class="headerlink" title="Hexo 常用命令"></a>Hexo 常用命令</h2><h3 id="创建一个新的文章"><a href="#创建一个新的文章" class="headerlink" title="创建一个新的文章"></a>创建一个新的文章</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">&quot;My New Post&quot;</span><br></code></pre></td></tr></table></figure><p>更新信息: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="运行服务"><a href="#运行服务" class="headerlink" title="运行服务"></a>运行服务</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo server<br></code></pre></td></tr></table></figure><p>更新信息: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="生成静态文件"><a href="#生成静态文件" class="headerlink" title="生成静态文件"></a>生成静态文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo generate<br></code></pre></td></tr></table></figure><p>更新信息: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="部署远程站点"><a href="#部署远程站点" class="headerlink" title="部署远程站点"></a>部署远程站点</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo deploy<br></code></pre></td></tr></table></figure><p>更新信息: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p><p>（完）</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>操作演示</category>
      
    </categories>
    
    
    <tags>
      
      <tag>GitHub</tag>
      
      <tag>Hexo</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CKA学习笔记</title>
    <link href="/blog/2023/05/CKA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html"/>
    <url>/blog/2023/05/CKA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html</url>
    
    <content type="html"><![CDATA[<h1 id="CKA学习笔记"><a href="#CKA学习笔记" class="headerlink" title="CKA学习笔记"></a>CKA学习笔记</h1><p>CKA学习记录</p><h2 id="容器"><a href="#容器" class="headerlink" title="容器"></a>容器</h2><p>容器和虚拟机的区别，容器本身是一个APP，虚拟机是一个完整的系统。</p><h3 id="容器管理"><a href="#容器管理" class="headerlink" title="容器管理"></a>容器管理</h3><p>runtime，运行时。</p><table><thead><tr><th><strong>高级别Runtime</strong></th><th><strong>低级别Runtime</strong></th></tr></thead><tbody><tr><td><strong>docker</strong></td><td><strong>runc</strong></td></tr><tr><td><strong>containerd</strong></td><td>lxc</td></tr><tr><td>cri-o</td><td>gvisor</td></tr><tr><td>rkt</td><td>kata</td></tr><tr><td>podman</td><td>…</td></tr><tr><td>…</td><td></td></tr></tbody></table><blockquote><p>一般而言，高级别的Runtime会去调用低级别的Runtime，docker和containerd底层调用的是runc。</p></blockquote><p>低级别运行时只能管理容器，高级别运行时不仅可以管理容器，还可以管理镜像。无论是高级别还是低级别运行时，所使用的镜像是一样的。</p><h3 id="容器架构"><a href="#容器架构" class="headerlink" title="容器架构"></a>容器架构</h3><p>docker是客户端工具，dockerd是服务端工具。docker默认连接的是本机dockerd，可以通过-H指定远程的dockerd服务。</p><p>containerd是服务端，上层的客户端有ctr,crictl,<strong>nerdctl</strong>，不同的客户端之间是通过命名空间相互隔离的，所以不同客户端创建的容器是隔离看不见的。</p><h2 id="搭建环境"><a href="#搭建环境" class="headerlink" title="搭建环境"></a>搭建环境</h2><p>创建2个虚拟机，在里面分别安装docker和containerd。</p><blockquote><p>使用containerd运行时是因为K8S的新版本中不再作为运行时了，但是docekr依旧可以用来打包和构建。</p></blockquote><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 关闭屏幕保护</span><br>setterm -black 0<br><span class="hljs-comment"># 配置yum源</span><br><span class="hljs-built_in">rm</span> -rf /etc/yum.repos.d/* ; wget ftp://ftp.rhce.cc/k8s/* -P /etc/yum.repos.d/<br><span class="hljs-comment"># 安装docker</span><br>yum install -y docker-ce<br><span class="hljs-comment"># 启动docker并设置开机启动</span><br>systemctl <span class="hljs-built_in">enable</span> docker --now<br><span class="hljs-comment"># 安装containerd和客户端工具</span><br>yum install -y containerd.io cri-tools <br><span class="hljs-comment"># 启动containerd并设置开机启动</span><br>systemctl <span class="hljs-built_in">enable</span> containerd --now<br></code></pre></td></tr></table></figure><h3 id="查看docker运行时"><a href="#查看docker运行时" class="headerlink" title="查看docker运行时"></a>查看docker运行时</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 查看运行时</span><br>docker info |grep -i runtime<br> Runtimes: io.containerd.runc.v2 runc<br> Default Runtime: runc<br></code></pre></td></tr></table></figure><h3 id="docker配置"><a href="#docker配置" class="headerlink" title="docker配置"></a>docker配置</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">cat</span> &gt; /etc/docker/daemon.json &lt;&lt;<span class="hljs-string">EOF</span><br><span class="hljs-string">&#123; &quot;registry-mirrors&quot;: [&quot;https://frz7i079.mirror.aliyuncs.com&quot;]</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">EOF</span><br>systemctl restart docker<br></code></pre></td></tr></table></figure><h3 id="查看containerd运行时"><a href="#查看containerd运行时" class="headerlink" title="查看containerd运行时"></a>查看containerd运行时</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># crictl连接运行时</span><br>crictl config runtime-endpoint unix:///var/run/containerd/containerd.sock<br><span class="hljs-comment"># 查看运行时</span><br>crictl info |grep -i runtime<br>        <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;RuntimeReady&quot;</span>,<br>      <span class="hljs-string">&quot;defaultRuntimeName&quot;</span>: <span class="hljs-string">&quot;runc&quot;</span>,<br></code></pre></td></tr></table></figure><h3 id="containerd配置"><a href="#containerd配置" class="headerlink" title="containerd配置"></a>containerd配置</h3><p>需要先配置客户端连接的运行时，</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 查看当前的配置</span><br>containerd config dump<br><span class="hljs-comment"># 导出containerd默认配置并覆盖当前的配置文件</span><br>containerd config default &gt; /etc/containerd/config.toml<br><span class="hljs-comment"># 设置加速服务,搜索mirrors并在底下加入2行，完整配置如下</span><br>[plugins.<span class="hljs-string">&quot;io.containerd.grpc.v1.cri&quot;</span>.registry.mirrors]<br>  [plugins.<span class="hljs-string">&quot;io.containerd.grpc.v1.cri&quot;</span>.registry.mirrors.<span class="hljs-string">&quot;docker.io&quot;</span>]  <br>    endpoint = [<span class="hljs-string">&quot;https://frz7i079.mirror.aliyuncs.com&quot;</span>]<br><span class="hljs-comment"># 搜索sandbox，修改这行内容为</span><br>sandbox_image = <span class="hljs-string">&quot;registry.aliyuncs.com/google_containers/pause:3.7&quot;</span><br><span class="hljs-comment"># 搜索SystemdCgroup并修改为true,同时删除上面几行，最终效果如下</span><br> [plugins.<span class="hljs-string">&quot;io.containerd.grpc.v1.cri&quot;</span>.containerd.runtimes.runc.options]<br>            SystemdCgroup = <span class="hljs-literal">true</span><br><span class="hljs-comment"># 修改完重启containerd</span><br>systemctl restart containerd<br></code></pre></td></tr></table></figure><h4 id="安装nerdctl客户端"><a href="#安装nerdctl客户端" class="headerlink" title="安装nerdctl客户端"></a>安装nerdctl客户端</h4><p>crictl用起来和docker命令兼容不是很好，比较好用的是nerdctl且命令也兼容docker，所以可以单独安装nerdctl搭配containerd。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 下载后并解压</span><br>tar -zxvf nerdctl-0.23.0-linux-amd64.tar.gz -C /usr/bin/<br><span class="hljs-comment">#　安装网络插件</span><br><span class="hljs-built_in">mkdir</span> -p /opt/cni/bin/<br>tar -zxvf cni-plugins-linux-amd64-v1.1.1.tgz -C /opt/cni/bin/<br></code></pre></td></tr></table></figure><p>由于nerdctl和crictl使用的是不同的命名空间，所以是相互隔离，为了兼容crictl创建的容器，可以将nerdctl的命名空间修改为和crictl一样。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 创建配置目录</span><br><span class="hljs-built_in">mkdir</span> /etc/nerdctl/<br><span class="hljs-comment"># 添加配置信息</span><br><span class="hljs-built_in">cat</span> &gt; /etc/nerdctl/nerdctl.toml &lt;&lt;<span class="hljs-string">EOF</span><br><span class="hljs-string">debug = false</span><br><span class="hljs-string">debug_full = false</span><br><span class="hljs-string">address = &quot;unix:///var/run/containerd/containerd.sock&quot;</span><br><span class="hljs-string"># 修改namespace为k8s.io,默认是default</span><br><span class="hljs-string">namespace = &quot;k8s.io&quot;</span><br><span class="hljs-string">#snapshotter = &quot;stargz&quot;</span><br><span class="hljs-string">cgroup_manager = &quot;systemd&quot;</span><br><span class="hljs-string">#hosts_dir = [&quot;/etc/containerd/certs.d&quot;,&quot;/etc/nerdctl/certs.d&quot;]</span><br><span class="hljs-string">insecure_registry = false</span><br><span class="hljs-string">EOF</span><br><br><span class="hljs-comment"># 启用linger</span><br>loginctl show-user root | grep Linger<br>loginctl enable-linger root<br></code></pre></td></tr></table></figure><h4 id="配置nerdctl加速"><a href="#配置nerdctl加速" class="headerlink" title="配置nerdctl加速"></a>配置nerdctl加速</h4><p>nerdctl并不会使用container的配置文件，而是有其自己的配置文件。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">mkdir</span> -p /etc/containerd/certs.d/docker.io<br><span class="hljs-built_in">cat</span> &gt; /etc/containerd/certs.d/docker.io/hosts.toml &lt;&lt;<span class="hljs-string">EOF</span><br><span class="hljs-string"># server = &quot;https://docker.io&quot;</span><br><span class="hljs-string">[host.&quot;https://frz7i079.mirror.aliyuncs.com&quot;]</span><br><span class="hljs-string">capabilities = [&quot;pull&quot;,&quot;resolve&quot;]</span><br><span class="hljs-string">override_path = true</span><br><span class="hljs-string">EOF</span><br></code></pre></td></tr></table></figure><h4 id="nerdctl命令自动补齐"><a href="#nerdctl命令自动补齐" class="headerlink" title="nerdctl命令自动补齐"></a>nerdctl命令自动补齐</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 编辑~/.bashrc文件并添加以下内容</span><br><span class="hljs-built_in">source</span> &lt;(nerdctl completion bash)<br></code></pre></td></tr></table></figure><h2 id="容器里运行的是什么"><a href="#容器里运行的是什么" class="headerlink" title="容器里运行的是什么"></a>容器里运行的是什么</h2><p>默认运行的是CMD指定的内容，可以通用<code>nerdctl history</code>查看镜像中指定的CMD命令。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">nerdctl <span class="hljs-built_in">history</span> hello-world<br>SNAPSHOT                                                                   CREATED          CREATED BY                                       SIZE        COMMENT<br>&lt;missing&gt;                                                                  17 months ago    /bin/sh -c <span class="hljs-comment">#(nop)  CMD [&quot;/hello&quot;]                0.0 B       </span><br>sha256:e07ee1baac5fae6a26f30cabfe54a36d3402f96afda318fe0a96cec4ca393359    17 months ago    /bin/sh -c <span class="hljs-comment">#(nop) COPY file:50563a97010fd7ce…    16.0 KiB    </span><br></code></pre></td></tr></table></figure><p>hello-world运行默认运行的就是<code>/hello</code>命令。</p><h2 id="容器的生命周期"><a href="#容器的生命周期" class="headerlink" title="容器的生命周期"></a>容器的生命周期</h2><p>容器里面的运行进程结束了，容器生命周期也结束了。默认进程运行的是CMD中制定的命令。</p><p>-t 模拟终端 -i 交互界面，如果默认CMD是bash,这样bash就有个依附窗口，不会自动结束容器了。</p><p>以下是合并的内容，还需要手动处理<br>容器<br>容器和虚拟机的区别：image-20230107193134952</p><p>要想运行容器，我们必须先安装软件runtime，也就是运行时。<br>image-20230107192916772</p><p>无论使用上图的哪一个runtime，他们最终使用的镜像是一致的。</p><p>OCI是一个镜像结构，和容器状态标准。</p><p>在1.24的时候就不使用docker使用runtime了，可以选择containerd.</p><p>但是并不是说docker就被淘汰了，无法继续使用了，而是可以在构建镜像，搭建仓库时用。</p><p>image-20230107194018096</p><p>docker是客户端，服务端模式，客户端可以连接到远程的机器上。</p><p>containerd是一个执行引擎，可以连接不通的客户端服务，最好用的是nerdctl，nerdctl，crictl,ctr之间创建的容器是通过namespace(命名空间）隔离的互相看不到。</p><p>虚拟机创建<br>从temp虚机克隆出两台虚机：</p><p>vm71-docker<br>vm72-container<br>账号密码都是root redhat<br>然后使用命令分别设置：</p><p>.&#x2F;set.sh 71</p><p>.&#x2F;set.sh 72</p><p>关闭屏保：setterm -blank 0</p><p>docekr安装<br>略</p><p>continerd安装<br>默认是crictl</p><p>默认已经有配置文件了，但是不全。 可以生成比较全的默认配置：</p><p>containerd config dufault &gt; &#x2F;etc&#x2F;containerd&#x2F;config.toml</p><p>查看当前的配置命令：</p><p>containerd config dufault</p><p>crictl命令<br>crictl images 查看镜像</p><p>crictl info 查看信息</p><p>默认使用的namespace:k8s.io</p><p>nerdctl<br>命令基本都是兼容docker的，非常好用。</p><p>但是netl和crictl默认使用的命名空间 是不同的。</p><p>默认使用的default</p><p>如果是K8s创建的容器，使用nerdctl排错时需要先切换成k8s的命令空间，否则看不到。</p><p>不同的命名空间 中镜像和容器都是隔离的，namespace的作用就是资源隔离。</p><p>镜像<br>一个镜像打了多个tag,都是用的一个image id，只有最后一个同imageid的镜像后，镜像文件才会从服务器中删除。</p><p>容器<br>容器里是一定要运行一个进程的。</p><p>如果创建容器的时候指定容器里运行的是什么的话，则容器里运行的是镜像里CMD所指定的。</p><p>使用docker history查看镜像所打的CMD命令</p><p>cka22-12-containerd-2镜像管理.vep 待学</p>]]></content>
    
    
    <categories>
      
      <category>生活</category>
      
      <category>经验</category>
      
    </categories>
    
    
    <tags>
      
      <tag>技巧</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>工作中的注意事项</title>
    <link href="/blog/2023/04/%E5%B7%A5%E4%BD%9C%E4%B8%AD%E7%9A%84%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9.html"/>
    <url>/blog/2023/04/%E5%B7%A5%E4%BD%9C%E4%B8%AD%E7%9A%84%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9.html</url>
    
    <content type="html"><![CDATA[<h2 id="离职"><a href="#离职" class="headerlink" title="离职"></a>离职</h2><p>离职后应提醒公司给社保减员，避免找到下家后由于上家公司社保没做减员操作，社保交不上的问题。</p><p>到了关账日，只能隔月份补交，社保的话医疗和工伤没法补，公积金只能补金额不能补月份。</p>]]></content>
    
    
    <categories>
      
      <category>生活</category>
      
      <category>经验</category>
      
    </categories>
    
    
    <tags>
      
      <tag>技巧</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Arthas配合Recaf调试服务端代码</title>
    <link href="/blog/2023/03/Arthas%E9%85%8D%E5%90%88Recaf%E8%B0%83%E8%AF%95%E6%9C%8D%E5%8A%A1%E7%AB%AF%E4%BB%A3%E7%A0%81.html"/>
    <url>/blog/2023/03/Arthas%E9%85%8D%E5%90%88Recaf%E8%B0%83%E8%AF%95%E6%9C%8D%E5%8A%A1%E7%AB%AF%E4%BB%A3%E7%A0%81.html</url>
    
    <content type="html"><![CDATA[<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><h3 id="Arthas"><a href="#Arthas" class="headerlink" title="Arthas"></a>Arthas</h3><p>从官方网站下载Arthas压缩包，上传到要对应的服务部署服务器上并解压。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 新建arthas目录</span><br><span class="hljs-built_in">mkdir</span> /opt/arthas<br><span class="hljs-comment"># 进入目录</span><br><span class="hljs-built_in">cd</span> /opt/arthas<br><span class="hljs-comment"># 上传arthas压缩包后，进行解压</span><br>unzip arthas*.zip<br></code></pre></td></tr></table></figure><p>解压后的目录文件：</p><p><img src="/blog/./assets/image-20230924224839416.png" alt="image-20230924224839416"></p><p>到此，  arthas就安装和部署完成了。</p><h3 id="Recaf"><a href="#Recaf" class="headerlink" title="Recaf"></a>Recaf</h3><p>Recaf是一个Jar包字节码查看工具，下载地址 ：<a href="https://github.com/Col-E/Recaf">https://github.com/Col-E/Recaf</a></p><h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><p>Arthas的功能和使用场景很多，这里以实际应用场景作为演示。</p><h3 id="修改SDK返回内容"><a href="#修改SDK返回内容" class="headerlink" title="修改SDK返回内容"></a>修改SDK返回内容</h3><p>借助 Arthas 可以让字节码修改和热更新变得简单。</p><ul><li>双击打开Recaf，或在命令行执行：</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">java jar -jar recaf<br></code></pre></td></tr></table></figure><ul><li>在启动的图形界面中，点击菜单栏的 <code>File - Load</code> ，加载需要反编译的 SDK Jar包。</li></ul><p><img src="/blog/./assets/image-20230924224749975.png" alt="image-20230924224749975"></p><ul><li>找到 SDK Jar包文档的方法入口，假设这是我们要注入异常的切入点。</li></ul><p><img src="/blog/./assets/image-20230924224917063.png" alt="image-20230924224917063"></p><p>在字节码查看工具里面找到对应的接口实现和方法，如下图所示：</p><p><img src="/blog/./assets/image-20230924225116497.png" alt="image-20230924225116497"></p><p>后面我们通过在服务器上直接反编译并修改Jar包逻辑，查看热更新字节码。</p><blockquote><p> 注意，在本地先修改后编译，然后上传class文件也是可以的，只是通过服务器操作更直接。</p></blockquote><h3 id="修改Jar包出分"><a href="#修改Jar包出分" class="headerlink" title="修改Jar包出分"></a>修改Jar包出分</h3><p>首先反编译查看Jar包代码，结合文档的方法入口和出入参找到对应的代码块。</p><p><img src="/blog/./assets/image-20230924225242783.png" alt="image-20230924225242783"></p><p>文档中出参是<strong>bj_score</strong>,对应代码的字段是<strong>jsonResult</strong>。</p><p>jsonResult的数据类型是个JSONObject，所以bj_score是JSONObject中的key，只要覆盖bj_score的value就可以修改bj_score的值了。</p><p>以下步骤同模拟<strong>Jar</strong>包异常部分，重复内容已省略。首先修改并覆盖bj_score的值，然后编译和刷新字节码。</p><p><img src="/blog/./assets/image-20230924225341513.png" alt="image-20230924225341513"></p><p>再次请求，就能看到<strong>bj_score</strong>的值已经被修改了。</p><p><img src="/blog/./assets/image-20230924225350121.png" alt="image-20230924225350121"></p><p>根据字节码反编译查看的源码，我们可以就可以直面加工方的Jar包逻辑，从而进行比如Jar包返回的Code码，返回值内容等等，等任何可以通过源码修改的地方，我们得可以轻松修改和模拟场景。</p><h3 id="热更新字节码"><a href="#热更新字节码" class="headerlink" title="热更新字节码"></a>热更新字节码</h3><p>Arthas 可以热更新字节码并生效，无需重启服务。</p><ul><li>启动 Arthas 服务，并进入 <strong>Arthas</strong> 控制台。</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 进入arthas解压后的目录</span><br><span class="hljs-built_in">cd</span> /opt/arthas<br><span class="hljs-comment"># 启动arthas服务</span><br>java -jar arthas-boot.jar<br></code></pre></td></tr></table></figure><ul><li>Arthas会列出当前服务下的java进程，比如我们要测试是的<strong>pudao_biz</strong>服务，就输入1。</li></ul><p><img src="/blog/./assets/image-20230924225642474.png" alt="image-20230924225642474"></p><ul><li>然后会打印以下的内容，比如 Java 的进程和 Arthas 的版本号。</li></ul><p><img src="/blog/./assets/image-20230924225721797.png" alt="image-20230924225721797"></p><ul><li>通过命令反查类的加载器，首先获取Jar包方法入口所在的包名称和类名。复制 package 路径 + class名称，<strong>com.icekredit.rccsdf.service.impl.RccsDeviceFraudServiceImpl</strong>。比如下图：</li></ul><p><img src="/blog/./assets/image-20230924225815199.png" alt="image-20230924225815199"></p> <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 通过类的路径反查类的加载器</span><br>sc -d com.icekredit.rccsdf.service.impl.RccsDeviceFraudServiceImpl |grep classLoaderHash<br></code></pre></td></tr></table></figure><ul><li>拿到类加载器的Hash值，比如下图的就是：<strong>51abf713</strong></li></ul><p><img src="/blog/./assets/image-20230924225908583.png" alt="image-20230924225908583"> </p><ul><li><p>将jar包的的字节码反编译成源码，下面的代码是将class字节码反编译成源码到**&#x2F;tmp&#x2F;RccsDeviceFraudServiceImpl.java**下，注意类名应该保持一致，源</p><p>码以**.java**结尾。</p></li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">jad --source-only com.icekredit.rccsdf.service.impl.RccsDeviceFraudServiceImpl &gt; /tmp/RccsDeviceFraudServiceImpl.java<br></code></pre></td></tr></table></figure><ul><li>上面的命令执行完毕后，新建一个服务器窗口，可以在上面查看到刚才反编译出的源码问题。</li></ul><p> <img src="/blog/./assets/image-20230924230006957.png" alt="image-20230924230006957"></p><ul><li>通过vim命令修改源码内容：</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">vim /tmp/RccsDeviceFraudServiceImpl.java<br></code></pre></td></tr></table></figure><ul><li>这里以模拟Jar包方法异常为例，在里面写入一个除零异常的代码。</li></ul><p><img src="/blog/./assets/image-20230924230048944.png" alt="image-20230924230048944"></p><p>这样凡是调用Jar包的下面方法时，就会抛出异常。</p><p><img src="/blog/./assets/image-20230924230108625.png" alt="image-20230924230108625"></p><ul><li>切换到<strong>arthas</strong>控制台的窗口，执行以下的命令将源码编译成字节码。（注意替换<strong>51abf713</strong>为实际类加载器hash值。）</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">mc -c 51abf713 /tmp/RccsDeviceFraudServiceImpl.java -d /tmp/<br></code></pre></td></tr></table></figure><p><img src="/blog/./assets/image-20230924230143233.png" alt="image-20230924230143233"></p><ul><li>再次切换服务器的窗口，获取变异后的class文件路径(&#x2F;tmp是之前编译的路径，RccsDeviceFraudServiceImpl是类名，class是字节码的后缀）</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">find /tmp -name RccsDeviceFraudServiceImpl.class<br></code></pre></td></tr></table></figure><p><img src="/blog/./assets/image-20230924230206615.png" alt="image-20230924230206615"></p><ul><li>重新切换回<strong>arthas</strong>控制台窗口，根据类加载器的Hash值（注意替换<strong>51abf713</strong>为实际类加载器hash值）热更新字节码（立即生效，无需重启）</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">redefine -c 51abf713 /tmp/com/icekredit/rccsdf/service/impl/RccsDeviceFraudServiceImpl.class<br></code></pre></td></tr></table></figure><p><img src="/blog/./assets/image-20230924230252745.png" alt="image-20230924230252745"></p><ul><li>调用接口，Jar包异常场景就覆盖到了。</li></ul><p><img src="/blog/./assets/image-20230924230327452.png" alt="image-20230924230327452"></p><ul><li>Jar包场景验证完毕后，将源码文件里面的除零异常代码行删除，再根据第<strong>8</strong>步骤的顺序往下执行，使用<strong>mc</strong>命令将源码编译成字节码，接着使用<strong>redefine</strong>命令热更新字节码就可以了，更新后服务又恢复正常了。</li></ul><p><img src="/blog/./assets/image-20230924230355671.png" alt="image-20230924230355671"></p><p>(本文完)</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>操作演示</category>
      
    </categories>
    
    
    <tags>
      
      <tag>软件测试</tag>
      
      <tag>测试工具</tag>
      
      <tag>Arthas</tag>
      
      <tag>Recaf</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Gatling压测模型和使用参数介绍</title>
    <link href="/blog/2022/03/Gatling%E5%8E%8B%E6%B5%8B%E6%A8%A1%E5%9E%8B%E5%92%8C%E4%BD%BF%E7%94%A8%E5%8F%82%E6%95%B0%E4%BB%8B%E7%BB%8D.html"/>
    <url>/blog/2022/03/Gatling%E5%8E%8B%E6%B5%8B%E6%A8%A1%E5%9E%8B%E5%92%8C%E4%BD%BF%E7%94%A8%E5%8F%82%E6%95%B0%E4%BB%8B%E7%BB%8D.html</url>
    
    <content type="html"><![CDATA[<h2 id="开放模型"><a href="#开放模型" class="headerlink" title="开放模型"></a>开放模型</h2><p>开放模型中我们可以主动的控制用户的到达率。</p><ul><li><p>开放模型的好处</p><ul><li><p>了解每阶段用户真实的请求量，与并发的不可控的情况下，这种场景会更加偏向于真实。</p></li><li><p>每个请求链或者请求都是一个新的连接，复用较少，会发现以前一些因为连接数不够而为发现的问题。</p></li><li><p>请求持续注入，当系统已经达到性能瓶颈时，不会与并发一样减少请求量，而是会以设置的请求量持续注入。</p></li></ul></li><li><p>开放模型的坏处</p><ul><li>每个虚拟用户都有自己的连接。如果生命周期短，用户创造率很高，那么将不得不打开和关闭大量连接。</li><li>与服务端连接数较多，当服务端处理过慢出现堆积的时候，会导致压测脚本崩溃。</li></ul></li></ul><h3 id="一次性注入"><a href="#一次性注入" class="headerlink" title="一次性注入"></a>一次性注入</h3><p>设置了一次性注入的用户数</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scala">atOnceUsers(<span class="hljs-number">4</span>)<br></code></pre></td></tr></table></figure><p><img src="/blog/./assets/image-jltwc0202rcaywr0t5k09ty.PNG" alt="一次性注入"></p><h3 id="在指定时间内线性增长用户数到指定数量"><a href="#在指定时间内线性增长用户数到指定数量" class="headerlink" title="在指定时间内线性增长用户数到指定数量"></a>在指定时间内线性增长用户数到指定数量</h3><p>设置了总的用户数，然后设置一个分配总用户数的时间，每秒的用户数是一样的。</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scala">rampUsers(<span class="hljs-number">4</span>).during(<span class="hljs-number">4.</span>seconds)<br></code></pre></td></tr></table></figure><p><img src="/blog/./assets/image-utx4scd6kgalt0aotyw4qu6.PNG" alt="线性增长用户"></p><h3 id="恒定速率"><a href="#恒定速率" class="headerlink" title="恒定速率"></a>恒定速率</h3><h3 id="每秒固定用户数"><a href="#每秒固定用户数" class="headerlink" title="每秒固定用户数"></a>每秒固定用户数</h3><p>持续指定时间，设置了每秒注入的用户数，然后设置一个持续的时间，每秒的用户数是一样的。</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scala">constantUsersPerSec(<span class="hljs-number">4</span>).during(<span class="hljs-number">4.</span>seconds)<br></code></pre></td></tr></table></figure><p><img src="/blog/./assets/image-i7fydusv68ke7gn5fx5xb6e.PNG" alt="每秒固定用户数恒定速率"></p><h3 id="每秒用户数从指定值提升到指定值"><a href="#每秒用户数从指定值提升到指定值" class="headerlink" title="每秒用户数从指定值提升到指定值"></a>每秒用户数从指定值提升到指定值</h3><p>持续指定时间，每秒的用户数会增加。</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scala">rampUsersPerSec(<span class="hljs-number">1</span>).to(<span class="hljs-number">4</span>).during(<span class="hljs-number">4.</span>seconds)<br></code></pre></td></tr></table></figure><p><img src="/blog/./assets/image-hxxs1z8f26jxksyf1c76jm9.PNG" alt="每秒用户数线性增长恒定速率"></p><h3 id="随机速率"><a href="#随机速率" class="headerlink" title="随机速率"></a>随机速率</h3><h3 id="每秒固定用户数-1"><a href="#每秒固定用户数-1" class="headerlink" title="每秒固定用户数"></a>每秒固定用户数</h3><p>持续指定时间（每秒的用户数是一样的，但因为是在毫秒级别随机，所有用户数曲线会有波动）。</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scala">constantUsersPerSec(<span class="hljs-number">4</span>).during(<span class="hljs-number">4.</span>seconds).randomized<br></code></pre></td></tr></table></figure><p><img src="/blog/./assets/image-3uv3bwpp4xipfl72jaa9k9q.PNG" alt="每秒固定用户数随机速率"></p><h3 id="每秒用户数从指定值提升到指定值-1"><a href="#每秒用户数从指定值提升到指定值-1" class="headerlink" title="每秒用户数从指定值提升到指定值"></a>每秒用户数从指定值提升到指定值</h3><p>持续指定时间(每秒的用户数会线性增加到一个指定值，又因为毫秒级别的随机导致曲线会存在波动）。</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scala">rampUsersPerSec(<span class="hljs-number">1</span>).to(<span class="hljs-number">4</span>).during(<span class="hljs-number">4.</span>seconds).randomized<br></code></pre></td></tr></table></figure><p><img src="/blog/./assets/image-64npwyakojlzdgo8tyl3mkt.PNG" alt="每秒用户数线性增长随机速率"></p><h3 id="阶跃函数"><a href="#阶跃函数" class="headerlink" title="阶跃函数"></a>阶跃函数</h3><p>在指定时间内，以阶跃函数的方式逐步增加用户到指定数量（即每秒递增）（先增长，后衰减）</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scala">heavisideUsers(<span class="hljs-number">12</span>).during(<span class="hljs-number">5.</span>seconds)<br></code></pre></td></tr></table></figure><p><img src="/blog/./assets/image-2lut99xqkt5wofihbjjao0z.PNG" alt="阶跃函数"></p><h3 id="开放模型负载"><a href="#开放模型负载" class="headerlink" title="开放模型负载"></a>开放模型负载</h3><p>从指定每秒用户数开始，每持续指定时间，在指定时间段内增加指定每秒用户数，如此循环增长指定次数（阶梯增加用户数）</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs scala">incrementUsersPerSec(<span class="hljs-number">50</span>)<br>.times(<span class="hljs-number">10</span>)<br>.eachLevelLasting(<span class="hljs-number">120.</span>seconds)<br>.separatedByRampsLasting(<span class="hljs-number">5.</span>seconds)<br>.startingFrom(<span class="hljs-number">100</span>)<br></code></pre></td></tr></table></figure><p><img src="/blog/./assets/image-z66h6rbwz535ucw90hd906n.PNG" alt="开放负载模型"></p><h2 id="封闭模型"><a href="#封闭模型" class="headerlink" title="封闭模型"></a>封闭模型</h2><p>封闭模型可控制并发用户数，保持一定的连接数并复用，减少因为建立连接所导致的问题，满负荷运行时，新用户只有在另一个用户退出后才能有效地进入系统。</p><ul><li><p>封闭模型的好处</p><ul><li><p>可以快速了解到系统的极限值在哪里。</p><ul><li>线程复用，不会每秒打开或者关闭连接导致系统资源出现问题。</li></ul></li></ul></li><li><p>封闭模型的坏处</p><ul><li><p>无法复现因为连接数导致的问题。</p></li><li><p>无法模拟真实用户的场景。</p></li></ul></li></ul><h3 id="固定并发用户数"><a href="#固定并发用户数" class="headerlink" title="固定并发用户数"></a>固定并发用户数</h3><p>指定时间内，固定并发用户数。</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scala">constantConcurrentUsers(<span class="hljs-number">1000</span>).during(<span class="hljs-number">30.</span>seconds)<br></code></pre></td></tr></table></figure><p><img src="/blog/./assets/image-bk5edfnhwkszeuageh9ghpk.PNG" alt="固定并发用户数"></p><h3 id="并发用户数从指定值增加到指定值"><a href="#并发用户数从指定值增加到指定值" class="headerlink" title="并发用户数从指定值增加到指定值"></a>并发用户数从指定值增加到指定值</h3><p>指定时间内，并发用户数从指定值增加到指定值。</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scala">rampConcurrentUsers(<span class="hljs-number">10</span>).to(<span class="hljs-number">50</span>).during(<span class="hljs-number">10.</span>seconds)<br></code></pre></td></tr></table></figure><p><img src="/blog/./assets/image-2onh0p8s99r3y2dphddqa40.PNG" alt="线性增长固定并发数"></p><h3 id="封闭模型负载"><a href="#封闭模型负载" class="headerlink" title="封闭模型负载"></a>封闭模型负载</h3><p>从指定并发开始，每持续指定时间，在指定时间段内增加指定并发数，如此循环增长指定次数。</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs scala">incrementConcurrentUsers(<span class="hljs-number">100</span>)<br>.times(<span class="hljs-number">10</span>)<br>.eachLevelLasting(<span class="hljs-number">120.</span>seconds)<br>.separatedByRampsLasting(<span class="hljs-number">5.</span>seconds)<br>.startingFrom(<span class="hljs-number">100</span>)<br></code></pre></td></tr></table></figure><p><img src="/blog/./assets/image-hk0wpk5yeowrdr97uyje1cs.PNG" alt="封闭负载模型"></p><p>（完）</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>Gatling</category>
      
    </categories>
    
    
    <tags>
      
      <tag>软件</tag>
      
      <tag>Gatling</tag>
      
      <tag>性能测试</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Gatling性能测试工具简介和入门</title>
    <link href="/blog/2022/03/Gatling%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%E7%AE%80%E4%BB%8B%E5%92%8C%E5%85%A5%E9%97%A8.html"/>
    <url>/blog/2022/03/Gatling%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%E7%AE%80%E4%BB%8B%E5%92%8C%E5%85%A5%E9%97%A8.html</url>
    
    <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p><strong>Gatling</strong>是一款基于<strong>Scala</strong>开发的高性能服务器端性能测试工具。具备以下特点:</p><ul><li>支持Akka Actors和Async IO；</li><li>支持实时生成html动态轻量级报表；</li><li>支持DSL脚本；</li><li>支持插件的开发和使用；</li><li>支持脚本的录制和导入；</li><li>社区版开源免费，可以二次开发。</li></ul><h2 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h2><p><a href="https://gatling.io/products">下载地址</a></p><p><img src="/blog/./assets/image-20240405174953012.png" alt="开源版下载"></p><h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><ol><li><p>解压下载的工具包后进入根目录</p><p><img src="/blog/./assets/image-v0zxc0uvyf9nptxyonz8drm.PNG" alt="目录结构"></p></li></ol><ul><li><p>bin目录</p><p>启动脚本及基本配置 gatling.bat（或gatling.sh），通过执行它来开启压测；</p></li><li><p>conf目录</p><p>些配置项，包括一些目录的配置，基础协议的配置</p></li><li><p>lib目录</p><p>依赖的第三方jar包，自己开发的插件或压测脚本依赖的第三方jar也可以放入该目录下</p></li><li><p>results目录</p><p>每次压测的执行结果包括结果记录和生成的html报表</p></li><li><p>user-files目录</p><p>有两个目录，resources和simulations，resources目录下存放压测参数化数据文件和脚本中用到的其他配置文件；simulations目录下存放脚本源码，当simulations目录下存在脚本源码时，每次启动压测都会先进行脚本编译，编译后的脚本会存放到target&#x2F;test-classes目录下</p></li></ul><ol start="2"><li>运行脚本</li></ol><ul><li>Windows下执行bin\gatling.bat</li><li>Linux下执行bin&#x2F;gatling.sh</li></ul><p>工具会先对user-files&#x2F;simulations下的脚本进行编译，然后展示target&#x2F;test-classes下的所有已经编译的脚本。</p><p><img src="/blog/./assets/image-nank3fhc9se38fugqp64lic.PNG" alt="压测脚本列表"></p><ol start="3"><li>选择一个脚本编号，然后回车，输入压测描述，再次回车开始发压</li></ol><p><img src="/blog/./assets/image-53a9vt9djmvyb665uk4g7pj.PNG" alt="选择脚本执行"></p><p>压测结束后，会在控制台会展示压测结果信息。</p><p><img src="/blog/./assets/image-ztumab65rcjy32htve2m7xz.PNG" alt="压测结果"></p><ul><li>包括请求总数（成功&#x2F;失败）</li><li>最小响应时间（成功&#x2F;失败）</li><li>最大响应时间（成功&#x2F;失败）</li><li>平均响应时间（成功&#x2F;失败）</li><li>标准差（成功&#x2F;失败）</li><li>响应时间TP50（成功&#x2F;失败）</li><li>响应时间TP75（成功&#x2F;失败）</li><li>响应时间TP90（成功&#x2F;失败）</li><li>响应时间TP99（成功&#x2F;失败）</li><li>QPS （成功&#x2F;失败）</li><li>响应时间分布（800ms-1200ms）</li></ul><p>同时在控制台中也会显示生成的html报表地址。</p><h2 id="压测报告"><a href="#压测报告" class="headerlink" title="压测报告"></a>压测报告</h2><ul><li>压测概览（包括响应时间的大体分布、成功&#x2F;失败占比、QPS、响应时间等）</li></ul><p><img src="/blog/./assets/image-u41kqaxn6wp5mcheifh9vdv.PNG" alt="压测概览"></p><ul><li><p>活跃用户数（描述在时间轴上每一秒的实际并发用户数）</p><p><img src="/blog/./assets/image-c61i4i2onrjfttx34e6pbcm.PNG" alt="活跃用户数"></p></li><li><p>响应时间详细分布（描述每个响应时间的请求数）</p><p><img src="/blog/./assets/image-31h00mqopcm39zsrd7fn01q.PNG" alt="相应时间分布"></p></li><li><p>响应时间百分位数（响应时间在时间轴上的各个百分位数）</p><p><img src="/blog/./assets/image-y0nlx9kc1tjmnxs7ql9t5ge.PNG" alt="相应时间百分比"></p></li><li><p>每秒请求数（每秒发送请求在时间轴上的个数）</p><p><img src="/blog/./assets/image-5duojboh0e04pmw3a4yaw7r.PNG" alt="每秒请求数"></p></li><li><p>每秒响应数（每秒收到响应在时间轴上的个数）</p><p><img src="/blog/./assets/image-25xe0ohek4uiizqxcy8z3c8.PNG" alt="每秒响应数"></p></li><li><p>RPS的响应时间分布（展示了每个RPS下的响应时间分布）</p><p><img src="/blog/./assets/image-z43yepcf23yktkgnfdmqyoo.PNG" alt="RPS响应时间分布"></p></li></ul><p>（完）</p><p><strong>参考</strong></p><p><a href="https://help.aliyun.com/zh/pts/interpretation-of-concurrent-users-and-rps-and-tps">并发用户、RPS、TPS的解读</a></p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>Gatling</category>
      
    </categories>
    
    
    <tags>
      
      <tag>软件</tag>
      
      <tag>Gatling</tag>
      
      <tag>性能测试</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>红帽RHCE学习总结</title>
    <link href="/blog/2022/02/%E7%BA%A2%E5%B8%BDRHCE%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93.html"/>
    <url>/blog/2022/02/%E7%BA%A2%E5%B8%BDRHCE%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93.html</url>
    
    <content type="html"><![CDATA[<h2 id="考试信息"><a href="#考试信息" class="headerlink" title="考试信息"></a>考试信息</h2><p>考试时间：4小时<br>总分：300分<br>及格分：210  </p><h3 id="安装和配置-Ansible"><a href="#安装和配置-Ansible" class="headerlink" title="安装和配置 Ansible"></a>安装和配置 Ansible</h3><p>按照下方所述，在控制节点 172.25.250.200 上安装和配置 Ansible：<br>安装所需的软件包<br>创建名为 &#x2F;home&#x2F;greg&#x2F;ansible&#x2F;inventory 的静态清单文件，以满足以下要求:</p><ul><li>172.25.250.9 是 dev 主机组的成员</li><li>172.25.250.10 是 test 主机组的成员</li><li>172.25.250.11 和 172.25.250.12 是 prod 主机组的成员</li><li>172.25.250.13 是 balancers 主机组的成员</li><li>prod 组是 webservers 主机组的成员<br>创建名为 &#x2F;home&#x2F;greg&#x2F;ansible&#x2F;ansible.cfg 的配置文件，以满足以下要求：  </li><li>主机清单文件为 &#x2F;home&#x2F;greg&#x2F;ansible&#x2F;inventory</li><li>playbook 中使用的角色的位置包括 &#x2F;home&#x2F;greg&#x2F;ansible&#x2F;roles</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 安装ansible</span><br>yum -y install ansible<br><span class="hljs-comment"># 创建目录</span><br><span class="hljs-built_in">mkdir</span> /home/greg/ansible/<br><span class="hljs-comment"># 配置清单</span><br>vim /home/greg/ansible/inventory<br>[dev]<br>172.25.250.9<br><br>[<span class="hljs-built_in">test</span>]<br>172.25.250.10<br><br>[prod]<br>172.25.250.11<br>172.25.250.12<br><br>[balancers]<br>172.25.250.13<br><br>[webservers:children]<br>prod<br><span class="hljs-comment"># 创建配置文件</span><br>vim /home/greg/ansible/ansible.cfg<br>[defaults]<br>inventory      =/home/greg/ansible/inventory <br>roles_path    = /home/greg/ansible/roles<br><br>[privilege_escalation]<br>become=True<br>become_method=sudo<br>become_user=root<br>become_ask_pass=False<br></code></pre></td></tr></table></figure><p>验证:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs sh">[root@bastion ansible]<span class="hljs-comment"># ansible-inventory --graph</span><br>@all:<br>  |--@balancers:<br>  |  |--172.25.250.13<br>  |--@dev:<br>  |  |--172.25.250.9<br>  |--@<span class="hljs-built_in">test</span>:<br>  |  |--1782.25.250.10<br>  |--@ungrouped:<br>  |--@webservers:<br>  |  |--@prod:<br>  |  |  |--172.25.250.11<br>  |  |  |--172.25.250.12<br><br></code></pre></td></tr></table></figure><h3 id="创建和运行-Ansible-临时命令"><a href="#创建和运行-Ansible-临时命令" class="headerlink" title="创建和运行 Ansible 临时命令"></a>创建和运行 Ansible 临时命令</h3><p>作为系统管理员，您需要在受管节点上安装软件。<br>请按照正文所述，创建一个名为 &#x2F;home&#x2F;greg&#x2F;ansible&#x2F;adhoc.sh 的 shell 脚本，该脚本将使用Ansible 临时命令在各个受管节点上安装 yum 存储库：</p><p>存储库 1：  </p><ul><li>存储库的名称为 EX294_BASE</li><li>描述为 EX294 base software</li><li>基础 URL 为 <a href="ftp://host.domain8.example.com/dvd/BaseOS">ftp://host.domain8.example.com/dvd/BaseOS</a></li><li>GPG 签名检查为启用状态</li><li>GPG 密钥 URL 为 <a href="ftp://host.domain8.example.com/dvd/RPM-GPG-KEY-redhat-release">ftp://host.domain8.example.com/dvd/RPM-GPG-KEY-redhat-release</a></li><li>存储库为启用状态</li></ul><p>存储库 2：  </p><ul><li>存储库的名称为 EX294_STREAM</li><li>描述为 EX294 stream software</li><li>基础 URL 为 <a href="ftp://host.domain8.example.com/dvd/AppStream">ftp://host.domain8.example.com/dvd/AppStream</a></li><li>GPG 签名检查为启用状态</li><li>GPG 密钥 URL 为 <a href="ftp://host.domain8.example.com/dvd/RPM-GPG-KEY-redhat-release">ftp://host.domain8.example.com/dvd/RPM-GPG-KEY-redhat-release</a></li><li>存储库为启用状态</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 配置脚本</span><br>vim /home/greg/ansible/adhoc.sh<br><span class="hljs-comment">#!/bin/bash</span><br><br>ansible all -m yum_repository -a <span class="hljs-string">&quot;name=EX294_BASE description=&#x27;EX294 base software&#x27; baseurl=ftp://host.domain8.example.com/dvd/BaseOS enabled=yes gpgcheck=yes gpgkey=ftp://host.domain8.example.com/dvd/RPM-GPG-KEY-redhat-release&quot;</span><br><br>ansible all -m yum_repository -a <span class="hljs-string">&quot;name=EX294_STREAM description=&#x27;EX294 stream software&#x27; baseurl=ftp://host.domain8.example.com/dvd/AppStream enabled=yes gpgcheck=yes gpgkey=ftp://host.domain8.example.com/dvd/RPM-GPG-KEY-redhat-release&quot;</span><br><span class="hljs-comment"># 添加可执行权限</span><br><span class="hljs-built_in">chmod</span> +x /home/greg/ansible/adhoc.sh<br><span class="hljs-comment"># 执行(需要进入执行目录，在外面的目录依旧是ansible默认配置）</span><br> /home/greg/ansible/<br> ./adhoc.sh<br></code></pre></td></tr></table></figure><blockquote><p>提示：查询模块：<code>ansible-doc -l |grep yum</code>  查询模块帮助：<code>ansible-doc yum_repository</code></p></blockquote><p>验证：  </p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">ansible all -m shell -a <span class="hljs-string">&quot;yum repolist all&quot;</span><br></code></pre></td></tr></table></figure><h3 id="安装软件包"><a href="#安装软件包" class="headerlink" title="安装软件包"></a>安装软件包</h3><p>创建一个名为 &#x2F;home&#x2F;greg&#x2F;ansible&#x2F;packages.yml 的 playbook :  </p><ul><li>将 php 和 mariadb 软件包安装到 dev、test 和 prod 主机组中的主机上</li><li>将 RPM Development Tools 软件包组安装到 dev 主机组中的主机上</li><li>将 dev 主机组中主机上的所有软件包更新为最新版本</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 编辑playbook</span><br>vim /home/greg/ansible/packages.yml<br><br>---<br>- hosts: dev,<span class="hljs-built_in">test</span>,prod<br>  tasks:<br>  - name: install php mariadb<br>    yum: name=php,mariadb state=present<br><br>- hosts: dev<br>  tasks:<br>  - name: rmp grpup<br>    yum: name=<span class="hljs-string">&quot;@RPM Development Tools&quot;</span> state=present<br><br>  - name: upgrade software<br>    yum: name=<span class="hljs-string">&#x27;*&#x27;</span> state=latest<br><br><span class="hljs-comment"># 检查playbook</span><br>ansible-playbook /home/greg/ansible/packages.yml --syntax-check<br><span class="hljs-comment"># 执行playbook</span><br>ansible-playbook /home/greg/ansible/packages.yml<br><br></code></pre></td></tr></table></figure><blockquote><p>查看软件包组：<code>yum grouplist</code></p></blockquote><h3 id="使用-RHEL-系统角色"><a href="#使用-RHEL-系统角色" class="headerlink" title="使用 RHEL 系统角色"></a>使用 RHEL 系统角色</h3><p>安装 RHEL 系统角色软件包，并创建符合以下条件的 playbook &#x2F;home&#x2F;greg&#x2F;ansible&#x2F;timesync.yml ：  </p><ul><li>在所有受管节点上运行</li><li>使用 timesync 角色</li><li>配置该角色，以使用当前有效的 NTP 提供商</li><li>配置该角色，以使用时间服务器 172.25.250.250</li><li>配置该角色，以启用 iburst</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#　搜索和安装rhel角色软件包</span><br>yum search *rhel*roles*<br>yum -y install rhel-system-roles.noarch<br><span class="hljs-comment"># 复制角色</span><br><span class="hljs-built_in">cp</span> -r /usr/share/ansible/roles/rhel-system-roles.timesync/ ~/ansible/roles/timesync<br><span class="hljs-comment"># 创建playbook</span><br>vim  /home/greg/ansible/timesync.yml<br><br>--- <br>- hosts: all <br>  vars: <br>   timesync_ntp_servers: <br>   - hostname: 172.25.250.250 <br>     iburst: <span class="hljs-built_in">yes</span> <br>     pool: <span class="hljs-built_in">yes</span> <br>  roles: <br>  - role: timesync <br></code></pre></td></tr></table></figure><blockquote><p>备注：可以使用<code>rpm -ql rhel-system-roles</code>查看安装包的文件。playbook可以从路径复制：<br>&#x2F;usr&#x2F;share&#x2F;doc&#x2F;rhel-system-roles&#x2F;timesync&#x2F;example-timesync-playbook.yml</p></blockquote><p>验证：  </p><p>在任意一台受控节点上查看:  </p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">cat</span> /etc/chrony.conf<br></code></pre></td></tr></table></figure><h3 id="使用-Ansible-Galaxy-安装角色"><a href="#使用-Ansible-Galaxy-安装角色" class="headerlink" title="使用 Ansible Galaxy 安装角色"></a>使用 Ansible Galaxy 安装角色</h3><p>使用名字为文件 &#x2F;home&#x2F;greg&#x2F;ansible&#x2F;roles&#x2F;requirements.yml 下载并安装 Ansible Galaxy 角<br>色。从下列 URL 下载 ：  </p><ul><li><a href="http://host.domain8.example.com/ex300/haproxy.tar.gz">http://host.domain8.example.com/ex300/haproxy.tar.gz</a> 此角色的名称应当为 balancer</li><li><a href="http://host.domain8.example.com/ex300/phpinfo.tar.gz">http://host.domain8.example.com/ex300/phpinfo.tar.gz</a> 此角色的名称应当为 phpinf</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 配置yml文件</span><br>vim /home/greg/ansible/roles/requirements.yml<br><br>- src: http://host.domain8.example.com/ex300/haproxy.tar.gz<br>  name: balancer<br>- src: http://host.domain8.example.com/ex300/phpinfo.tar.gz<br>  name: phpinfo<br>  <br><span class="hljs-comment"># 安装角色</span><br>ansible-galaxy install -r roles/requirements.yml -p roles<br></code></pre></td></tr></table></figure><blockquote><p>r:指定role文件，p:指定roles路径</p></blockquote><h3 id="创建和使用角色"><a href="#创建和使用角色" class="headerlink" title="创建和使用角色"></a>创建和使用角色</h3><p>根据下列要求，在 &#x2F;home&#x2F;greg&#x2F;ansible&#x2F;roles 中创建名为 apache 的角色：</p><ul><li>httpd 软件包已安装，设为在系统启动时启用并启动</li><li>防火墙已启用并正在运行，并使用允许访问 Web 服务器的规则</li><li>模板文件为 index.html.j2 ，用于创建具有以下输出的文件 &#x2F;var&#x2F;www&#x2F;html&#x2F;index.html ：<br>Welcome to HOSTNAME on IPADDRESS</li><li>其中，HOSTNAME 是受管节点的完全限定域名，IPADDRESS 则是受管节点的 IP 地址。 </li><li>创建名为 newroles.yml 的 playbook，使用这个角色，对 webservers 组进行操作。</li><li>HOSTNAME 是 FQDN 的完整主机名</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 创建角色</span><br>ansible-galaxy init roles/apache<br><span class="hljs-comment"># 编辑角色task</span><br>vim roles/apache/tasks/main.yml<br><br>---<br><span class="hljs-comment"># tasks file for apache</span><br>- name: install httpd<br>  yum: name=httpd state=installed<br><br>- name: start httpd<br>  service: name=httpd state=started enabled=<span class="hljs-built_in">yes</span><br><br>- name: start firewalld<br>  service: name=firewalld state=started enabled=<span class="hljs-built_in">yes</span><br><br>- name: open http firewalld<br>  firewalld: service=http immediate=<span class="hljs-built_in">yes</span> permanent=<span class="hljs-built_in">yes</span> state=enabled<br><br>- name: copy jinja2<br>  template: src=index.html.j2 dest=/var/www/html/index.html<br><br><span class="hljs-comment"># 创建模板</span><br>vim roles/apache/templates/index.html.j2<br><br>Welcome to &#123;&#123;ansible_fqdn&#125;&#125; on &#123;&#123;ansible_default_ipv4.address&#125;&#125;<br><br><span class="hljs-comment"># 创建playbook</span><br>vim newroles.yml <br><br>---<br>- hosts: webservers<br>  roles:<br>  - role: apache<br>  <br><span class="hljs-comment"># 使用playbook</span><br>ansible-playbook newroles.yml <br></code></pre></td></tr></table></figure><blockquote><p>变量帮助： <code>ansible dev -m setup | grep fqdn</code>和<code>ansible dev -m setup | grep defaul</code></p></blockquote><p>验证：<br>    登入webserver下的机器，查看var&#x2F;www&#x2F;html&#x2F;index.html。<br>   在控制端curl被控端80端口，有响应和输出内容。</p><h3 id="从-Ansible-Galaxy-使用角色"><a href="#从-Ansible-Galaxy-使用角色" class="headerlink" title="从 Ansible Galaxy 使用角色"></a>从 Ansible Galaxy 使用角色</h3><p>根据下列要求，创建一个名为 &#x2F;home&#x2F;greg&#x2F;ansible&#x2F;roles.yml 的 playbook ：</p><ul><li>playbook 中包含一个 play，该 play 在 balancers 主机组中的主机上运行并将使用 balancer<br>角色。</li><li>此角色配置一项服务，以在 webservers 主机组中的主机之间平衡 Web 服务器请求的负载。</li><li>浏览到 balancers 主机组中的主机（例如 <a href="http://172.25.250.13/">http://172.25.250.13</a> ）将生成以下输出：<br>Welcome to serverc.domain8.example.com on 172.25.250.11</li><li>重新加载浏览器将从另一 Web 服务器生成输出：<br>Welcome to serverd.domain8.example.com on 172.25.250.12</li></ul><p>playbook 中包含一个 play，该 play 在 webservers 主机组中的主机上运行并将使用 phpinfo<br>角色。</p><ul><li>请通过 URL &#x2F;hello.php 浏览到 webservers 主机组中的主机将生成以下输出：<br>Hello PHP World from FQDN</li><li>其中，FQDN 是主机的完全限定名称。<br>Hello PHP World from serverb.lab.example.com</li><li>另外还有 PHP 配置的各种详细信息，如安装的 PHP 版本等。</li><li>同样，浏览到 <a href="http://172.25.250.12/hello.php">http://172.25.250.12/hello.php</a> 会生成以下输出：<br>Hello PHP World from serverc.lab.example.com</li><li>另外还有 PHP 配置的各种详细信息，如安装的 PHP 版本等。</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 创建playbook</span><br>vim  /home/greg/ansible/roles.yml<br><br>---<br>- hosts: all<br><br>- hosts: balancers<br>  roles:<br>  - role: balancer<br><br>- hosts: webservers<br>  roles:<br>  - role: phpinfo<br><br><span class="hljs-comment"># 使用playbook</span><br>ansible-playbook roles.yml<br></code></pre></td></tr></table></figure><p>验证： </p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 负载均衡</span><br>curl 172.25.250.1<br><span class="hljs-comment"># 内容验证</span><br>firefox打开<br>http://172.25.250.11/hello.php<br>http://172.25.250.12/hello.php<br></code></pre></td></tr></table></figure><h3 id="创建和使用逻辑"><a href="#创建和使用逻辑" class="headerlink" title="创建和使用逻辑"></a>创建和使用逻辑</h3><p>创建一个名为 &#x2F;home&#x2F;greg&#x2F;ansible&#x2F;lv.yml 的 playbook ，它将在所有受管节点上运行以执行下列任务：<br>创建符合以下要求的逻辑卷：  </p><ul><li>逻辑卷创建在 research 卷组中</li><li>逻辑卷名称为 data</li><li>逻辑卷大小为 1500 MiB</li><li>使用 ext4 文件系统格式化逻辑卷</li><li>如果无法创建请求的逻辑卷大小，应显示错误信息 Could not create logical volume of that<br>size，并且应改为使用大小 800 MiB。</li><li>如果卷组 research 不存在，应显示错误信息 Volume group done not exist。</li><li>不要以任何方式挂载逻辑卷</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 创建playbook</span><br>vim /home/greg/ansible/lv.yml<br><br>---<br>- hosts: all<br>  tasks:<br>  - name: judge research <span class="hljs-built_in">exit</span><br>    shell: <span class="hljs-string">&quot;vgdisplay research&quot;</span><br>    ignore_errors: <span class="hljs-built_in">yes</span><br>    register: aa<br>  - name: <span class="hljs-keyword">if</span> not <span class="hljs-built_in">exit</span> <span class="hljs-built_in">print</span> err<br>    fail: msg=<span class="hljs-string">&quot;Volume group done not exis&quot;</span><br>    when: aa.rc != 0<br><br>  - name: create lv<br>    block:<br>    - name: create 1500M lv<br>      lvol: vg=research lv=data size=1500M<br>    rescue:<br>    - name: debug 1500 Not create<br>      debug: msg=<span class="hljs-string">&quot;Could not create logical volume of that size&quot;</span><br>    - name: create 800M lv<br>      lvol: vg=research lv=data size=800M<br><br>  - name: mk filesystem ext4<br>    filesystem: dev=/dev/research/data fstype=ext4 force=<span class="hljs-built_in">yes</span><br><br><span class="hljs-comment"># 执行playbook</span><br>ansible-playbook lv.yml<br></code></pre></td></tr></table></figure><p>验证：  </p><p>到受控机器上通过<code>vgs</code>和<code>lvscan</code>查看。</p><h3 id="创建并使用磁盘分区"><a href="#创建并使用磁盘分区" class="headerlink" title="创建并使用磁盘分区"></a>创建并使用磁盘分区</h3><p>创建名为 partition.yml 的 playbook，对所有的节点进行操作：  </p><ul><li>在 vdb 上创建一个主分区， 1500MiB</li><li>使用 ext4 文件系统进行格式化</li><li>将文件系统挂载到&#x2F;newpart</li><li>如果分区大小不满足，产生报错信息： could not create partation of that size<br>则创建分区大小变成 800MiB</li><li>如果磁盘不存在，产生报错信息： disk does not exit</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 创建playbook</span><br>vim /home/greg/ansible/partition.yml<br><br>---<br>- hosts: diskgroup<br>  tasks:<br>  - name: judge vdb exist<br>    shell: <span class="hljs-string">&quot;ls /dev/vdb&quot;</span><br>    ignore_errors: <span class="hljs-built_in">yes</span><br>    register: aa<br><br>  - name: <span class="hljs-keyword">if</span> vbd Not exist <span class="hljs-built_in">print</span> a err info<br>    fail: msg=<span class="hljs-string">&quot;disk does not exist&quot;</span><br>    when: aa.rc != 0<br><br>  - name: create a partitio<br>    block:<br>    - name: create 1500M<br>      parted: device=/dev/vdb number=1 part_end=1500MiM state=present<br>    rescue:<br>    - name: debug 1500M not create<br>      debug: msg=<span class="hljs-string">&quot;could not create partation of that size&quot;</span><br>    - name: create 800M<br>      parted: device=/dev/vdb number=1 part_end=800MiB state=present<br>      <br>    - name: mk a file system<br>      filesystem: dev=/dev/vdb1 fstype=ext4 force=<span class="hljs-built_in">yes</span><br><br>    - name: mount path<br>      mount: src=/dev/vdb1 fstype=ext4 path=/newpart state=mounted<br><br><span class="hljs-comment"># 执行playbook</span><br>ansible-playbook  partition.yml<br></code></pre></td></tr></table></figure><p>验证:  </p><p>到受控机器上通过<code>lsblk</code>查看。</p><h3 id="生成主机文件"><a href="#生成主机文件" class="headerlink" title="生成主机文件"></a>生成主机文件</h3><p>将一个初始模板文件从 <a href="http://host.domain8.example.com/ex300/hosts.j2">http://host.domain8.example.com/ex300/hosts.j2</a> 下载到&#x2F;home&#x2F;greg&#x2F;ansible<br>完成该模板，以便用它生成以下文件：针对每个清单主机包含一行内容，其格式与&#x2F;etc&#x2F;hosts 相同。</p><p>创建名为 &#x2F;home&#x2F;greg&#x2F;ansible&#x2F;hosts.yml 的 playbook，它将使用此模板在 dev 主机组中<br>的主机上生成文件 &#x2F;etc&#x2F;myhosts 。</p><p>该 playbook 运行后， dev 主机组中主机上的文件 &#x2F;etc&#x2F;myhosts 应针对每个受管主机包含<br>一行内容：</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-number">127.0.0.1</span> localhost localhost.localdomain localhost4 localhost4.localdomain4 ::<span class="hljs-number">1</span> localhost<br>localhost.localdomain localhost6 localhost6.localdomain6<br><span class="hljs-number">172.25.250.9</span> workstation.lab.example.com workstation<br><span class="hljs-number">172.25.250.10</span> servera.lab.example.com servera<br><span class="hljs-number">172.25.250.11</span> serverb.lab.example.com serverb<br><span class="hljs-number">172.25.250.12</span> serverc.lab.example.com serverc<br><span class="hljs-number">172.25.250.13</span> serverd.lab.example.com serverd<br></code></pre></td></tr></table></figure><p>注：清单主机名称的显示顺序不重要</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 完善j2文件</span><br><br>&#123;% <span class="hljs-keyword">for</span> host <span class="hljs-keyword">in</span> <span class="hljs-built_in">groups</span>[<span class="hljs-string">&#x27;all&#x27;</span>] %&#125;<br>&#123;&#123; hostvars[host][<span class="hljs-string">&#x27;ansible_default_ipv4&#x27;</span>][<span class="hljs-string">&#x27;address&#x27;</span>]&#125;&#125; &#123;&#123; hostvars[host][<span class="hljs-string">&#x27;ansible_fqdn&#x27;</span>] &#125;&#125; &#123;&#123; hostvars[host][<span class="hljs-string">&#x27;ansible_hostname&#x27;</span>] &#125;&#125;<br>&#123;% endfor %&#125;<br><br><span class="hljs-comment"># 创建playbook</span><br>- hosts: all<br><br>- hosts: dev<br>  tasks:<br>  - name: copy a file<br>    template: src=hosts.j2 dest=/etc/myhosts<br>    <br><span class="hljs-comment"># 执行playbook</span><br>ansible-playbook hosts.yml<br></code></pre></td></tr></table></figure><p>验证:<br>去受控节点dev上查看<code>/etc/myhosts</code>文件</p><h3 id="修改文件内容"><a href="#修改文件内容" class="headerlink" title="修改文件内容"></a>修改文件内容</h3><p>按照下方所述，创建一个名为 &#x2F;home&#x2F;greg&#x2F;ansible&#x2F;issue.yml 的 playbook ：</p><ul><li>该 playbook 将在所有清单主机上运行</li><li>该 playbook 会将 &#x2F;etc&#x2F;issue 的内容替换为下方所示的一行文本：</li><li>在 dev 主机组中的主机上，这行文本显示 为：Development</li><li>在 test 主机组中的主机上，这行文本显示 为：Test</li><li>在 prod 主机组中的主机上，这行文本显示 为：Productio</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 创建playbook</span><br>vim /home/greg/ansible/issue.yml<br><br>---<br>- hosts: all<br>  tasks:<br>  - name: dev content<br>    copy: dest=/etc/issue content=<span class="hljs-string">&quot;Development\n&quot;</span><br>    when: inventory_hostname <span class="hljs-keyword">in</span> groups.dev<br><br>  - name: <span class="hljs-built_in">test</span> content<br>    copy: dest=/etc/issue content=<span class="hljs-string">&quot;Test\n&quot;</span><br>    when: inventory_hostname <span class="hljs-keyword">in</span> groups.test<br><br>  - name: prod content<br>    copy: dest=/etc/issue content=<span class="hljs-string">&quot;Production\n&quot;</span><br>    when: inventory_hostname <span class="hljs-keyword">in</span> groups.prod<br>    <br><span class="hljs-comment"># 执行playbook</span><br>ansible-playbook issue.yml<br></code></pre></td></tr></table></figure><p>验证:<br>去受控节点dev上查看<code>/etc/issue</code>文件</p><h3 id="创建-Web-内容目录"><a href="#创建-Web-内容目录" class="headerlink" title="创建 Web 内容目录"></a>创建 Web 内容目录</h3><p>按照下方所述，创建一个名为 &#x2F;home&#x2F;greg&#x2F;ansible&#x2F;webcontent.yml 的 playbook ：</p><ul><li>该 playbook 在 dev 主机组中的受管节点上运行</li><li>创建符合下列要求的目录 &#x2F;webdev ：</li><li>所属组为 webdev 组</li><li>具有常规权限：owner&#x3D;read+write+execute ，group&#x3D;read+write+execute，<br>other&#x3D;read+execute</li><li>具有特殊权限：设置组 ID</li><li>用符号链接将 &#x2F;var&#x2F;www&#x2F;html&#x2F;webdev 链接到 &#x2F;webdev</li><li>创建文件 &#x2F;webdev&#x2F;index.html ，其中包含如下所示的单行文件： Development</li><li>在 dev 主机组中主机上浏览此目录（例如 <a href="http://172.25.250.9/webdev/">http://172.25.250.9/webdev/</a> ）将生成以下<br>输出：<br>Development</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 创建playbook</span><br>vim /home/greg/ansible/webcontent.yml<br><br>---<br>- hosts: dev<br>  roles:<br>  - role: apache<br><br>  tasks:<br>  - name: create a group<br>    group: name=webdev state=present<br>  - name: create a direct<br>    file: path=/webdev/ state=directory mode=2755 group=webdev setype=httpd_sys_content_t<br>  - name: create a <span class="hljs-built_in">link</span><br>    file: src=/webdev dest=/var/www/html/webdev state=<span class="hljs-built_in">link</span><br><br>  - name: create a file<br>    copy: content=<span class="hljs-string">&quot;Development\n&quot;</span> dest=/webdev/index.html setype=httpd_sys_content_t<br><br><span class="hljs-comment"># 执行playbook</span><br>ansible-playbook /home/greg/ansible/webcontent.yml<br></code></pre></td></tr></table></figure><blockquote><p>setype可通过<code>ls -Zd /var/www/html</code>查看</p></blockquote><p>验证:  </p><p>执行<code>curl 172.25.250.9/webdev/index.html</code></p><h3 id="生成硬件报告"><a href="#生成硬件报告" class="headerlink" title="生成硬件报告"></a>生成硬件报告</h3><p>创建一个名为 &#x2F;home&#x2F;greg&#x2F;ansible&#x2F;hwreport.yml 的 playbook ，它将在所有受管节点上生成<br>含有以下信息的输出文件 &#x2F;root&#x2F;hwreport.txt ：</p><ul><li>清单主机名称</li><li>以 MB 表示的总内存大小</li><li>BIOS 版本</li><li>磁盘设备 vda 的大小</li><li>磁盘设备 vdb 的大小</li><li>输出文件中的每一行含有一个 key&#x3D;value 对。<br>您的 playbook 应当：</li><li>从 <a href="http://host/ex300/hwreport.empty">http://host/ex300/hwreport.empty</a> 下载文件，并将它保存为 &#x2F;root&#x2F;hwreport.txt</li><li>使用正确的值改为 &#x2F;root&#x2F;hwreport.txt</li><li>如果硬件项不存在，相关的值应设为 NONE<br>when: ansible_devices.vdb is not define</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 创建playbook</span><br>vim /home/greg/ansible/hwreport.yml<br><br>---<br>- hosts: all<br>  tasks:<br>  - name: <span class="hljs-built_in">rm</span> file<br>    shell: <span class="hljs-string">&quot;rm -rf /root/hwreport.txt&quot;</span><br><br>  - name: download file<br>    get_url: url=<span class="hljs-string">&quot;http://host/ex300/hwreport.empty&quot;</span> dest=<span class="hljs-string">&quot;/root/hwreport.txt&quot;</span><br><br>  - name: inventory name<br>    lineinfile: path=/root/hwreport.txt regexp=<span class="hljs-string">&quot;^HOST&quot;</span> line=HOST=&#123;&#123;inventory_hostname&#125;&#125;<br><br>  - name: memory size<br>    lineinfile: path=/root/hwreport.txt regexp=<span class="hljs-string">&quot;^MEMORY&quot;</span> line=MEMORY=&#123;&#123;ansible_memtotal_mb&#125;&#125;MB<br><br>  - name: bios version<br>    lineinfile: path=/root/hwreport.txt regexp=<span class="hljs-string">&quot;^BIOS&quot;</span> line=BIOS=&#123;&#123;ansible_bios_version&#125;&#125;<br><br>  - name: vda size<br>    lineinfile: path=/root/hwreport.txt regexp=<span class="hljs-string">&quot;^DISK_SIZE_VDA&quot;</span> line=DISK_SIZE_VDA=&#123;&#123;ansible_devices.vda.size&#125;&#125;<br><br>  - name: vdb size<br>    block:<br>    - lineinfile: path=/root/hwreport.txt regexp=<span class="hljs-string">&quot;^DISK_SIZE_VDB&quot;</span> line=DISK_SIZE_VDB=&#123;&#123;ansible_devices.vdb.size&#125;&#125;<br>    rescue:<br>    - lineinfile: path=/root/hwreport.txt regexp=<span class="hljs-string">&quot;^DISK_SIZE_VDB&quot;</span> line=DISK_SIZE_VDB=NONE<br><br><span class="hljs-comment"># 执行playbook</span><br>ansible-playbook hwreport.yml<br></code></pre></td></tr></table></figure><p>方法二： </p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 创建playbook</span><br>vim /home/greg/ansible/hwreport.yml<br><br>---<br>- hosts: all<br>  tasks:<br>  - name: <span class="hljs-built_in">rm</span> file<br>    shell: <span class="hljs-string">&quot;rm -rf /root/hwreport.txt&quot;</span><br><br>  - name: download file<br>    get_url: url=<span class="hljs-string">&quot;http://host/ex300/hwreport.empty&quot;</span> dest=<span class="hljs-string">&quot;/root/hwreport.txt&quot;</span><br><br>  - name: inventory name<br>    replace: path=/root/hwreport.txt regexp=<span class="hljs-string">&quot;^HOST&quot;</span> replace=<span class="hljs-string">&quot;&#123;&#123;inventory_hostname&#125;&#125;&quot;</span><br><br>  - name: memory size<br>    replace: path=/root/hwreport.txt regexp=<span class="hljs-string">&quot;^MEMORY&quot;</span> replace=<span class="hljs-string">&quot;&#123;&#123;ansible_memtotal_mb | string&#125;&#125;&quot;</span><br><br>  - name: bios version<br>    replace: path=/root/hwreport.txt regexp=<span class="hljs-string">&quot;^BIOS&quot;</span> replace=<span class="hljs-string">&quot;&#123;&#123;ansible_bios_version&#125;&#125;&quot;</span><br><br>  - name: vda size<br>    replace: path=/root/hwreport.txt regexp=<span class="hljs-string">&quot;^DISK_SIZE_VDA&quot;</span> replace=<span class="hljs-string">&quot;&#123;&#123;ansible_devices.vda.size&#125;&#125;&quot;</span><br><br>  - name: vdb size<br>    replace: path=/root/hwreport.txt regexp=<span class="hljs-string">&quot;^DISK_SIZE_VDB&quot;</span> replace=<span class="hljs-string">&quot;&#123;&#123;ansible_devices.vdb.size&#125;&#125; | default(&#x27;NONE&#x27;)&quot;</span><br><br><br><span class="hljs-comment"># 执行playbook</span><br>ansible-playbook hwreport.yml<br></code></pre></td></tr></table></figure><p>验证:  </p><p>在被控节点上查看<code>/root/hwreport.txt</code></p><h3 id="创建密码库"><a href="#创建密码库" class="headerlink" title="创建密码库"></a>创建密码库</h3><p>按照下方所述，创建一个 Ansible 库来存储用户密码：</p><ul><li>库名称为 &#x2F;home&#x2F;greg&#x2F;ansible&#x2F;locker.yml</li><li>库中含有两个变量，名称如下：</li><li>pw_developer，值为 redhat</li><li>pw_manager，值为 redhat</li><li>用于加密和解密该库的密码为 redhat</li><li>密码存储在文件 &#x2F;home&#x2F;greg&#x2F;ansible&#x2F;secret.txt 中</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 创建locker.yml</span><br>vim  /home/greg/ansible/locker.yml<br><br>pw_developer: redhat<br>pw_manager: redhat<br><br><span class="hljs-comment"># 创建secret.txt</span><br>vim /home/greg/ansible/secret.txt<br>redhat<br><br><span class="hljs-comment"># 加密</span><br>ansible-vault encrypt --vault-id=./secret.txt locker.yml<br></code></pre></td></tr></table></figure><p>验证：  </p><p>查看密码：<code>ansible-vault view --vault-id=./secret.txt locker.yml</code></p><h3 id="创建用户帐户"><a href="#创建用户帐户" class="headerlink" title="创建用户帐户"></a>创建用户帐户</h3><p>从 <a href="http://host/ex300/user_list.yml">http://host/ex300/user_list.yml</a> 下载要创建的用户的列表，并将它保存到&#x2F;home&#x2F;greg&#x2F;ansible。</p><p>在本次考试中使用在其他位置创建的密码库 &#x2F;home&#x2F;greg&#x2F;ansible&#x2F;locker.yml 。创建名为<br>&#x2F;home&#x2F;greg&#x2F;ansible&#x2F;users.yml 的 playbook ，从而按以下所述创建用户帐户：<br>职位描述为 developer 的用户应当：</p><ul><li>在 dev 和 test 主机组中的受管节点上创建</li><li>从 pw_developer 变量分配密码</li><li>是附属组 devops 的成员<br>职位描述为 manager 的用户应当：  </li><li>在 prod 主机组中的受管节点上创建</li><li>从 pw_manager 变量分配密码</li><li>是附属组 opsmgr 的成员</li><li>密码采用 SHA512 哈希格式。</li><li>额外，增加密码过期<br>您的 playbook 应能够在本次考试中使用在其他位置创建的库密码文件<br>&#x2F;home&#x2F;greg&#x2F;ansible&#x2F;secret.txt 正常运行。</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 下载用户列表</span><br>wget  http://host/ex300/user_list.yml<br><span class="hljs-comment"># 创建playbook</span><br><br>---<br>- hosts: dev,<span class="hljs-built_in">test</span><br>  vars_files:<br>  - user_list.yml<br>  - locker.yml<br>  tasks:<br>  - name: create a group<br>    group: name=devops state=present<br>  - name: create a user<br>    user: name=&#123;&#123;item.name&#125;&#125; state=present comment=developer <span class="hljs-built_in">groups</span>=devops password=&#123;&#123;pw_developer | password_hash(<span class="hljs-string">&#x27;sha512&#x27;</span>)&#125;&#125; <br>    when: item.job == <span class="hljs-string">&quot;developer&quot;</span><br>    loop: <span class="hljs-string">&quot;&#123;&#123;users&#125;&#125;&quot;</span><br><br>- hosts: prod<br>  vars_files:<br>  - user_list.yml<br>  - locker.yml<br>  tasks:<br>  - name: create a group<br>    group: name=opsmgr state=present<br>  - name: create a user<br>    user: name=&#123;&#123;item.name&#125;&#125;  state=present comment=manager <span class="hljs-built_in">groups</span>=opsmgr password=&#123;&#123;pw_manager | password_hash(<span class="hljs-string">&#x27;sha512&#x27;</span>)&#125;&#125;<br>    when: item.job == <span class="hljs-string">&quot;manager&quot;</span><br>    loop: <span class="hljs-string">&quot;&#123;&#123;users&#125;&#125;&quot;</span><br>  - name: <span class="hljs-built_in">enable</span> password expires<br>    shell: chage -M <span class="hljs-string">&quot;&#123;&#123;item.passwd_max_expires&#125;&#125;&quot;</span> <span class="hljs-string">&quot;&#123;&#123;item.name&#125;&#125;&quot;</span><br>    when: item.job == <span class="hljs-string">&quot;developer&quot;</span><br>    loop: <span class="hljs-string">&quot;&#123;&#123;users&#125;&#125;&quot;</span><br><br><span class="hljs-comment"># 执行playbook</span><br>ansible-playbook users.yml --vault-id=./secret.txt<br></code></pre></td></tr></table></figure><blockquote><p>enable password expires这步是新加的，可替换成实际过期天数，如30。</p></blockquote><p>验证:  </p><p>在dev,test节点上查看<code>id bob</code>和<code>id fred</code>。<br>验证密码过期:<code>chage -l bob</code>。<br>在prod节点上查看<code>id sally</code>。</p><h3 id="更新-Ansible-库的密钥"><a href="#更新-Ansible-库的密钥" class="headerlink" title="更新 Ansible 库的密钥"></a>更新 Ansible 库的密钥</h3><p>按照下方所述，更新现有 Ansible 库的密钥：<br>从 <a href="http://host/ex300/salaries.yml">http://host/ex300/salaries.yml</a> 下载 Ansible 库到 &#x2F;home&#x2F;greg&#x2F;ansible</p><ul><li>当前的库密码为 111111</li><li>新的库密码为 redhat</li><li>库使用新密码保持加密状态</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 下载</span><br>wget http://host/ex300/salaries.yml<br><span class="hljs-comment"># 修改密码</span><br>ansible-vault rekey salaries.yml<br></code></pre></td></tr></table></figure><p>验证：<br>使用命令<code>ansible-vault view salaries.yml</code>，然后输出密码。</p><h3 id="selinux"><a href="#selinux" class="headerlink" title="selinux"></a>selinux</h3><p>安装 RHEL 系统角色软件包，并创建符合以下条件的 playbook&#x2F;home&#x2F;greg&#x2F;ansible&#x2F;selinux.yml ：</p><ul><li>在所有受管节点上运行</li><li>使用 selinux 角色</li><li>要求所有的节点上 selinux</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 在 ansible 主机上安装 rhel-system-roles.noarch</span><br>yum install rhel-system-roles.noarch<br><span class="hljs-comment"># 拷贝角色</span><br><span class="hljs-built_in">cp</span> -r /usr/share/ansible/roles/rhel-system-roles.selinux/ ./roles/selinux<br><span class="hljs-comment"># 拷贝playbook</span><br><span class="hljs-built_in">cp</span> /usr/share/doc/rhel-system-roles/selinux/example-selinux-playbook.yml selinux.yml<br><span class="hljs-comment"># 修改playbook</span><br>把 rhel-system-roles.selinux 换成 selinux<br><span class="hljs-comment"># 执行playbook</span><br>ansible-playbook selinux.yml<br></code></pre></td></tr></table></figure><p>验证：<br>去受控节点上查询<code>getenforce</code></p><h3 id="crontab"><a href="#crontab" class="headerlink" title="crontab"></a>crontab</h3><p>创建一个名为 <code>/home/greg/ansible/cron.yml</code> 的 playbook : </p><ul><li>配置 <code>cron</code> 作业，该作业<code>每隔 2 分钟</code>运行并执行以下命令：<br><code>logger &quot;EX200 in progress&quot;</code>，以用户 <code>natasha</code></li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 创建playbook</span><br>vim /home/greg/ansible/cron.yml<br><br>---<br>- name: create logger<br>  hosts: all<br>  tasks:<br>  - name: create user natasha<br>    user:<br>      name: natasha<br>      state: present<br>  - name: <span class="hljs-string">&quot;logger info for natasha&quot;</span><br>    cron:<br>      name: <span class="hljs-string">&quot;logger info&quot;</span><br>      minute: <span class="hljs-string">&quot;*/2&quot;</span><br>      user: natasha<br>      job: logger <span class="hljs-string">&quot;EX294 in progress&quot;</span><br><br><span class="hljs-comment"># 执行playbook</span><br>ansible-playbook cron.yml<br></code></pre></td></tr></table></figure><p>验证：<br>去受控节点上查询<code>crontab -u natasha -l</code>。</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>考试</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>Ansible</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>红帽RHCSA学习总结</title>
    <link href="/blog/2022/02/%E7%BA%A2%E5%B8%BDRHCSA%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93.html"/>
    <url>/blog/2022/02/%E7%BA%A2%E5%B8%BDRHCSA%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93.html</url>
    
    <content type="html"><![CDATA[<h2 id="考试信息"><a href="#考试信息" class="headerlink" title="考试信息"></a>考试信息</h2><p>考试时间：3小时<br>满分：300分<br>及格分：210分<br>携带物品：身份证，签字笔(考试会发）</p><p>做题注意：<br>如果是服务，都设置下开机启动<code>systemctl enable xxx</code>。 同时设置开启防火墙。 考试是在<code>/etc/selinuxconfig</code>为<strong>enforce</strong>下进行的,使用命令<code>getenforce</code>可查询状态。<br>Linux命令如果不存在，使用<code>yum whatprovides */semanage</code>,semanage可替换成其他命令。在查询结果中找到*.noarch的包，在使用<code>yum install *.noarch -y</code>。<br>所有编写的脚本都设置x执行权限。<br>做完题目后重启机器检查。</p><h2 id="网络设置"><a href="#网络设置" class="headerlink" title="网络设置"></a>网络设置</h2><ul><li>主机名：node1.domain250.example.com</li></ul><p>查看现在的主机名：<code>hostname</code><br>修改主机名: <code>hostnamectl set-hostname node1.domain250.example.com</code><br>验证主机名：<code>hostname</code></p><blockquote><p><em>此题还可以通过编辑</em><code>*/etc/hostname*</code><em>来配置，需要重启才能生效</em></p></blockquote><ul><li>IP 地址：172.25.250.100</li></ul><p>方法一：<br>查看现在IP地址：<code>ifconfig</code>，记下网卡名称比如:<code>eth0</code><br>修改IP地址:<code>nmtui-edit</code>,删除刚才的网卡名称<code>eth0</code>,再点击<strong>Add</strong>按钮添加一个新的连接，选择<strong>Ethernet</strong>， <strong>Profile name</strong>和<strong>Device</strong>填入对应的网卡名称<code>eth0</code>,再<strong>IPV4 CONFIGURATION</strong>将<strong>Automatic</strong>修改为<strong>Manual</strong>，然后点击<strong>Show</strong>，在<strong>ADddresses</strong>填入<code>172.25.250.100/24</code>,<strong>Gateway</strong>,<strong>DNS servers</strong>依次配置，最后点击<strong>OK</strong>并退出。<br>验证IP地址：<code>ifconfig</code></p><blockquote><p><em>注意新增无需刷新生效，如果是新修改则需要</em><code>*nmcli device reapply eth0*</code><em>刷新生效</em></p></blockquote><p>方法二：<br>查看网络设置信息：<code>nmcli connection show</code><br>设置网络：<code>nmcli connection eth0 ipv4.address 172.25.250.100/24 ipv4.getway 172.25.250.254 ipv4.dns 172.25.250.254 ipv4.method manual</code><br>重启生效:<code>nmcli connection up eth0</code></p><p>方法三：<br>通过vim编辑配置文件 <code>vim /etc/sysconfig/network-scripts/ifcfg-eth0</code></p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">TYPE</span>=Ethernet<br><span class="hljs-attr">PROXY_METHOD</span>=none<br><span class="hljs-attr">BROWSER_ONLY</span>=<span class="hljs-literal">no</span><br><span class="hljs-attr">BOOTPROTO</span>=static<br><span class="hljs-attr">IPADDR</span>=<span class="hljs-number">172.25</span>.<span class="hljs-number">250.100</span><br><span class="hljs-attr">PREFIX</span>=<span class="hljs-number">24</span><br><span class="hljs-attr">GATEWAY</span>=<span class="hljs-number">172.25</span>.<span class="hljs-number">250.254</span><br><span class="hljs-attr">DNS1</span>=<span class="hljs-number">172.25</span>.<span class="hljs-number">250.254</span><br><span class="hljs-attr">DEFROUTE</span>=<span class="hljs-literal">yes</span><br><span class="hljs-attr">IPV4_FAILURE_FATAL</span>=<span class="hljs-literal">no</span><br><span class="hljs-attr">IPV6INIT</span>=<span class="hljs-literal">yes</span><br><span class="hljs-attr">IPV6_AUTOCONF</span>=<span class="hljs-literal">yes</span><br><span class="hljs-attr">IPV6_DEFROUTE</span>=<span class="hljs-literal">yes</span><br><span class="hljs-attr">IPV6_FAILURE_FATAL</span>=<span class="hljs-literal">no</span><br><span class="hljs-attr">IPV6_ADDR_GEN_MODE</span>=stable-privacy<br><span class="hljs-attr">NAME</span>=eth0<br><span class="hljs-attr">UUID</span>=e5d912ab-<span class="hljs-number">45</span>ae-<span class="hljs-number">4</span>d2d-<span class="hljs-number">85</span>fa-<span class="hljs-number">0</span>ea82150b3bb<br><span class="hljs-attr">DEVICE</span>=eth0<br><span class="hljs-attr">ONBOOT</span>=<span class="hljs-literal">yes</span><br></code></pre></td></tr></table></figure><blockquote><p><em>需要刷新网络（考试环境无法刷新）或重启生效</em></p></blockquote><ul><li>子网掩码：255.255.255.0</li></ul><p>无需配置，默认。<br>验证:<code>ifconfig</code></p><ul><li>网关：172.25.250.254</li></ul><p>同IP配置。<br>验证:<code>ifconfig</code></p><ul><li>DNS服务器：172.25.250.254</li></ul><p>同IP配置。<br>验证：<code>netstat -nr</code>或<code>route -n</code>或<code>nslookup node1</code></p><h2 id="配置您的系统以使用默认存储库"><a href="#配置您的系统以使用默认存储库" class="headerlink" title="配置您的系统以使用默认存储库"></a>配置您的系统以使用默认存储库</h2><p>YUM 存储库已可以从 <a href="http://foundation0.ilt.example.com/dvd/BaseOS">http://foundation0.ilt.example.com/dvd/BaseOS</a> 和 <a href="http://foundation0.ilt.example.com/dvd/AppStream">http://foundation0.ilt.example.com/dvd/AppStream</a> 使用配置您的系统，以将这些位置用作默认存储库</p><p>进入<code>/etc/yum.repos.d</code>，任意起名一个文件，以<code>.repo</code>结尾，在文件中增加以下配置内容:</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-section">[BaseOS]</span><br><span class="hljs-attr">name</span>=BaseOS<br><span class="hljs-attr">baseurl</span>=http://foundation0.ilt.example.com/dvd/BaseOS<br><span class="hljs-attr">enabled</span>=<span class="hljs-number">1</span><br><span class="hljs-attr">gpgcheck</span>=<span class="hljs-number">0</span>[AppStream]<br><span class="hljs-attr">name</span>=AppStream<br><span class="hljs-attr">baseurl</span>=http://foundation0.ilt.example.com/dvd/AppStream<br><span class="hljs-attr">enabled</span>=<span class="hljs-number">1</span><br><span class="hljs-attr">gpgcheck</span>=<span class="hljs-number">0</span><br></code></pre></td></tr></table></figure><p>检查：</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ada">yum clean <span class="hljs-keyword">all</span><br>yum repolist <span class="hljs-keyword">all</span><br></code></pre></td></tr></table></figure><p>能在命令行输出中看到配置的两个仓库地址即配置成功。</p><blockquote><p><em>可以使用</em><code>*yum list all*</code><em>来校验仓库地址是否有配错</em></p></blockquote><h2 id="调试-SELinux"><a href="#调试-SELinux" class="headerlink" title="调试 SELinux"></a>调试 SELinux</h2><p>非标准端口 82 上运行的 Web 服务器在提供内容时遇到问题。根据需要调试并解决问题，使其满足以下条件：</p><ul><li>系统上的 Web 服务器能够提供 &#x2F;var&#x2F;www&#x2F;html 中所有现有的 HTML 文件（注：不要删除或以其他方式改动现有的文件内容）</li><li>Web 服务器在端口 82 上提供此内容</li><li>Web 服务器在系统启动时自动启动</li></ul><p>82端口启动失败，发现是semanage中并没有加入http的82端口</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">semanage</span> port -l |grep http<br><span class="hljs-attribute">http_cache_port_t</span>              tcp      <span class="hljs-number">8080</span>, <span class="hljs-number">8118</span>, <span class="hljs-number">8123</span>, <span class="hljs-number">10001</span>-<span class="hljs-number">10010</span><br><span class="hljs-attribute">http_cache_port_t</span>              udp      <span class="hljs-number">3130</span><br><span class="hljs-attribute">http_port_t</span>                    tcp      <span class="hljs-number">80</span>, <span class="hljs-number">81</span>, <span class="hljs-number">443</span>, <span class="hljs-number">488</span>, <span class="hljs-number">8008</span>, <span class="hljs-number">8009</span>, <span class="hljs-number">8443</span>, <span class="hljs-number">9000</span><br><span class="hljs-attribute">pegasus_http_port_t</span>            tcp      <span class="hljs-number">5988</span><br><span class="hljs-attribute">pegasus_https_port_t</span>           tcp      <span class="hljs-number">5989</span><br></code></pre></td></tr></table></figure><p>添加82端口：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">semanage port -<span class="hljs-selector-tag">a</span> -t http_port_t  -<span class="hljs-selector-tag">p</span> tcp <span class="hljs-number">82</span><br></code></pre></td></tr></table></figure><p>如果配置错了，可以使用修改命令：</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">semanage</span> port -m -t http_port_t  -p tcp <span class="hljs-number">82</span><br></code></pre></td></tr></table></figure><blockquote><p><em>semanager可以参考<br>grep semanage &#x2F;etc&#x2F;ssh&#x2F;sshd_config<br>#semanage port -a -t ssh_port_t -p tcp #PORTNUMBER</em></p></blockquote><p>开启访问墙端口放行：</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile">firewall-<span class="hljs-keyword">cmd</span><span class="language-bash"> --add-port=82/tcp --permanent</span><br><span class="hljs-comment"># reload</span><br>firewall-<span class="hljs-keyword">cmd</span><span class="language-bash"> --reload</span><br></code></pre></td></tr></table></figure><blockquote><p><em>查看httpd端口</em><code>*vim /etc/httpd/conf/httpd.conf*</code>*<br>检查httpd服务状态:<em><code>*systemctl status httpd*</code></em><br>启动httpd服务:<em><code>*systemctl start httpd*</code></em><br>重启httpd服务:<em><code>*systemctl restart httpd*</code></em><br>开启启动httpd:*<code>*systemctl enable httpd*</code></p></blockquote><p>验证：</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c">semanage port -l <span class="hljs-string">|grep http</span><br></code></pre></td></tr></table></figure><p>在http里面查看到82端口即可，同时curl访问文件有返回内容<code>curl 127.0.0.1:82/file</code></p><p>额外的练习： 以下内容考试不需要做:</p><p>查看静态资源文件下的file1文件权限：</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs dts">ls -Zd <span class="hljs-keyword">/var/</span>www<span class="hljs-keyword">/html/</span>*<br><span class="hljs-symbol">              system_u:</span>object_r:etc_t:s0 <span class="hljs-keyword">/var/</span>www<span class="hljs-keyword">/html/</span>file1<br><span class="hljs-symbol">system_u:</span>object_r:httpd_sys_content_t:s0 <span class="hljs-keyword">/var/</span>www<span class="hljs-keyword">/html/</span>file2<br><span class="hljs-symbol">system_u:</span>object_r:httpd_sys_content_t:s0 <span class="hljs-keyword">/var/</span>www<span class="hljs-keyword">/html/</span>file3<br></code></pre></td></tr></table></figure><p>修改file1的文件权限同file2和file3:</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">semanage fcontext -a -t httpd_sys_content_t <span class="hljs-regexp">/var/</span>www<span class="hljs-regexp">/html/</span>file1<br><span class="hljs-comment"># 刷新配置</span><br>restorecon -R -v <span class="hljs-regexp">/var/</span>www<span class="hljs-regexp">/html/</span><br></code></pre></td></tr></table></figure><h2 id="创建用户帐户"><a href="#创建用户帐户" class="headerlink" title="创建用户帐户"></a>创建用户帐户</h2><p>创建下列用户、组和组成员资格：</p><ul><li>名为 sysmgrs 的组</li></ul><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">groupadd sysmgrs</span><br></code></pre></td></tr></table></figure><p>验证:</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gradle"><span class="hljs-keyword">grep</span> sysmgrs <span class="hljs-regexp">/etc/g</span>roup<br></code></pre></td></tr></table></figure><ul><li>用户 natasha ，作为次要组从属于 sysmgrs</li></ul><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">useradd -G sysmgrs natasha</span><br></code></pre></td></tr></table></figure><p>验证：</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript"><span class="hljs-built_in">id</span> natasha<br></code></pre></td></tr></table></figure><ul><li>用户 harry ，作为次要组还从属于 sysmgrs</li></ul><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">useradd -G sysmgrs harry</span><br></code></pre></td></tr></table></figure><p>验证：</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript"><span class="hljs-built_in">id</span> harry<br></code></pre></td></tr></table></figure><ul><li>用户 sarah ，无权访问系统上的交互式 shell 且不是 sysmgrs 的成员</li></ul><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">useradd  sarah -s <span class="hljs-regexp">/sbin/</span>nologin<br></code></pre></td></tr></table></figure><blockquote><p><em>非交互式shell可以是</em><code>*/bin/false*</code><em>或</em><code>*/sbin/nologin*</code></p></blockquote><p>验证：<br>sarah无法使登入ssh或者查看shell: <code>grep sarah /etc/passed</code></p><ul><li>natasha 、 harry 和 sarah 的密码应当都是 flectrag</li></ul><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli"><span class="hljs-keyword">echo</span> flectrag | passwd <span class="hljs-params">--stdin</span> natasha<br><span class="hljs-keyword">echo</span> flectrag | passwd <span class="hljs-params">--stdin</span> harry<br><span class="hljs-keyword">echo</span> flectrag | passwd <span class="hljs-params">--stdin</span> sarah<br></code></pre></td></tr></table></figure><p>验证：<br>natasha和harry可以使用密码登入ssh</p><h2 id="配置-cron-作业"><a href="#配置-cron-作业" class="headerlink" title="配置 cron 作业"></a>配置 cron 作业</h2><p>配置 cron 作业，该作业每隔 2 分钟运行并执行以下命令:<br>logger “EX200 in progress”，以用户 natasha 身份运行</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">crontab -u natasha -e<br>*<span class="hljs-string">/2</span> * * * * logger <span class="hljs-string">&quot;EX200 in progress&quot;</span><br></code></pre></td></tr></table></figure><p>验证：</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-keyword">grep</span> EX200 /var/<span class="hljs-built_in">log</span>/<span class="hljs-keyword">messages</span><br></code></pre></td></tr></table></figure><h2 id="创建协作目录"><a href="#创建协作目录" class="headerlink" title="创建协作目录"></a>创建协作目录</h2><p>创建具有以下特征的协作目录 &#x2F;home&#x2F;managers ：</p><ul><li>&#x2F;home&#x2F;managers 的组用权是 sysmgrs</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">chgrp</span> sysmgrs /home/managers<br></code></pre></td></tr></table></figure><ul><li>目录应当可被 sysmgrs 的成员读取、写入和访问，但任何其他用户不具这些权限。（当然，root 用户有权访问系统上的所有文件和目录）</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">chmod</span> g+rw,o-rw /home/managers<br></code></pre></td></tr></table></figure><ul><li>&#x2F;home&#x2F;managers 中创建的文件自动将组所有权设置到 sysmgrs 组</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">chmod</span> g+s /home/managers<br></code></pre></td></tr></table></figure><p>验证:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">ls</span> -ld /home/managers<br></code></pre></td></tr></table></figure><p>去<code>/home/managers</code>中创建文件，查看文件属性，确认后删除该文件。</p><h2 id="配置-NTP"><a href="#配置-NTP" class="headerlink" title="配置 NTP"></a>配置 NTP</h2><p>配置您的系统，使其成为 materials.example.com 的 NTP 客户端。（注：materials.example.com 是 classroom.example.com 的 DNS 别名）</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs routeros">vim /etc/chrony.conf<br><span class="hljs-comment"># 添加配置</span><span class="hljs-built_in"></span><br><span class="hljs-built_in">server </span>materials.example.com iburst<br><span class="hljs-comment"># 重启服务</span><br>systemctl restart chronyd<br><span class="hljs-comment"># 开机启动</span><br>systemctl <span class="hljs-built_in">enable</span> chronyd<br></code></pre></td></tr></table></figure><p>验证:</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">chronyc sources</span><br></code></pre></td></tr></table></figure><h2 id="配置-autofs"><a href="#配置-autofs" class="headerlink" title="配置 autofs"></a>配置 autofs</h2><p>配置 autofs ，以按照如下所述自动挂载远程用户的主目录：</p><ul><li>materials.example.com ( 172.25.254.254 ) NFS 导出 &#x2F;rhome 到您的系统。此文件系统包含为用户 remoteuser1 预配置的主目录</li><li>remoteuser1 的主目录是 materials.example.com:&#x2F;rhome&#x2F;remoteuser1</li><li>remoteuser1 的主目录应自动挂载到本地 &#x2F;rhome 下的 &#x2F;rhome&#x2F;remoteuser1</li><li>主目录必须可供其用户写入</li><li>remoteuser1 的密码是 flectrag</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#新建编辑</span><br>vim /etc/auto.master.d/rhcsa.autofs<br><span class="hljs-comment">#添加以下内容</span><br>/rhome /etc/rhcsa.misc<br><span class="hljs-comment">#新建编辑/etc/rhcsa.misc</span><br>vim /etc/rhcsa.misc<br>remoteuser1     -fstype=nfs,rw    materials.example.com:/rhome/remoteuser1<br></code></pre></td></tr></table></figure><blockquote><p><em>注意&#x2F;rhome&#x2F;remoteuser1 如果有多级目录如&#x2F;rhome&#x2F;b&#x2F;c&#x2F;remoteuser1，则需要在rhcsa.autofs配置多级&#x2F;rhome&#x2F;a&#x2F;b。</em></p></blockquote><p>重启配置：</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">systemctl restart <span class="hljs-built_in">auto</span>fs<br></code></pre></td></tr></table></figure><p>开机启动：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">systemctl <span class="hljs-built_in">enable</span> autofs<br></code></pre></td></tr></table></figure><p>验证：<br><code>su - remoteuser1</code> 或者<code>cd /rhome/remoteuse1</code></p><h2 id="配置-var-tmp-fstab-权限"><a href="#配置-var-tmp-fstab-权限" class="headerlink" title="配置 &#x2F;var&#x2F;tmp&#x2F;fstab 权限"></a>配置 &#x2F;var&#x2F;tmp&#x2F;fstab 权限</h2><p>将文件 &#x2F;etc&#x2F;fstab 复制到 &#x2F;var&#x2F;tmp&#x2F;fstab 。配置 &#x2F;var&#x2F;tmp&#x2F;fstab 的权限以满足如下条件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cp</span> -a /etc/fstab /var/tmp/fstab<br></code></pre></td></tr></table></figure><ul><li>文件 &#x2F;var&#x2F;tmp&#x2F;fstab 自 root 用户所有<br>无需修改</li><li>文件 &#x2F;var&#x2F;tmp&#x2F;fstab 属于组 root<br>无需修改</li><li>文件 &#x2F;var&#x2F;tmp&#x2F;fstab 应不能被任何人执行<br>无需修改</li><li>用户 natasha 能够读取和写入 &#x2F;var&#x2F;tmp&#x2F;fstab<br><code>setfacl -m u:natasha:rw /var/tmp/fstab</code></li><li>用户 harry 无法写入或读取 &#x2F;var&#x2F;tmp&#x2F;fstab<br><code>setfacl -m u:harry:- /var/tmp/fstab</code></li><li>所有其他用户（当前或未来）能够读取 &#x2F;var&#x2F;tmp&#x2F;fstab<br>无需修改</li></ul><p>验证：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#查看文件信息</span><br><span class="hljs-built_in">ls</span> -ld /var/tmp/fstab<br><span class="hljs-comment"># 验证文件权限</span><br>getfacl /var/tmp/fstab<br></code></pre></td></tr></table></figure><blockquote><p><em>查看帮助里面的例子：</em><code>*man setfacl |grep -A8 -i example*</code></p></blockquote><h2 id="配置用户帐号"><a href="#配置用户帐号" class="headerlink" title="配置用户帐号"></a>配置用户帐号</h2><p>配置用户 manalo ，其用户 ID 为 3533。此用户的密码应当为 flectrag。</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli"><span class="hljs-comment"># 创建用户并设置uid</span><br>useradd -u 3533 manalo<br><span class="hljs-comment"># 设置密码</span><br><span class="hljs-keyword">echo</span> flectrag | passwd <span class="hljs-params">--stdin</span> manalo<br></code></pre></td></tr></table></figure><p>验证：</p><p>查看uid:<code>id manalo</code><br>验证密码:<code>ssh manalo @localhost</code></p><p>或者使用远程执行ssh命令验证:<code>ssh manalo@localhost id</code></p><h2 id="查找文件"><a href="#查找文件" class="headerlink" title="查找文件"></a>查找文件</h2><p>查找当 jacques 所有的所有文件并将其副本放入 &#x2F;root&#x2F;findfiles 目录。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">find / -user jacques -<span class="hljs-built_in">exec</span> <span class="hljs-built_in">cp</span> -a &#123;&#125; /root/findfiles/ \;<br></code></pre></td></tr></table></figure><p>验证:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">ls</span> -l /root/findfiles<br></code></pre></td></tr></table></figure><p>找出&#x2F;etc目录下大小超过5MB的文件，并将其副本放入 &#x2F;root&#x2F;findfiles 目录。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">find /etc/ -size +5M -<span class="hljs-built_in">exec</span> <span class="hljs-built_in">cp</span> -a &#123;&#125; /root/findfiles/ \;<br></code></pre></td></tr></table></figure><p>验证:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">ls</span> -l /root/findfiles<br></code></pre></td></tr></table></figure><h2 id="查找字符串"><a href="#查找字符串" class="headerlink" title="查找字符串"></a>查找字符串</h2><p>查找文件 &#x2F;usr&#x2F;share&#x2F;xml&#x2F;iso-codes&#x2F;iso_639_3.xml 中包含字符串 ng 的所有行。将所有这些行的副本按原始顺序放在文件 &#x2F;root&#x2F;list 中。 &#x2F;root&#x2F;list 不得包含空行，且所有行必须是 &#x2F;usr&#x2F;share&#x2F;xml&#x2F;iso-codes&#x2F;iso_639_3.xml 中原始行的确切副本。</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gradle"><span class="hljs-keyword">grep</span> ng <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/xml/i</span>so-codes<span class="hljs-regexp">/iso_639_3.xml &gt; /</span>root/list<br></code></pre></td></tr></table></figure><p>验证：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> /root/list<br></code></pre></td></tr></table></figure><h2 id="创建存档"><a href="#创建存档" class="headerlink" title="创建存档"></a>创建存档</h2><p>创建一个名为 &#x2F;root&#x2F;backup.tar.gz 的 tar 存档，其应包含 &#x2F;usr&#x2F;local 的 tar 存档，其应包含 &#x2F;usr&#x2F;local 的内容。该 tar 存档必须使用 gzip 进行压缩。</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">tar -zcvf <span class="hljs-regexp">/root/</span>backup.tar.gz <span class="hljs-regexp">/usr/</span>local<br></code></pre></td></tr></table></figure><p>验证：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-comment"># 查看文件类型</span><br>file <span class="hljs-regexp">/root/</span>backup.tar.gz<br><span class="hljs-comment"># 查看压缩包内容</span><br>tar -tf <span class="hljs-regexp">/root/</span>backup.tar.gz<br></code></pre></td></tr></table></figure><blockquote><p><em>gzip压缩或bzip2压缩查阅参数</em><code>*man tar |egrep &#39;gzip|bzip2&#39;*</code></p></blockquote><h2 id="sudo提权"><a href="#sudo提权" class="headerlink" title="sudo提权"></a>sudo提权</h2><p>配置sudo提权，允许admins组的成员可以以root身份执行命令，且不需要输入密码。</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs perl"><span class="hljs-comment"># 复制模板</span><br><span class="hljs-keyword">grep</span> wheel /etc/sudoers &gt; <span class="hljs-regexp">/etc/sud</span>oers.d/admins<br><span class="hljs-comment"># 编辑/etc/sudoers.d/admins内容</span><br>%admins ALL=(ALL)       NOPASSWD: ALL<br></code></pre></td></tr></table></figure><h2 id="密码过期"><a href="#密码过期" class="headerlink" title="密码过期"></a>密码过期</h2><p>设置新建用户的密码20天过期。</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-comment"># 编辑配置文件</span><br><span class="hljs-attribute">vim</span> /etc/login.defs<br><span class="hljs-comment"># 修改密码20天过期</span><br><span class="hljs-attribute">PASS_MAX_DAYS</span>   <span class="hljs-number">20</span><br></code></pre></td></tr></table></figure><h2 id="配置容器使其自动启动"><a href="#配置容器使其自动启动" class="headerlink" title="配置容器使其自动启动"></a>配置容器使其自动启动</h2><p>利用注册服务器上的 rsyslog 镜像，创建一个名为 logserver 的容器 这两道容器题目需要结合来做，根据步骤来做题。</p><ul><li>面向 wallah 用户，配置一个 systemd 服务</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 步骤四</span><br><span class="hljs-comment"># 创建systemd 用户目录</span><br><span class="hljs-built_in">mkdir</span> -p ~/.config/systemd/user<br><span class="hljs-comment"># 进入systemd 用户目录</span><br><span class="hljs-built_in">cd</span> .config/systemd/user/<br></code></pre></td></tr></table></figure><ul><li>该服务命名为 container-logserver ，并在系统重启时自动启动，无需干预</li></ul><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs crmsh"><span class="hljs-comment"># 步骤五</span><br><span class="hljs-comment"># 停止容器服务</span><br>podman <span class="hljs-literal">stop</span> logserver<br><span class="hljs-comment"># 检查 systemd 控制权的状态</span><br>loginctl enable-linger wallah<br>loginctl show-<span class="hljs-keyword">user</span> <span class="hljs-title">wallah</span><br><span class="hljs-comment"># 生成systemd服务</span><br>podman generate systemd -n logserver  -f<br><span class="hljs-comment"># 开机启动</span><br>systemctl --<span class="hljs-keyword">user</span> <span class="hljs-title">enable</span> --now container-logserver.service<br><span class="hljs-comment"># 查看状态</span><br>systemctl --<span class="hljs-keyword">user</span> <span class="hljs-title">status</span> container-logserver<br></code></pre></td></tr></table></figure><blockquote><p><em>注意题目描述服务命名为 container-logserver，这里创建时不需要额外加container，直接使用logserver创建后会自动加上。</em></p></blockquote><p>验证：</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs crmsh"><span class="hljs-comment"># 查看Linger=no是否变为yes</span><br>loginctl show-<span class="hljs-keyword">user</span> <span class="hljs-title">wallah</span><br><span class="hljs-comment"># 查看是否开机启动</span><br>systemctl --<span class="hljs-keyword">user</span> <span class="hljs-title">is-enabled</span>  container-logserver.service<br></code></pre></td></tr></table></figure><blockquote><p><em>如果重新生成了systemc服务，并且是同名的。则使用</em><code>*systemctl --user daemon-reload*</code><em>刷新生效</em></p></blockquote><h2 id="为容器配置持久存储"><a href="#为容器配置持久存储" class="headerlink" title="为容器配置持久存储"></a>为容器配置持久存储</h2><p>通过以下方式扩展上一个任务的服务</p><ul><li>配置主机系统的 journald 日志以在系统重启后保留数据，并重新启动日志记录服务</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 步骤一# 先查看所需要的所有者和所属组</span><br>ll -d /run/log/journal<br><span class="hljs-comment"># 检查目录/var/log/journal 是否存在，没有就创建</span><br><span class="hljs-built_in">mkdir</span> /var/log/journa<br><span class="hljs-comment"># 和/run/log/journal一样的用户和组权限</span><br><span class="hljs-built_in">chown</span> root:systemd-journal /var/log/journal<br><span class="hljs-built_in">chmod</span> 2755 /var/log/journa<br><span class="hljs-comment"># 重启日志记录服务systemctl </span><br>restart systemd-journald<br><span class="hljs-comment"># 设置容器永久化</span><br>vim /etc/systemd/journald.conf<br><span class="hljs-comment"># 将Storage=auto内容修改为Storage=persistent</span><br></code></pre></td></tr></table></figure><ul><li>将主机 &#x2F;var&#x2F;log&#x2F;journal目录下任何以 *.journal 的文件复制到 &#x2F;home&#x2F;wallah&#x2F;container_logfile 中</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 步骤二</span><br><span class="hljs-comment"># 将日志拷贝到指定目录</span><br><span class="hljs-built_in">cp</span> -a /var/log/journal/*/*.journal /home/wallah/container_logfile/<br><span class="hljs-comment"># 修改文件权限</span><br><span class="hljs-built_in">chown</span> -R wallah /home/wallah/<br><span class="hljs-comment"># 修改wallah密码</span><br><span class="hljs-built_in">echo</span> flectrag | passwd --stdin wallah<br></code></pre></td></tr></table></figure><ul><li>将服务配置为在启动时自动将 &#x2F;home&#x2F;wallah&#x2F;container_logfile 挂载到容器中的 &#x2F;var&#x2F;log&#x2F;journal 下</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">步骤三</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">ssh到wallah</span><br>ssh wallah @node1<br><span class="hljs-meta prompt_"># </span><span class="language-bash">登入镜像仓库podman login registry.domain250.example.com</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">拉取镜像podman pull rhel8/rsyslog</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">启动容器并挂载目录podman run -d --name logserver -v /home/wallah/container_logfile:/var/log/journal:Zregistry.domain250.example.com/rhel8/rsyslog</span><br></code></pre></td></tr></table></figure><blockquote><p><em>登入时提示错误</em>Error: error authenticating creds for “registry.domain250.example.com”: error pinging docker registry registry.domain250.example.com: Get <a href="https://registry.domain250.example.com/v2/">https://registry.domain250.example.com/v2/</a>: x509: certificate has expired or is not yet valid<em>，解决思路：</em> <code>*man podman login |grep -A8 certificates*</code></p></blockquote><p>验证：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">在容器里执行命令查看日志文件podman <span class="hljs-built_in">exec</span> logserver <span class="hljs-built_in">ls</span> /var/log/journal</span><br></code></pre></td></tr></table></figure><h2 id="设置-root-密码"><a href="#设置-root-密码" class="headerlink" title="设置 root 密码"></a>设置 root 密码</h2><p>将 node2 的 root 密码设置为 flectrag 。您需要获得系统访问权限才能进行此操作。 这道题是在不知道node2密码的前提下设置root密码。</p><p>关机，开机（使用重启时来不及打开控制台就进入系统了）。在第一个选项中输入e，进入编辑模式，在<strong>Linux</strong>开头的那行ctrl+e，进入末尾，空格，输入<code>rd.break</code>,然后按<code>ctrl+x</code>，等待进入<strong>switch_root</strong>终端界面后,在终端输入命令:</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs awk">mount -o remount,rw <span class="hljs-regexp">/sysroot/</span><br>chroot <span class="hljs-regexp">/sysroot/</span><br><span class="hljs-comment"># 修改root密码</span><br>echo flectrag | passwd --stdin root<br>touch /.autorelabel<br><span class="hljs-keyword">exit</span><br><span class="hljs-keyword">exit</span><br></code></pre></td></tr></table></figure><h2 id="预先创建2G的分区-dev-vdb1-并用于创建卷组testvg"><a href="#预先创建2G的分区-dev-vdb1-并用于创建卷组testvg" class="headerlink" title="预先创建2G的分区&#x2F;dev&#x2F;vdb1,并用于创建卷组testvg"></a>预先创建2G的分区&#x2F;dev&#x2F;vdb1,并用于创建卷组testvg</h2><p>提示: lvm结构 从下到上 pp pv vg lg</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-comment"># 创建pp</span><br><span class="hljs-comment"># 查看块设备</span><br><span class="hljs-attribute">lsblk</span><br><span class="hljs-comment"># 分区</span><br><span class="hljs-attribute">fdisk</span> /dev/vdb<br><span class="hljs-comment"># 进入fdisk交互界面</span><br><span class="hljs-comment"># 查看分区信息</span><br><span class="hljs-attribute">p</span><br><span class="hljs-comment"># 增加新分区</span><br><span class="hljs-attribute">n</span><br><span class="hljs-comment"># 添加主分区(p）或扩展分区(e)</span><br><span class="hljs-attribute">p</span><br><span class="hljs-comment"># 分区信息，前2个默认即可,直接回车</span><br><span class="hljs-attribute">Partition</span> number (<span class="hljs-number">1</span>,<span class="hljs-number">2</span>, default <span class="hljs-number">1</span>):<br><span class="hljs-attribute">First</span> sector (<span class="hljs-number">2095106</span>-<span class="hljs-number">8388607</span>, default <span class="hljs-number">2097152</span>):<br><span class="hljs-comment"># 设置结束分区大小</span><br><span class="hljs-attribute">Last</span> sector, +sectors or +size&#123;K,M,G,T,P&#125; (<span class="hljs-number">2097152</span>-<span class="hljs-number">8388607</span>, default <span class="hljs-number">8388607</span>): +<span class="hljs-number">2</span>G<br><span class="hljs-comment"># 保存</span><br><span class="hljs-attribute">w</span><br><span class="hljs-comment"># 再次查看块设备</span><br><span class="hljs-attribute">lsblk</span><br><span class="hljs-comment"># 创建pv</span><br><span class="hljs-attribute">pvcreate</span> /dev/vdb1<br><span class="hljs-attribute">Physical</span> volume <span class="hljs-string">&quot;/dev/vdb1&quot;</span> successfully created.<br><span class="hljs-comment">#查看</span><br><span class="hljs-attribute">pvs</span><br><span class="hljs-comment"># 创建vg</span><br><span class="hljs-attribute">vgcreate</span> testvg /dev/vdb1<br><span class="hljs-attribute">Volume</span> group <span class="hljs-string">&quot;testvg&quot;</span> successfully created<br><span class="hljs-comment"># 查看</span><br><span class="hljs-attribute">vgs</span><br></code></pre></td></tr></table></figure><h2 id="创建大小为200M的逻辑卷-dev-testvg-vo-格式化为xfs文件系统，并挂载在-mnt-vo上"><a href="#创建大小为200M的逻辑卷-dev-testvg-vo-格式化为xfs文件系统，并挂载在-mnt-vo上" class="headerlink" title="创建大小为200M的逻辑卷&#x2F;dev&#x2F;testvg&#x2F;vo,格式化为xfs文件系统，并挂载在&#x2F;mnt&#x2F;vo上"></a>创建大小为200M的逻辑卷&#x2F;dev&#x2F;testvg&#x2F;vo,格式化为xfs文件系统，并挂载在&#x2F;mnt&#x2F;vo上</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 创建lv</span><br>lvcreate -L 200M -n vo testvg<br>Logical volume <span class="hljs-string">&quot;vo&quot;</span> created.<br><span class="hljs-comment"># 查看</span><br>lvs<br><span class="hljs-comment"># 格式化</span><br>mkfs.xfs /dev/testvg/vo<br><span class="hljs-comment">#查看块信息</span><br>blkid<br>/dev/mapper/testvg-vo: UUID=<span class="hljs-string">&quot;61414b60-5003-48ed-94ec-14a6a7d69b67&quot;</span> TYPE=<span class="hljs-string">&quot;xfs&quot;</span><br><span class="hljs-comment"># 永久挂载</span><br>vim /etc/fstab<br><span class="hljs-comment"># 添加以下内容</span><br>dev/mapper/testvg-vo /mnt/vo xfs defaults        0 0<br><span class="hljs-comment"># 刷新挂载</span><br>mount -a<br><span class="hljs-comment"># 查看</span><br><span class="hljs-built_in">df</span> -hT<br></code></pre></td></tr></table></figure><h2 id="设置逻辑卷大小"><a href="#设置逻辑卷大小" class="headerlink" title="设置逻辑卷大小"></a>设置逻辑卷大小</h2><p>将逻辑卷 vo 及其文件系统的大小调整到 230 MiB。确保文件系统内容保持不变。注：分区大小很少与请求的大小完全相同，因此可以接受范围为 217 MiB 到 243 MiB 的大小。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># ext4</span><br><span class="hljs-comment"># 查看volo逻辑卷</span><br><span class="hljs-built_in">df</span> -hT |grep vo<br>/dev/mapper/myvol-vo ext4      175M  1.6M  160M   1% /reports<br><span class="hljs-comment"># 扩展逻辑卷</span><br>lvextend -L 230M /dev/mapper/myvol-vo<br><span class="hljs-comment"># 应用扩展(ext4格式),后面跟随逻辑卷的路径</span><br>resize2fs /dev/mapper/myvol-vo<br><span class="hljs-comment"># 如果是xfs格式</span><br><span class="hljs-comment"># xfs_growfs /reports</span><br><span class="hljs-comment"># xfs</span><br><span class="hljs-built_in">df</span> -hT |grep vo<br>/dev/mapper/testvg-vo xfs       195M   12M  184M   6% /mnt/vo<br>lvextend -L 300M /dev/mapper/testvg-vo<br><span class="hljs-comment"># xfs后面跟随挂载点路径</span><br>xfs_growfs /mnt/vo<br></code></pre></td></tr></table></figure><blockquote><p><em>注意：</em><code>*lvextend -L 230M /dev/mapper/myvol-vo*</code><em>和</em><code>*resize2fs /dev/mapper/myvol-vo*</code><em>可以合并为一步</em><code>*lvextend -L 230M -r /dev/mapper/myvol-vo*</code></p></blockquote><h2 id="添加交换分区"><a href="#添加交换分区" class="headerlink" title="添加交换分区"></a>添加交换分区</h2><p>向您的系统添加一个额外的交换分区 756MiB 。交换分区应在系统启动时自动挂载。不要删除或以任何方式改动系统上的任何现有交换分区。</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs autoit"><span class="hljs-meta"># 做题要先lsblk查看块设备，能在同个块上做的就在同块上做，保留完整的块做后面的题</span><br><span class="hljs-meta"># 查看块设备，找到符合大小的块设备</span><br>lsblk<br>fdisk /dev/vdb<br><span class="hljs-meta"># 新建分区</span><br>n<br><span class="hljs-meta"># 划分分区大小</span><br>Partition <span class="hljs-built_in">number</span> (<span class="hljs-number">3</span>,<span class="hljs-number">4</span>, <span class="hljs-literal">default</span> <span class="hljs-number">3</span>):<br>First sector (<span class="hljs-number">2095106</span><span class="hljs-number">-8388607</span>, <span class="hljs-literal">default</span> <span class="hljs-number">2097152</span>):<br>Last sector, +sectors <span class="hljs-literal">or</span> +size&#123;K,M,G,T,P&#125; (<span class="hljs-number">2097152</span><span class="hljs-number">-8388607</span>, <span class="hljs-literal">default</span> <span class="hljs-number">8388607</span>): +<span class="hljs-number">756</span>M<br><span class="hljs-meta"># 转化分区</span><br>t<br><span class="hljs-meta"># 选择分区3</span><br>Partition <span class="hljs-built_in">number</span> (<span class="hljs-number">1</span><span class="hljs-number">-3</span>, <span class="hljs-literal">default</span> <span class="hljs-number">3</span>): <span class="hljs-number">3</span><br><span class="hljs-meta"># 选择swap(82  Linux swap / So)</span><br><span class="hljs-built_in">Hex</span> code (type L <span class="hljs-keyword">to</span> list all codes): <span class="hljs-number">82</span><br><span class="hljs-meta"># 保存</span><br>w<br>partprobe /dev/vdb<br><span class="hljs-meta"># 格式化分区</span><br>mkswap /dev/vdb3<br><span class="hljs-meta"># 编辑永久挂载</span><br>vim /etc/fstab<br>/dev/vdb3 none swap defaults <span class="hljs-number">0</span> <span class="hljs-number">0</span><br><span class="hljs-meta"># 刷新fstab挂载</span><br>swapon -a<br>swapon -s<br></code></pre></td></tr></table></figure><h2 id="创建逻辑卷"><a href="#创建逻辑卷" class="headerlink" title="创建逻辑卷"></a>创建逻辑卷</h2><p>根据如下要求，创建新的逻辑卷：</p><ul><li>逻辑卷取名为 qa ，属于 qagroup 卷组，大小为 60 个扩展块</li><li>qagroup 卷组中逻辑卷的扩展块大小应当为 16 MiB</li><li>使用 ext3 文件系统格式化新逻辑卷。该逻辑卷应在系统启动时自动挂载到 &#x2F;mnt&#x2F;qa 下</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs bash">fdisk /dev/vdb<br><span class="hljs-comment"># 新建分区</span><br>n<br><span class="hljs-comment"># 划分分区大小</span><br>Selected partition 4<br>First sector (2095106-8388607, default 3645440):<br>Last sector, +sectors or +size&#123;K,M,G,T,P&#125; (3645440-8388607, default 8388607): +1200M<br><span class="hljs-comment"># 转化分区</span><br>t<br><span class="hljs-comment"># 选择分区3</span><br>Partition number (1-3, default 3): 3<br><span class="hljs-comment"># 选择LVM(Linux LVM)</span><br>Hex code (<span class="hljs-built_in">type</span> L to list all codes): 8e<br><span class="hljs-comment"># 保存</span><br>w<br>partprobe /dev/vdb<br><span class="hljs-comment"># 创建物理卷</span><br>pvcreate /dev/vdb4<br><span class="hljs-comment"># 创建卷组</span><br>vgcreate -s 16 qagroup /dev/vdb4<br><span class="hljs-comment"># 创建逻辑卷</span><br>lvcreate -l 60 -n qa qagroup<br><span class="hljs-comment"># 格式化exe3</span><br>mkfs.ext3 /dev/qagroup/qa<br><span class="hljs-comment"># 创建挂载目录</span><br><span class="hljs-built_in">mkdir</span> /mnt/qa<br><span class="hljs-comment"># 配置永久挂载点</span><br>vim /etc/fstab<br>/dev/qagroup/qa /mnt/qa  ext3 defaults 0 0<br><span class="hljs-comment"># 刷新fstab</span><br>mount -a<br></code></pre></td></tr></table></figure><h2 id="创建-VDO-卷"><a href="#创建-VDO-卷" class="headerlink" title="创建 VDO 卷"></a>创建 VDO 卷</h2><p>根据如下要求，创建新的 VDO 卷：</p><ul><li>使用未分区的磁盘</li><li>该卷的名称为 vdough</li><li>该卷的逻辑大小为 50G</li><li>该卷使用 xfs 文件系统格式化</li><li>该卷（在系统启动时）挂载到 &#x2F;vbread 下</li></ul><figure class="highlight dsconfig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs dsconfig"><span class="hljs-comment"># 搜索vod的包</span><br><span class="hljs-string">yum</span> <span class="hljs-string">list</span> *<span class="hljs-string">vdo</span>*<br><span class="hljs-comment"># 在找到的软件包中安装这2个包名</span><br><span class="hljs-string">yum</span> -<span class="hljs-string">y</span> <span class="hljs-string">install</span> <span class="hljs-string">kmod-kvdo</span>.<span class="hljs-string">x86_64</span>  <span class="hljs-string">vdo</span>.<span class="hljs-string">x86_64</span><br><span class="hljs-comment"># 查看是否有服务了</span><br><span class="hljs-string">systemctl</span> <span class="hljs-built_in">list-unit-files</span> |<span class="hljs-string">grep</span> <span class="hljs-string">vod</span><br><span class="hljs-comment"># 查看服务状态</span><br><span class="hljs-string">systemctl</span> <span class="hljs-string">status</span> <span class="hljs-string">vdo</span><br><span class="hljs-comment"># 启动服务</span><br><span class="hljs-string">systemctl</span> <span class="hljs-string">start</span> <span class="hljs-string">vdo</span><br><span class="hljs-comment"># 利用帮助找选项</span><br><span class="hljs-string">vdo</span> <span class="hljs-string">create</span> <span class="hljs-built_in">--help</span> |<span class="hljs-string">grep</span> <span class="hljs-string">Size</span><br><span class="hljs-comment"># 根据题目创建vdo</span><br><span class="hljs-string">vdo</span> <span class="hljs-string">create</span> <span class="hljs-built_in">--name=vdough</span> <span class="hljs-built_in">--device=/dev/vdc</span> <span class="hljs-built_in">--vdoLogicalSize=50G</span><br><span class="hljs-comment"># 快速格式化xfs</span><br><span class="hljs-string">mkfs</span>.<span class="hljs-string">xfs</span> -<span class="hljs-string">K</span> /<span class="hljs-string">dev</span>/<span class="hljs-string">mapper</span>/<span class="hljs-string">vdough</span><br><span class="hljs-comment"># 创建挂载目录</span><br><span class="hljs-string">mkdir</span> /<span class="hljs-string">vbread</span><br><span class="hljs-comment"># 配置永久挂载文件</span><br><span class="hljs-string">vim</span> /<span class="hljs-string">etc</span>/<span class="hljs-string">fstab</span><br><span class="hljs-comment"># 如果不配置_netdev或写错了，系统会启动不起来，并进入emergency模式</span><br>/<span class="hljs-string">dev</span>/<span class="hljs-string">mapper</span>/<span class="hljs-string">vdough</span> /<span class="hljs-string">vbread</span>  <span class="hljs-string">xfs</span>  <span class="hljs-string">defaults</span>,<span class="hljs-string">_netdev</span>  <span class="hljs-string">0</span> <span class="hljs-string">0</span><br><span class="hljs-comment"># 刷新fstab</span><br><span class="hljs-string">mount</span> -<span class="hljs-string">a</span><br><span class="hljs-comment"># 查看</span><br><span class="hljs-string">df</span> -<span class="hljs-string">hT</span><br></code></pre></td></tr></table></figure><blockquote><p><em>利用帮助:</em> <code>*man vdo |grep create*</code> <em>和</em><code>*man vdo |grep defaults*</code></p></blockquote><h2 id="配置系统调优"><a href="#配置系统调优" class="headerlink" title="配置系统调优"></a>配置系统调优</h2><p>为您的系统选择建议的 tuned 配置集并将它设为默认设置。</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-meta"># 查看系统推荐的配置</span><br>tuned-adm recommend<br><span class="hljs-keyword">virtual</span>-guest<br><span class="hljs-meta"># 查看目前使用的配置</span><br>tuned-adm active<br>Current active profile: throughput-performance<br><span class="hljs-meta"># 设置推荐的配置</span><br>tuned-adm profile <span class="hljs-keyword">virtual</span>-guest<br><span class="hljs-meta"># 验证修改后的配置</span><br>tuned-adm active<br>Current active profile: <span class="hljs-keyword">virtual</span>-guest<br></code></pre></td></tr></table></figure><h2 id="删除逻辑卷"><a href="#删除逻辑卷" class="headerlink" title="删除逻辑卷"></a>删除逻辑卷</h2><ol><li>卸载文件系统，并删除&#x2F;etc&#x2F;fstab中的记录</li></ol><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">unmount</span> /dev/vg0/<span class="hljs-number">1</span>v01<br></code></pre></td></tr></table></figure><ol><li>删除逻辑卷</li></ol><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">lvremove</span> /dev/vg0/<span class="hljs-number">1</span>v01<br></code></pre></td></tr></table></figure><ol><li>删除卷组</li></ol><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">vgremove v<span class="hljs-name">g0</span><br></code></pre></td></tr></table></figure><ol><li>删除物理卷</li></ol><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">pvremove <span class="hljs-regexp">/dev/</span>sdb1 <span class="hljs-regexp">/dev/</span>db2<br></code></pre></td></tr></table></figure><h2 id="查找拷贝"><a href="#查找拷贝" class="headerlink" title="查找拷贝"></a>查找拷贝</h2><p>在&#x2F;usr&#x2F;bin 目录下创建一个 repwis 脚本，查找&#x2F;usr 目录大小范围在 10–50K 之间并且组 id 不为 root 的文件且拥有 sgid 的文件，把查到的文件结果拷贝到&#x2F;root&#x2F;myfiles文件夹内。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#/bin/bash</span><br><span class="hljs-keyword">if</span> [ ! -d /root/myfiles ]; <span class="hljs-keyword">then</span><br><span class="hljs-built_in">mkdir</span> /root/myfiles<br><span class="hljs-keyword">fi</span><br>find /usr -<span class="hljs-built_in">type</span> f -a \( -size +10k -size -50k \) -a \( ! -group root \) -a \( -perm /2000 \) -<span class="hljs-built_in">exec</span> <span class="hljs-built_in">cp</span> -a &#123;&#125; /root/myfiles \;<br></code></pre></td></tr></table></figure><h2 id="欢迎语"><a href="#欢迎语" class="headerlink" title="欢迎语"></a>欢迎语</h2><p>登录到普通用户后提示一句欢迎语’hello word !’或者用户在登陆前显示欢迎语提示。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 配置登入后的欢迎语（登入系统输入账号后）</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;hello word !&#x27;</span> &gt;&gt; /etc/motd<br><span class="hljs-comment"># 配置登入前的欢迎语（登入系统输入账号前）</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;hello word !&#x27;</span> &gt;&gt; /etc/issue<br></code></pre></td></tr></table></figure><h2 id="查找文件-1"><a href="#查找文件-1" class="headerlink" title="查找文件"></a>查找文件</h2><p>在&#x2F;usr&#x2F;bin 目录下创建一个 repwis 脚本，查找&#x2F;usr&#x2F;目录下小于 10M 并且组 id 不为 root 的文 件，把查找到的文件放在&#x2F;root&#x2F;myfiles 文件夹内</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">find /usr -<span class="hljs-built_in">type</span> f -a  \( -size -10M \) -a \( ! -group root \)  -<span class="hljs-built_in">exec</span> <span class="hljs-built_in">cp</span> -a &#123;&#125; /root/myfiles \;<br></code></pre></td></tr></table></figure><h2 id="查找文件-2"><a href="#查找文件-2" class="headerlink" title="查找文件"></a>查找文件</h2><p>在&#x2F;usr&#x2F;bin 目录下创建一个 repwis 脚本，查找&#x2F;usr&#x2F; 具有粘贴位是 4（u 的位置上有 s 位）， 其他 ugo 是什么权限， 不管。且组 id 不为 root 的文件，把查找到的文件放在&#x2F;root&#x2F;myfiles文件夹内</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">find /usr -<span class="hljs-built_in">type</span> f -a \( -perm /4000 \) -a \( ! -group root  \) -<span class="hljs-built_in">exec</span> <span class="hljs-built_in">cp</span> -a &#123;&#125; /root/myfiles \;<br></code></pre></td></tr></table></figure><h2 id="权限设置"><a href="#权限设置" class="headerlink" title="权限设置"></a>权限设置</h2><p>对 diff 用户设置默认权限：</p><ul><li>用户新创建的文件权限都为：444 r — r — r —</li><li>同一个用户下新创建的目录权限为：554 dr-xr-xr —</li></ul><p>如果既要求了文件的默认权限 xxx，也要求了目录的默认权限 yyy。<br>则 umask 的值以目录来算，即 umask&#x3D;777-yyy，不用管文件。<br>比如目录的默认权限为 554，文件的默认权限为 444。<br>则 umask 可以设置为 777–554&#x3D;223，不用管文件的默认权限了。<br>如果题目只要求设置文件的默认权限 xxx，并没有说目录的默认权限是什么。<br>则 umask&#x3D;666-xxx<br>算出来 umask 值为 zzz 之后。<br>用户 vim ~用户&#x2F;.bash_profile，添加 umask zzz 这里 zzz 是你算出来的数字。</p><h2 id="打印输出"><a href="#打印输出" class="headerlink" title="打印输出"></a>打印输出</h2><p>在节点上使用 bob 用户写一个脚本 rhcsa，然后执行 rhcsa,执行后输出<strong>it is ok</strong></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-comment"># 查看用户的环境变量</span><br>echo <span class="hljs-variable">$PATH</span><br><span class="hljs-regexp">/home/</span>bob<span class="hljs-regexp">/.local/</span>bin:<span class="hljs-regexp">/home/</span>bob<span class="hljs-regexp">/bin:/u</span>sr<span class="hljs-regexp">/local/</span>bin:<span class="hljs-regexp">/usr/</span>bin:<span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/sbin:/u</span>sr/sbin<br>mkdir <span class="hljs-regexp">/home/</span>bob/bin<br><span class="hljs-comment"># 编辑脚本</span><br>vim <span class="hljs-regexp">/home/</span>bob<span class="hljs-regexp">/bin/</span>rhcsa<br><span class="hljs-comment">#/bin/bash</span><br>echo <span class="hljs-string">&quot;it is ok&quot;</span><br><span class="hljs-comment"># 设置可执行权限</span><br>chmod +x <span class="hljs-regexp">/home/</span>bob<span class="hljs-regexp">/bin/</span>rhcsa<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>考试</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>podman</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Bug报告写作指南</title>
    <link href="/blog/2021/10/Bug%E6%8A%A5%E5%91%8A%E5%86%99%E4%BD%9C%E6%8C%87%E5%8D%97.html"/>
    <url>/blog/2021/10/Bug%E6%8A%A5%E5%91%8A%E5%86%99%E4%BD%9C%E6%8C%87%E5%8D%97.html</url>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>此翻译参考了网络中现有的中文翻译，在此基础上做了些语义调整，同时在原先中文的基础上增加了部分新增的英文内容。</p><p>原文使用的是 Bugzilla 这个 Bug 追踪工具，你可以将其代替成你所使用的缺陷管理软件或系统。</p><h2 id="为什么你要读这份指南"><a href="#为什么你要读这份指南" class="headerlink" title="为什么你要读这份指南"></a>为什么你要读这份指南</h2><p>简单地说，如果你报告 Bug 越有效, 工程师完全修复它的可能性就越大。<br>这份 Bug 写作指南是针对新手在书写有效的 Bug 报告方面进行指导的常规指南，并非每个建议都正好适用于你的软件项目。</p><h2 id="如何写一份有用的-Bug-报告"><a href="#如何写一份有用的-Bug-报告" class="headerlink" title="如何写一份有用的 Bug 报告"></a>如何写一份有用的 Bug 报告</h2><p>有用的 Bug 报告是用于正确修复 Bug 的。因此一份有用的 Bug 报告通常的有两个特征：</p><ol><li><strong>可复现</strong>：如果工程师不能复现或最终证明这一 Bug 存在,工程师或许会将它标记为 “我这没问题（WORKSFORME）”或 ”无效反馈（INVALID ）“，并且继续进行下一个 Bug 的修复工作。任何你能提供的详尽描述将为工程师修复 Bug 提供帮助。</li><li><strong>详细精确</strong>：如果工程师能越早隔离、定位问题，就越可能方便地修复。（如果程序员或测试人员不得不像破译密码一般去寻找跟踪分析 Bug，那么他们将花费比修复或测试问题更多的时间去诅咒 Bug 提交人。）</li></ol><p>让我们举一个例子：你正在测试的应用程序是一个网络浏览器，在访问 foo.com 网站时崩溃了，因此你想写一个 Bug 报告:</p><ul><li><strong>糟糕的 Bug 报告</strong>：“我的浏览器崩溃了。我正在访问 foo.com。我和比尔-盖茨打高尔夫，所以你最好解决这个问题，否则我就向他报告你。顺便说一下,你的 “返回 “图标看起来像一只被压扁的啮齿动物。丑陋极了。还有我的祖母的主页看上去外观也不正确，或者，它们全被搞乱了。祝好运。”</li><li><strong>有用的 Bug 报告</strong>：“我每次进入<a href="http://www.foo.com,在windows/">www.foo.com，在Windows</a> 2000系统上使用2002-02-25的版本时都会崩溃。我还重启了Linux，并使用2002-02-24的Linux版本再现了这个问题。我发现每次崩溃都发生在绘制这个页面位于上端的 Foo 横幅的时候。我分析了页面，发现除非你删除 ” border &#x3D;0″属性，否则下列图片链接将导致应用程序崩溃 ：<IMG SRC="http://www.foo.com/images/topics/topicfoos.gif" width="34" height="44" border="0" alt="News">”</li></ul><h2 id="如何在-Bugzilla-中输入你有用的-Bug-报告"><a href="#如何在-Bugzilla-中输入你有用的-Bug-报告" class="headerlink" title="如何在 Bugzilla 中输入你有用的 Bug 报告"></a>如何在 Bugzilla 中输入你有用的 Bug 报告</h2><p>在你输入你发现的 Bug 前，应使用 Bugzilla 查询页检查是否你发现的是已知并被报告的 Bug。（如果你发现的 Bug 同第 37 条已经知道的结果相同，你报告的话，就可能骚扰工程师，从而影响工程师修复 Bug 的效率。）</p><p>下一步,确认你发现的 Bug 是在最新的版本中所发生的。（工程师更倾向于对那些他们正在编写的代码中的严重问题感兴趣，而不是对以前那些废弃代码中数以百计的 Bug 进行修复。）</p><p>如果你已经在当前版本中发现了一个新的 Bug，请在 Bugzilla 中报告：</p><ol><li>从你的 Bugzilla 主页中,选择“Enter a new bug”。</li><li>选择你发现 Bug 的产品。</li><li>输入你的电子邮件地址、密码，然后按“Login”按钮。（如果你遗忘或还没有得到密码,让密码正文框空白，并且按 ” E-mail me a password “按钮，不久你将收到包含你的密码的电子邮件。）</li></ol><p>现在，填写那张出现的表格。以下说明表格中的所有含义：</p><h3 id="你在哪儿发现了-Bug？"><a href="#你在哪儿发现了-Bug？" class="headerlink" title="你在哪儿发现了 Bug？"></a>你在哪儿发现了 Bug？</h3><ul><li><strong>产品：在哪一个产品中你发现了 Bug？</strong><br>你在上一页已选择，所以你不能在这编辑</li><li><strong>版本：在产品的哪一个版本中你找到了 Bug？</strong><br>（如果有的话）</li><li><strong>产品单元：在产品的哪一个单元中存在 Bug？</strong><br>Bugzilla 在你输入一个 Bug 时，要求你必须选择一个产品单元。（如果你无法确定所列产品单元的意思，单击产品单元链接，那将链接到对每个产品单元的详细描述，这会帮助你作出最好选择。）</li><li><strong>OS：在哪一个操作系统（OS）中你找到了这个 Bug？（例如 Linux、Windows 2000、Mac OS 9。）</strong><br>如果你知道这个 Bug 会发生在所有 OS 中，请选择“All”，否则请选择相应的你发现 Bug 的 OS，如果列表中没有出现你的 OS，请选择“Other”。</li></ul><h3 id="这个-Bug-有多重要？"><a href="#这个-Bug-有多重要？" class="headerlink" title="这个 Bug 有多重要？"></a>这个 Bug 有多重要？</h3><ul><li><strong>严重性：这个 Bug 的破坏性有多大？</strong><br>这项值默认为“普通（normal）”。（要为一个特定的 Bug 界定最适当的严重性，单击严重性链接，你会看到每个严重程度的描述。）</li></ul><h3 id="谁将跟踪解决-Bug？"><a href="#谁将跟踪解决-Bug？" class="headerlink" title="谁将跟踪解决 Bug？"></a>谁将跟踪解决 Bug？</h3><ul><li><strong>指定给：哪一个工程师将负责修复这个 Bug？</strong><br>在你提交 Bug 报告后，Bugzilla 将自动把 Bug 分配给默认工程师；填写正文框将允许你用手工方式把它分配给其他工程师。（要查看每个产品单元的默认工程师列表,请单击产品单元链接。）</li><li><strong>Cc：还有哪些人将收到这个 Bug 修复更新的电子邮件?</strong><br>列出其他需要通过电子邮件收到这个 Bug 修复更新的人的完整的电子邮件地址。您可以输入任意多的电子邮件地址，用空格或逗号隔开，只要这些人有Bugzilla帐户。</li></ul><h3 id="关于这个Bug你还能告诉工程师什么？"><a href="#关于这个Bug你还能告诉工程师什么？" class="headerlink" title="关于这个Bug你还能告诉工程师什么？"></a>关于这个Bug你还能告诉工程师什么？</h3><ul><li><strong>摘要：你如何用大约60个或更少的字符来描述这个错误？</strong><br>一个好的摘要应该能快速而独特地识别一个错误报告。否则，工程师无法通过摘要来有意义地识别你的bug，而且在浏览10页的bug列表时，往往不会注意到你的bug报告。</li></ul><p>一个有用的摘要可能是 “PCMCIA安装在Tosh Tecra 780DVD w&#x2F; 3c589C上失败”。”软件失败 “或 “安装问题 “将是不好的摘要的例子。</p><ul><li><strong>描述：</strong></li></ul><p>请在这个领域提供一个详细的问题报告。你的错误的接收者很可能希望得到以下信息：<br><strong>概括描述：</strong>更详细地扩展总结。<br>在NSGetFactory中拖动选择任何页面都会使Mac的构建崩溃<br><strong>Bug复现的步骤</strong>：最小化的、易于操作的、会触发错误的步骤。包括任何特殊的设置步骤。</p><ol><li>查看任何网页。(我使用了默认的样本页。 resource:&#x2F;res&#x2F;samples&#x2F;test0.html)</li><li>拖动选择该页面。(具体来说，在按住鼠标按钮的同时，将鼠标指针从浏览器内容区域的任何一点向下拖动到浏览器内容区域的底部)</li></ol><p><strong>目前的结果</strong>：执行上述步骤后，应用程序做了什么。<br>该应用程序崩溃了。下面是MacsBug的堆栈爬行。<br><strong>期望的结果</strong>：如果不存在这个错误，应用程序应该做什么。</p><p>窗口应向下滚动。滚动的内容应该被选中。<br>(或者，至少，应用程序不应该崩溃）。<br><strong>时间及硬件平台</strong>：第一次出现这个Bug的时间及硬件平台。<br>在Mac OS 9.0上构建2002-03-15<br><strong>其它环境及硬件平台</strong>：Bug是否出现在其他硬件平台或浏览器上。</p><ul><li>也出现在<br>Mozilla (2002-03-15 build on Windows NT 4.0)</li><li>不出现在<br>Mozilla (2002-03-15 build on Red Hat Linux; feature not supported)<br>Internet Explorer 5.0 (在Windows NT 4.0上运行的版本)<br>Netscape Communicator 4.5 (在Mac OS 9.0上发布)</li></ul><p><strong>其它信息</strong>：任何其他调试信息。对应崩溃的错误：</p><ul><li><strong>Win32</strong>: 如果你收到华生医生的错误( Dr. Watson error), 请注意崩溃的类型，以及应用程序崩溃的模块。(例如：apprunner.exe中的访问违规)</li><li><strong>Mac OS</strong>: 如果你运行的是MacsBug，请提供一个how和一个sc的结果:</li></ul><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs maxima">*** MACSBUG STACK CRAWL OF CRASH (Mac OS)<br>Calling chain using A6/R1 links <br>Back chain  ISA  Caller <br><span class="hljs-number">00000000</span>    PPC  <span class="hljs-number">0BA85E74</span>   <br><span class="hljs-number">03AEFD80</span>    PPC  <span class="hljs-number">0B742248</span>   <br><span class="hljs-number">03AEFD30</span>    PPC  <span class="hljs-number">0B50FDDC</span>  NSGetFactory+<span class="hljs-number">027FC</span><br>PowerPC unmapped memory exception <span class="hljs-built_in">at</span> <span class="hljs-number">0B512BD0</span> NSGetFactory+<span class="hljs-number">055F0</span><br></code></pre></td></tr></table></figure><p>你已经完成了一篇不错的bug报告！</p><p>在确认你的输入无误后，请按“t提交（Commit）”按钮，现在你的Bug报告已经存入Bugzilla数据库。</p><h2 id="关于写好-Bug-报告的更多信息"><a href="#关于写好-Bug-报告的更多信息" class="headerlink" title="关于写好 Bug 报告的更多信息"></a>关于写好 Bug 报告的更多信息</h2><ol><li><strong>有用的Bug报告的一般提示</strong></li></ol><p><strong>使用一个明确的结构，这样你的错误报告就很容易被浏览。</strong>错误报告的用户通常需要立即访问您的错误的特定部分。如果您安装的Bugzilla支持Bugzilla帮助器，请使用它。</p><p><strong>避免可爱，如果它需要清晰度</strong>。没有人会在凌晨3点时因为你那有趣的错误标题而发笑，因为他们不记得如何找到你的错误。</p><p><strong>每个报告只有一个bug</strong>。完全不同的人通常会修复、验证和优先处理不同的bug。如果你在一份报告中混入了大量的bug，正确的人可能不会及时发现你的bug，或者根本不会发现。某些bug也比其他的更重要。当一个错误报告包含四个不同的问题时，不可能对其进行优先排序，这些问题的重要性各不相同。</p><p><strong>没有一个错误是不值得报告的</strong>。除非你正在阅读源代码，否则你无法看到实际的软件错误，如空指针 – 你会看到它们的可见表现，如应用程序最终崩溃时的故障。严重的软件问题可以通过表面上微不足道的方式表现出来。无论如何要把它们归档。</p><ol start="2"><li><strong>如何以及为什么要写好Bug总结？</strong></li></ol><p><strong>你想给错误接收者留下一个好的第一印象。</strong>就像《纽约时报》的标题引导读者从几十种选择中找到相关的文章一样，你的bug摘要是否会暗示你的bug报告值得从几十种或几百种选择中阅读？</p><p>相反，像安装问题这样的模糊的bug摘要会迫使审查安装bug的人浪费时间打开你的bug来确定它是否重要。</p><p><strong>你的bug经常会被它的摘要所搜索到</strong>。就像你用Google通过直觉搜索关键词来找到网页一样，其他人也会找到你的bug。描述性的bug摘要自然是富含关键词的，而且更容易找到。</p><p>例如，如果你搜索 “列表”、”终端 “或 “路径”，你会发现一个题为 “将图标从列表视图拖到gnome终端（gnome-terminal）不会粘贴路径 “的错误。这些搜索关键词不会发现一个题为 “拖动图标不能粘贴 “的错误。</p><p>问问自己，”有人会从这个摘要中理解我的错误吗？” 如果是这样，你已经写了一个很好的摘要。</p><p><strong>不要写像这样的标题:</strong></p><ol><li>“无法安装” - 为什么无法安装？当你尝试安装时会发生什么？</li><li>“严重的性能问题” - ……当你做什么的时候会出现这些问题？</li><li>“返回按钮不生效” - 生效过吗？还是根本没有？</li></ol><p><strong>好的错误标题：</strong></p><ol><li>“如果存在Mozilla M18包，1.0升级安装失败” - 解释了问题和背景。</li><li>“如果在Red Hat 6.2（RPM 3）系统上启动RPM 4安装程序会崩溃” - 解释了发生的情况和背景。</li></ol><p>（完）</p><p><strong>参考</strong></p><ul><li><a href="http://wallace.westminster.lib.co.us/bugzilla-custom/default-ticket-writing.html">Bug Writing Guidelines</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>翻译转载</category>
      
    </categories>
    
    
    <tags>
      
      <tag>软件测试</tag>
      
      <tag>翻译</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>用户登入测试用例设计</title>
    <link href="/blog/2021/10/%E7%94%A8%E6%88%B7%E7%99%BB%E5%85%A5%E6%B5%8B%E8%AF%95%E7%94%A8%E4%BE%8B%E8%AE%BE%E8%AE%A1.html"/>
    <url>/blog/2021/10/%E7%94%A8%E6%88%B7%E7%99%BB%E5%85%A5%E6%B5%8B%E8%AF%95%E7%94%A8%E4%BE%8B%E8%AE%BE%E8%AE%A1.html</url>
    
    <content type="html"><![CDATA[<h2 id="划分维度"><a href="#划分维度" class="headerlink" title="划分维度"></a>划分维度</h2><p>软件测试根据维度划分为两大需求：</p><ol><li>显式功能性需求</li><li>隐式功能性需求</li></ol><blockquote><p>显式功能性需求（Functional requirement）指的是软件本身需要实现的具体功能，对应的是隐式功能性需求(Non-functional requirement）</p></blockquote><p>隐式功能性需求主要涉三大方面:</p><ol><li>安全性</li><li>性能</li><li>兼容性</li></ol><p>因此，设计测试用例的时候可以根据上述划分来设计。</p><h2 id="显式功能性需求测试用例设计"><a href="#显式功能性需求测试用例设计" class="headerlink" title="显式功能性需求测试用例设计"></a>显式功能性需求测试用例设计</h2><ul><li>输入已注册的用户名和正确的密码，验证是否登录成功</li><li>输入已注册的用户名和不正确的密码，验证是否登录失败，并且提示信息正确</li><li>输入未注册的用户名和任意密码，验证是否登录失败，并且提示信息正确</li><li>用户名和密码两者都为空，验证是否登录失败，并且提示信息正确</li><li>用户名和密码两者之一为空，验证是否登录失败，并且提示信息正确</li><li>如果登录功能启用了验证码功能，在用户名和密码正确的前提下，输入正确的验证码，验证是否登录成功</li><li>如果登录功能启用了验证码功能，在用户名和密码正确的前提下，输入错误的验证码，验证是否登录失败，并且提示信息正确</li><li>用户名和密码是否大小写敏感</li><li>页面上的密码框是否加密显示</li><li>后台系统创建的用户第一次登录成功时，是否提示修改密码</li><li>忘记用户名和忘记密码的功能是否可用</li><li>前端页面是否根据设计要求限制用户名和密码长度</li><li>如果登录功能需要验证码，点击验证码图片是否可以更换验证码，更换后的验证码是否可用</li><li>刷新页面是否会刷新验证码</li><li>如果验证码具有时效性，需要分别验证时效内和时效外验证码的有效性</li><li>用户登录成功但是会话超时后，继续操作是否会重定向到用户登录界面</li><li>不同级别的用户，比如管理员用户和普通用户，登录系统后的权限是否正确</li><li>页面默认焦点是否定位在用户名的输入框中</li><li>快捷键 Tab 和 Enter 等，是否可以正常使用</li><li>网络延迟或者弱网或者切换网络或者断网时正常登录是否正常</li><li>是否支持第三方登录</li><li>用户名密码是否支持特殊字符和中文等</li><li>登录用户限制，比如同时支持10个用户登录，同时9个或者11个用户登录是否正常或者提示信息正确</li><li>未激活的用户是否可以登录</li><li>被停用的用户是否可以登录</li><li>登录的操作日志记录是否准确</li><li>登录有实效性是否控制正确</li><li>为空和输入空字符串时的校验是否一致</li><li>使用中文键盘输入字母时和使用英文键盘输入字母时传给后端的字符长度是否一致</li><li>输入账号密码时对键盘格式是否有要求比如数字键盘</li><li>密码一栏是否需要设置明暗码切换按钮</li><li>输入账号密码格式不规范时是否将按钮设置为不可点击</li><li>输入栏是否设置快速删除按钮</li><li>是否用到缓存</li><li>用户名和密码是否对空格敏感</li><li>密码是否有明文和暗文显示两种模式</li><li>更改密码后是否还能用之前的密码登录</li><li>一个用户是否具备多种登录方式(用户名，手机号，邮箱…)</li></ul><h2 id="隐式功能性需求测试用例设计（三大方面）"><a href="#隐式功能性需求测试用例设计（三大方面）" class="headerlink" title="隐式功能性需求测试用例设计（三大方面）"></a>隐式功能性需求测试用例设计（三大方面）</h2><h3 id="安全性测试用例设计"><a href="#安全性测试用例设计" class="headerlink" title="安全性测试用例设计"></a>安全性测试用例设计</h3><ul><li>用户密码后台存储是否加密</li><li>用户密码在网络传输过程中是否加密</li><li>密码是否具有有效期，密码有效期到期后，是否提示需要修改密码</li><li>不登录的情况下，在浏览器中直接输入登录后的 URL 地址，验证是否会重新定向到用户登录界面</li><li>密码输入框是否不支持复制和粘贴</li><li>密码输入框内输入的密码是否都可以在页面源码模式下被查看</li><li>用户名和密码的输入框中分别输入典型的“SQL 注入攻击”字符串，验证系统的返回页面</li><li>用户名和密码的输入框中分别输入典型的“XSS 跨站脚本攻击”字符串，验证系统行为是否被篡改</li><li>连续多次登录失败情况下，系统是否会阻止后续的尝试以应对暴力破解</li><li>同一用户在同一终端的多种浏览器上登录，验证登录功能的互斥性是否符合设计预期</li><li>同一用户先后在多台终端的浏览器上登录，验证登录是否具有互斥性</li><li>是否可以使用登录的API发送登录请求，并绕开验证码校验</li><li>是否可以用抓包工具抓到的请求包直接登录</li><li>截取到的token等信息，是否可以在其他终端上直接使用，绕开登录，token过期时间</li><li>是否可记住密码，记住的密码保存是否加密</li><li>记住密码是否有有效期，有有效期，过期之后是否会清空密码</li><li>GDPR相关的测试，用户登录过程中log中是否有个人信息明文打印</li><li>密码强弱性校验</li><li>登录成功后的session时效设置</li><li>安全性方面异地登录校验、更换设备登录校验、登录信息异常是否考虑账号冻结停用</li></ul><h3 id="性能压力测试用例设计"><a href="#性能压力测试用例设计" class="headerlink" title="性能压力测试用例设计"></a>性能压力测试用例设计</h3><ul><li>单用户登录的响应时间是否小于 3 秒</li><li>单用户登录时，后台请求数量是否过多</li><li>高并发场景下用户登录的响应时间是否小于 5 秒</li><li>高并发场景下服务端的监控指标是否符合预期</li><li>高集合点并发场景下，是否存在资源死锁和不合理的资源等待</li><li>长时间大量用户连续登录和登出，服务器端是否存在内存泄漏</li></ul><h3 id="兼容性测试用例设计"><a href="#兼容性测试用例设计" class="headerlink" title="兼容性测试用例设计"></a>兼容性测试用例设计</h3><ul><li>不同浏览器下，验证登录页面的显示以及功能正确性；</li><li>相同浏览器的不同版本下，验证登录页面的显示以及功能正确性；</li><li>不同移动设备终端的不同浏览器下，验证登录页面的显示以及功能正确性；</li><li>不同分辨率的界面下，验证登录页面的显示以及功能正确性。</li></ul><p>当然，除了上面罗列的测试用例外，还会存在一些遗漏的测试点没有覆盖到。大多数情况下，是不可能进行穷尽测试的。一般采用基于风险驱动的模式，有所侧重地选择测试范围和设计测试用例，以寻求缺陷风险和研发成本之间的平衡。</p><blockquote><p><strong>穷尽测试</strong>是指包含了软件输入值和前提条件所有可能组合的测试方法，完成穷尽测试的系统里应该不残留任何未知的软件缺陷。</p></blockquote><h2 id="结尾"><a href="#结尾" class="headerlink" title="结尾"></a>结尾</h2><p>每一个解决方案都是下一个问题的来源，要真正理解问题，那至少对自己的解决方案提出三个可能出错的地方。<br>                                                                             –《你的灯亮着吗》Donald C. Gaus</p><p>（本文完）</p>]]></content>
    
    
    <categories>
      
      <category>工作</category>
      
      <category>业务架构</category>
      
    </categories>
    
    
    <tags>
      
      <tag>软件测试</tag>
      
      <tag>测试用例</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>团队建设</title>
    <link href="/blog/2021/09/%E5%9B%A2%E9%98%9F%E5%BB%BA%E8%AE%BE.html"/>
    <url>/blog/2021/09/%E5%9B%A2%E9%98%9F%E5%BB%BA%E8%AE%BE.html</url>
    
    <content type="html"><![CDATA[<h2 id="团队拓扑"><a href="#团队拓扑" class="headerlink" title="团队拓扑"></a>团队拓扑</h2><p><img src="/blog/./assets/image-16795113742435328.JPG" alt="团队拓扑"></p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>管理学</category>
      
    </categories>
    
    
    <tags>
      
      <tag>管理学</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>管理者的品质</title>
    <link href="/blog/2021/05/%E7%AE%A1%E7%90%86%E8%80%85%E7%9A%84%E5%93%81%E8%B4%A8.html"/>
    <url>/blog/2021/05/%E7%AE%A1%E7%90%86%E8%80%85%E7%9A%84%E5%93%81%E8%B4%A8.html</url>
    
    <content type="html"><![CDATA[<ol><li><p>成就<br>哪怕是休息的时候，无所事事都会让我非常难以忍受<br>完成一项任务，会推动我朝下一个目标努力</p><p>应用：<br>要可以衡量自己的工作时间、工作总量以及取得的业绩<br>共同努力工作会使我感到亲密<br>对自己的奖励：不是让自己休息，而是制定更高的目标</p></li><li><p>行动<br>一旦做出决定，就必须行动<br>采取行动，检验结果，继而学习和进步</p><p>应用：<br>需要别人知道我能干的鼓励<br>领导一个陷入惰性，光说不干的团队<br>适合讨论如何率先创新和改进</p></li><li><p>适应<br>不讨厌突如其来的变化和曲折<br>认为未来是在现有的选择上发展起来的<br>甚至喜欢变化</p><p>应用：<br>适合短兵相接，不适合打持久战<br>觉得计划工作极其乏味</p></li><li><p>分析<br>擅长预先识别结构与规律<br>寻找问题的原因</p><p>应用：<br>要用逻辑证明决策的依据<br>对自己的推理能力表示认可和赞赏，为自己严谨的思维感到自豪<br>更加相信有数据的信息<br>善于在数据中发现规律<br>准确完成任务比按时完成更重要，应经常核对进度</p></li><li><p>信仰<br>  经常关注家庭、乐于助人、甚至追求灵性<br>  珍视责任和伦理<br>  金钱和名利并不完全代表成功，可以排除诱惑朝既定的目标努力<br>  恒定性让我很容易获得别人的信赖<br>  必须从事与价值观相符的工作，自己的工作必须有意义</p></li></ol><p>  应用：<br>  把自己笃信的价值与公司的价值相结合<br>  更看重提升服务质量，而不是多赚钱</p><ol start="6"><li>统率<br>  一旦形成观点，就必须与人分享<br>  一旦确立目标，就要用它来统一众人的思想，并不害怕对立<br>  直言不讳，喜欢开诚布公</li></ol><p>  应用：<br>  善于打通障碍或说服别人<br>  思想不会随大流<br>  不喜欢别人管头管脚，放手让他领导和决策<br>  如果拉帮结派、冒犯同事，要抓住证据，当头棒喝。并视情况让他将功补过<br>  不要威胁他<br>  固执己见有助于提高效率，但是要避免咄咄逼人和出口伤人</p><ol start="7"><li><p>沟通<br>  喜欢解释、描述、主持、演讲和写作<br>  喜欢故事化地捕捉别人的注意力<br>  应用：<br>  鼓励他搜集公司内部的传奇和趣事<br>  喜欢讲述自己的生活经历<br>  要安排他参加一流演讲大师的高级班培训，对于初级班会很快厌倦</p></li><li><p>竞争<br>  参加比赛不是为了取乐，而是为了取胜</p></li></ol><p>  应用：<br>  只有获胜的人，才会从公开成绩中获得激励，其他人会感觉是羞辱<br>  管理他的最好方法，就是找一个能力更强的竞争者<br>  达到目标就是胜利，未达目标就是失败<br>  安排竞赛，喜欢跟水平相似的人竞争，对低能力者不感兴趣<br>  采用竞争式的语言</p><ol start="9"><li>关联<br>  深信凡事发生必有原因，笃信人类大同<br>  你知道自己有自己的优势，但不是无所不知，所以会自信而谦卑，你感到与别人有关联，<br>  是因为别人具有你不具备的智慧</li></ol><p>  应用：<br>  善于向不同的人说明他们相互依赖，会成为公司的团队建设能手<br>  乐于帮助公司重新定义和构思使命，乐于成为大事业的一部分<br>  与他分享文章、作品和经验，彼此增加关注点</p><ol start="10"><li><p>回顾<br>在过去中寻找答案，是为了了解现在，使蓝图重现，重回初衷</p><p>应用：<br>在行动之前需要了解背景<br>在介绍他认识新同事的时候，要先告知新同事的个人背景，再谈正事<br>每次开会都要做阶段性的工作与学习回顾<br>喜欢通过案例思考能够对公司文化起作用</p></li><li><p>统筹<br>喜欢管理变数，并将其形成最佳的组合<br>总在寻找最佳配置<br>形势越是变化无常，就越能让你出神入化</p><p>应用：<br>喜欢负责，善于打造最佳团队<br>足智多谋，可以干困难的工作<br>靠相互信任的关系打造团队，拒绝他认为不诚实的人与敷衍了事的人</p></li><li><p>审慎<br>喜欢提前计划，以防不测<br>谨慎地选择朋友，并避而不谈私事<br>讨厌变数，希望计划十全十美</p><p>应用：<br>不要让他干当机立断的事，靠直觉决策会让他不安<br>让他加入好冲动的团队，会让团队深思熟虑<br>尊重他的隐私，如果他与你刻意保持距离，你也不必往心里去<br>天生善于预见危险<br>不擅长迎来送往或者拉关系<br>在交友方面是有选择的，要确定周围的人可以信赖</p></li><li><p>伯乐<br>能善于发现别人的潜能<br>与别人交往的目的是帮助他们成功<br>能够搜寻别人进步的蛛丝马迹，别人的进入如同燃料，给予你力量和满足</p><p>应用：<br>出面表扬表现优秀的同事<br>善于培养担当重任的人才<br>用伯乐的才干，用于帮助强者取得成功，而不是帮助陷入困境的弱者，对于陷入困境的<br>人，最大的帮助就是让他另辟蹊径<br>增强他催人奋进的自我意识：他们靠自己永远不会打破记录，你的鼓励和信心使他们奋起</p></li><li><p>纪律<br>建立常规、制定时间表，把长期任务分解为短期目标，然后锲而不舍地贯彻实施<br>不一定整洁有序，但是要求精确，从而建立控制感、渴求预测<br>必须了解，不是每个人都像你一样渴求预测，他们有自己的解决之道，以避免冲突</p><p>应用：<br>给他机会处理混乱的局面，天生受不了无序和混乱<br>脏乱差的地方会待不下去，从而惹恼他<br>一定要告知任务期限，喜欢提前完成<br>不要随意改变计划和工作重点，他们讨厌意外<br>他需要分清轻重缓急<br>对于制定计划和安排工作是他的强项，可以让同事在这方面咨询他<br>鼓励他针对不同的环境，建立不同的常规，他善于为提高效率建立常规</p></li><li><p>体谅<br>理解别人的选择，即使不认同、不怜悯，但是明白他们为什么要这么做<br>能听到无声的提问和需求<br>帮助别人用合适的语言来表达情感，帮助他们倾诉情感生活<br>能够让别人愿意倾诉、能把握别人的情感需求、善于换位思考</p><p>应用：<br>帮助你了解公司中某些人的想法，对别人的情绪非常敏感<br>在开始某项工作前，了解他及其他员工的情感因素，因为他认为这也是一个环节<br>他如果哭，应该给予关注，切忌反应过度，他感受别人的喜怒哀乐甚至超过当事人<br>让他知道自己的体谅是一种才干，用于帮助别人<br>问他的本能意见，而不是逻辑决策，他说不清为什么对，但又常常是对的。问：你从骨子<br>里觉得我们应该做什么？<br>容易受别人的情绪感染，所以要安排他和积极乐观的人共事，和消极的人共事会让他意志<br>消沉<br>如果员工或顾客对一项措施不解，可以让他感知他们的疑问所在</p></li><li><p>公平<br>无论社会地位如何，要平等地对待他人<br>对依靠：背景、关系和贿赂上位的行为深恶痛绝<br>不喜欢自己和别人滥用职权<br>同情弱者，论功行赏</p><p>应用：<br>在分析数据时，擅长使用群体数据，而非个人特点<br>在需要公平地执行规章时，可以让他帮忙辅助解释<br>不愿意参加头脑风暴和长期规划，喜欢完成任务</p></li><li><p>专注<br>需要一个明确的目的地，否则会对工作和生活一筹莫展<br>每年、每月、每周都在制定目标<br>本能地判断某些活动是否有助于你达成目标，无助于此的便被放弃<br>会确保每个人目不斜视，不因为“有趣”而偏离了方向<br>善于寻找最佳路径提高效率</p><p>应用：<br>喜欢定期讨论目标，并讨论实现目标取得的阶段性进步<br>对别人的情感不敏感，在实现目标的过程中，会毫不顾忌别人的情感<br>不喜欢变动无常的场面，用“新的目标”“新的标准”来定义变化会更好<br>一旦加入有严格期限的项目，就会倾注全力，直到完成<br>漫无边际的会议会使他厌烦</p></li><li><p>前瞻<br>喜欢想象未来<br>对未来的憧憬会让你精力倍增，同时振奋别人<br>人们往往期待你描述未来的种种遐想<br>人们将拥抱你带来的希望<br>善于把未来描述地惟妙惟肖</p><p>应用：<br>请他描述自己的愿景<br>给他时间去思考、描述和规划未来需要的产品和服务<br>对于未来的远见，需要一些材料辅助<br>可以让他描述公司 3 年后的发展前景<br>在做变革时，请他像员工们描述未来的美好前景</p></li><li><p>和谐<br>寻求共识，因为觉得冲突和摩擦有害无益，所以尽量避免<br>有人总想把自己的想法强加于人，这在你看来难以置信，因为比起固执己见，寻求共识和<br>支持才会使效率大增<br>只要别人的基本价值与你相符，可以修改自己的目标以求与别人保持一致</p><p>应用：<br>尽量使他远离冲突<br>确定你在哪方面赞同他的意见，与他定期回顾这些一致意见，并安排具有“和谐”主题的员<br>工和他共事<br>如果他知道别人在支持他，就会效率更高、更专注，并且更有创造性<br>不要浪费时间同他讨论有争议的问题，他不喜欢单纯的辩论，反而可以集中讨论可以采取<br>行动的实际问题<br>不要指望他对你提出不同意见，即使你的想法是馊主意，为了保持和谐，他也会对你的想<br>法点头称是<br>当别人争执不休时，他能使他们言归于好，虽未能解决争端，却可以让大家求同存异，而<br>这些共识会成为再度合作的出发点<br>他希望对自己的行动建立信心，所以应当帮他争取权威人士和专家的支持</p></li><li><p>包容<br>以“扩大圈子”为人生准则<br>希望拉人入伙，使他们感到自己是团队成员<br>不愿目睹有人站在圈外，你请他们进来，给他们温暖<br>从不妄加评判他人<br>评判可能伤及他人的感情，不到万不得已何必这样做呢<br>之所以具有包容心，不是因为你认为应当尊重差异，而是确信我们在本质上相同，一样重<br>要<br>愿意邀请别人来家里玩，很喜欢新人</p><p>应用：<br>热衷于使每个人都感到自己是团队的一员，使他编写新员工入门课，会乐于思考如何欢迎<br>新成员<br>天生善于判断谁受到冷遇<br>举办集体活动时，请他动员每个人参加<br>不喜欢针对少数人的高档产品和服务，参与为大众市场提供产品和服务</p></li><li><p>个别<br>对每个人的与众不同之处兴趣盎然<br>不能容忍一概而论或者简单归类<br>不喜欢抹杀个人特点，关注个人差异，关注每个人的风格、动机、思维方法和交际方式<br>能为朋友选择恰到好处的生日礼品<br>能够因人施教<br>有助于建立高效团队，寻找完美无缺的团队结构<br>团队的优势在于每个人都做自己擅长的事</p><p>应用：<br>加入职务选拔委员会，能准确判断每个候选人的优势和弱点<br>根据每个人的优势和弱点来安排工作，帮助公司提高效率<br>能帮助你从员工的角度想问题<br>天生善于区别对待每个员工</p></li><li><p>搜集<br>充满好奇，爱攒东西<br>积攒信息、事实、语录等，或搜集有形的瓷娃娃、老照片</p><p>应用：<br>具有天生的好奇心，喜欢从研究中获得知识<br>可担任有大量研究任务的工作<br>可充分利用互联网，在网上查找所需信息</p></li><li><p>思维<br>喜欢思考，喜欢思想活动<br>喜欢独处，因为这样能沉思冥想<br>可能努力解决一个问题，或酝酿一个创意，或了解另一个人的感受</p><p>应用：<br>思考使他精力充沛，要多加利用<br>随时向他的思想挑战，不要犹豫，他会感到受到重视<br>鼓励他找出整块时间来思考，思考使他思路清晰，自信心更强<br>他喜欢自省和自我发现，可同他详细讨论他的优势<br>让他与“行动”主题突出的人合作，后者会推动他将想法和主意付诸行动</p></li><li><p>学习<br>你热爱学习，不论什么题目，学习过程而不是内容或结果，最使你兴奋<br>如果不学习新东西，就会坐立不安</p><p>应用：<br>分配他做需要在瞬息万变的环境中不落伍的工作<br>他无论担任什么工作，都急于了解新情况，学习新技能<br>帮助他记录学习的进步，并祝贺他取得的每个进步<br>安排他主持内部讨论或演讲，施教于人是最好的学习方式<br>为他争取继续教育补贴</p></li><li><p>完美<br>你的标准是优秀而不是平均<br>发现优势后，你感到必须培育它，改进它，将它发挥直到炉火纯青<br>你避开力图修理你，使你样样精通的人，你不想终生哀叹自己的欠缺</p><p>应用：<br>他喜欢琢磨如何将正常的业绩最大化，对把破东西修好不感兴趣<br>别让他担任需要不断解决问题的工作<br>过多关注他的弱点会使他沮丧<br>尽量帮助他开辟一条事业之路，使他在本职岗位上出类拔萃<br>他乐于思考每个岗位上杰出表现的员工，天生对佳绩好奇</p></li><li><p>积极<br>你慷慨赞人，笑容可掬，不失时机地捕捉亮点<br>乐观豁达，人们喜欢和你相处<br>你内心深处确信：活着无比美好，工作充满乐趣，无论遇到什么挫折，都不应失去幽默感</p><p>应用：<br>能为工作场所注入戏剧和动力<br>与怨天尤人者在一起会很快耗尽他的活力<br>他喜欢赞美，配合“伯乐”才干，能成为一名优秀的教练<br>配合“统率”才干，能在销售上出类拔萃</p></li><li><p>交往<br>你能从保持米有交往中获得无穷乐趣<br>一旦与人结识，你就会有意深化关系<br>你深知别人可能利用你，但你甘愿接受这种风险，对你来说唯有真诚的关系才有价值<br>检验关系十分真诚的唯一方式便是完全信任别人</p><p>应用：<br>对他明说，你很在乎他<br>他喜欢与同事建立亲密关系，这需要时间，不要让他担任需要他频繁离开同事和顾客的工<br>作<br>放心将秘密告诉他，他为人忠诚，珍视信任<br>将其与你希望留住的骨干建立真正的信任关系，他能用良好的人际关系增进优秀人才对公<br>司的忠诚<br>配合“专注”“统筹”“自信”主题，具有管理的潜能<br>宽宏大量是他的优势，提醒他予以关注</p></li><li><p>责任<br>你一旦作出承诺，无论大小，你从感情上就觉得有义务将其完全落实<br>如果因为某种原因承诺不能兑现，你会自动寻找其他途径给对方以补偿<br>你不作出补偿，就会寝食难安</p><p>应用：<br>做人准则是履行诺言，与做不到这一点的人共事会让他痛苦难言<br>他以自身的高质量为豪，不要强迫他不顾质量而赶工，他会反抗<br>同他讨论工作时，先谈质量<br>他做事积极主动，不需要监督就能完成分配给他的工作<br>让他担任需要严格遵守道德规范的工作，他不会让你失望<br>要注意，他可能宁愿自己做事，而不愿为别人的工作负责，因而不愿担任管理工作。</p></li><li><p>排难<br>你热衷于排忧解难<br>其他人遇到新困难往往一筹莫展，而你却干劲倍增<br>判断故障，排除问题，起死回生，使你其乐无穷（救“活”的对象如：机器、人或公司）</p><p>应用：<br>当你希望识别公司内部的问题时，请他发表意见<br>派他去为最佳客户解决问题<br>他解决一个问题后，切记赞扬他取得的成绩<br>了解他希望如何改进，在他遇到棘手问题时，给他支持，问题悬而未决，他就会产生失败<br>感</p></li><li><p>自信<br>在你的心灵最深处，你对自己的优势充满信心<br>你深知自己是个有能力的人，并对自己的判断充满信心<br>你知道没有人能为你作决定，别人能够引导，能够建议，但只有你才有权作结论，下决<br>心，去行动</p><p>应用：<br>让他担任有充分的自主决策空间的工作<br>让他担任需要坚持不懈才能成功的工作<br>对他说：由你做主，把这件事办成了<br>帮他认识到，他的决定和行动的确有效<br>他或许以为他能做到与自身优势无关的事，他需要清醒的反馈来补充他的直觉<br>配合“前瞻”“专注”“追求”或“统筹”等优势主题，就可能具备担任公司负责人的潜力</p></li><li><p>追求<br>你希望在别人的眼中非同凡响<br>你希望自己获得真正意义上的认可，希望自己的意见受到重视<br>你希望出人头地，希望出名<br>你尤其希望别人了解和赞赏你的独特优势<br>你希望与可信赖和专业化的成功人士交往，如果他们不是这样，你就会推动他们朝此努<br>力，直到成功，否则你就会弃他们而去<br>你天性独立，在工作中希望获得充分的自由，按你自己的方式做事的自由</p><p>应用：<br>切记，他需要独立，不要过多管束他<br>切记，他有贡献，要及时表扬，这是他的动力，给他活动空间，但切勿不管不问，他应得<br>的表扬要全部给他<br>给他机会亮相，让大家都知道他，他喜欢成为公众关注的焦点<br>他喜欢与高手为伍<br>鼓励他表扬团队中其他取得优异成绩的人，他喜欢让其他人有成就感<br>当他想出类拔萃时，帮助他分析为了实现这些理想而必须增强的自身优势，切勿要求他降<br>低标准<br>他非常重视他人的看法，如果别人不给他应得的褒奖，他的自尊心就会受到伤害</p></li><li><p>战略<br>你能在复杂事物中识别其中的规律，尝试不同的解决方案<br>你能够清晰判断潜在的障碍，看清各条路径的走向，并进行筛选<br>对未来具有预见性</p><p>应用：<br>让他为公司打头阵，他善于解决和预见问题，这种能力非常宝贵<br>让他参与公司规划，问他：如果发生这种情况，我们该怎么办<br>在征求他的意见之前，务必给他足够的时间思考，他需要考虑几种方案<br>派他参加战略计划研讨会<br>他往往善于用语言表达观点和思想</p></li><li><p>取悦<br>酷爱结识新人并赢得好感<br>不怕见生人，喜欢主动与生人攀谈<br>一旦关系建立，你就高高兴兴地把它搁置一边</p><p>应用：<br>让他担任每天都能见到新人的工作，与陌生人见面使他兴奋<br>派他代表公司与外界打交道，他能使人感到宾至如归<br>帮助他建立系统来记人名<br>除非他具备“体谅”和“交往”优势，别指望他会喜欢与客户建立密切关系的工作<br>担任社区内的亲善使者，代表公司参加社区的俱乐部和集会</p></li></ol><p>（完）</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>管理学</category>
      
    </categories>
    
    
    <tags>
      
      <tag>管理学</tag>
      
      <tag>领导力</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>管理的基本认识</title>
    <link href="/blog/2021/05/%E7%AE%A1%E7%90%86%E7%9A%84%E5%9F%BA%E6%9C%AC%E8%AE%A4%E8%AF%86.html"/>
    <url>/blog/2021/05/%E7%AE%A1%E7%90%86%E7%9A%84%E5%9F%BA%E6%9C%AC%E8%AE%A4%E8%AF%86.html</url>
    
    <content type="html"><![CDATA[<h2 id="领导和管理的区别是什么？"><a href="#领导和管理的区别是什么？" class="headerlink" title="领导和管理的区别是什么？"></a>领导和管理的区别是什么？</h2><ul><li><p>个人定位：为企业打工VS事业的主人</p><p>管理者为企业打工，而领导会把自己定位成事业的主人，有明确的主人意识。领导者会以所有者的身份去思考和运作。</p></li><li><p>目标长久的价值观：引进外援VS内部塑造；天赋异禀VS遵守纪律</p><p>领导者有更长久的目标，更大的愿景：对事业终身负责，追求长远的伟大，而不是短期的成功。站在更长久的尺度上十年、几十年去考虑事业的未来；</p><p>既然对一份事业终身负责，意味着追求的不再是短期利益，而是长期的持续成功和优秀的品质。如在组建团队的时候是修炼内功而不是引进外援，在选</p><p>择人才的时候是选择遵守纪律，而不是天赋异禀。</p></li><li><p>对象管理：发布指令、行为控制VS凝聚共识</p><p>领导注重凝聚共识，管理者注重行为控制和发布指令。凝聚共识的建立：</p><ol><li>建立不同的观测纬度，通过工作、生活不同维度来观测员工性格、行为；</li><li>了解团队成员是什么样的人：脾气、秉性，以及适合的沟通方式等；</li><li>按照成员各自的特点，通过：劝说、鼓励、激将法、惩罚等手段，让团队统一思想，统一目标，产生对胜利的渴望，向着愿景、关键目标而奋斗。</li></ol></li><li><p>乐于探索未知：面向已知，利用现有能力VS面向未知，开发未知潜力</p><p>管理者面向已知，按照已有的规定来管理公司，而领导者面向未知，他们要自己制定规则，寻找路径，并且带领团队前往未知的新领域。</p></li><li><p>始终如一：面对新技术VS做自己；面对对手VS做自己</p><ul><li>面对新技术：在看似很有作用的新技术、新帮手面前，保持适当的距离和清醒的判断，做到始终如一；</li><li>面对对手：全神贯注于自己所控制的事物上，而不是研究对手，不会根据对手来定义自己，而是自己定义自己</li><li>总的来说：领导不盲从、不迷信，以自己的需求为中心去连接资源、拓展事业；自己定义目标，不要一味竞争，把自己锁死在对手的版图里。</li></ul></li></ul><h2 id="优秀的领导者需要具备什么品质？"><a href="#优秀的领导者需要具备什么品质？" class="headerlink" title="优秀的领导者需要具备什么品质？"></a>优秀的领导者需要具备什么品质？</h2><ul><li><p>向员工清晰地描绘愿景并梳理关键任务</p><ul><li><p>愿景是公司高于利润指标之上的追求，是一家企业从优秀到卓越的重要一步，没有愿景的企业，员工会陷入工作效率不高，士气低迷，只为“钱”工作，经</p><p>济目的达成以后心理迷茫……所以作为公司的优秀领导者，一定要梳理公司愿景，并向员工清晰的描绘灌输公司愿景。因为每个人的成就感不一样，不梳</p><p>理的话整个公司就没有一个共同的方向。</p></li><li><p>关键任务：领导者不需要对任何事情亲力亲为，应该按照2~8定律，重点抓住20%的工作，去完成80%的利润目标。因此，领导者需要知道实现愿景需要</p><p>完成哪几项关键任务(3~5项）。并且不停地向员工灌输愿景，并按照关键任务安排工作，合力朝着目标不断前进。</p></li></ul></li><li><p>让员工值得追随，愿意追随</p><ul><li><p>教练制，及时赋能并反馈：</p><p>像教练一样随时观察员工的表现，针对员工表现出来的情况给出反馈，而不是等到年终评估的时候直接告诉员工，哪里没做好，哪里需要改进。找2至3个</p><p>指导对象，并确定目标：要把他们指导成什么样子，然后拿出时间来，每隔几天进行一次谈话，帮助他们设立这几个月具体进步的目标，帮助他们把这个</p><p>事情做好，看着他们进步。</p></li><li><p>接班人计划，及时授权工作：</p><p>所以如果你意识到自己最大的责任是通过别人来完成工作，那么你就能意识到，你最大的责任是培养他们，授权给他们，帮助他们成长。</p></li></ul></li><li><p>言行一致</p><p>言必行，行必果，不耍小聪明，下属更在意的是领导怎么做，而不是怎么说。如果言行不一，或者领导善于运用语言小技巧，将形式朝着向自己有力的方向去</p><p>扭转，他人就会只注重领导者的言而不是行。但任何技巧性的东西都只会短暂地维持，所有的所谓技巧都会在时间面前变得苍白，它只会让人觉得被愚弄，结</p><p>果往往适得其反。</p></li><li><p>如履薄冰的心态</p><p>对市场变化敏感，敬畏心和危机感，所以一个优秀的领导者，要始终抱有如履薄冰的心态，以更全面的视野、更多元的观点，审视企业内外部资源及环境，及</p><p>时发现行业机会及挑战，确保公司可持续的成功。</p></li></ul><p><img src="/blog/./assets/image-16788744494695424.jpeg" alt="管理"></p><h2 id="如何去激励自己的下属？"><a href="#如何去激励自己的下属？" class="headerlink" title="如何去激励自己的下属？"></a>如何去激励自己的下属？</h2><p>所谓激励，就是组织通过设计适当的奖酬方式和工作环境，以一定的行为规范和惩罚性措施，来激发、引导、保持和规范组织成员的行为，从而有效地实现组织及</p><p>其个人目标的过程。对下属的激励可以分为：物质激励、精神激励、价值观激励。</p><ul><li>物质激励一般能获得立马见效的效果，让员工物质富足，过上理想的物质生活；</li><li>精神激励有可能促使团队更加高效，让员工更有成就感；</li><li>价值观激励让员工感到他们正处于某种有价值的、独特的、非同寻常的事业洪流中，让员工的工作更加主动自觉。</li></ul><p>管理者的责任就在于让自己的团队，全身心投入到自己热爱的事业当中。为了别人，为了公司的目标，为了高于其本身的更伟大的理由和意义。这种价值观上的激</p><p>励，远远会比物质激励和精神激励产生更深远的影响。</p><h2 id="企业家精神是什么？如何理解企业家精神的重要性？"><a href="#企业家精神是什么？如何理解企业家精神的重要性？" class="headerlink" title="企业家精神是什么？如何理解企业家精神的重要性？"></a>企业家精神是什么？如何理解企业家精神的重要性？</h2><p>企业家精神是指：</p><p>企业家在不确定性和不连续性面前表现出来的：战略前瞻性、市场敏感性和团队领导力。</p><p>首先，企业家是指：能把资产从生产力和产出低的区域转移到生产力和产出高的区域，并敢于承担所有的风险和责任的人；企业高层、各级别管理者、个人都应该</p><p>具有企业家精神。运用企业家精神能在不确定性和不连续中抓住新机遇。</p><p>如何理解：</p><ul><li><p>前瞻性，站得高看得远</p><p>在麦当劳的故事里，克洛克对来自麦当劳的“异常订单”十分敏感，马上决定到麦当劳现场参观。说明克洛克具有企业家应该有的前瞻性思维，看到了别人目光</p><p>所不能及的更远的地方，对市场有前瞻性的洞察力，通过搅拌机订单的增加推测可能会有大的商业机会；</p></li><li><p>市场敏感</p><p>克洛克果断的加入了麦当劳公司，拿下总代理的合作，说明他敏锐地注意到了美国社会结构和快餐业产业结构的变化。20世纪50年代，二战之后大量的美国年</p><p>轻人组成家庭，生育子女。人口结构的变化带来了对餐饮业的巨大需求。这是对市场敏感度把握的体现。从中嗅到了巨大的市场商机；</p></li><li><p>团队领导力：</p><p>展现优秀的领导品质，使下属愿意跟随；</p></li><li><p>企业家精神不仅仅局限于企业家群体：</p><p>无论是现存的大型机构，还是白手起家的个体户，企业家精神的基本原则都是一样的。这些原则也适用于非营利组织、政府机构甚至是个人。至于普通人如何</p><p>获得企业家精神，如何抓住创新机遇。</p></li><li><p>企业家精神可以通过学习和实践获得：</p><p>管理是一门实践的学科。个人可以通过不断地学习和实践，获得企业家般的战略前瞻性、市场敏感性和团队领导力。</p></li><li><p>企业家精神的人更容易抓住机遇：</p><p>不同人抓住机会的能力不同。面对相同或类似的创新机遇，具有企业家精神的人，既有高瞻远瞩的眼光，又有脚踏实地的干劲。只有这些人，才能抓住创新机遇。</p></li></ul><h2 id="对待上级应怎样？"><a href="#对待上级应怎样？" class="headerlink" title="对待上级应怎样？"></a>对待上级应怎样？</h2><ul><li><p>首先知道谁是上级？<br>知道在复杂的职场环境中，谁是你的上级，你可能有好几个老板，有好几个老板对你的升职加薪有决定性的作用，或者会起到建议的作用。因此你必须知道你有多少上级，你需要分别向多少人汇报你的工作；</p></li><li><p>了解我能为上级做什么，怎么做；我需要上级什么支持，向上管理；</p><ul><li><p>找到这些上级，与他们进行沟通，尝试获得一些有用的信息；</p></li><li><p>问问他们你可以为他们做什么，为他们分担工作，让他们变得更轻松一些；</p></li><li><p>多听取上级的建议，让他们明白你的谦虚，获得信任；</p></li><li><p>在工作过程中保持沟通，在遇到困难时请求支持，争取他们的帮助。</p></li></ul></li><li><p>与上级沟通信息，保持信息通畅；</p><ul><li><p>信息要向下流通，让下属顺利、便利工作，还需要向上流通，让上级知道你的工作流程；</p></li><li><p>让所有的上级领导都获得你的工作目标、计划、内容、进度、结果、困难等反馈信息，优秀的管理者是优秀的信息搜集者和整合者。</p></li></ul></li><li><p>不要贬低上级，不要揪住不放；<br>换位思考，你是老板不能做到十全十美，也不希望你的下属贬低诋毁你。</p></li></ul><h2 id="对待下级应怎样？"><a href="#对待下级应怎样？" class="headerlink" title="对待下级应怎样？"></a>对待下级应怎样？</h2><p>充分授权：作为管理者，在分派工作之前，要明白：你的任务是让每一个员工发挥出他们所能达到的最高水平，而不是达到如果由你来做这项工作所能达到的水平；你最大的成功是组建一个团队，让你的存在在这个团队中显得多余；</p><ul><li><p>授权工作——“接班人计划”：</p><ul><li><p>“教是最好的学”找2~3下属作为“接班人”，但不需要告诉他们；</p></li><li><p>制定出接班人计划，把工作逐渐授权给他们，逐渐加大对他们的责任。调动积极性，让他们对公司发挥最大的实力；另外他们会觉得你是以为好领带，值得信任的领导，愿意一路追随你；</p></li><li><p>转变思想：要意识到你最大的职责是通过别人来完成工作，所以你做大的责任是培养他们，授权他们，帮助他们成长；</p></li><li><p>如何授权：首先，画出接班人阵容图，列出2~3位接班人，列出每位接班人需要培养的能力和具体培养方案；其次，将手头上的关键任务与接班人与阵容图里的接班人相匹配，将任务分配给他们，告诉他们哪些必须做好，哪些做到“差不多”即可；最后，在下属执行过程中，不直接参与任务，也不会干预下属的决策，而是用教练的方式给与必要的指导，帮助下属更好的完成工作。</p></li></ul></li><li><p>授权绩效——目标管理：</p><ul><li>自下而上的方式制定绩效管理目标，而不是自上而下。承认“人性本善”，每个人都有自己的特长，有自我实现的需求和自我控制的能力，让下级以管理者的身份自行制定自己团队的绩效；</li><li>绩效的评估直接反馈给下属管理者本人而不是上级，让下属以自由人的身份自行纠偏，而不是上级控制下级的工具。</li></ul></li></ul><h2 id="如何理解创新的产生和作用？"><a href="#如何理解创新的产生和作用？" class="headerlink" title="如何理解创新的产生和作用？"></a>如何理解创新的产生和作用？</h2><p>创新的七种来源包括：意外事件、不协调事件、流程改进的需要、产业和市场结构变化、人口变化、认知变化、新知识。七种来源的共同点是：不确定性和不连续性。</p><p>作用：具备企业家可以精神的人可以利用创新抓住新的机遇；</p><ul><li>孤注一掷：集中全部资源，争取毕其功于一役。罗氏公司在维生素被发现但还没有认识到重要性的基础上，孤注一掷买下专利，聘请维生素的发现者，最终占据着全球最大的市场份额；</li><li>功其软肋：创造性模仿策略，先山寨，再创新：QQ模仿ICQ的故事，先模仿，再创新，最终成就企鹅帝国；</li><li>生态利基：专注细分市场，避免正面竞争。德国日本高科技领域里的“隐形冠军”企业；</li><li>生态创新：不仅仅是产品方面的创新，而是包括商业模式、产品等方面的综合创新。小米生态链，适应客户处于的社会和经济现状，向客户提供所需的真正价值。</li></ul><p>（完）</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>管理学</category>
      
    </categories>
    
    
    <tags>
      
      <tag>管理学</tag>
      
      <tag>领导力</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>管理类研究生备考策略</title>
    <link href="/blog/2021/05/%E7%AE%A1%E7%90%86%E7%B1%BB%E7%A0%94%E7%A9%B6%E7%94%9F%E5%A4%87%E8%80%83.html"/>
    <url>/blog/2021/05/%E7%AE%A1%E7%90%86%E7%B1%BB%E7%A0%94%E7%A9%B6%E7%94%9F%E5%A4%87%E8%80%83.html</url>
    
    <content type="html"><![CDATA[<h2 id="面试"><a href="#面试" class="headerlink" title="面试"></a>面试</h2><h3 id="日常练习"><a href="#日常练习" class="headerlink" title="日常练习"></a>日常练习</h3><ul><li>个人第1周练习，以书面形式呈现</li><li>个人第2周练习，以录音形式呈现</li></ul><blockquote><p>每周进行思维训练。</p></blockquote><h3 id="行业分析"><a href="#行业分析" class="headerlink" title="行业分析"></a>行业分析</h3><p>从以下方面对所在行业进行分析: </p><ol><li><p>现在:所在周期与竞争程度; 工 </p></li><li><p>痛点:目前行业中普遍存在的问题(1-2点) </p></li><li><p>未来:改革方向与趋势(结合热门产品、龙头企业)，你的个人分析和预测</p></li></ol><ul><li><p>新技术</p></li><li><p>新需求</p></li><li><p>新模式</p></li><li><p>新政策</p></li></ul><h3 id="企业分析"><a href="#企业分析" class="headerlink" title="企业分析"></a>企业分析</h3><p>从以下方面对所在企业进行分析: </p><ol><li>同行角度:企业布局、企业部门结构、企业文化、企业主打产品与优势 </li><li>管理者心态(你所在部门):企业管理特色、员工激励方式与制度、哪些地方可以做优化(1-2点)</li></ol><h4 id="示例：xxx金融科技企业分析"><a href="#示例：xxx金融科技企业分析" class="headerlink" title="示例：xxx金融科技企业分析"></a>示例：xxx金融科技企业分析</h4><p>xxx金融科技企业是一家立足于金融科技的高科技企业。公司以高科技产品、金融解决方案，软件项目外包、运营服务等服务相结合，为客户提供全面完善的金融解决方案及高质素的专业人员。</p><h5 id="同行角度"><a href="#同行角度" class="headerlink" title="同行角度"></a>同行角度</h5><p>企业布局：公司业务主要分信贷、大数据和创新产品。</p><p>部门结构：</p><p><img src="/blog/./assets/image-16788744705573888.png" alt="部门结构"> </p><p>企业文化：以科技创新为基础，紧跟科技前沿面向未来。</p><p>企业主打产品：主打为客户提供一站式智能金融解决方案。</p><p>优势：</p><p>1.解决方案：领先的互联网金融产品和行业领先的解决方案；</p><p>2.科技创新：与国内多家人工智能研究机构合作；</p><p>3.优质服务：优质的行业服务、灵活定制的交付模式。</p><h5 id="管理者心态"><a href="#管理者心态" class="headerlink" title="管理者心态"></a>管理者心态</h5><p>企业管理特色：弹性上下班，扁平化管理。</p><p>员工激励方式与制度：KPI绩效考核，关联晋升、调薪和年终奖。</p><p>哪些地方可以做优化：为员工提供有保障的福利和保险; 适当放权，让员工肩负权利的同时肩负责任。</p><h2 id="数学"><a href="#数学" class="headerlink" title="数学"></a>数学</h2><p>数学总分75分，都是选择题。</p><p>控制在1个小时内完成 ，共25道题。60&#x2F;25&#x3D;2.4分钟&#x2F;道 </p><ul><li>问题求解15题*3分&#x3D;45分 </li><li>条件充分性判断10题*3&#x3D;30分</li></ul><h2 id="英语"><a href="#英语" class="headerlink" title="英语"></a>英语</h2><p>根据下面四步骤环环相扣，不能调换顺序，一步不能少 。</p><ol><li><p>做历年真题 </p></li><li><p>背单词——碎片时间 </p><ul><li><p>初步背单词-单词检测:打好单词基础，记住70-80%即可 </p></li><li><p>滚轮背单词-单词检测:单词重复记忆，1小时-15分钟-5分钟</p></li></ul></li><li><p>长难句解析+全文逐句翻译 </p></li><li><p>看错题解析</p></li></ol><p>其中第3步:长难句解析+全文逐句翻译</p><ol><li><p>长难句分析——单词到句子的过渡 </p><p>不需要从头学语法，跟着书本来练习长难句，基础弱也可以慢慢积累 </p></li><li><p>逐句翻译全文: </p><p>口述&#x2F;脑海中进行翻译，直到能把每句话都翻译 成完整且通顺句子为止。 </p><p>口述，而非落笔写一时间短，效果佳 。</p><p>把单词带到情景中再去记忆，强化背诵效果——背单词做好的方法是使用。</p></li></ol>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>管理学</category>
      
    </categories>
    
    
    <tags>
      
      <tag>管理学</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>使用update-alternatives管理多个可执行文件版本</title>
    <link href="/blog/2021/04/update-alternatives%E7%AE%A1%E7%90%86%E5%A4%9A%E4%B8%AA%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6%E7%89%88%E6%9C%AC.html"/>
    <url>/blog/2021/04/update-alternatives%E7%AE%A1%E7%90%86%E5%A4%9A%E4%B8%AA%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6%E7%89%88%E6%9C%AC.html</url>
    
    <content type="html"><![CDATA[<h2 id="管理Java版本"><a href="#管理Java版本" class="headerlink" title="管理Java版本"></a>管理Java版本</h2><p>要使用 <code>update-alternatives</code> 添加 Java，需要先确保已经安装了多个 Java 版本，并且这些版本位于不同的路径下。</p><p><code>update-alternatives</code> 允许你设置一个默认的 Java 版本，并在多个版本之间切换。</p><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p>确保多个 Java 版本安装在不同的路径下。使用update-alternatives添加 Java 版本。</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs n1ql">sudo <span class="hljs-keyword">update</span>-alternatives --install /usr/bin/java java &lt;<span class="hljs-keyword">path</span>-<span class="hljs-keyword">to</span>-java-version&gt; &lt;priority&gt;<br></code></pre></td></tr></table></figure><blockquote><p>备注:</p><p><code>/usr/bin/java</code> 是通用的 Java 命令路径。</p><p><code>java</code> 是这个命令的替代名称。</p><p><code>&lt;path-to-java-version&gt;</code> Java 版本的完整路径，例如 <code>/usr/lib/jvm/java-11-openjdk-amd64/bin/java</code>。</p><p><code>&lt;priority&gt;</code> 是一个数字，表示这个版本的优先级。数字越大，优先级越高。</p></blockquote><h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><p>要设置某个版本为默认版本，可以使用以下命令：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">sudo <span class="hljs-keyword">update</span><span class="hljs-operator">-</span>alternatives <span class="hljs-comment">--config java</span><br></code></pre></td></tr></table></figure><p>这会列出所有已注册的 Java 版本，并让你选择一个作为默认。</p><h3 id="验证"><a href="#验证" class="headerlink" title="验证"></a>验证</h3><p>可以使用以下命令来验证当前的默认 Java 版本：</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript">java -<span class="hljs-built_in">version</span><br></code></pre></td></tr></table></figure><p>这将显示当前默认 Java 版本的详细信息。</p><blockquote><p>注意，每次添加或删除 Java 版本时，都应该使用 <code>update-alternatives</code> 来更新系统配置。</p></blockquote><p>（完）</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>大脑训练</title>
    <link href="/blog/2021/03/%E5%A4%A7%E8%84%91%E8%AE%AD%E7%BB%83.html"/>
    <url>/blog/2021/03/%E5%A4%A7%E8%84%91%E8%AE%AD%E7%BB%83.html</url>
    
    <content type="html"><![CDATA[<h2 id="大脑“快乐激素”"><a href="#大脑“快乐激素”" class="headerlink" title="大脑“快乐激素”"></a>大脑“快乐激素”</h2><h3 id="多巴胺（Dopamine）–“奖赏”激素"><a href="#多巴胺（Dopamine）–“奖赏”激素" class="headerlink" title="多巴胺（Dopamine）–“奖赏”激素"></a>多巴胺（Dopamine）–“奖赏”激素</h3><ul><li>尝试新事物</li><li>听音乐</li><li>完成一系列小任务</li><li>冥想</li><li>适当补充铁＆维生素B</li><li>进食少量甜食</li></ul><h3 id="血清素（Serotonin）–情绪“稳定剂”"><a href="#血清素（Serotonin）–情绪“稳定剂”" class="headerlink" title="血清素（Serotonin）–情绪“稳定剂”"></a>血清素（Serotonin）–情绪“稳定剂”</h3><ul><li>晒太阳</li><li>体育运动</li><li>冥想</li><li>健康饮食</li><li>适当补充维生素D</li><li>进行感恩练习</li></ul><h3 id="催产素（Oxytocin）—“爱情荷尔蒙”"><a href="#催产素（Oxytocin）—“爱情荷尔蒙”" class="headerlink" title="催产素（Oxytocin）—“爱情荷尔蒙”"></a>催产素（Oxytocin）—“爱情荷尔蒙”</h3><ul><li>给别人一个热情的拥抱</li><li>与朋友相处</li><li>听音乐</li><li>参加社会活动如志愿活动</li><li>对他人表达赞赏</li><li>和小动物玩耍</li></ul><h3 id="内啡肽（Endorphins）–天然“止痛药”"><a href="#内啡肽（Endorphins）–天然“止痛药”" class="headerlink" title="内啡肽（Endorphins）–天然“止痛药”"></a>内啡肽（Endorphins）–天然“止痛药”</h3><ul><li>进行中等强度的运动</li><li>练习瑜伽或冥想</li><li>听音乐，绘画</li><li>笑一笑</li><li>食用少量黑巧克力</li><li>适量食用辛辣食物</li></ul><p>（完）</p>]]></content>
    
    
    <categories>
      
      <category>生活</category>
      
      <category>健康</category>
      
    </categories>
    
    
    <tags>
      
      <tag>食物</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>cgroup简介和在容器里的使用</title>
    <link href="/blog/2021/03/cgroup%E7%AE%80%E4%BB%8B%E5%92%8C%E5%9C%A8%E5%AE%B9%E5%99%A8%E9%87%8C%E7%9A%84%E4%BD%BF%E7%94%A8.html"/>
    <url>/blog/2021/03/cgroup%E7%AE%80%E4%BB%8B%E5%92%8C%E5%9C%A8%E5%AE%B9%E5%99%A8%E9%87%8C%E7%9A%84%E4%BD%BF%E7%94%A8.html</url>
    
    <content type="html"><![CDATA[<p><code>free -hm</code>看到的内存并不一定是真实可用内存。查看机器内存有16G,但实际可用只有1G，超出分配内存就被cgroup杀死的进程，原因是被cgroup给做了内存限制。</p><h2 id="cgroup"><a href="#cgroup" class="headerlink" title="cgroup"></a>cgroup</h2><p>在Linux系统中，cgroups（控制组）可以用来限制、记录、隔离进程组所使用的物理资源（如CPU、内存、磁盘I&#x2F;O等）。<br>可以通过读取cgroup文件系统中的相关文件来查看内存限制和当前使用情况。</p><p>一般来说，cgroup的内存相关设置和状态信息存储在<code>/sys/fs/cgroup/memory/</code>目录下。</p><p>以下是一些基本的步骤来查看cgroup的内存信息：</p><h3 id="查看内存cgroup的总览"><a href="#查看内存cgroup的总览" class="headerlink" title="查看内存cgroup的总览"></a>查看内存cgroup的总览</h3>   <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">ls</span> /sys/fs/cgroup/memory/<br></code></pre></td></tr></table></figure><ul><li><code>memory.usage_in_bytes</code></li><li><code>memory.limit_in_bytes</code><br> 这些文件包含了cgroup的内存使用情况和限制信息。</li></ul><h3 id="查看特定cgroup的内存使用情况"><a href="#查看特定cgroup的内存使用情况" class="headerlink" title="查看特定cgroup的内存使用情况"></a>查看特定cgroup的内存使用情况</h3>   <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> /sys/fs/cgroup/memory/your_cgroup_name/memory.usage_in_bytes<br></code></pre></td></tr></table></figure><blockquote><p>注意：<code>your_cgroup_name</code>需要替换为你想要查看的cgroup的实际名称或路径。</p></blockquote><h3 id="查看内存限制"><a href="#查看内存限制" class="headerlink" title="查看内存限制"></a>查看内存限制</h3>   <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> /sys/fs/cgroup/memory/your_cgroup_name/memory.limit_in_bytes<br></code></pre></td></tr></table></figure><h3 id="查看所有cgroup的内存信息"><a href="#查看所有cgroup的内存信息" class="headerlink" title="查看所有cgroup的内存信息"></a>查看所有cgroup的内存信息</h3><p>   要查看所有cgroup的内存使用情况，需要遍历<code>/sys/fs/cgroup/memory/</code>目录下的所有子目录，并读取每个子目录中的<code>memory.usage_in_bytes</code>文件。</p><h2 id="容器和cgroup"><a href="#容器和cgroup" class="headerlink" title="容器和cgroup"></a>容器和cgroup</h2><p>在容器内运行Java应用时，可以通过JVM参数来让Java运行时识别并适应容器设置的资源限制。这主要通过使用JVM的某些特性来实现，这些特性允许Java应用更好地与容器的资源限制集成。</p><p>一种常用的方法是使用JVM的<code>-XX:+UnlockExperimentalVMOptions -XX:+UseCGroupMemoryLimitForHeap</code>参数。它们允许JVM自动检测并适应由cgroup设置的内存限制。当启用这些选项时，JVM会尝试根据容器的内存限制来自动调整Java堆的大小。</p><p>例如:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">java -XX:+UnlockExperimentalVMOptions -XX:+UseCGroupMemoryLimitForHeap -jar your-app.jar<br></code></pre></td></tr></table></figure><p>这样，当Java应用运行在Docker容器或其他使用cgroup限制资源的环境中时，JVM会自动检测这些限制并相应地调整堆大小。这有助于避免手动设置堆大小不当而导致的问题，如内存溢出或容器被杀死。</p><p>（完）</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>容器</tag>
      
      <tag>cgroup</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>句子摘录</title>
    <link href="/blog/2021/02/%E5%8F%A5%E5%AD%90%E6%91%98%E5%BD%95.html"/>
    <url>/blog/2021/02/%E5%8F%A5%E5%AD%90%E6%91%98%E5%BD%95.html</url>
    
    <content type="html"><![CDATA[<h2 id="学习"><a href="#学习" class="headerlink" title="学习"></a>学习</h2><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">解释不清楚一个概念，很多时候并不是表达能力不行，而是知识储备不够，理解不到位。<br></code></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs text">If you can&#x27;t explain it simply, you don&#x27;t understand it well enough.<br>--Albert Einstein<br></code></pre></td></tr></table></figure><h2 id="哲学"><a href="#哲学" class="headerlink" title="哲学"></a>哲学</h2><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs text">叔本华认为死亡是生命的解脱；<br>海德格尔认为抗拒死亡就不能完全实现生命；<br>马克思说“没有说够的傻子才有遗言”；<br>维特根斯坦认为现在活着，就是永恒的活着。<br>无论如何，希望你能从哲学家的视角里找到一些宁静。<br></code></pre></td></tr></table></figure><h2 id="自律"><a href="#自律" class="headerlink" title="自律"></a>自律</h2><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs text">人的生命只有惯性，没有命运。<br>人生更像航船而不是火车，有风向.有航向，但没有轨道。有目标，没有站点。<br>你下一秒钟做什么，只是不太容易明显改变你下下秒的状态，但却对三个月或半年后的你完全可以有重大的颠覆性影响。<br></code></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs text">工作，赚钱，学习，健身，做饭，乐高，拼图，刷剧，直播，视频。<br>有一百种方式让时间流逝，并且大部分时候，我觉得分身乏术，一个人想掰开当好几个人用。<br>对于我来说，时间并不是用来打发的，而是用来更好的规划的，充分利用的。<br></code></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs text">为什么人到中年，很少有身材苗条的?<br>因为在各种求而不得的世俗欲望中，唯有食欲的实现，是最容易的。<br></code></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">苦尽甘来内啡肽，意犹未尽多巴胺。<br></code></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">我观察了同龄人，尤其是男生，堕落都是从疏远运动开始的，特别是毕业后忙于工作应酬享乐，又不节制饮食，三五年后，当年清秀的少年一个个变成脑满肥肠臃肿不堪满脸横肉，真是糟糕。村上春树说肉体才是人的神殿，不管在那里供奉什么，它都应该更强韧、更美丽、更清洁。<br></code></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs text">富兰克林的自律十三条：<br>1.节制：食不过饱，饭不过量。<br>2.缄默：避免空谈，言必对己或对人有益。<br>3.有序：你的一切应井然有序，一时一事都要有周全计划。<br>4.决心：当做必做，做就要做好。<br>5.节俭：对人或对己有益才可花钱，决不浪费。<br>6.勤奋：珍惜光阴，做有益之事，避无谓之举。<br>7.真诚：不欺骗，有良知，为人厚道，说话实在。<br>8.正义：不做不利于人的事，不逃避自己的义务。<br>9.中庸：避免走极端，容忍别人给的伤害，认为是应该承受之事。<br>10.整洁：保持身体，衣服和住所的整洁。<br>11.冷静：不因小事，寻常之事，不可避免之事而慌乱。<br>12.节欲：少行房事，除非考虑到身体健康或者延续子嗣，不要房事过度，伤害身体或者损害自己的或他人的安宁与名誉。<br>13.谦虚：效法耶稣和苏格拉底。<br></code></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs text">高效能人士的七个习惯<br>习惯1:积极主动<br>习惯2:以终为始<br>习惯3:要事第一<br>习惯4:双赢思维<br>习惯5:知彼解己<br>习惯6:统合综效<br>习惯7:不断更新<br></code></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs text">最谦卑的时候才是最接近伟大的时候<br>有一种美丽需要发现和经营<br>不要因为外因而改变自己的想法<br>最好的镜子是你自己<br>要永远看清自己的模样<br>小心！金钱会迷惑人去践踏生命<br>己所不欲，勿施于人<br>人最难抑制的情感是骄傲<br>改过迁善不嫌迟<br></code></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs text">越是愚昧、贫穷的时候，越是关心远在天边的事，越是把自己代入，这样活得才有点意义。<br>你越有代入感，他们财富涨得越快，你变得越穷。<br>大家都关心社区的事、自己家的事，才是富裕社会的状态。<br></code></pre></td></tr></table></figure><h2 id="选择"><a href="#选择" class="headerlink" title="选择"></a>选择</h2><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs text">一旦你将结婚生子从人生规划中删除之后，你会发现年龄对你根本无法形成任何束缚和恐惧。<br>人生也可以不用那么紧赶慢赶，一生都可以用来追逐梦想，以及体验各种未知。<br></code></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">我学会了如果你必须离开一个地方，一个你曾经住过、爱过、深埋着所有过往的地方，无论以何种方式离开，都不要慢慢离开，要尽你所能决绝地离开，永远不要回头，也永远不要相信过去的时光才更好，因为它们已经消亡。过去的岁月看来安全无害，能被轻易跨越，而未来藏在迷雾之中，隔着距离，看来叫人胆怯。但当你踏足其中，就会云开雾散。我学会了这一点，但就像所有人一样，待到学会，为时太晚。<br></code></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">纪伯伦说过：“如果有一天，你不再寻找爱情，只是去爱；你不再渴望成功，只是去做；你不再追逐成长，只是去修，一切才真正的开始”。<br></code></pre></td></tr></table></figure><p>（完）</p>]]></content>
    
    
    <categories>
      
      <category>生活</category>
      
      <category>经验</category>
      
    </categories>
    
    
    <tags>
      
      <tag>语录</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Redis知识总结</title>
    <link href="/blog/2020/12/Redis%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93.html"/>
    <url>/blog/2020/12/Redis%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93.html</url>
    
    <content type="html"><![CDATA[<h2 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h2><ul><li>缓存</li><li>单机里用JVM锁锁,在集群中用分布式锁</li><li>无锁化<ul><li>原子操作是一种提供无锁并发访问控制的方法。</li><li>多个操作写到一个Lua脚本中执行。</li></ul></li></ul><h2 id="Redis-到底有多快"><a href="#Redis-到底有多快" class="headerlink" title="Redis 到底有多快"></a>Redis 到底有多快</h2><p><code>Redis</code> 官方提供了一个测试脚本，可以供我们测试 <code>Redis</code> 的吞吐量：</p><ul><li><code>redis-benchmark -q -n 100000</code>：测试常用命令的吞吐量。</li><li><code>redis-benchmark -t set,lpush -n 100000 -q</code>：测试 <code>Redis</code> 处理 <code>set</code> 和 <code>lpush</code> 命令的吞吐量。</li><li><code>redis-benchmark -n 100000 -q script load &quot;redis.call(&#39;set&#39;,&#39;foo&#39;,&#39;bar&#39;)&quot;</code>：测试 <code>Redis</code> 处理 <code>Lua</code> 脚本等吞吐量。</li></ul><h2 id="Redis-为什么这么快"><a href="#Redis-为什么这么快" class="headerlink" title="Redis 为什么这么快"></a>Redis 为什么这么快</h2><ul><li><code>Redis</code> 是纯内存结构的，避免了磁盘 <code>I/O</code> 等耗时操作。</li><li><code>Redis</code> 命令处理的核心模块为单线程，减少了锁竞争，以及频繁创建线程和销毁线程的代价，减少了线程上下文切换的消耗。</li><li>采用了 <code>I/O</code> 多路复用机制，大大提升了并发效率。</li></ul><h2 id="redis线程模型"><a href="#redis线程模型" class="headerlink" title="redis线程模型"></a>redis线程模型</h2><h3 id="IO模型维度的特征"><a href="#IO模型维度的特征" class="headerlink" title="IO模型维度的特征"></a>IO模型维度的特征</h3><p>IO模型使用了多路复用器，在linux系统中使用的是EPOLL<br>类似netty的BOSS,WORKER使用一个EventLoopGroup(threads&#x3D;1)<br>单线程的Reactor模型，每次循环取socket中的命令然后逐一操作，可以保证socket中的指令是按顺序的，不保证不同的socket也就是客户端的命令的顺序性。</p><h3 id="数据架构模型"><a href="#数据架构模型" class="headerlink" title="数据架构模型"></a>数据架构模型</h3><p>自身的内存存储数据，读写操作不涉及磁盘IO<br>redis除了提供了Value具备类型还为每种类型实现了一些操作命令<br>实现了计算向数据移动，而非数据向计算移动，这样在IO的成本上有一定的优势<br>且在数据结构类型上，丰富了一些统计类属性，读写操作中，写操作会O(1)负载度更新length类属性，使得读操作也是O(1)的</p><h2 id="Redis是单线程还是多线程"><a href="#Redis是单线程还是多线程" class="headerlink" title="Redis是单线程还是多线程"></a>Redis是单线程还是多线程</h2><p><code>Redis</code> 从 <code>4.0</code> 版本开始就有了多线程的概念，虽然处理命令请求的核心模块确实是保证了单线程执行，然而在其它许多地方已经有了多线程，比如：在后台删除对象，通过 <code>Redis</code> 模块实现阻塞命令，生成 <code>dump</code> 文件，以及 <code>6.0</code> 版本中网络 <code>I/O</code> 实现了多线程等，但是无论什么版本,工作线程就是一个。</p><p>所谓的单线程，只是说 <code>Redis</code> 处理客户端的请求（即执行命令）时，是单线程去执行的，并不是说整个 <code>Redis</code> 都是单线程。</p><p>单线程满足了Redis的串行原子,只不过IO多线程后,把输入&#x2F;输出放到更多的线程里去并行,多线程存在客户端被读取的顺序不能被保障，但在一个连接socket里是可以被保障的。</p><blockquote><p>面向IO模型编程的时候,有内核的事。第一步从内核把数据搬运到程序里；第二步搬运回来的数据做计算（比如Netty）</p></blockquote><p><img src="/blog/./assets/image-20240412222918987.png" alt="6.x之前"></p><p><img src="/blog/./assets/image-20240412223005643.png" alt="6.x之后"></p><h2 id="Redis为什么使用单线程来执行请求"><a href="#Redis为什么使用单线程来执行请求" class="headerlink" title="Redis为什么使用单线程来执行请求"></a>Redis为什么使用单线程来执行请求</h2><p><code>CPU</code> 成为 <code>Redis</code> 瓶颈的情况并不常见，成为 <code>Redis</code> 瓶颈的通常是内存或网络带宽。例如，在一个普通的 <code>Linux</code> 系统上使用  命令，<code>Redis</code> 可以每秒完成 <code>100</code> 万个请求，所以如果我们的应用程序主要使用 <code>O(N)</code> 或 <code>O(log(N))</code> 复杂度的命令，它几乎不会使用太多的 <code>CPU</code>。</p><p>既然 <code>CPU</code> 不会成为瓶颈，理所当然的就没必要去使用多线程来执行命令，同时多线程一定会比单线程快吗？答案是不一定。因为多线程也是有代价的，最直接的两个代价就是线程的创建和销毁（当然可以通过线程池来一定程度减少频繁的创建线程和销毁线程）以及线程的上下文切换。</p><p>在我们的日常系统中，主要可以区分为两种：<code>CPU</code> 密集型 和 <code>IO</code> 密集型：</p><ol><li><code>CPU</code> 密集型：这种系统就说明 <code>CPU</code> 的利用率很高，那么使用多线程反而会增加上下文切换而带来额外的开销，所以使用多线程效率可能会不升反降。</li></ol><p>举个例子：假如你现在在干活，你一直不停的在做一件事，需要 <code>1</code> 分钟可以做完，但是你中途总是被人打断，需要花 <code>1</code> 秒钟时间步行到旁边去做另一件事，假如这件事也需要 <code>1</code> 分钟，那么你因为反复切换做两件事，每切换一次就要花 <code>1</code> 秒钟，最后做完这 <code>2</code> 件事的时间肯定大于 <code>2</code> 分钟（取决于中途切换的次数），但是如果中途不被打断，你做完一件事再去做另一件事，那么你最多只需要切换 <code>1</code> 次，也就是 <code>2</code> 分 <code>1</code> 秒就能做完。</p><ol start="2"><li><code>IO</code> 密集型：<code>IO</code> 操作也可以分为磁盘 <code>IO</code> 和网络 <code>IO</code> 等操作。大部分 <code>IO</code> 操作的特点是比较耗时且 <code>CPU</code> 利用率不高，所以 <code>Redis 6.0</code> 版本网络 <code>IO</code> 会改进为多线程。至于磁盘 <code>IO</code>，因为 <code>Redis</code> 中的数据都存储在内存（也可以持久化），所以并不会过多的涉及到磁盘操作。</li></ol><p>举个例子：假如你现在给树苗浇水，你每浇完一次水之后就需要等别人给你加水之后你才能继续浇，那么假如这个等待过程需要 <code>5</code> 秒钟，也就是说你浇完一次水就可以休息 <code>5</code> 秒钟，而你切换去做另一件事来回只需要 <code>2</code> 秒，那么你完全可以先去做另一件事，做完之后再回来继续浇水，这样就可以充分利用你空闲的 <code>5</code> 秒钟时间，从而提升了效率。</p><p>使用多线程还会带来一个问题就是数据的安全性，所以多线程编程都会涉及到锁竞争，由此也会带来额外的开销。</p><h2 id="IO-多路复用机制"><a href="#IO-多路复用机制" class="headerlink" title="IO 多路复用机制"></a>IO 多路复用机制</h2><p><code>I/O</code> 指的是网络 <code>I/O</code>， 多路指的是多个 <code>TCP</code> 连接（如 <code>Socket</code>），复用指的是复用一个或多个线程。<code>I/O</code> 多路复用的核心原理就是不再由应用程序自己来监听连接，而是由服务器内核替应用程序监听。</p><p>在 <code>Redis</code> 中，其多路复用有多种实现，如：<code>select</code>，<code>epoll</code>，<code>evport</code>，<code>kqueue</code> 等。</p><p>我们用去餐厅吃饭的例子来解释一下 <code>I/O</code> 多路复用机制（点餐人相当于客户端，餐厅的厨房相当于服务器，厨师就是线程）。</p><ul><li>阻塞 <code>IO</code>：张三去餐厅吃饭，点了一道菜，这时候他啥事也不干了，就是一直等，等到厨师炒好菜，他就把菜端走开始吃饭了。也就是在菜被炒好之前，张三被阻塞了，这就是 <code>BIO</code>（阻塞 <code>IO</code>），效率非常低下。</li><li>非阻塞 <code>IO</code>：张三去餐厅吃饭，点了一道菜，这时候张三他不会一直等，找了个位置坐下，刷刷抖音，打打电话，做点其它事，然后每隔一段时间就去厨房问一下自己的菜好了没有。这种就属于非阻塞 <code>IO</code>，这种方式虽然可以提高性能，但是如果有大量 <code>IO</code> 都来定期轮询，也会给服务器造成非常大的负担。</li><li>事件驱动机制：张三去餐厅吃饭，点了一道菜，这时候他找了个位置坐下来等，接下来厨房（服务器）有两种做法：<ul><li>厨房把菜做好了直接把菜端出去，但是端菜的人并不知道这道菜是谁的，于是就挨个询问顾客，这就是多路复用中的 <code>select</code> 模型，不过 <code>select</code> 模型最多只能监听 <code>1024</code> 个 <code>socket</code>（<code>poll</code> 模型解决了这个限制问题）。</li><li>厨房把菜做好了直接把菜放在窗口上，大喊一声：“某某菜做好了，是谁的快过来拿。”这时候听到通知的顾客就会自己去拿，这就是多路复用中的 <code>epoll</code> 模型。</li></ul></li></ul><p>需要注意的是：在 <code>IO</code> 多路复用机制下，客户端可以阻塞也可以选择不阻塞（大部分场景下是阻塞 <code>IO</code>），这个要具体情况具体分析，但是在多路复用机制下，服务端就可以通过多线程（上面示例中可以多几个厨师同时炒菜）来提升并发效率。</p><h2 id="Redis-中-I-O-多路复用的应用"><a href="#Redis-中-I-O-多路复用的应用" class="headerlink" title="Redis 中 I&#x2F;O 多路复用的应用"></a>Redis 中 I&#x2F;O 多路复用的应用</h2><p><code>Redis</code> 服务器是一个事件驱动程序，服务器需要处理两类事件：文件事件和时间事件。</p><ul><li>文件事件：<code>Redis</code> 服务器和客户端（或其它服务器）进行通信会产生相应的文件事件，然后服务器通过监听并处理这些事件来完成一系列的通信操作。</li><li>时间事件：<code>Redis</code> 内部的一些在给定时间之内需要进行的操作。</li></ul><p><code>Redis</code> 的文件事件处理器以单线程的方式运行，其内部使用了 <code>I/O</code> 多路复用程序来同时监听多个套接字（<code>Socket</code>）连接，提升了性能的同时又保持了内部单线程设计的简单性。下图就是文件事件处理器的示意图：</p><p><img src="/blog/./assets/PIJFGYQXAAQBY.png" alt="IO多路复用"></p><p><code>I/O</code> 多路复用程序虽然会同时监听多个 <code>Socket</code> 连接，但是其会将监听的 <code>Socket</code> 都放到一个队列里面，然后通过这个队列有序的、同步的将每个 <code>Socket</code> 对应的事件传送给文件事件分派器，再由文件事件分派器分派给对应的事件处理器进行处理，只有当一个 <code>Socket</code> 所对应的事件被处理完毕之后，<code>I/O</code> 多路复用程序才会继续向文件事件分派器传送下一个 <code>Socket</code> 所对应的事件，这也可以验证上面的结论，处理客户端的命令请求是单线程的方式逐个处理，但是事件处理器内并不是只有一个线程。</p><h2 id="Redis线程安全"><a href="#Redis线程安全" class="headerlink" title="Redis线程安全"></a>Redis线程安全</h2><ul><li>redis可以保障内部串行</li><li>业务上要自行保障顺序</li></ul><h2 id="Redis缓存穿透、击穿、雪崩"><a href="#Redis缓存穿透、击穿、雪崩" class="headerlink" title="Redis缓存穿透、击穿、雪崩"></a>Redis缓存穿透、击穿、雪崩</h2><h3 id="缓存穿透"><a href="#缓存穿透" class="headerlink" title="缓存穿透"></a>缓存穿透</h3><p>缓存穿透是指查询一个一定不存在的数据，由于缓存是不命中时被动写的，并且出于容错考虑，如果从存储层查不到数据则不写入缓存，这将导致这个不存在的数据每次请求都要到存储层去查询，失去了缓存的意义。在流量大时，可能DB就挂掉了，要是有人利用不存在的key频繁攻击我们的应用，这就是漏洞。</p><h4 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h4><p>有很多种方法可以有效地解决缓存穿透问题，最常见的则是采用布隆过滤器，将所有可能存在的数据哈希到一个足够大的bitmap中，一个一定不存在的数据会被 这个bitmap拦截掉，从而避免了对底层存储系统的查询压力。另外也有一个更为简单粗暴的方法（我们采用的就是这种），如果一个查询返回的数据为空（不管是数 据不存在，还是系统故障），我们仍然把这个空结果进行缓存，但它的过期时间会很短，最长不超过五分钟。</p><h3 id="缓存击穿"><a href="#缓存击穿" class="headerlink" title="缓存击穿"></a>缓存击穿</h3><p>对于一些设置了过期时间的key，如果这些key可能会在某些时间点被超高并发地访问，是一种非常“热点”的数据。这个时候，需要考虑一个问题：缓存被“击穿”的问题，这个和缓存雪崩的区别在于这里针对某一key缓存，前者则是很多key。<br>缓存在某个时间点过期的时候，恰好在这个时间点对这个Key有大量的并发请求过来，这些请求发现缓存过期一般都会从后端DB加载数据并回设到缓存，这个时候大并发的请求可能会瞬间把后端DB压垮。</p><h4 id="解决方案-1"><a href="#解决方案-1" class="headerlink" title="解决方案"></a>解决方案</h4><p>缓存失效时的雪崩效应对底层系统的冲击非常可怕。大多数系统设计者考虑用加锁或者队列的方式保证缓存的单线 程（进程）写，从而避免失效时大量的并发请求落到底层存储系统上。这里分享一个简单方案就时讲缓存失效时间分散开，比如我们可以在原有的失效时间基础上增加一个随机值，比如1-5分钟随机，这样每一个缓存的过期时间的重复率就会降低，就很难引发集体失效的事件。</p><h3 id="缓存雪崩"><a href="#缓存雪崩" class="headerlink" title="缓存雪崩"></a>缓存雪崩</h3><p>缓存雪崩是指在我们设置缓存时采用了相同的过期时间，导致缓存在某一时刻同时失效，请求全部转发到DB，DB瞬时压力过重雪崩。</p><h4 id="解决方案-2"><a href="#解决方案-2" class="headerlink" title="解决方案"></a>解决方案</h4><ul><li><p>使用互斥锁(mutex key)</p><p>业界比较常用的做法，是使用mutex。简单地来说，就是在缓存失效的时候（判断拿出来的值为空），不是立即去load db，而是先使用缓存工具的某些带成功操作返回值的操作（比如Redis的SETNX或者Memcache的ADD）去set一个mutex key，当操作返回成功时，再进行load db的操作并回设缓存；否则，就重试整个get缓存的方法。</p><p>SETNX，是「SET if Not eXists」的缩写，也就是只有不存在的时候才设置，可以利用它来实现锁的效果。在redis2.6.1之前版本未实现setnx的过期时间</p></li><li><p>“提前”使用互斥锁(mutex key)：</p><p>在value内部设置1个超时值(timeout1), timeout1比实际的memcache timeout(timeout2)小。当从cache读取到timeout1发现它已经过期时候，马上延长timeout1并重新设置到cache。然后再从数据库加载数据并设置到cache中。</p></li><li><p>“永远不过期”：</p><p>这里的“永远不过期”包含两层意思：</p><ul><li>从redis上看，确实没有设置过期时间，这就保证了，不会出现热点key过期问题，也就是“物理”不过期。</li><li>从功能上看，如果不过期，那不就成静态的了吗？所以我们把过期时间存在key对应的value里，如果发现要过期了，通过一个后台的异步线程进行缓存的构建，也就是“逻辑”过期</li></ul></li></ul><p>​从实战看，这种方法对于性能非常友好，唯一不足的就是构建缓存时候，其余线程(非构建缓存的线程)可能访问的是老数据，但是对于一般的互联网功能来说这个还是可以忍受。</p><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><ul><li>穿透：缓存不存在，数据库不存在，高并发，少量key</li><li>击穿：缓存不存在，数据库存在，高并发，少量key</li><li>雪崩：缓存不存在，数据库存在，高并发，大量key</li></ul><blockquote><p>都可以使用限流的互斥锁，保障数据库的稳定</p></blockquote><h2 id="redis事务是怎么实现的"><a href="#redis事务是怎么实现的" class="headerlink" title="redis事务是怎么实现的"></a>redis事务是怎么实现的</h2><p>MULTI 、 EXEC 、 DISCARD 和 WATCH 是 Redis 事务相关的命令。事务可以一次执行多个命令， 并且带有以下两个重要的保证：</p><blockquote><p>事务是一个单独的隔离操作：事务中的所有命令都会序列化、按顺序地执行。事务在执行的过程中，不会被其他客户端发送来的命令请求所打断。<br>事务是一个原子操作：事务中的命令要么全部被执行，要么全部都不执行。</p></blockquote><p>EXEC 命令负责触发并执行事务中的所有命令：</p><blockquote><p>如果客户端在使用 MULTI 开启了一个事务之后，却因为断线而没有成功执行 EXEC ，那么事务中的所有命令都不会被执行。<br>另一方面，如果客户端成功在开启事务之后执行 EXEC ，那么事务中的所有命令都会被执行。</p></blockquote><p>当使用 AOF 方式做持久化的时候， Redis 会使用单个 write(2) 命令将事务写入到磁盘中。</p><p>然而，如果 Redis 服务器因为某些原因被管理员杀死，或者遇上某种硬件故障，那么可能只有部分事务命令会被成功写入到磁盘中。</p><p>如果 Redis 在重新启动时发现 AOF 文件出了这样的问题，那么它会退出，并汇报一个错误。</p><p>使用redis-check-aof程序可以修复这一问题：它会移除 AOF 文件中不完整事务的信息，确保服务器可以顺利启动。</p><p>从 2.2 版本开始，Redis 还可以通过乐观锁（optimistic lock）实现 CAS （check-and-set）操作。</p><h3 id="事务中的错误"><a href="#事务中的错误" class="headerlink" title="事务中的错误"></a>事务中的错误</h3><p>使用事务时可能会遇上以下两种错误：</p><ol><li>事务在执行 EXEC 之前，入队的命令可能会出错。比如说，命令可能会产生语法错误（参数数量错误，参数名错误，等等），或者其他更严重的错误，比如内存不足（如果服务器使用 maxmemory 设置了最大内存限制的话）。</li><li>命令可能在 EXEC 调用之后失败。举个例子，事务中的命令可能处理了错误类型的键，比如将列表命令用在了字符串键上面，诸如此类。</li></ol><p>对于发生在 EXEC 执行之前的错误，客户端以前的做法是检查命令入队所得的返回值：如果命令入队时返回 QUEUED ，那么入队成功；否则，就是入队失败。如果有命令在入队时失败，那么大部分客户端都会停止并取消这个事务。</p><p>不过，从 Redis 2.6.5 开始，服务器会对命令入队失败的情况进行记录，并在客户端调用 EXEC 命令时，拒绝执行并自动放弃这个事务。</p><p>在 Redis 2.6.5 以前， Redis 只执行事务中那些入队成功的命令，而忽略那些入队失败的命令。 而新的处理方式则使得在流水线（pipeline）中包含事务变得简单，因为发送事务和读取事务的回复都只需要和服务器进行一次通讯。</p><p>至于那些在 EXEC 命令执行之后所产生的错误， 并没有对它们进行特别处理： 即使事务中有某个&#x2F;某些命令在执行时产生了错误， 事务中的其他命令仍然会继续执行。</p><h2 id="Redis不支持回滚"><a href="#Redis不支持回滚" class="headerlink" title="Redis不支持回滚"></a>Redis不支持回滚</h2><blockquote><p>Redis 在事务失败时不进行回滚，而是继续执行余下的命令。</p></blockquote><ul><li>Redis 命令只会因为错误的语法而失败（并且这些问题不能在入队时发现），或是命令用在了错误类型的键上面：这也就是说，从实用性的角度来说，失败的命令是由编程错误造成的，而这些错误应该在开发的过程中被发现，而不应该出现在生产环境中。</li><li>因为不需要对回滚进行支持，所以 Redis 的内部可以保持简单且快速。</li></ul><p>在通常情况下， 回滚并不能解决编程错误带来的问题。 </p><p>举个例子， 如果你本来想通过 INCR 命令将键的值加上 1 ， 却不小心加上了 2。又或者对错误类型的键执行了 INCR ， 回滚是没有办法处理这些情况的。</p><h2 id="redis集群方案"><a href="#redis集群方案" class="headerlink" title="redis集群方案"></a>redis集群方案</h2><ul><li>主从复制集群<ul><li>主从复制集群，手动切换</li><li>带有哨兵的HA的主从复制集群</li></ul></li><li>分片集群<ul><li>客户端实现路由索引的分片集群</li><li>使用中间件代理层的分片集群</li><li>redis自身实现的cluster分片集群</li></ul></li></ul><h2 id="redis主从复制的原理"><a href="#redis主从复制的原理" class="headerlink" title="redis主从复制的原理"></a>redis主从复制的原理</h2><h3 id="主从复制机制"><a href="#主从复制机制" class="headerlink" title="主从复制机制"></a>主从复制机制</h3><p>当一个 master 实例和一个 slave 实例连接正常时， master 会发送一连串的命令流来保持对 slave的更新，以便于将自身数据集的改变复制给 slave ， ：包括客户端的写入、key 的过期或被逐出等等。<br>当 master 和 slave 之间的连接断开之后，因为网络问题、或者是主从意识到连接超时， slave 重新连接上 master 并会尝试进行部分重同步：这意味着它会尝试只获取在断开连接期间内丢失的命令流。<br>当无法进行部分重同步时， slave 会请求进行全量重同步。这会涉及到一个更复杂的过程，例如 master需要创建所有数据的快照，将之发送给 slave ，之后在数据集更改时持续发送命令流到 slave 。</p><h3 id="主从复制的关注点"><a href="#主从复制的关注点" class="headerlink" title="主从复制的关注点"></a>主从复制的关注点</h3><p>Redis 使用异步复制，slave 和 master 之间异步地确认处理的数据量<br>一个 master 可以拥有多个 slave<br>slave 可以接受其他 slave 的连接。除了多个 slave 可以连接到同一个 master 之外， slave 之间也可以像层叠状的结构（cascading like structure）连接到其他 slave 。自 Redis 4.0 起，所有的 sub slave 将会从 master 收到完全一样的复制流。<br>Redis 复制在 master 侧是非阻塞的。这意味着 master 在一个或多个 slave 进行初次同步或者是部分重同步时，可以继续处理查询请求。<br>复制在 slave 侧大部分也是非阻塞的。当 slave 进行初次同步时，它可以使用旧数据集处理查询请求，假设你在 redis.conf 中配置了让 Redis 这样做的话。否则，你可以配置如果复制流断开， Redis slave会返回一个 error 给客户端。但是，在初次同步之后，旧数据集必须被删除，同时加载新的数据集。<br>slave 在这个短暂的时间窗口内（如果数据集很大，会持续较长时间），会阻塞到来的连接请求。自 Redis4.0 开始，可以配置 Redis 使删除旧数据集的操作在另一个不同的线程中进行，但是，加载新数据集的操作依然需要在主线程中进行并且会阻塞 slave 。<br>复制既可以被用在可伸缩性，以便只读查询可以有多个 slave 进行（例如 O(N) 复杂度的慢操作可以被下放到 slave ），或者仅用于数据安全。</p><p>可以使用复制来避免 master 将全部数据集写入磁盘造成的开销：一种典型的技术是配置你的 masterRedis.conf 以避免对磁盘进行持久化，然后连接一个 slave ，其配置为不定期保存或是启用 AOF。但是，这个设置必须小心处理，因为重新启动的 master 程序将从一个空数据集开始：如果一个 slave 试图与它同步，那么这个 slave 也会被清空。<br>任何时候数据安全性都是很重要的，所以如果 master 使用复制功能的同时未配置持久化，那么自动重启进程这项应该被禁用。</p><h2 id="Redis-复制功能"><a href="#Redis-复制功能" class="headerlink" title="Redis 复制功能"></a>Redis 复制功能</h2><p>每一个 Redis master 都有一个 replication ID ：这是一个较大的伪随机字符串，标记了一个给定的数据集。每个 master 也持有一个偏移量，master 将自己产生的复制流发送给 slave 时，发送多少个字节的数据，自身的偏移量就会增加多少，目的是当有新的操作修改自己的数据集时，它可以以此更新 slave的状态。复制偏移量即使在没有一个 slave 连接到 master 时，也会自增，所以基本上每一对给定的</p><blockquote><p>Replication ID, offset</p></blockquote><p>都会标识一个 master 数据集的确切版本。<br>当 slave 连接到 master 时，它们使用 PSYNC 命令来发送它们记录的旧的 master replication ID 和它们至今为止处理的偏移量。通过这种方式， master 能够仅发送 slave 所需的增量部分。但是如果 master的缓冲区中没有足够的命令积压缓冲记录，或者如果 slave 引用了不再知道的历史记录（replication<br>ID），则会转而进行一个全量重同步：在这种情况下， slave 会得到一个完整的数据集副本，从头开始。<br>下面是一个全量同步的工作细节：<br>master 开启一个后台保存进程，以便于生产一个 RDB 文件。同时它开始缓冲所有从客户端接收到的新的写入命令。当后台保存完成时， master 将数据集文件传输给 slave， slave将之保存在磁盘上，然后加载文件到内存。再然后 master 会发送所有缓冲的命令发给 slav e。这个过程以指令流的形式完成并且和 Redis 协议本身的格式相同。<br>你可以用 telnet 自己进行尝试。在服务器正在做一些工作的同时连接到 Redis 端口并发出 SYNC 命令。你将会看到一个批量传输，并且之后每一个 master 接收到的命令都将在 telnet 回话中被重新发出。事实上 SYNC 是一个旧协议，在新的 Redis 实例中已经不再被使用，但是其仍然向后兼容：但它不允许部分重同步，所以现在 PSYNC 被用来替代 SYNC。<br>之前说过，当主从之间的连接因为一些原因崩溃之后， slave 能够自动重连。如果 master 收到了多个slave 要求同步的请求，它会执行一个单独的后台保存，以便于为多个 slave 服务。</p><h3 id="无需磁盘参与的复制"><a href="#无需磁盘参与的复制" class="headerlink" title="无需磁盘参与的复制"></a>无需磁盘参与的复制</h3><p>正常情况下，一个全量重同步要求在磁盘上创建一个 RDB 文件，然后将它从磁盘加载进内存，然后slave以此进行数据同步。<br>如果磁盘性能很低的话，这对 master 是一个压力很大的操作。Redis 2.8.18 是第一个支持无磁盘复制的版本。在此设置中，子进程直接发送 RDB 文件给 slave，无需使用磁盘作为中间储存介质。</p><h2 id="Redis删除过期key策略"><a href="#Redis删除过期key策略" class="headerlink" title="Redis删除过期key策略"></a>Redis删除过期key策略</h2><h3 id="过期精度"><a href="#过期精度" class="headerlink" title="过期精度"></a>过期精度</h3><p>在 Redis 2.4 及以前版本，过期期时间有0-1秒的误差。从 Redis 2.6 起，过期时间误差缩小到0-1毫秒。</p><h3 id="过期和持久"><a href="#过期和持久" class="headerlink" title="过期和持久"></a>过期和持久</h3><ul><li>Keys的过期时间使用Unix时间戳存储(从Redis 2.6开始以毫秒为单位)。这意味着即使Redis实例不可用，时间也是一直在流逝的。</li><li>要想过期的工作处理好，计算机必须采用稳定的时间。 如果你将RDB文件在两台时钟不同步的电脑间同步，有趣的事会发生（所有的 keys装载时就会过期）。</li><li>即使正在运行的实例也会检查计算机的时钟，例如如果你设置了一个key的有效期是1000秒，然后设置你的计算机时间为未来2000秒，这时key会立即失效，而不是等1000秒之后。</li></ul><h3 id=""><a href="#" class="headerlink" title=""></a></h3><h3 id="淘汰策略"><a href="#淘汰策略" class="headerlink" title="淘汰策略"></a>淘汰策略</h3><p>Redis keys过期有两种方式</p><h4 id="被动式"><a href="#被动式" class="headerlink" title="被动式"></a>被动式</h4><p>程序或手动delete</p><h4 id="主动式"><a href="#主动式" class="headerlink" title="主动式"></a>主动式</h4><p>当一些客户端尝试访问它时，key会被发现并主动的过期。<br>当然，这样是不够的，因为有些过期的keys，永远不会访问他们。 无论如何，这些keys应该过期，所以定时随机测试设置keys的过期时间。所有这些过期的keys将会从密钥空间删除。<br>具体就是Redis每秒10次做的事情：</p><ol><li>测试随机的20个keys进行相关过期检测。</li><li>删除所有已经过期的keys。</li><li>如果有多于25%的keys过期，重复步奏1</li></ol><p>不断重复过期检测，直到过期的keys的百分百低于25%,这意味着，在任何给定的时刻，最多会清除25%的过期keys。</p><h3 id="在复制AOF文件时如何处理过期"><a href="#在复制AOF文件时如何处理过期" class="headerlink" title="在复制AOF文件时如何处理过期"></a>在复制AOF文件时如何处理过期</h3><p>为了获得正确的行为而不牺牲一致性，当一个key过期， DEL 将会随着AOF文字一起合成到所有附加的slaves。在master实例中，这种方法是集中的，并且不存在一致性错误的机会。<br>然而，当slaves连接到master时，不会独立过期keys（会等到master执行DEL命令），他们任然会在数据集里面存在，所以当slave当选为master时淘汰keys会独立执行，然后成为master。</p><h3 id="扩展"><a href="#扩展" class="headerlink" title="扩展"></a>扩展</h3><p>绝对时间点过期<br>相对时间点过期<br>时钟轮算法</p><h2 id="回收策略"><a href="#回收策略" class="headerlink" title="回收策略"></a>回收策略</h2><ul><li>noeviction:返回错误当内存限制达到并且客户端尝试执行会让更多内存被使用的命令（大部分的写入指令，但DEL和几个例外）</li><li>allkeys lru: 尝试回收最少使用的键（LRU），使得新添加的数据有空间存放。</li><li>volatile lru: 尝试回收最少使用的键（LRU），但仅限于在过期集合的键,使得新添加的数据有空间存放。</li><li>allkeys random: 回收随机的键使得新添加的数据有空间存放。</li><li>volatile random: 回收随机的键使得新添加的数据有空间存放，但仅限于在过期集合的键。</li><li>volatile ttl: 回收在过期集合的键，并且优先回收存活时间（TTL）较短的键,使得新添加的数据有空间存放。</li><li>volatile lfu：从所有配置了过期时间的键中驱逐使用频率最少的键</li><li>allkeys lfu：从所有键中驱逐使用频率最少的键</li></ul><p>如果没有键满足回收的前提条件的话，策略volatile-lru, volatile-random以及volatile-ttl就和noeviction 差不多了。</p><p>选择正确的回收策略是非常重要的，这取决于你的应用的访问模式，不过你可以在运行时进行相关的策略调整，并且监控缓存命中率和没命中的次数，通过RedisINFO命令输出以便调优。</p><p>一般的经验规则:</p><ul><li>使用allkeys-lru策略：当你希望你的请求符合一个幂定律分布，也就是说，你希望部分的子集元素将比其它其它元素被访问的更多。如果你不确定选择什么，这是个很好的选择。.</li><li>使用allkeys-random：如果你是循环访问，所有的键被连续的扫描，或者你希望请求分布正常（所有元素被访问的概率都差不多）。</li><li>使用volatile-ttl：如果你想要通过创建缓存对象时设置TTL值，来决定哪些对象应该被过期。</li></ul><p>allkeys-lru 和 volatile-random策略对于当你想要单一的实例实现缓存及持久化一些键时很有用。不过一般运行两个实例是解决这个问题的更好方法。</p><p>为了键设置过期时间也是需要消耗内存的，所以使用allkeys-lru这种策略更加高效，因为没有必要为键取设置过期时间当内存有压力时。</p><h3 id="回收进程如何工作"><a href="#回收进程如何工作" class="headerlink" title="回收进程如何工作"></a>回收进程如何工作</h3><ul><li>一个客户端运行了新的命令，添加了新的数据。</li><li>Redis检查内存使用情况，如果大于maxmemory的限制, 则根据设定好的策略进行回收。</li><li>一个新的命令被执行等。</li><li>不断地穿越内存限制的边界，通过不断达到边界然后不断地回收回到边界以下。</li></ul><p>如果一个命令的结果导致大量内存被使用（例如很大的集合的交集保存到一个新的键），不用多久内存限制就会被这个内存使用量超越。</p><h2 id="Redis缓存预热"><a href="#Redis缓存预热" class="headerlink" title="Redis缓存预热"></a>Redis缓存预热</h2><ul><li>提前把数据塞入redis</li><li>开发逻辑上也要规避差集(没缓存的),会造成击穿,穿透,雪崩</li></ul><h2 id="数据库与缓存不一致问题"><a href="#数据库与缓存不一致问题" class="headerlink" title="数据库与缓存不一致问题"></a>数据库与缓存不一致问题</h2><p>redis和mysql,只有只读的时候，肯定不存在数据不一致的问题。只有同时存在读写并且是并行的场景下会存在读写不一致。</p><p>缓存更新推荐使用删除而不是修改，因为逻辑比较简单。</p><h3 id="先修改数据库，再删除缓存"><a href="#先修改数据库，再删除缓存" class="headerlink" title="先修改数据库，再删除缓存"></a>先修改数据库，再删除缓存</h3><p>需要考虑删除缓存失败的重试机制。</p><h3 id="先删除缓存，再修改数据库"><a href="#先删除缓存，再修改数据库" class="headerlink" title="先删除缓存，再修改数据库"></a>先删除缓存，再修改数据库</h3><p>会存在线程T1删除了redis缓存，在更新数据库的时候由于网络延迟;线程T2进来先查询缓存，查询不到，会从mysql查询到旧数据并放入缓存。<br>此时线程T1再把数据库的数据修改了。数据库里的是新数据。导致redis和数据库的数据不一致。</p><p>解决：使用延时双删。线程T1增加一步2次删除缓存的操作。</p><p>即：删除缓存–&gt;更新数据库–&gt;再次删除缓存。</p><p>这样只会存在更新数据库和再次删除缓存之间的数据不一致，之后的数据都是一致的。</p><blockquote><p>注意: 第2次删除要设置延迟时间，比如500ms（这个根据实际业务分析），防止线程2先从数据库查询到旧数据，然后线程T1第2次删除的时候，被线程2的旧数据给覆盖了。</p></blockquote><p>不管是先操作数据库还是先操作缓存，都会存在数据不一致的问题。</p><p>因为redis和数据库之间的操作不是原子性的。要保证原子性只能上锁，但这会影响系统的吞吐量，违背的使用redis是提高系统的性能。</p><p>所以一般只保证最终一致性，而不是强一致性。AP和CP只能保证一种，这个需要取舍。</p><p>当然最终一致性也存在删除缓存失败的场景，这个可以利用MQ异步重试机制去删除。</p><h2 id="Redis主从不一致"><a href="#Redis主从不一致" class="headerlink" title="Redis主从不一致"></a>Redis主从不一致</h2><ul><li>Redis的确默认时弱一致性,异步的同步</li><li>锁不能用主从(单实例&#x2F;分片集群&#x2F;redlock)<ul><li>解决：redisson</li></ul></li><li>redis配置中配置同步因子(同步比例）,趋向于强一致性（违背redis的ap）</li><li>wait（违背redis的ap）</li></ul><h2 id="Redis持久化原理"><a href="#Redis持久化原理" class="headerlink" title="Redis持久化原理"></a>Redis持久化原理</h2><ul><li>异步线程知识点</li><li>计算机组成原理</li><li>fork</li><li>copy on write</li><li>系统IO</li><li>pagecache</li><li>fsync</li></ul><h2 id="redis持久化方式"><a href="#redis持久化方式" class="headerlink" title="redis持久化方式"></a>redis持久化方式</h2><ul><li>RDB持久化<ul><li>能够在指定的时间间隔能对你的数据进行快照存储.</li></ul></li><li>AOF持久化<ul><li>记录每次对服务器写的操作,当服务器重启的时候会重新执行这些命令来恢复原始的数据,AOF命令以redis协议追加保存每次写的操作到文件末尾.Redis还能对AOF文件进行后台重写,使得AOF文件的体积不至于过大.</li></ul></li><li>如果只希望你的数据在服务器运行的时候存在,你也可以不使用任何持久化方式.</li><li>也可以同时开启两种持久化方式, 在这种情况下, 当redis重启的时候会优先载入AOF文件来恢复原始的数据,因为在通常情况下AOF文件保存的数据集要比RDB文件保存的数据集要完整.</li></ul><h3 id="RDB和AOF持久化方式的不同"><a href="#RDB和AOF持久化方式的不同" class="headerlink" title="RDB和AOF持久化方式的不同"></a>RDB和AOF持久化方式的不同</h3><h4 id="RDB的优点"><a href="#RDB的优点" class="headerlink" title="RDB的优点"></a>RDB的优点</h4><ul><li>RDB是一个非常紧凑的文件,它保存了某个时间点得数据集,非常适用于数据集的备份,比如你可以在每个小时报保存一下过去24小时内的数据,同时每天保存过去30天的数据,这样即使出了问题你也可以根据需求恢复到不同版本的数据集.</li><li>RDB是一个紧凑的单一文件,很方便传送到另一个远端数据中心或者亚马逊的S3（可能加密），非常适用于灾难恢复.</li><li>RDB在保存RDB文件时父进程唯一需要做的就是fork出一个子进程,接下来的工作全部由子进程来做，父进程不需要再做其他IO操作，所以RDB持久化方式可以最大化redis的性能.</li><li>与AOF相比,在恢复大的数据集的时候，RDB方式会更快一些.</li></ul><h4 id="RDB的缺点"><a href="#RDB的缺点" class="headerlink" title="RDB的缺点"></a>RDB的缺点</h4><ul><li>如果你希望在redis意外停止工作（例如电源中断）的情况下丢失的数据最少的话，那么RDB不适合你.虽然你可以配置不同的save时间点(例如每隔5分钟并且对数据集有100个写的操作),是Redis要完整的保存整个数据集是一个比较繁重的工作,你通常会每隔5分钟或者更久做一次完整的保存,万一在Redis意外宕机,你可能会丢失几分钟的数据.</li><li>RDB 需要经常fork子进程来保存数据集到硬盘上,当数据集比较大的时候,fork的过程是非常耗时的,可能会导致Redis在一些毫秒级内不能响应客户端的请求.如果数据集巨大并且CPU性能不是很好的情况下,这种情况会持续1秒,AOF也需要fork,但是你可以调节重写日志文件的频率来提高数据集的耐久度.</li></ul><h4 id="AOF-优点"><a href="#AOF-优点" class="headerlink" title="AOF 优点"></a>AOF 优点</h4><ul><li>使用AOF 会让你的Redis更加耐久: 你可以使用不同的fsync策略：无fsync,每秒fsync,每次写的时候fsync.使用默认的每秒fsync策略,Redis的性能依然很好(fsync是由后台线程进行处理的,主线程会尽力处理客户端请求),一旦出现故障，你最多丢失1秒的数据.</li><li>AOF文件是一个只进行追加的日志文件,所以不需要写入seek,即使由于某些原因(磁盘空间已满，写的过程中宕机等等)未执行完整的写入命令,你也也可使用redis-check-aof工具修复这些问题.</li><li>Redis 可以在 AOF 文件体积变得过大时，自动地在后台对 AOF 进行重写： 重写后的新 AOF 文件包含了恢复当前数据集所需的最小命令集合。 整个重写操作是绝对安全的，因为 Redis 在创建新AOF 文件的过程中，会继续将命令追加到现有的 AOF 文件里面，即使重写过程中发生停机，现有的 AOF 文件也不会丢失。 而一旦新 AOF 文件创建完毕，Redis 就会从旧 AOF 文件切换到新 AOF文件，并开始对新 AOF 文件进行追加操作。</li><li>AOF 文件有序地保存了对数据库执行的所有写入操作， 这些写入操作以 Redis 协议的格式保存，因此 AOF 文件的内容非常容易被人读懂， 对文件进行分析（parse）也很轻松。 导出（export）AOF 文件也非常简单： 举个例子， 如果你不小心执行了 FLUSHALL 命令， 但只要 AOF 文件未被重写， 那么只要停止服务器， 移除 AOF 文件末尾的 FLUSHALL 命令， 并重启 Redis ， 就可以将数据集恢复到 FLUSHALL 执行之前的状态。</li></ul><h4 id="AOF-缺点"><a href="#AOF-缺点" class="headerlink" title="AOF 缺点"></a>AOF 缺点</h4><ul><li>对于相同的数据集来说，AOF 文件的体积通常要大于 RDB 文件的体积。</li><li>根据所使用的 fsync 策略，AOF 的速度可能会慢于 RDB 。 在一般情况下， 每秒 fsync 的性能依然非常高， 而关闭 fsync 可以让 AOF 的速度和 RDB 一样快， 即使在高负荷之下也是如此。 不过在处理巨大的写入载入时，RDB 可以提供更有保证的最大延迟时间（latency）。</li></ul><h3 id="4-X版本的整合策略"><a href="#4-X版本的整合策略" class="headerlink" title="4.X版本的整合策略"></a>4.X版本的整合策略</h3><ul><li>在AOF重写策略上做了优化</li><li>在重写AOF文件时，4.x版本以前是把内存数据集的操作指令落地，而新版本是把内存的数据集以rdb的形式落地</li><li>这样重写后的AOF依然追加的是日志，但是，在恢复的时候是先rdb再增量的日志，性能更优秀</li></ul><h2 id="Redis分布式锁命令"><a href="#Redis分布式锁命令" class="headerlink" title="Redis分布式锁命令"></a>Redis分布式锁命令</h2><p>SETNX<br>格式：setnx key value 将 key 的值设为 value ，当且仅当 key 不存在。若给定的 key 已经存在，则 SETNX 不做任何动作,操作失败。<br>SETNX 是『SET if Not eXists』(如果不存在，则 SET)的简写。<br>加锁：set key value nx ex 10s<br>释放锁：delete key</p><h2 id="Redis如何做分布式锁"><a href="#Redis如何做分布式锁" class="headerlink" title="Redis如何做分布式锁"></a>Redis如何做分布式锁</h2><p>假设有两个服务A、B都希望获得锁，执行过程大致如下:</p><ol><li>服务A为了获得锁，向Redis发起如下命令: SET productId:lock 0xx9p03001 NX EX 30000 其中，”productId”由自己定义，可以是与本次业务有关的id，”0xx9p03001”是一串随机值，必须保证全局唯一，“NX”指的是当且仅当key(也就是”productId:lock”)在Redis中不存在时，返回执行成功，否则执行失败。”EX 30000”指的是在30秒后，key将被自动删除。执行命令后返回成功，表明服务成功的获得了锁。</li><li>服务B为了获得锁，向Redis发起同样的命令: SET productId:lock 0000111 NX EX 30000。由于Redis内已经存在同名key，且并未过期，因此命令执行失败，服务B未能获得锁。服务B进入循环请求状态，比如每隔1秒钟(自行设置)向Redis发送请求，直到执行成功并获得锁。</li><li>服务A的业务代码执行时长超过了30秒，导致key超时，因此Redis自动删除了key。此时服务B再次发送命令执行成功，假设本次请求中设置的value值为0000222。此时需要在服务A中对key进行续期。</li><li>服务A执行完毕，为了释放锁，服务A会主动向Redis发起删除key的请求。注意: 在删除key之前，一定要判断服务A持有的value与Redis内存储的value是否一致。比如当前场景下，Redis中的锁早就不是服务A持有的那一把了，而是由服务2创建，如果贸然使用服务A持有的key来删除锁，则会误将服务2的锁释放掉。此外，由于删除锁时涉及到一系列判断逻辑，因此一般使用lua脚本，具体如下:</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">if</span> redis.call(<span class="hljs-string">&quot;get&quot;</span>, KEYS[<span class="hljs-number">1</span>])==ARGV[<span class="hljs-number">1</span>] then<br>    <span class="hljs-keyword">return</span> redis.call(<span class="hljs-string">&quot;del&quot;</span>, KEYS[<span class="hljs-number">1</span>])<br>    <span class="hljs-keyword">else</span><br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>end<br></code></pre></td></tr></table></figure><h2 id="Redis分布式锁死锁场景"><a href="#Redis分布式锁死锁场景" class="headerlink" title="Redis分布式锁死锁场景"></a>Redis分布式锁死锁场景</h2><ul><li>加锁，没有释放锁。需要加释放锁的操作。比如delete key。</li><li>加锁后，程序还没有执行释放锁，程序挂了。需要用的key的过期机制。</li></ul><p>（完）</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>Redis</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Redis</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>分布式系统下保障请求的执行顺序</title>
    <link href="/blog/2020/11/%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E4%B8%8B%E4%BF%9D%E9%9A%9C%E8%AF%B7%E6%B1%82%E7%9A%84%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F.html"/>
    <url>/blog/2020/11/%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E4%B8%8B%E4%BF%9D%E9%9A%9C%E8%AF%B7%E6%B1%82%E7%9A%84%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F.html</url>
    
    <content type="html"><![CDATA[<h2 id="前端保障"><a href="#前端保障" class="headerlink" title="前端保障"></a>前端保障</h2><ul><li>防抖</li><li>节流</li></ul><h2 id="后端保障"><a href="#后端保障" class="headerlink" title="后端保障"></a>后端保障</h2><ul><li>分布式锁<ul><li>redis的分布式锁</li><li>zookeeper的分布式锁</li></ul></li><li>dubbo 的一致性 hash 负载均衡策略</li></ul><p>（相同类型的数据Mod到同一个机器上），然后在使用内存队(例如：redis队列)<br>业务保证幂等性</p><ul><li>缓存控制</li></ul><p>redis插入set,下次支付前先判断是否存在。</p><h2 id="数据库保障"><a href="#数据库保障" class="headerlink" title="数据库保障"></a>数据库保障</h2><ul><li>数据库的乐观锁</li></ul><p>（完）</p>]]></content>
    
    
    <categories>
      
      <category>工作</category>
      
      <category>业务架构</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>电商系统</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>大型电商系统的搜索链路业务架构</title>
    <link href="/blog/2020/11/%E5%A4%A7%E5%9E%8B%E7%94%B5%E5%95%86%E7%B3%BB%E7%BB%9F%E7%9A%84%E6%90%9C%E7%B4%A2%E9%93%BE%E8%B7%AF%E4%B8%9A%E5%8A%A1%E6%9E%B6%E6%9E%84.html"/>
    <url>/blog/2020/11/%E5%A4%A7%E5%9E%8B%E7%94%B5%E5%95%86%E7%B3%BB%E7%BB%9F%E7%9A%84%E6%90%9C%E7%B4%A2%E9%93%BE%E8%B7%AF%E4%B8%9A%E5%8A%A1%E6%9E%B6%E6%9E%84.html</url>
    
    <content type="html"><![CDATA[<h2 id="大型电商系统的搜索链路业务架构"><a href="#大型电商系统的搜索链路业务架构" class="headerlink" title="大型电商系统的搜索链路业务架构"></a>大型电商系统的搜索链路业务架构</h2><pre><code class=" mermaid">graph关键词搜索--&gt;李宁冬动运鞋--敏感词、表情符过滤--&gt;搜索词重写--&gt;纠错--李宁冬季运动鞋--&gt;NLP处理--组装搜索造句--&gt;搜索引擎--&gt;是否有结果--&gt;YES--&gt;综合排序--&gt;返回结果是否有结果--&gt;NO--&gt;是否经过丢词处理--&gt;是--&gt;返回猜你喜欢是否经过丢词处理--&gt;否--&gt;搜索引擎纠错--&gt;类目预测--辅助排序--&gt;搜索引擎关键词搜索--&gt;经纬度--辅助排序--&gt;搜索引擎关键词搜索--&gt;用户特征获取--辅助排序--&gt;搜索引擎</code></pre><p>其中，在步骤<strong>NLP处理</strong>中，将搜索关键字转化处理类似的内容：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;brand&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;李宁&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;brandSynonyms&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">[</span><span class="hljs-string">&quot;erke&quot;</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;category&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;鞋&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;categorySynoyms&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">[</span><span class="hljs-string">&quot;鞋子&quot;</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;normalTerms&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">[</span><br>        <span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-attr">&quot;term&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;秋季&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;termSynonyms&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">[</span><span class="hljs-string">&quot;秋天&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;秋&quot;</span><span class="hljs-punctuation">]</span><br>        <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-attr">&quot;term&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;运动&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;termSynonyms&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">[</span><span class="hljs-string">&quot;跑步&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;运动款&quot;</span><span class="hljs-punctuation">]</span><br>        <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-punctuation">]</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>在步骤<strong>综合排序</strong>中，根据以下算法项进行综合排序：</p><ul><li>文本相关性</li><li>品牌命中</li><li>类名命中</li><li>店铺评分</li><li>用户特征</li><li>类目预测</li><li>流量倾斜</li><li>距离</li><li>其他</li></ul><p>（完）</p>]]></content>
    
    
    <categories>
      
      <category>工作</category>
      
      <category>业务架构</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>电商系统</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>衡量软件测试效率的方法和实践</title>
    <link href="/blog/2020/11/%E8%A1%A1%E9%87%8F%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95%E6%95%88%E7%8E%87%E7%9A%84%E6%96%B9%E6%B3%95%E5%92%8C%E5%AE%9E%E8%B7%B5.html"/>
    <url>/blog/2020/11/%E8%A1%A1%E9%87%8F%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95%E6%95%88%E7%8E%87%E7%9A%84%E6%96%B9%E6%B3%95%E5%92%8C%E5%AE%9E%E8%B7%B5.html</url>
    
    <content type="html"><![CDATA[<ul><li>测试设计中工作效率：文档产出率、用例产出率。</li><li>测试设计中工作质量：需求覆盖率、文档质量、文档有效率、用例有效率、评审问题数。</li><li>测试执行中工作效率：执行效率、进度偏离度、缺陷发现率。</li><li>测试执行中工作质量：缺陷数、有效缺陷数&#x2F;率、严重缺陷率、模块缺陷率、遗漏缺陷率、BUG发现的时间点、缺陷定位和可读性。</li></ul><p>（完）</p>]]></content>
    
    
    <categories>
      
      <category>工作</category>
      
      <category>编程思想</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>电商系统</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>软件工程专有名词中英文对照</title>
    <link href="/blog/2020/06/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B%E4%B8%93%E6%9C%89%E5%90%8D%E8%AF%8D%E4%B8%AD%E8%8B%B1%E6%96%87%E5%AF%B9%E7%85%A7.html"/>
    <url>/blog/2020/06/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B%E4%B8%93%E6%9C%89%E5%90%8D%E8%AF%8D%E4%B8%AD%E8%8B%B1%E6%96%87%E5%AF%B9%E7%85%A7.html</url>
    
    <content type="html"><![CDATA[<h2 id="软件测试"><a href="#软件测试" class="headerlink" title="软件测试"></a>软件测试</h2><table><thead><tr><th>中文</th><th>英文</th></tr></thead><tbody><tr><td>软件测试</td><td>Software Testing</td></tr><tr><td>黑盒测试</td><td>Black-box Testing</td></tr><tr><td>白盒测试</td><td>White-box Testing</td></tr><tr><td>手工测试</td><td>Manual Testing</td></tr><tr><td>自动化测试</td><td>Automated Testing</td></tr><tr><td>单元测试</td><td>Component Testing&#x2F;Unit Testing</td></tr><tr><td>集成测试</td><td>Integration Testing</td></tr><tr><td>系统测试</td><td>System Testing</td></tr><tr><td>验收测试</td><td>Acceptance Testing</td></tr><tr><td>FLURPS</td><td>Function（功能）、Localization（局域化）、Usability（可用性）、Reliability（可靠性）、Performance（性能）、Support（支持）</td></tr><tr><td>桩</td><td>Stub</td></tr><tr><td>驱动器</td><td>Driver</td></tr><tr><td>功能测试</td><td>Functional Testing&#x2F;Behavioral Testing</td></tr><tr><td>性能测试</td><td>Performance Testing</td></tr><tr><td>负载测试</td><td>Load Testing</td></tr><tr><td>压力测试</td><td>Stress Testing</td></tr><tr><td>可靠性测试</td><td>Reliability Testing</td></tr><tr><td>可用性测试</td><td>Usability Testing</td></tr><tr><td>可维护性测试</td><td>Maintainability Testing</td></tr><tr><td>可移植性测试</td><td>Portability Testing</td></tr><tr><td>兼容性测试</td><td>Compatibility Testing</td></tr><tr><td>安全性测试</td><td>Security Testing</td></tr><tr><td>本地化测试</td><td>Localizability Testing</td></tr><tr><td>配置测试</td><td>Configuration Testing</td></tr><tr><td>静态测试</td><td>Static Testing</td></tr><tr><td>动态测试</td><td>Dynamic Testing</td></tr><tr><td>确认测试</td><td>Confirmation Testing</td></tr><tr><td>回归测试</td><td>Regression Testing</td></tr><tr><td>冒烟测试</td><td>Smoke Testing</td></tr><tr><td>探索性测试</td><td>Exploratory Testing</td></tr><tr><td>随机测试</td><td>Ad-hoc Testing</td></tr><tr><td>敏捷开发</td><td>Scrum</td></tr></tbody></table><p>（完）</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>英语</category>
      
    </categories>
    
    
    <tags>
      
      <tag>英语</tag>
      
      <tag>专有名词</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>银行业务专有名词中英文对照</title>
    <link href="/blog/2020/06/%E9%93%B6%E8%A1%8C%E4%B8%9A%E5%8A%A1%E4%B8%93%E6%9C%89%E5%90%8D%E8%AF%8D%E4%B8%AD%E8%8B%B1%E6%96%87%E5%AF%B9%E7%85%A7.html"/>
    <url>/blog/2020/06/%E9%93%B6%E8%A1%8C%E4%B8%9A%E5%8A%A1%E4%B8%93%E6%9C%89%E5%90%8D%E8%AF%8D%E4%B8%AD%E8%8B%B1%E6%96%87%E5%AF%B9%E7%85%A7.html</url>
    
    <content type="html"><![CDATA[<h2 id="银行业务专有名称"><a href="#银行业务专有名称" class="headerlink" title="银行业务专有名称"></a>银行业务专有名称</h2><table><thead><tr><th>英文</th><th>中文</th></tr></thead><tbody><tr><td>acquiring company</td><td>收购公司</td></tr><tr><td>bad loan</td><td>呆帐</td></tr><tr><td>chart of cash flow</td><td>现金流量表</td></tr><tr><td>clearly-established ownership</td><td>产权清晰</td></tr><tr><td>debt to equity</td><td>债转股</td></tr><tr><td>diversity of equities</td><td>股权多元化</td></tr><tr><td>economy of scale</td><td>规模经济</td></tr><tr><td>emerging economies</td><td>新兴经济</td></tr><tr><td>exchange-rate regime</td><td>汇率机制</td></tr><tr><td>fund and financing</td><td>筹资融资</td></tr><tr><td>global financial architecture</td><td>全球金融体系</td></tr><tr><td>global integration, globality</td><td>全球一体化，全球化</td></tr><tr><td>go public</td><td>上市</td></tr><tr><td>growth spurt</td><td>（经济的）急剧增长</td></tr><tr><td>have one’s ‘two commas</td><td>百万富翁</td></tr><tr><td>hedge against</td><td>套期保值</td></tr><tr><td>housing mortgage</td><td>住房按揭</td></tr><tr><td>holdings</td><td>控股，所持股份</td></tr><tr><td>holding company</td><td>控股公司</td></tr><tr><td>initial offerings</td><td>原始股</td></tr><tr><td>initial public offerings</td><td>首次公募</td></tr><tr><td>innovative business</td><td>创新企业</td></tr><tr><td>intellectual capital</td><td>智力资本</td></tr><tr><td>inter-bank lending</td><td>拆借</td></tr><tr><td>internet customer</td><td>网上客户</td></tr><tr><td>investment payoff period</td><td>投资回收期</td></tr><tr><td>joint-stock</td><td>参股</td></tr><tr><td>mall rat</td><td>爱逛商店的年轻人</td></tr><tr><td>means of production</td><td>生产要素</td></tr><tr><td>(the)medical cost social pool for major diseases</td><td>大病医疗费用社会统筹</td></tr><tr><td>mergers and acquisitions</td><td>并购</td></tr><tr><td>mobile-phone banking</td><td>移动电话银行业</td></tr><tr><td>moods</td><td>人气</td></tr><tr><td>net potato</td><td>网虫</td></tr><tr><td>non-store seling</td><td>直销</td></tr><tr><td>offering</td><td>新股</td></tr><tr><td>online-banking</td><td>网上银行业</td></tr><tr><td>online-finance</td><td>在线金融</td></tr><tr><td>online client</td><td>（银行的）网上客户</td></tr><tr><td>paper profit</td><td>帐面收益</td></tr><tr><td>physical assets</td><td>有形资产</td></tr><tr><td>project fund system</td><td>项目资本金制度</td></tr><tr><td>pyramid sale</td><td>传销</td></tr><tr><td>recapitalize</td><td>资产重组</td></tr><tr><td>regional corrency blocks</td><td>地区货币集团</td></tr><tr><td>regulate</td><td>调控</td></tr><tr><td>sell off</td><td>变现</td></tr><tr><td>share(stock) option</td><td>期权，股票认购权</td></tr><tr><td>smart card</td><td>智能卡</td></tr><tr><td>slash prices</td><td>杀价</td></tr><tr><td>spare capacity</td><td>闲置的生产能力</td></tr><tr><td>strong growth</td><td>强劲的增长势头</td></tr><tr><td>switch trade</td><td>转手贸易</td></tr><tr><td>take…public</td><td>上市</td></tr><tr><td>tap the idle assets</td><td>盘活存量资产</td></tr><tr><td>transaction</td><td>（银行的）交易</td></tr><tr><td>transfer payment from the exchequer</td><td>财政转移支付</td></tr><tr><td>venture-capital</td><td>风险资本</td></tr><tr><td>virtual bank</td><td>虚拟银行</td></tr><tr><td>wire transfer</td><td>电子转帐</td></tr><tr><td>account number</td><td>帐目编号</td></tr><tr><td>depositor</td><td>存户</td></tr><tr><td>pay-in slip</td><td>存款单</td></tr><tr><td>a deposit form</td><td>存款单</td></tr><tr><td>a banding machine</td><td>自动存取机</td></tr><tr><td>to deposit</td><td>存款</td></tr><tr><td>deposit receipt</td><td>存款收据</td></tr><tr><td>private deposits</td><td>私人存款</td></tr><tr><td>certificate of deposit</td><td>存单</td></tr><tr><td>deposit book, passbook</td><td>存折</td></tr><tr><td>credit card</td><td>信用卡</td></tr><tr><td>principal</td><td>本金</td></tr><tr><td>overdraft, overdraw</td><td>透支</td></tr><tr><td>to counter sign</td><td>双签</td></tr><tr><td>to endorse</td><td>背书</td></tr><tr><td>endorser</td><td>背书人</td></tr><tr><td>to cash</td><td>兑现</td></tr><tr><td>to honor a cheque</td><td>兑付</td></tr><tr><td>to dishonor a cheque</td><td>拒付</td></tr><tr><td>to suspend payment</td><td>止付</td></tr><tr><td>cheque,check</td><td>支票</td></tr><tr><td>cheque book</td><td>支票本</td></tr><tr><td>order cheque</td><td>记名支票</td></tr><tr><td>bearer cheque</td><td>不记名支票</td></tr><tr><td>blank cheque</td><td>空白支票</td></tr><tr><td>rubber cheque</td><td>空头支票</td></tr><tr><td>cheque stub, counterfoil</td><td>票根</td></tr><tr><td>cash cheque</td><td>现金支票</td></tr><tr><td>traveler’s cheque</td><td>旅行支票</td></tr><tr><td>cheque for transfer</td><td>转帐支票</td></tr><tr><td>outstanding cheque</td><td>未付支票</td></tr><tr><td>canceled cheque</td><td>已付支票</td></tr><tr><td>forged cheque</td><td>伪支票</td></tr><tr><td>Bandar’s note</td><td>庄票，银票</td></tr><tr><td>banker</td><td>银行家</td></tr><tr><td>president</td><td>行长</td></tr><tr><td>savings bank</td><td>储蓄银行</td></tr><tr><td>Chase Bank</td><td>大通银行</td></tr><tr><td>National City Bank of New York</td><td>花旗银行</td></tr><tr><td>Hongkong Shanghai Banking Corporation</td><td>汇丰银行</td></tr><tr><td>Chartered Bank of India, Australia and China</td><td>麦加利银行</td></tr><tr><td>Banque de I’IndoChine</td><td>东方汇理银行</td></tr><tr><td>central bank, national bank, banker’s bank</td><td>中央银行</td></tr><tr><td>bank of issue, bank of circulation</td><td>发行币银行</td></tr><tr><td>commercial bank</td><td>商业银行，储蓄信贷银行</td></tr><tr><td>member bank, credit bank</td><td>储蓄信贷银行</td></tr><tr><td>discount bank</td><td>贴现银行</td></tr><tr><td>exchange bank</td><td>汇兑银行</td></tr><tr><td>requesting bank</td><td>委托开证银行</td></tr><tr><td>issuing bank, opening bank</td><td>开证银行</td></tr><tr><td>advising bank, notifying bank</td><td>通知银行</td></tr><tr><td>negotiation bank</td><td>议付银行</td></tr><tr><td>confirming bank</td><td>保兑银行</td></tr><tr><td>paying bank</td><td>付款银行</td></tr><tr><td>associate banker of collection</td><td>代收银行</td></tr><tr><td>consigned banker of collection</td><td>委托银行</td></tr><tr><td>clearing bank</td><td>清算银行</td></tr><tr><td>local bank</td><td>本地银行</td></tr><tr><td>domestic bank</td><td>国内银行</td></tr><tr><td>overseas bank</td><td>国外银行</td></tr><tr><td>unincorporated bank</td><td>钱庄</td></tr><tr><td>branch bank</td><td>银行分行</td></tr><tr><td>trustee savings bank</td><td>信托储蓄银行</td></tr><tr><td>trust company</td><td>信托公司</td></tr><tr><td>financial trust</td><td>金融信托公司</td></tr><tr><td>unit trust</td><td>信托投资公司</td></tr><tr><td>trust institution</td><td>银行的信托部</td></tr><tr><td>credit department</td><td>银行的信用部</td></tr><tr><td>commercial credit company(discount company)</td><td>商业信贷公司（贴现公司）</td></tr><tr><td>neighborhood savings bank, bank of deposit</td><td>街道储蓄所</td></tr><tr><td>credit union</td><td>合作银行</td></tr><tr><td>credit bureau</td><td>商业兴信所</td></tr><tr><td>self-service bank</td><td>无人银行</td></tr><tr><td>land bank</td><td>土地银行</td></tr><tr><td>construction bank</td><td>建设银行</td></tr><tr><td>industrial and commercial bank</td><td>工商银行</td></tr><tr><td>bank of communications</td><td>交通银行</td></tr><tr><td>mutual savings bank</td><td>互助储蓄银行</td></tr><tr><td>post office savings bank</td><td>邮局储蓄银行</td></tr><tr><td>mortgage bank, building society</td><td>抵押银行</td></tr><tr><td>industrial bank</td><td>实业银行</td></tr><tr><td>home loan bank</td><td>家宅贷款银行</td></tr><tr><td>reserve bank</td><td>准备银行</td></tr><tr><td>chartered bank</td><td>特许银行</td></tr><tr><td>corresponding bank</td><td>往来银行</td></tr><tr><td>merchant bank, accepting bank</td><td>承兑银行</td></tr><tr><td>investment bank</td><td>投资银行</td></tr><tr><td>import and export bank (EXIMBANK)</td><td>进出口银行</td></tr><tr><td>joint venture bank</td><td>合资银行</td></tr><tr><td>money shop, native bank</td><td>钱庄</td></tr><tr><td>credit cooperatives</td><td>信用社</td></tr><tr><td>clearing house</td><td>票据交换所</td></tr><tr><td>public accounting</td><td>公共会计</td></tr><tr><td>business accounting</td><td>商业会计</td></tr><tr><td>cost accounting</td><td>成本会计</td></tr><tr><td>depreciation accounting</td><td>折旧会计</td></tr><tr><td>computerized accounting</td><td>电脑化会计</td></tr><tr><td>general ledger</td><td>总帐</td></tr><tr><td>subsidiary ledger</td><td>分户帐</td></tr><tr><td>cash book</td><td>现金出纳帐</td></tr><tr><td>cash account</td><td>现金帐</td></tr><tr><td>journal, day-book</td><td>日记帐，流水帐</td></tr><tr><td>bad debts</td><td>坏帐</td></tr><tr><td>investment</td><td>投资</td></tr><tr><td>surplus</td><td>结余</td></tr><tr><td>idle capital</td><td>游资</td></tr><tr><td>economic cycle</td><td>经济周期</td></tr><tr><td>economic boom</td><td>经济繁荣</td></tr><tr><td>economic recession</td><td>经济衰退</td></tr><tr><td>economic depression</td><td>经济萧条</td></tr><tr><td>economic crisis</td><td>经济危机</td></tr><tr><td>economic recovery</td><td>经济复苏</td></tr><tr><td>inflation</td><td>通货膨胀</td></tr><tr><td>deflation</td><td>通货收缩</td></tr><tr><td>devaluation</td><td>货币贬值</td></tr><tr><td>revaluation</td><td>货币增值</td></tr><tr><td>international balance of payment</td><td>国际收支</td></tr><tr><td>favourable balance</td><td>顺差</td></tr><tr><td>adverse balance</td><td>逆差</td></tr><tr><td>hard currency</td><td>硬通货</td></tr><tr><td>soft currency</td><td>软通货</td></tr><tr><td>international monetary system</td><td>国际货币制度</td></tr><tr><td>the purchasing power of money</td><td>货币购买力</td></tr><tr><td>money in circulation</td><td>货币流通量</td></tr><tr><td>note issue</td><td>纸币发行量</td></tr><tr><td>national budget</td><td>国家预算</td></tr><tr><td>national gross product</td><td>国民生产总值</td></tr><tr><td>public bond</td><td>公债</td></tr><tr><td>stock, share</td><td>股票</td></tr><tr><td>debenture</td><td>债券</td></tr><tr><td>treasury bill</td><td>国库券</td></tr><tr><td>debt chain</td><td>债务链</td></tr><tr><td>direct exchange</td><td>直接（对角）套汇</td></tr><tr><td>indirect exchange</td><td>间接（三角）套汇</td></tr><tr><td>cross rate, arbitrage rate</td><td>套汇汇率</td></tr><tr><td>foreign currency (exchange) reserve</td><td>外汇储备</td></tr><tr><td>foreign exchange fluctuation</td><td>外汇波动</td></tr><tr><td>foreign exchange crisis</td><td>外汇危机</td></tr><tr><td>discount</td><td>贴现</td></tr><tr><td>discount rate, bank rate</td><td>贴现率</td></tr><tr><td>gold reserve</td><td>黄金储备</td></tr><tr><td>money (financial) market</td><td>金融市场</td></tr><tr><td>stock exchange</td><td>股票交易所</td></tr><tr><td>broker</td><td>经纪人</td></tr><tr><td>commission</td><td>佣金</td></tr><tr><td>bookkeeping</td><td>簿记</td></tr><tr><td>bookkeeper</td><td>簿记员</td></tr><tr><td>an application form</td><td>申请单</td></tr><tr><td>bank statement</td><td>对帐单</td></tr><tr><td>letter of credit</td><td>信用证</td></tr><tr><td>strong room, vault</td><td>保险库</td></tr><tr><td>equitable tax system</td><td>等价税则</td></tr><tr><td>specimen signature</td><td>签字式样</td></tr><tr><td>banking hours, business hours</td><td>营业时间</td></tr><tr><td>Cash business</td><td>现金业务</td></tr><tr><td>transfer business</td><td>转账业务</td></tr><tr><td>currency exchange business</td><td>汇兑业务</td></tr><tr><td>commission receivables</td><td>委托收款</td></tr><tr><td>loans</td><td>发放贷款</td></tr><tr><td>loan recovery</td><td>贷款收回</td></tr><tr><td>loan extension</td><td>贷款展期</td></tr><tr><td>apply for bank drafts</td><td>办理银行汇票</td></tr><tr><td>interest</td><td>收息</td></tr><tr><td>collection</td><td>托收</td></tr><tr><td>account number</td><td>帐目编号</td></tr><tr><td>depositor</td><td>存户</td></tr><tr><td>pay-in slip</td><td>存款单</td></tr><tr><td>a deposit form</td><td>存款单</td></tr><tr><td>a banding machine</td><td>自动存取机</td></tr><tr><td>to deposit</td><td>存款</td></tr><tr><td>deposit receipt</td><td>存款收据</td></tr><tr><td>private deposits</td><td>私人存款</td></tr><tr><td>certificate of deposit</td><td>存单</td></tr><tr><td>deposit book, passbook</td><td>存折</td></tr><tr><td>credit card</td><td>信用卡</td></tr><tr><td>principal</td><td>本金</td></tr><tr><td>overdraft, overdraw</td><td>透支</td></tr><tr><td>to counter sign</td><td>双签</td></tr><tr><td>to endorse</td><td>背书</td></tr><tr><td>endorser</td><td>背书人</td></tr><tr><td>to cash</td><td>兑现</td></tr><tr><td>to honor a cheque</td><td>兑付</td></tr><tr><td>to dishonor a cheque</td><td>拒付</td></tr><tr><td>to suspend payment</td><td>止付</td></tr><tr><td>cheque,check</td><td>支票</td></tr><tr><td>cheque book</td><td>支票本</td></tr><tr><td>order cheque</td><td>记名支票</td></tr><tr><td>bearer cheque</td><td>不记名支票</td></tr><tr><td>crossed cheque</td><td>横线支票</td></tr><tr><td>blank cheque</td><td>空白支票</td></tr><tr><td>rubber cheque</td><td>空头支票</td></tr><tr><td>cheque stub, counterfoil</td><td>票根</td></tr><tr><td>cash cheque</td><td>现金支票</td></tr><tr><td>traveler’s cheque</td><td>旅行支票</td></tr><tr><td>cheque for transfer</td><td>转帐支票</td></tr><tr><td>outstanding cheque</td><td>未付支票</td></tr><tr><td>canceled cheque</td><td>已付支票</td></tr><tr><td>forged cheque</td><td>伪支票</td></tr><tr><td>Bandar’s note</td><td>庄票，银票</td></tr><tr><td>banker</td><td>银行家</td></tr><tr><td>president</td><td>行长</td></tr><tr><td>savings bank</td><td>储蓄银行</td></tr><tr><td>Chase Bank</td><td>大通银行</td></tr><tr><td>National City Bank of New York</td><td>花旗银行</td></tr><tr><td>Hongkong Shanghai Banking Corporation</td><td>汇丰银行</td></tr><tr><td>Chartered Bank of India, Australiaand China</td><td>麦加利银行</td></tr><tr><td>Banque de I’IndoChine</td><td>东方汇理银行</td></tr><tr><td>central bank, national bank, banker’s bank</td><td>中央银行</td></tr><tr><td>bank of issue, bank of circulation</td><td>发行币银行</td></tr><tr><td>commercial bank</td><td>商业银行，储蓄信贷银行</td></tr><tr><td>member bank, credit bank</td><td>储蓄信贷银行</td></tr><tr><td>discount bank</td><td>贴现银行</td></tr><tr><td>exchange bank</td><td>汇兑银行</td></tr><tr><td>requesting bank</td><td>委托开证银行</td></tr><tr><td>issuing bank, opening bank</td><td>开证银行</td></tr><tr><td>advising bank, notifying bank</td><td>通知银行</td></tr><tr><td>negotiation bank</td><td>议付银行</td></tr><tr><td>confirming bank</td><td>保兑银行</td></tr><tr><td>paying bank</td><td>付款银行</td></tr><tr><td>associate banker of collection</td><td>代收银行</td></tr><tr><td>consigned banker of collection</td><td>委托银行</td></tr><tr><td>clearing bank</td><td>清算银行</td></tr><tr><td>local bank</td><td>本地银行</td></tr><tr><td>domestic bank</td><td>国内银行</td></tr><tr><td>overseas bank</td><td>国外银行</td></tr><tr><td>unincorporated bank</td><td>钱庄</td></tr><tr><td>branch bank</td><td>银行分行</td></tr><tr><td>trustee savings bank</td><td>信托储蓄银行</td></tr><tr><td>trust company</td><td>信托公司</td></tr><tr><td>financial trust</td><td>金融信托公司</td></tr><tr><td>unit trust</td><td>信托投资公司</td></tr><tr><td>trust institution</td><td>银行的信托部</td></tr><tr><td>credit department</td><td>银行的信用部</td></tr><tr><td>commercial credit company(discountcompany)</td><td>商业信贷公司（贴现公司）</td></tr><tr><td>neighborhood savings bank, bank of deposit</td><td>街道储蓄所</td></tr><tr><td>credit union</td><td>合作银行</td></tr><tr><td>credit bureau</td><td>商业兴信所</td></tr><tr><td>self-service bank</td><td>无人银行</td></tr><tr><td>land bank</td><td>土地银行</td></tr><tr><td>construction bank</td><td>建设银行</td></tr><tr><td>industrial and commercial bank</td><td>工商银行</td></tr><tr><td>bank of communications</td><td>交通银行</td></tr><tr><td>mutual savings bank</td><td>互助储蓄银行</td></tr><tr><td>post office savings bank</td><td>邮局储蓄银行</td></tr><tr><td>mortgage bank, building society</td><td>抵押银行</td></tr><tr><td>industrial bank</td><td>实业银行</td></tr><tr><td>home loan bank</td><td>家宅贷款银行</td></tr><tr><td>reserve bank</td><td>准备银行</td></tr><tr><td>chartered bank</td><td>特许银行</td></tr><tr><td>corresponding bank</td><td>往来银行</td></tr><tr><td>merchant bank, accepting bank</td><td>承兑银行</td></tr><tr><td>investment bank</td><td>投资银行</td></tr><tr><td>import and export bank (EXIMBANK)</td><td>进出口银行</td></tr><tr><td>joint venture bank</td><td>合资银行</td></tr><tr><td>money shop, native bank</td><td>钱庄</td></tr><tr><td>credit cooperatives</td><td>信用社</td></tr><tr><td>clearing house</td><td>票据交换所</td></tr><tr><td>public accounting</td><td>公共会计</td></tr><tr><td>business accounting</td><td>商业会计</td></tr><tr><td>cost accounting</td><td>成本会计</td></tr><tr><td>depreciation accounting</td><td>折旧会计</td></tr><tr><td>computerized accounting</td><td>电脑化会计</td></tr><tr><td>general ledger</td><td>总帐</td></tr><tr><td>subsidiary ledger</td><td>分户帐</td></tr><tr><td>cash book</td><td>现金出纳帐</td></tr><tr><td>cash account</td><td>现金帐</td></tr><tr><td>journal, day-book</td><td>日记帐，流水帐</td></tr><tr><td>bad debts</td><td>坏帐</td></tr><tr><td>investment</td><td>投资</td></tr><tr><td>surplus</td><td>结余</td></tr><tr><td>idle capital</td><td>游资</td></tr><tr><td>economic cycle</td><td>经济周期</td></tr><tr><td>economic boom</td><td>经济繁荣</td></tr><tr><td>economic recession</td><td>经济衰退</td></tr><tr><td>economic depression</td><td>经济萧条</td></tr><tr><td>economic crisis</td><td>经济危机</td></tr><tr><td>economic recovery</td><td>经济复苏</td></tr><tr><td>inflation</td><td>通货膨胀</td></tr><tr><td>deflation</td><td>通货收缩</td></tr><tr><td>devaluation</td><td>货币贬值</td></tr><tr><td>revaluation</td><td>货币增值</td></tr><tr><td>international balance of payment</td><td>国际收支</td></tr><tr><td>favourable balance</td><td>顺差</td></tr><tr><td>adverse balance</td><td>逆差</td></tr><tr><td>hard currency</td><td>硬通货</td></tr><tr><td>soft currency</td><td>软通货</td></tr><tr><td>international monetary system</td><td>国际货币制度</td></tr><tr><td>the purchasing power of money</td><td>货币购买力</td></tr><tr><td>money in circulation</td><td>货币流通量</td></tr><tr><td>note issue</td><td>纸币发行量</td></tr><tr><td>national budget</td><td>国家预算</td></tr><tr><td>national gross product</td><td>国民生产总值</td></tr><tr><td>public bond</td><td>公债</td></tr><tr><td>stock, share</td><td>股票</td></tr><tr><td>debenture</td><td>债券</td></tr><tr><td>treasury bill</td><td>国库券</td></tr></tbody></table><p>（完）</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>英语</category>
      
    </categories>
    
    
    <tags>
      
      <tag>英语</tag>
      
      <tag>专有名词</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>DDD</title>
    <link href="/blog/2020/05/DDD%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1.html"/>
    <url>/blog/2020/05/DDD%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1.html</url>
    
    <content type="html"><![CDATA[<p>DDD：领域驱动设计（Domain Drive Design）<br>    它关注的是Service层的设计，着重于业务的实现,将分析和设计结合起来，不再使他们处于分裂的状态，这对于我们正确完整的实现客户的需求，以及建立一个具有业务伸缩性的模型<br>    域驱动设计（DDD）是一种将实现与不断发展的模型联系在一起的开发方法。将项目的重点放在核心领域（知识领域），背后的逻辑上，并迫使技术和非技术方面之间进行协作以改进模型</p><p>ddd的作用<br>    统一思想<br>    明确分工<br>    反映变化<br>    边界分离</p><p>ddd的概念<br>    值对象<br>    聚合<br>    聚合根<br>    领域服务<br>    领域事件<br>    实体</p><p>ddd的4种模式<br>    失血模型<br>    贫血模型<br>    胀血模型<br>    充血模型<br>对于ddd而言，失血和胀血都不合适。失血太轻没有聚合， 胀血那是初学者才这样写代码  .</p>]]></content>
    
    
    <categories>
      
      <category>生活</category>
      
      <category>经验</category>
      
    </categories>
    
    
    <tags>
      
      <tag>技巧</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Apollo简介及入门</title>
    <link href="/blog/2020/04/Apollo%E7%AE%80%E4%BB%8B%E5%8F%8A%E5%85%A5%E9%97%A8.html"/>
    <url>/blog/2020/04/Apollo%E7%AE%80%E4%BB%8B%E5%8F%8A%E5%85%A5%E9%97%A8.html</url>
    
    <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>Apollo（阿波罗）是携程框架部门研发的分布式配置中心，能够集中化管理应用不同环境、不同集群的配置，配置修改后能够实时推送到应用端，并且具备规范的权限、流程治理等特性，适用于微服务配置管理场景。</p><p>服务端基于Spring Boot和Spring Cloud开发，打包后可以直接运行，不需要额外安装Tomcat等应用容器。</p><p>Java客户端不依赖任何框架，能够运行于所有Java运行时环境，同时对Spring&#x2F;Spring Boot环境也有较好的支持。</p><h3 id="核心功能"><a href="#核心功能" class="headerlink" title="核心功能"></a>核心功能</h3><h4 id="统一管理不同环境、不同集群配置："><a href="#统一管理不同环境、不同集群配置：" class="headerlink" title="统一管理不同环境、不同集群配置："></a>统一管理不同环境、不同集群配置：</h4><ul><li>Apollo提供了一个统一界面集中式管理不同环境（environment）、不同集群（cluster）、不同命名空间（namespace）的配置。</li><li>同一份代码部署在不同的集群，可以有不同的配置，比如zk的地址等</li><li>通过命名空间（namespace）可以很方便的支持多个不同应用共享同一份配置，同时还允许应用对共</li><li>享的配置进行覆盖</li><li>配置界面支持多语言（中文，English）</li></ul><h4 id="热发布"><a href="#热发布" class="headerlink" title="热发布"></a>热发布</h4><p>用户在Apollo修改完配置并发布后，客户端能实时（1秒）接收到最新的配置，并通知到应用程序。</p><h4 id="版本发布管理"><a href="#版本发布管理" class="headerlink" title="版本发布管理"></a>版本发布管理</h4><p>所有的配置发布都有版本概念，从而可以方便的支持配置的回滚。</p><h4 id="灰度发布"><a href="#灰度发布" class="headerlink" title="灰度发布"></a>灰度发布</h4><p>支持配置的灰度发布，比如点了发布后，只对部分应用实例生效，等观察一段时间没问题后再推给所有应用实例。</p><h4 id="权限管理、发布审核、操作审计"><a href="#权限管理、发布审核、操作审计" class="headerlink" title="权限管理、发布审核、操作审计"></a>权限管理、发布审核、操作审计</h4><ol><li>应用和配置的管理都有完善的权限管理机制，对配置的管理还分为了编辑和发布两个环节，从而减少人为的错误。</li><li>所有的操作都有审计日志，可以方便的追踪问题。</li></ol><h4 id="客户端配置信息监控"><a href="#客户端配置信息监控" class="headerlink" title="客户端配置信息监控"></a>客户端配置信息监控</h4><p>可以方便的看到配置在被哪些实例使用</p><h4 id="提供Java和-Net原生客户端"><a href="#提供Java和-Net原生客户端" class="headerlink" title="提供Java和.Net原生客户端"></a>提供Java和.Net原生客户端</h4><ul><li>提供了Java和.Net的原生客户端，方便应用集成</li><li>支持Spring Placeholder，Annotation和Spring Boot的ConfigurationProperties，方便应用使用（需要Spring 3.1.1+）</li><li>同时提供了Http接口，非Java和.Net应用也可以方便的使用</li></ul><h4 id="提供开放平台API"><a href="#提供开放平台API" class="headerlink" title="提供开放平台API"></a>提供开放平台API</h4><ul><li>Apollo自身提供了比较完善的统一配置管理界面，支持多环境、多数据中心配置管理、权限、流程治理等特性。</li><li>不过Apollo出于通用性考虑，对配置的修改不会做过多限制，只要符合基本的格式就能够保存。</li><li>在我们的调研中发现，对于有些使用方，它们的配置可能会有比较复杂的格式，如xml, json，需要对格式做校验。</li><li>还有一些使用方如DAL，不仅有特定的格式，而且对输入的值也需要进行校验后方可保存，如检查数据库、用户名和密码是否匹配。</li><li>对于这类应用，Apollo支持应用方通过开放接口在Apollo进行配置的修改和发布，并且具备完善的授权和权限控制</li></ul><h4 id="部署简单"><a href="#部署简单" class="headerlink" title="部署简单"></a>部署简单</h4><ul><li>配置中心作为基础服务，可用性要求非常高，这就要求Apollo对外部依赖尽可能地少</li><li>目前唯一的外部依赖是MySQL，所以部署非常简单，只要安装好Java和MySQL就可以让Apollo跑起来</li><li>Apollo还提供了打包脚本，一键就可以生成所有需要的安装包，并且支持自定义运行时参数</li></ul><h2 id="单机部署"><a href="#单机部署" class="headerlink" title="单机部署"></a>单机部署</h2><h3 id="单机版架构"><a href="#单机版架构" class="headerlink" title="单机版架构"></a>单机版架构</h3><p><img src="/blog/./assets/image-yjbmwqvh0q1vgque6igzb2d.PNG" alt="单机版架构"></p><ul><li>Apollo Config Service:提供配置的读取、推送等功能，服务对象是 Apollo 客户端。</li><li>Apollo Admin Service:提供配置的修改、发布等功能，服务对象是Apollo Portal。</li><li>Apollo Portal:Apollo 的管理界面，进行不同项目的配置（项目配置、权限配置等），服务对象是开发者和开放平台API。</li></ul>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>Apollo</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Apollo</tag>
      
      <tag>配置中心</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CodeReview需关注的问题点</title>
    <link href="/blog/2020/04/CodeReview%E9%9C%80%E5%85%B3%E6%B3%A8%E7%9A%84%E9%97%AE%E9%A2%98%E7%82%B9.html"/>
    <url>/blog/2020/04/CodeReview%E9%9C%80%E5%85%B3%E6%B3%A8%E7%9A%84%E9%97%AE%E9%A2%98%E7%82%B9.html</url>
    
    <content type="html"><![CDATA[<h2 id="常见代码问题"><a href="#常见代码问题" class="headerlink" title="常见代码问题"></a>常见代码问题</h2><ul><li><p>空值</p><p>防御式编程，判空处理，有胜于无</p></li><li><p>未捕获潜在的异常</p><p>API返回做判断；切忌默默吞掉异常；防御式编程</p></li><li><p>低性能</p><p>批量调用接口或访问DB;处理超时；降维多重循环；复用大对象</p></li><li><p>影响范围过大</p><p>谨慎修改公共函数、基础函数、基类等；充分测试；评估影响范围</p></li><li><p>单测间题</p><p>重要业务逻辑必有单测；单测全部通过；代码BUG或变更单测覆盖；增加异常单测</p></li><li><p>与原有业务逐辑不兼容</p><p>充分理解已有逻辑及设计；</p></li><li><p>缺乏必要日志</p><p>重要而关键的实例状态、代码路径及API调用，INFO日志；异常捕获并Error日志</p></li><li><p>错误码不符合规范</p><p>错误码集中在一个类管理，切忌分散在代码中；遵循团队规范</p></li><li><p>参数检测缺乏或不足</p><p>参数值类型；参数业务类型；契约式编程；</p></li><li><p>API参数传递错误</p><p>参数类型具体化；避免相同类型参数相邻</p></li><li><p>引用错误</p><p>有多个重名类时仔细核对类的全名；源加新类时先搜索重名类引用</p></li><li><p>细节错误</p><ul><li><p>数组越界、JSON解析出错、函数参数传递出错、API版本不对；</p></li><li><p>使用网上拷贝的未经测试的代码、不成熟的算法、传值与传引用、相等性比较</p></li></ul></li><li><p>多重条件</p><p>拆分为有业务语义的单个条件的组合</p></li><li><p>文不符实</p><p>查询接口中有更新&#x2F;新增甚至删除操作，引发故障的定时炸弹</p></li><li><p>跨语言或跨系统交互</p><p>空值、JSON、数组的不同解析；接口与交互约定；联调确认</p></li></ul><h2 id="可维护性问题"><a href="#可维护性问题" class="headerlink" title="可维护性问题"></a>可维护性问题</h2><ul><li><p>硬编码</p><p>“魔数”(枚举替代);写死的配置(配置项);临时加的逆辊和文案(抽离管理)</p></li><li><p>重复代码</p><p>抽离通用的部分，定制差异；事实一致性；</p></li><li><p>通用逻辑与业务逻辑耦合</p><p>通用处理流程抽离，业务逻辑以回调函数传入；复用而非混杂</p></li><li><p>直接在原方法里加逻辑</p><p>新增一个函数，然后在原方法中调用并说明原因</p></li><li><p>多业务耦合</p><p>先划分业务边界，定义好接口设计和服务依赖关系，再着手开发</p></li><li><p>代码层次不合理</p><p>代码的放置位置不符合当前架构设计约定；Control调用Control;</p></li><li><p>不用多余的代码</p><p>后续维护时会造成困惑；确认不用及时删除</p></li><li><p>使用全局变量</p><p>破坏函数的复用性；排查和调试问题</p></li><li><p>缺乏必要的注释</p><p>重要和关键点的代码；特殊处理缺乏说明</p></li></ul><h2 id="轻微问题"><a href="#轻微问题" class="headerlink" title="轻微问题"></a>轻微问题</h2><ul><li><p>命名不贴切</p><p>取贴切的名字</p></li><li><p>声明时未初始化</p><p>赋予默认初始值</p></li><li><p>风格与整体有不一致</p><p>调整为整体一致风格</p></li><li><p>类型转换错误</p><p>转换前判断类型；避免类型转换报错</p></li><li><p>否定式风格</p><p>使用肯定句式</p></li><li><p>容器遍历的结构变更</p><p>使用迭代器遍历和变更</p></li><li><p>单行调用括号过多</p><p>拆解为多行</p></li><li><p>修改方法签名</p><p>扫描和修改所有调用者</p></li><li><p>打印日志太多</p><p>仅保留必需日志</p></li><li><p>多级数据结构</p><p>确保父级结构的数据存在</p></li><li><p>作用域过大</p><p>仅在需要时定义和使用</p></li></ul><h2 id="复杂问题"><a href="#复杂问题" class="headerlink" title="复杂问题"></a>复杂问题</h2><ul><li><p>并发</p><ul><li>多线程访问缺乏同步保护；死锁</li><li>缺乏控制的手动线程或动态创建的线程池</li></ul></li><li><p>缺乏事务控制</p><p>识别原子操作集并添加事务</p></li><li><p>大数据量的SQL低效</p><ul><li>合适的素引、查询条件与顺序</li><li>避免Join,子查询</li></ul></li><li><p>安全问题</p><ul><li>输入；清除敏感私密信息；加密存储；</li><li>角色、权限、操作、数据访问分级和控制</li></ul></li><li><p>设计问题</p><ul><li><p>性能问题</p></li><li><p>扩展性问题</p></li><li><p>缺乏幂等处理</p></li></ul></li></ul><p>（完）</p>]]></content>
    
    
    <categories>
      
      <category>工作</category>
      
      <category>编程思想</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Remnote</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Ribbon简介和入门</title>
    <link href="/blog/2020/04/Ribbon%E7%AE%80%E4%BB%8B%E5%92%8C%E5%85%A5%E9%97%A8.html"/>
    <url>/blog/2020/04/Ribbon%E7%AE%80%E4%BB%8B%E5%92%8C%E5%85%A5%E9%97%A8.html</url>
    
    <content type="html"><![CDATA[<h2 id="Ribbon介绍"><a href="#Ribbon介绍" class="headerlink" title="Ribbon介绍"></a>Ribbon介绍</h2><p>Ribbon是Netflix发布的负载均衡器，有助于控制HTTP客户端行为。为Ribbon配置服务提供地址列表<br>后，Ribbon就可基于负载均衡算法，自动帮助服务消费者请求。<br>Ribbon默认提供的负载均衡算法：轮询，随机,重试法,加权。当然，我们可用自己定义负载均衡算法。</p><h3 id="Ribbon实践"><a href="#Ribbon实践" class="headerlink" title="Ribbon实践"></a>Ribbon实践</h3><p><img src="/blog/./assets/image-asifss1jjk0hiuyywy1mqns.PNG" alt="业务介绍"></p><p>如上图，当用户下单调用 hailtaxi-order 服务的时候，该服务会调用 hailtaxi-driver ，此时如果是抢单过程，查询压力也会很大，我们可以为 hailtaxi-driver 做集群，做集群只需要把工程复制多份即可，多个工程如下图：</p><p><img src="/blog/./assets/image-9lmfsov6eazrzqaazwai32m.PNG" alt="本地伪集群配置"></p><p>在idea中将项目的启动配置复制一份出来，修改启动端口号</p><p><img src="/blog/./assets/image-agvr7hq73x9lg01v3hersj7.PNG" alt="修改启动端口"></p><p>调用测试，访问：<a href="http://localhost:18082/order%E8%B0%83%E7%94%A8%EF%BC%8C%E5%8F%AF%E4%BB%A5%E5%8F%91%E7%8E%B0%E5%B7%B2%E7%BB%8F%E5%AE%9E%E7%8E%B0%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E4%BA%86%EF%BC%8C">http://localhost:18082/order调用，可以发现已经实现负载均衡了，</a> 18081 和 18085 ， 18086 服务默认是轮询访问。</p><h3 id="Ribbon算法"><a href="#Ribbon算法" class="headerlink" title="Ribbon算法"></a>Ribbon算法</h3><p>我们上面没做任何相关操作，只是把服务换成了多个就实现了负载均衡，这是因为OpenFeign默认使用了Ribbon的轮询算法,如下图依赖包，引入OpenFeign的时候会传递依赖Ribbon包：</p><p><img src="/blog/./assets/image-oe6d8tbp0dt7m31a5alyihg.PNG" alt="OpenFeign依赖"></p><p><img src="/blog/./assets/image-fz9srp8zoiundd5a8kqwtl3.PNG" alt="依赖树"></p><p>Ribbon支持多种负载均衡算法，我们可以按照自己的需求使用相关算法，在 hailtaxi-order 配置类中</p><p>配置如下规则：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/***</span><br><span class="hljs-comment">* 负载均衡算法设置</span><br><span class="hljs-comment">*/</span><br><span class="hljs-meta">@Bean</span> <span class="hljs-comment">//要交给容器管理</span><br><span class="hljs-keyword">public</span> IRule <span class="hljs-title function_">randomRule</span><span class="hljs-params">()</span>&#123;<br><span class="hljs-comment">//随机算法</span><br><span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RandomRule</span>();<br><span class="hljs-comment">//重试算法</span><br><span class="hljs-comment">//return new RetryRule();</span><br><span class="hljs-comment">//加权法</span><br><span class="hljs-comment">//return new ZoneAvoidanceRule();</span><br>&#125;<br></code></pre></td></tr></table></figure><ul><li><p>RoundRobinRule</p><p>轮询</p></li><li><p>RandomRule</p><p>随机算法</p></li><li><p>RetryRule</p><p>重试算法。该算法先按照轮询的策略获取服务,如果获取服务失败则在指定的时间内会进行重试，获取可用的服务。</p></li><li><p>ZoneAvoidanceRule</p><p>加权算法。会根据平均响应时间计算所有服务的权重，响应时间越快服务权重越大被选中的概率越大。刚启动时如果同统计信息不足，则使用轮询的策略，等统计信息足够会切换到自身规则。</p></li></ul><p>（完）</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>Ribbon</category>
      
    </categories>
    
    
    <tags>
      
      <tag>微服务</tag>
      
      <tag>Ribbon</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>OpenFeign简介和入门</title>
    <link href="/blog/2020/04/OpenFeign%E7%AE%80%E4%BB%8B%E5%92%8C%E5%85%A5%E9%97%A8.html"/>
    <url>/blog/2020/04/OpenFeign%E7%AE%80%E4%BB%8B%E5%92%8C%E5%85%A5%E9%97%A8.html</url>
    
    <content type="html"><![CDATA[<h2 id="OpenFeign前身"><a href="#OpenFeign前身" class="headerlink" title="OpenFeign前身"></a>OpenFeign前身</h2><ul><li>Feign是Spring Cloud组件中的一个轻量级RESTful的HTTP服务客户端。</li><li>Feign内置了Ribbon，用来做客户端负载均衡，去调用服务注册中心的服务。</li><li>Feign的使用方式是：使用Feign的注解定义接口，调用这个接口，就可以调用服务注册中心的服务。</li><li>Feign支持的注解和用法请参考官方文档：<a href="https://github.com/OpenFeign/feign">https://github.com/OpenFeign/feign</a></li><li>Feign本身不支持Spring MVC的注解，它有一套自己的注解。</li></ul><h2 id="OpenFeign介绍"><a href="#OpenFeign介绍" class="headerlink" title="OpenFeign介绍"></a>OpenFeign介绍</h2><p>OpenFeign是Spring Cloud 在Feign的基础上支持了Spring MVC的注解，如@RequesMapping等，是一</p><p>个轻量级的Http封装工具对象,大大简化了Http请求，使得我们对服务的调用转换成了对本地接口方法的</p><p>调用。</p><p>OpenFeign 的 @FeignClient 可以解析SpringMVC的 @RequestMapping 注解下的接口，并通过动态代</p><p>理的方式产生实现类，实现类中做负载均衡并调用其他服务。</p><ul><li>集成了Ribbon的负载均衡功能</li><li>集成Hystrix的熔断器功能</li><li>支持请求压缩</li><li>大大简化了远程调用的代码，同时功能还增强啦</li><li>以更加优雅的方式编写远程调用代码，并简化重复代码</li></ul><p><img src="/blog/./assets/image-ptms6zvcztuu9ajffq5ht16.PNG" alt="业务分析"></p><p><strong>需求：</strong></p><p>如上图，我们现在要实现打车用户打车下单，打车下单的时候需要匹配指定司机并更改司机状态，由之</p><p>前空闲状态改成接单状态。</p><p><strong>技术支持：</strong></p><p>这时候就涉及到 hailtaxi-order 服务调用 hailtaxi-driver 服务了，此时如果使用HttpClient工具，</p><p>操作起来非常麻烦，我们可以使用 SpringCloud OpenFeign 实现调用。</p><h2 id="OpenFeign实践"><a href="#OpenFeign实践" class="headerlink" title="OpenFeign实践"></a>OpenFeign实践</h2><h3 id="启动项目"><a href="#启动项目" class="headerlink" title="启动项目"></a>启动项目</h3><p>使用OpenFeign实现服务之间调用，可以按照如下步骤实现：</p><ol><li><p>导入openfeign依赖</p></li><li><p>编写openfeign客户端接口-将请求地址写到该接口上</p></li><li><p>消费者启动引导类开启openfeign功能注解</p></li><li><p>访问接口测试</p></li><li><p>导入依赖</p></li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--配置feign--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-starter-openfeign<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.2.1.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>&lt;/dependency<br></code></pre></td></tr></table></figure><ol start="2"><li>创建Feign客户端接口</li></ol><p>修改 hailtaxi-api 创建 xyz.maojun.driver.feign.DriverFeign 接口，代码如下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@FeignClient(value = &quot;hailtaxi-driver&quot;)</span><span class="hljs-comment">//value = &quot;hailtaxi-driver&quot;指定服务的名字</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">DriverFeign</span> &#123;<br><span class="hljs-comment">/****</span><br><span class="hljs-comment">* 更新司机信息，该方法和hailtaxi-driver服务中的方法保持一致</span><br><span class="hljs-comment">*/</span><br><span class="hljs-meta">@PutMapping(value = &quot;/driver/status/&#123;id&#125;/&#123;status&#125;&quot;)</span><br>Driver <span class="hljs-title function_">status</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable(value = &quot;id&quot;)</span>String id, <span class="hljs-meta">@PathVariable(value =</span></span><br><span class="hljs-meta"><span class="hljs-params">&quot;status&quot;)</span>Integer status)</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>Feign会通过动态代理，帮我们生成实现类。</p><ul><li>注解@FeignClient声明Feign的客户端，注解value指明服务名称</li><li>接口定义的方法，采用SpringMVC的注解。Feign会根据注解帮我们生成URL地址</li><li>注解@RequestMapping中的&#x2F;driver，不要忘记。因为Feign需要拼接可访问地址</li></ul><ol start="3"><li>Controller调用</li></ol><p>修改 hailtaix-order 的下单方法，在下单方法中调用 DriverFeign 修改司机状态，代码如下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Autowired</span><br><span class="hljs-keyword">private</span> DriverFeign driverFeign;<br><span class="hljs-comment">/***</span><br><span class="hljs-comment">* 下单</span><br><span class="hljs-comment">*/</span><br><span class="hljs-meta">@PostMapping</span><br><span class="hljs-keyword">public</span> OrderInfo <span class="hljs-title function_">add</span><span class="hljs-params">()</span>&#123;<br><span class="hljs-comment">//修改司机信息 司机ID=1</span><br><span class="hljs-type">Driver</span> <span class="hljs-variable">driver</span> <span class="hljs-operator">=</span> driverFeign.status(<span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-number">2</span>);<br><span class="hljs-comment">//创建订单</span><br><span class="hljs-type">OrderInfo</span> <span class="hljs-variable">orderInfo</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OrderInfo</span>(<span class="hljs-string">&quot;No&quot;</span>+((<span class="hljs-type">int</span>)(Math.random()*<span class="hljs-number">10000</span>)), (<span class="hljs-type">int</span>)<br>(Math.random()*<span class="hljs-number">100</span>), <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(), <span class="hljs-string">&quot;深圳北站&quot;</span>, <span class="hljs-string">&quot;罗湖港&quot;</span>, driver);<br>orderInfoService.add(orderInfo);<br><span class="hljs-keyword">return</span> orderInfo;<br>&#125;<br></code></pre></td></tr></table></figure><ol start="4"><li>启用OpenFeign</li></ol><p>上面所有业务逻辑写完了，但OpenFeign还并未生效，我们需要在 hailtaxi-order 中开启OpenFeign ，只需要在 OrderApplication 启动类上添加 @EnableFeignClients(basePackages &#x3D;<br>“xyz.maojun.driver.feign”) 即可。</p><p>测试地址：<a href="http://localhost:18082/order">http://localhost:18082/order</a></p><p><img src="/blog/./assets/image-macazyaszgdh6y4zfe5ig3d.PNG" alt="请求访问"></p><p>数据库查询验证：</p><p><img src="/blog/./assets/image-sertor17n2m3fkkankwo45k.PNG" alt="数据库验证"></p><h3 id="日志配置"><a href="#日志配置" class="headerlink" title="日志配置"></a>日志配置</h3><p>为了获得服务请求的参数和返回值，我们经常使用的一个做法就是打印日志。你可以在程序中使用 log.info 或者log.debug 方法将服务请求的入参和返回值一一打印出来。如果远程调用组件能自己实现调用参数的日志打印，这个事情不就完美解决了么！下面来看怎么做。</p><ol><li>首先，你需要在配置文件中指定 FeignClient 接口的日志级别为 Debug。这样做是因为OpenFeign 组件默认将日志信息以 debug 模式输出，而默认情况下 Spring Boot 的日志级别是Info，因此我们必须将应用日志的打印级别改为 debug 后才能看到 OpenFeign 的日志。</li><li>在应用的上下文中使用代码的方式声明 Feign 组件的日志级别。这里的日志级别并不是我们传统意义上的 Log Level，它是 OpenFeign 组件自定义的一种日志级别，用来控制 OpenFeign 组件向日志中写入什么内容</li></ol><blockquote><p>因为@FeignClient注解修饰的客户端在被代理时，都会创建一个新的Feign.Logger实例。我们需要额外通过配置类的方式指定这个日志的级别才可以。</p></blockquote><h4 id="实现步骤"><a href="#实现步骤" class="headerlink" title="实现步骤"></a>实现步骤</h4><ol><li><p>在application.yml配置文件中开启日志级别配置</p></li><li><p>编写配置类，定义日志级别bean。</p></li><li><p>在接口的@FeignClient中指定配置类</p></li><li><p>重启项目，测试访问</p></li><li><p>普通日志等级配置</p><p>在 hailtaxi-order 的配置文件中设置包下的日志级别都为debug：\</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">logging:</span><br><span class="hljs-attr">level:</span><br><span class="hljs-attr">xyz.maojun:</span> <span class="hljs-string">debug</span><br></code></pre></td></tr></table></figure></li><li><p>Feign日志等级配置</p></li></ol><p>在 hailtaxi-order 启动类 OrderApplication 中创建 Logger.Level ,定义日志级别：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/***</span><br><span class="hljs-comment">* 日志级别</span><br><span class="hljs-comment">* <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment">*/</span><br><span class="hljs-meta">@Bean</span><br><span class="hljs-keyword">public</span> Logger.Level <span class="hljs-title function_">feignLoggerLevel</span><span class="hljs-params">()</span>&#123;<br><span class="hljs-keyword">return</span> Logger.Level.FULL;<br>&#125;<br></code></pre></td></tr></table></figure><p>Feign支持4种级别：</p><ol><li><p>NONE：不记录任何日志，默认值</p></li><li><p>BASIC：只记录服务请求的 URL、HTTP Method、响应状态码（如 200、404 等）和服务调用的执行</p><p>时间</p></li><li><p>HEADERS：在 BASIC 的基础上，还记录了请求和响应中的 HTTP Headers</p></li><li><p>FULL：在 HEADERS 级别的基础上，还记录了服务请求和服务响应中的 Body 和 metadata，FULL</p><p>级别记录了最完整的调用信息。</p></li></ol><p>重启项目，即可看到每次访问的日志。</p><h3 id="超时判定"><a href="#超时判定" class="headerlink" title="超时判定"></a>超时判定</h3><p>超时判定是一种保障可用性的手段。如果你要调用的目标服务的 RT（Response Time）值非常高，那么</p><p>你的调用请求也会处于一个长时间挂起的状态，这是造成服务雪崩的一个重要因素。为了隔离下游接口</p><p>调用超时所带来的的影响，我们可以在程序中设置一个超时判定的阈值，一旦下游接口的响应时间超过</p><p>了这个阈值，那么程序会自动取消此次调用并返回一个异常。</p><p>超时配置如下</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">feign:</span><br><span class="hljs-attr">client:</span><br><span class="hljs-attr">config:</span><br><span class="hljs-comment">#全局默认配置</span><br><span class="hljs-attr">default:</span><br><span class="hljs-comment">#网络连接阶段1秒超时 单位毫秒</span><br><span class="hljs-attr">connectTimeout:</span> <span class="hljs-number">1000</span><br><span class="hljs-comment">#服务请求响应阶段5秒超时</span><br><span class="hljs-attr">readTimeout:</span> <span class="hljs-number">5000</span><br><span class="hljs-comment">#针对某个特定服务的超时配置</span><br><span class="hljs-attr">hailtaxi-driver:</span><br><span class="hljs-attr">connectTimeout:</span> <span class="hljs-number">1000</span><br><span class="hljs-attr">readTimeout:</span> <span class="hljs-number">2000</span><br></code></pre></td></tr></table></figure><h3 id="服务降级"><a href="#服务降级" class="headerlink" title="服务降级"></a>服务降级</h3><p>降级逻辑是在远程服务调用发生超时或者异常（比如 400、500 Error Code）的时候，自动执行的一段</p><p>业务逻辑。你可以根据具体的业务需要编写降级逻辑，比如执行一段兜底逻辑将服务请求从失败状态中</p><p>恢复，或者发送一个失败通知到相关团队提醒它们来线上排查问题。</p><p>OpenFeign 支持两种不同的方式来指定降级逻辑，一种是定义 fallback 类，另一种是定义 fallback 工</p><p>厂。</p><p>譬如这里使用 fallback 工厂，编写xyz.maojun.driver.feign.fallback.DriverFeignFallBackFactory</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DriverFeignFallBackFactory</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">FallbackFactory</span>&lt;DriverFeign&gt;<br>&#123;<br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> DriverFeign <span class="hljs-title function_">create</span><span class="hljs-params">(Throwable cause)</span> &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DriverFeign</span>() &#123;<br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> Driver <span class="hljs-title function_">status</span><span class="hljs-params">(String id, Integer status)</span> &#123;<br>System.out.println(<span class="hljs-string">&quot;走降级&quot;</span>);<br><span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Driver</span>();<br>&#125;<br>&#125;;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>在feign接口上指定</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@FeignClient(</span><br><span class="hljs-meta">name = &quot;hailtaxi-driver&quot;</span><br><span class="hljs-meta">,fallbackFactory = DriverFeignFallBackFactory.class</span><br><span class="hljs-meta">)</span><br></code></pre></td></tr></table></figure><p>opfeign默认集成了hystrix，但未开启，需要开启，降级才生效。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">feign:</span><br><span class="hljs-attr">hystrix:</span><br><span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><h3 id="数据压缩"><a href="#数据压缩" class="headerlink" title="数据压缩"></a>数据压缩</h3><p>用户在网络请求过程中，如果网络不佳、传输数据过大，会造成体验差的问题，我们需要将传输数据压缩提升体验。SpringCloud OpenFeign支持对请求和响应进行GZIP压缩，以减少通信过程中的性能损耗。</p><p>通过配置开启请求与响应的压缩功能，在openfeign的客户端配置，即 hailtaxi-order 中</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">feign:</span><br><span class="hljs-attr">compression:</span><br><span class="hljs-attr">request:</span><br><span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span> <span class="hljs-comment"># 开启请求压缩</span><br><span class="hljs-attr">response:</span><br><span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span> <span class="hljs-comment"># 开启响应压缩</span><br></code></pre></td></tr></table></figure><p>也可以对请求的数据类型，以及触发压缩的大小下限进行设置</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">feign:</span><br><span class="hljs-attr">compression:</span><br><span class="hljs-attr">request:</span><br><span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span> <span class="hljs-comment"># 开启请求压缩</span><br><span class="hljs-attr">mime-types:</span> <span class="hljs-string">text/html,application/xml,application/json</span> <span class="hljs-comment"># 设置压缩的数据类型</span><br><span class="hljs-attr">min-request-size:</span> <span class="hljs-number">2048</span> <span class="hljs-comment"># 设置触发压缩的大小下限</span><br><span class="hljs-comment">#以上数据类型，压缩大小下限均为默认值</span><br><span class="hljs-attr">response:</span><br><span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span> <span class="hljs-comment"># 开启响应压缩</span><br></code></pre></td></tr></table></figure><h3 id="拦截器"><a href="#拦截器" class="headerlink" title="拦截器"></a>拦截器</h3><p>用 Feign 来调用远程服务，比如远程服务的权限验证，需要在 header 中传递 token 之类的。在方法中显式传递又过于麻烦了，这时候就可以考虑使用 Feign 提供的 RequestInterceptor 接口，只要实现了该接口，那么 Feign 每次做远程调用之前都可以被它拦截下来再进行包装。</p><ol><li>在 hailtaxi-api 中创建拦截器</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment">* 1、直接实现接口</span><br><span class="hljs-comment">* 2、继承 BaseRequestInterceptor</span><br><span class="hljs-comment">*/</span><br><span class="hljs-meta">@Slf4j</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyRequestInterceptor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">RequestInterceptor</span> &#123;<br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">apply</span><span class="hljs-params">(RequestTemplate template)</span> &#123;<br><span class="hljs-type">String</span> <span class="hljs-variable">url</span> <span class="hljs-operator">=</span> template.url();<br>Map&lt;String, Collection&lt;String&gt;&gt; headers = template.headers();<br><span class="hljs-type">String</span> <span class="hljs-variable">method</span> <span class="hljs-operator">=</span> template.method();<br>Map&lt;String, Collection&lt;String&gt;&gt; queries = template.queries();<br>    Request.<span class="hljs-type">Body</span> <span class="hljs-variable">body</span> <span class="hljs-operator">=</span> template.requestBody();<br>log.info(<span class="hljs-string">&quot;url=&#123;&#125;,headers=&#123;&#125;,method=&#123;&#125;,queries=&#123;&#125;,body=</span><br><span class="hljs-string">&#123;&#125;&quot;</span>,url,headers,method,queries,body);<br><span class="hljs-comment">//添加头信息</span><br>template.header(<span class="hljs-string">&quot;GlobalId&quot;</span>, UUID.randomUUID().toString());<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><ol start="2"><li>在 hailtaxi-order 中创建配置类，加入容器即可</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InterceptorConfiguration</span> &#123;<br><span class="hljs-meta">@Bean</span><br><span class="hljs-keyword">public</span> RequestInterceptor <span class="hljs-title function_">interceptor</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyRequestInterceptor</span>();<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>(完)</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>OpenFeign</category>
      
    </categories>
    
    
    <tags>
      
      <tag>微服务</tag>
      
      <tag>OpenFeign</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Consul简介和入门</title>
    <link href="/blog/2020/04/Consul%E7%AE%80%E4%BB%8B%E5%92%8C%E5%85%A5%E9%97%A8.html"/>
    <url>/blog/2020/04/Consul%E7%AE%80%E4%BB%8B%E5%92%8C%E5%85%A5%E9%97%A8.html</url>
    
    <content type="html"><![CDATA[<h2 id="Consul介绍"><a href="#Consul介绍" class="headerlink" title="Consul介绍"></a>Consul介绍</h2><p>Consul 是 HashiCorp 公司推出的开源工具，用于实现分布式系统的服务发现与配置。与其它分布式服务注册与发现的方案相比较，Consul 的方案更“一站式”，内置了服务注册与发现框架、分布一致性协议实现、健康检查、Key&#x2F;Value 存储、多数据中心方案，不再需要依赖其它工具（比如 ZooKeeper 等）。使用起来也较为简单。Consul 使用 Go 语言编写，因此具有天然可移植性(支持Linux、windows和MacOS X)；安装包仅包含一个可执行文件，方便部署，与 Docker 等轻量级容器可无缝配合。</p><p>Consul和其他服务注册和发现框架的对比：</p><table><thead><tr><th align="center">对比项</th><th align="center">euerka</th><th align="center">Consul</th><th align="center">zookeeper</th><th align="center">etcd</th></tr></thead><tbody><tr><td align="center">服务健康检查</td><td align="center">可配支持</td><td align="center">服务状态，内  存，硬盘等</td><td align="center">(弱)长连接， keepalive</td><td align="center">连接心跳</td></tr><tr><td align="center">多数据中心</td><td align="center">&#x2F;</td><td align="center">支持</td><td align="center">&#x2F;</td><td align="center">&#x2F;</td></tr><tr><td align="center">ky存储服务</td><td align="center">&#x2F;</td><td align="center">支持</td><td align="center">支持</td><td align="center">支持</td></tr><tr><td align="center">一致性</td><td align="center">&#x2F;</td><td align="center">raft</td><td align="center">paxos</td><td align="center">raft</td></tr><tr><td align="center">cap</td><td align="center">ap</td><td align="center">Cp</td><td align="center">Cp</td><td align="center">Cp</td></tr><tr><td align="center">使用接口(多语  言能力)</td><td align="center">http</td><td align="center">支持http和dns</td><td align="center">客户端</td><td align="center">http&#x2F;grpc</td></tr><tr><td align="center">watch支持</td><td align="center">支持long polling&#x2F;大  部分增量</td><td align="center">全量&#x2F;支持long   polling</td><td align="center">支持</td><td align="center">支持long  polling</td></tr><tr><td align="center">自身监控</td><td align="center">metrics</td><td align="center">metrics</td><td align="center">&#x2F;</td><td align="center">metrics</td></tr><tr><td align="center">安全</td><td align="center">&#x2F;</td><td align="center">acl &#x2F;https</td><td align="center">acl</td><td align="center">https支持    (弱)</td></tr><tr><td align="center">spring cloud  集成</td><td align="center">已支持</td><td align="center">已支持</td><td align="center">已支持</td><td align="center">已支持</td></tr></tbody></table><h4 id="特性"><a href="#特性" class="headerlink" title="特性"></a>特性</h4><ul><li><p>服务发现</p></li><li><p>健康检查</p></li><li><p>Key&#x2F;Value 存储</p></li><li><p>多数据中心</p></li><li><p>社区活跃</p></li></ul><h4 id="优势"><a href="#优势" class="headerlink" title="优势"></a>优势</h4><ul><li><p>使用 Raft 算法来保证一致性, 比复杂的 Paxos 算法更直接. 相比较而言, zookeeper 采用的是 Paxos, 而 etcd 使用的则是 Raft。</p></li><li><p>支持多数据中心，内外网的服务采用不同的端口进行监听。  多数据中心集群可以避免单数据中心的 单点故障,而其部署则需要考虑网络延迟, 分片等情况等。  zookeeper 和 etcd 均不提供多数据中心 功能的支持。</p></li><li><p>支持健康检查。  etcd 不提供此功能。</p></li><li><p>支持 http 和 dns 协议接口。  zookeeper 的集成较为复杂, etcd 只支持 http 协议。</p></li><li><p>官方提供 web 管理界面, etcd 无此功能。</p></li><li><p>综合比较, Consul 作为服务注册和配置管理的新星, 比较值得关注和研究。</p></li><li><p>提供了rest api 便于集成：  <a href="https://www.consul.io/api-docs/index">https://www.consul.io/api-docs/index</a></p></li></ul><h4 id="角色"><a href="#角色" class="headerlink" title="角色"></a>角色</h4><ul><li>client: 客户端, 无状态, 将 HTTP 和 DNS 接口请求转发给局域网内的服务端集群。</li><li>server: 服务端, 保存配置信息, 高可用集群, 在局域网内与本地客户端通讯, 通过广域网与其它数据中心通讯。每个数据中心的 server 数量推荐为 3 个或是 5 个。</li></ul><p>Consul 客户端、服务端还支持跨中心的使用，更加提高了它的高可用性。</p><h4 id="基础架构"><a href="#基础架构" class="headerlink" title="基础架构"></a>基础架构</h4><ul><li>agent</li></ul><p>组成 consul 集群的每个成员上都要运行一个 agent，可以通过 consul agent 命令来启动。agent可以运</p><p>行在 server 状态或者 client 状态。自然的，运行在 server 状态的节点被称为 server 节点；运行在</p><p>client 状态的节点被称为 client 节点。</p><ul><li>server 节点</li></ul><p>负责组成 cluster 的复杂工作（选举server 自行选举一个 leader、状态维护、转发请求到 leader），以</p><p>及 consul 提供的服务（响应RPC 请求），以及存放和复制数据。考虑到容错和收敛，一般部署 3 ~ 5 个</p><p>比较合适。</p><ul><li>client 节点</li></ul><p>负责转发所有的 RPC 到 server 节点。本身无状态，且轻量级，因此，可以部署大量的client 节点。</p><ul><li>数据中心</li></ul><p>虽然数据中心的定义似乎很明显，但仍有一些细微的细节必须考虑。我们将一个数据中心定义为一个私</p><p>有、低延迟和高带宽的网络环境。这不包括通过公共互联网的通信，但是为了我们的目的，单个EC2 区</p><p>域内的多个可用区域将被视为单个数据中心的一部分。</p><p>另外，server 自行选举一个 leader。虽然 Consul 可以运行在一台 server ，但是建议使用 3 到 5 台来避免失败情况下数据的丢失。每个数据中心建议配置一个 server 集群。</p><p>在基础设施中需要发现其他服务的组件可以查询任何一个 Consul 的 server 或者agent，Agent 会自动</p><p>转发请求到 server。每个数据中心运行了一个 Consul server 集群。当一个跨数据中心的服务发现和配置请求创建时，本地Consul Server 转发请求到远程的数据中心并返回结果。</p><p><img src="/blog/./assets/image-1db1r20an3eb0kb55xm13r5.PNG" alt="consul流程图"></p><h4 id="现服务注册和发现"><a href="#现服务注册和发现" class="headerlink" title="现服务注册和发现"></a>现服务注册和发现</h4><p><img src="/blog/./assets/image-tpv569baonfctdmlcvmofiw.PNG" alt="服务注册和发现"></p><p>Consul在项目中发挥服务注册与发现的功能，我们讲解下它的工作原理：</p><ol><li>当Producer启动的时候，会向Consul发送一个post请求，并向Consul传输自己的IP和Port。</li><li>Consul 接收到Producer的注册后，每隔10s（默认）会向Producer发送一个健康检查的请求，检验Producer是否健康。</li><li>当Consumer以Http的方式向Producer发起请求，会先从Consul中拿到一个存储服务IP和Port的临时表，从表中拿到Producer的IP和Port后再发送请求。</li><li>该临时表每隔10s会更新，只包含有通过了健康检查的Producer。</li></ol><h2 id="Consul安装"><a href="#Consul安装" class="headerlink" title="Consul安装"></a>Consul安装</h2><h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><p>下载地址：<a href="https://www.consul.io/downloads.html%EF%BC%9B">https://www.consul.io/downloads.html；</a></p><p>历史版本下载地址：<a href="https://releases.hashicorp.com/consul/">https://releases.hashicorp.com/consul/</a></p><p><img src="/blog/./assets/image-cvvvcvvbm9hx838328hk75b.PNG" alt="下载安装"></p><p>下载后解压添加到环境变量到path中。</p><h3 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h3><p>consul server运行，参考如下命令：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">agent -server -bootstrap-expect 1 -data-dir<br>server -node=n1 -ui -client=0.0.0.0 -<span class="hljs-built_in">bind</span>=192.168.10.11<br></code></pre></td></tr></table></figure><ul><li>-server 定义 agent 运行在 server 模式</li><li>-bootstrap-expect 1 在一个 datacenter 中期望提供的 server 节点数目，当该值提供的时候，consul一直等到达到指定 sever 数目的时候才会引导整个集群。这里我们为了方便演示只启动一个服务端</li><li>-data-dir 参数设置 Consul 自己的维护的数据存储路径</li><li>-node&#x3D;n1 节点在集群中的名称，在一个集群中必须是唯一的，默认是该节点的主机名</li><li>bind&#x3D;192.168.10.11 该地址用来在集群内部的通讯，集群内的所有节点到地址都必须是可达的，默认是 0.0.0.0</li><li>-datacenter&#x3D;dc1 指定当前数据中心名字，该参数可以不设置</li><li>-ui 指定可以以 UI 的方式呈现，当前的 UI 访问地址是:http:&#x2F;&#x2F;本机 IP:8500</li><li>-client&#x3D;0.0.0.0 consul 服务侦听地址，这个地址提供 HTTP、DNS、RPC 等服务，默认是127.0.0.1所以不对外提供服务，如果你要对外提供服务改成 0.0.0.0，我们当前配置为对外提供地址。</li></ul><p>完整启动选项参数见官方文档：<a href="https://www.consul.io/docs/agent/options">https://www.consul.io/docs/agent/options</a></p><p>启动后访问控制台UI: <a href="http://192.168.10.11:8500/">http://192.168.10.11:8500/</a></p><p><img src="/blog/./assets/image-flbmbpu8upwukh1i88fudah.PNG" alt="控制台UI"></p><ul><li>Services ：服务信息。</li><li>Nodes ：节点信息，Consul支持集群。</li><li>Key&#x2F;Value ：存储的动态配置信息。</li><li>ACL ：权限信息。</li><li>Intentions ：通过命令的方式对consul进行管理。</li></ul><p>consul client运行，参考命令如下：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">./consul agent -data-dir /opt/itcast/springcloud/data/client -node=n2 -ui -client=0.0.0.0 -<span class="hljs-built_in">bind</span>=192.168.10.30 -<span class="hljs-built_in">join</span> 192.168.10.11<br></code></pre></td></tr></table></figure><p>通过以上两步操作，就启动了一个完整的数据中心。如果为了方便使用，可以使用如下命令启动一个agent server。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">consul agent -dev<br></code></pre></td></tr></table></figure><h2 id="Consul实践"><a href="#Consul实践" class="headerlink" title="Consul实践"></a>Consul实践</h2><p>项目中要想使用Consul作为服务注册中心，只需要引入如下依赖包，在启动类上添加</p><p>@EnableDiscoveryClient 注解，并在 application.yml 中添加Consul服务地址即可：</p><ol><li>添加依赖</li></ol><p>在项目 hailtaxi-order 添加依赖包：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--consul--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-starter-consul-discovery<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.2.1.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.2.10.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><ol start="2"><li>添加 @EnableDiscoveryClient 注解</li></ol><p>在 hailtaxi-order 启动类 OrderApplication 上添加 @EnableDiscoveryClient 注解。</p><ol start="3"><li>配置Consul服务信息</li></ol><p>在 application.yml 中添加Consul服务信息：</p><p><img src="/blog/./assets/image-vgqy0uuer4lpnoldvmqtig3.PNG" alt="配置信息"></p><p>Yaml配置信息如下：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">spring:</span><br><span class="hljs-attr">application:</span><br><span class="hljs-attr">name:</span> <span class="hljs-string">hailtaxi-order</span><br><span class="hljs-attr">datasource:</span><br><span class="hljs-attr">driver-class-name:</span> <span class="hljs-string">com.mysql.cj.jdbc.Driver</span><br><span class="hljs-comment"># 使用docker启动MySQL数据库：</span><br><span class="hljs-comment"># 1. docker run -itd --name mysql-hailtaxi -p 3306:3306 -v</span><br><span class="hljs-string">/opt/itcast/spring-cloud/data/mysql:/var/lib/mysql</span> <span class="hljs-string">-v</span> <span class="hljs-string">/opt/itcast/springcloud/sql/:/opt/sql</span> <span class="hljs-string">-e</span> <span class="hljs-string">MYSQL_ROOT_PASSWORD=123456</span> <span class="hljs-string">mysql:8.0</span><br><span class="hljs-comment"># 2. docker exec -it mysql-hailtaxi bash</span><br><span class="hljs-comment"># 3. 执行sql语句</span><br><span class="hljs-attr">url:</span> <span class="hljs-string">jdbc:mysql://linux30:3306/hailtaxi-order?</span><br><span class="hljs-string">useUnicode=true&amp;characterEncoding=UTF-8&amp;serverTimezone=UTC</span><br><span class="hljs-attr">username:</span> <span class="hljs-string">root</span><br><span class="hljs-attr">password:</span> <span class="hljs-number">123456</span><br><span class="hljs-attr">cloud:</span><br><span class="hljs-comment">#Consul配置</span><br><span class="hljs-attr">consul:</span><br><span class="hljs-attr">host:</span> <span class="hljs-string">localhost</span><br><span class="hljs-attr">port:</span> <span class="hljs-number">8500</span><br><span class="hljs-attr">discovery:</span><br><span class="hljs-comment">#注册到Consul中的服务名字</span><br><span class="hljs-attr">service-name:</span> <span class="hljs-string">$&#123;spring.application.name&#125;</span><br><span class="hljs-comment">#注册的服务的实例 Id，最好不要重复，这里参考官网建议的方式 带随机数</span><br><span class="hljs-comment">#instance-id:</span><br><span class="hljs-string">$&#123;spring.application.name&#125;:$&#123;vcap.application.instance_id:$&#123;spring.application.i</span><br><span class="hljs-string">nstance_id:$&#123;random.value&#125;&#125;&#125;</span><br><span class="hljs-comment"># 自定义实例id为:应用名:ip:port</span><br><span class="hljs-attr">instance-id:</span> <span class="hljs-string">$&#123;spring.application.name&#125;:$&#123;spring.cloud.client.ipaddress&#125;:$&#123;server.port&#125;</span><br><span class="hljs-attr">prefer-ip-address:</span> <span class="hljs-literal">true</span><br><span class="hljs-comment"># 开启服务注册</span><br><span class="hljs-attr">register:</span> <span class="hljs-literal">true</span><br><span class="hljs-comment"># 开启服务发现</span><br><span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span><br><span class="hljs-comment">#2 分钟之后健康检查未通过取消注册</span><br><span class="hljs-attr">health-check-critical-timeout:</span> <span class="hljs-string">2m</span><br><span class="hljs-comment">#consul 健康检查的轮询周期</span><br><span class="hljs-attr">health-check-interval:</span> <span class="hljs-string">10s</span><br><br></code></pre></td></tr></table></figure><ol start="4"><li>Consul服务数据</li></ol><p><img src="/blog/./assets/image-9gec8m7u1xih4kpfghke7am.PNG" alt="服务数据"></p><p>（完）</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>Consul</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Consul</tag>
      
      <tag>微服务</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Dubbo简介与原理</title>
    <link href="/blog/2020/04/Dubbo%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%8E%9F%E7%90%86.html"/>
    <url>/blog/2020/04/Dubbo%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%8E%9F%E7%90%86.html</url>
    
    <content type="html"><![CDATA[<h2 id="Dubbo架构体系"><a href="#Dubbo架构体系" class="headerlink" title="Dubbo架构体系"></a>Dubbo架构体系</h2><h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><p>Dubbo是一个高性能优秀的服务框架，使得应用可通过高性能的 RPC 实现服务的输出和输入功能，可以和 Spring框架无缝集成。同时Dubbo是一款高性能、轻量级的开源Java RPC框架，它提供了三大核心能力：</p><ol><li>面向接口的远程方法调用。</li><li>智能容错和负载均衡。</li><li>服务自动注册和发现。</li></ol><h3 id="运行架构"><a href="#运行架构" class="headerlink" title="运行架构"></a>运行架构</h3><p><img src="/blog/./assets/image-ofctlzky2dk2e8v8gaq4i6t.PNG" alt="image-ofctlzky2dk2e8v8gaq4i6t"></p><h4 id="节点角色"><a href="#节点角色" class="headerlink" title="节点角色"></a>节点角色</h4><table><thead><tr><th>节点</th><th>角色说明</th></tr></thead><tbody><tr><td>Provider</td><td>暴露服务的服务提供方</td></tr><tr><td>Consumer</td><td>调用远程服务的服务消费方</td></tr><tr><td>Registry</td><td>服务注册与发现的注册中心</td></tr><tr><td>Monitor</td><td>统计服务的调用次数和调用时间的监控中心</td></tr><tr><td>Container</td><td>服务运行容器</td></tr></tbody></table><h4 id="调用关系"><a href="#调用关系" class="headerlink" title="调用关系"></a>调用关系</h4><ol><li><p>服务容器负责启动，加载，运行服务提供者。</p></li><li><p>服务提供者在启动时，向注册中心注册自己提供的服务。</p></li><li><p>服务消费者在启动时，向注册中心订阅自己所需的服务。</p></li><li><p>注册中心返回服务提供者地址列表给消费者，如果有变更，注册中心将基于长连接推送变更数据给消费者。</p></li><li><p>服务消费者，从提供者地址列表中，基于软负载均衡算法，选一台提供者进行调用，如果调用失败，再选另一台调用。</p></li><li><p>服务消费者和提供者，在内存中累计调用次数和调用时间，定时每分钟发送一次统计数据到监控中心</p></li></ol><blockquote><p>dubbo 的特点有连通性、健壮性、伸缩性、以及向未来架构的升级性。</p></blockquote><h3 id="整体设计"><a href="#整体设计" class="headerlink" title="整体设计"></a>整体设计</h3><p><img src="/blog/./assets/image-3gg2d8fkulhczchlfayf754.PNG" alt="Dubbo调用设计"></p><h4 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h4><ul><li>图中左边淡蓝背景的为服务消费方使用的接口，右边淡绿色背景的为服务提供方使用的接口，位于中轴线上的为双方都用到的接口。</li><li>图中从下至上分为十层，各层均为单向依赖，右边的黑色箭头代表层之间的依赖关系，每一层都可以剥离上层被复用，其中，Service 和Config 层为 API，其它各层均为 SPI。</li><li>图中绿色小块的为扩展接口，蓝色小块为实现类，图中只显示用于关联各层的实现类。</li><li>图中蓝色虚线为初始化过程，即启动时组装链，红色实线为方法调用过程，即运行时调时链，紫色三角箭头为继承，可以把子类看作父类的同一个节点，线上的文字为调用的方法</li></ul><h4 id="各层说明"><a href="#各层说明" class="headerlink" title="各层说明"></a>各层说明</h4><ul><li><p>config 配置层</p><p>对外配置接口，以 ServiceConfig ,ReferenceConfig 为中心，可以直接初始化配置类，也可以通过spring 解析配置生成配置类。</p></li><li><p>proxy 服务代理层</p><p>服务接口透明代理，生成服务的客户端 Stub 和服务器端 Skeleton, 以 ServiceProxy 为中心，扩展接口为ProxyFactory。</p></li><li><p>registry 注册中心层</p><p>封装服务地址的注册与发现，以服务 URL 为中心，扩展接口为 RegistryFactory , Registry , RegistryService。</p></li><li><p>cluster 路由层</p><p>封装多个提供者的路由及负载均衡，并桥接注册中心，以 Invoker 为中心，扩展接口为 Cluster , Directory ,Router , LoadBalance。</p></li><li><p>monitor 监控层</p><p>RPC 调用次数和调用时间监控，以 Statistics 为中心，扩展接口为 MonitorFactory , Monitor , MonitorService。</p></li><li><p>protocol 远程调用层</p><p>封装 RPC 调用，以 Invocation , Result 为中心，扩展接口为 Protocol , Invoker , Exporter。</p></li><li><p>exchange 信息交换层</p><p>封装请求响应模式，同步转异步，以Request , Response 为中心，扩展接口为 Exchanger ,ExchangeChannel , ExchangeClient , ExchangeServer。</p></li><li><p>transport 网络传输层</p><p>抽象 mina 和 netty 为统一接口，以Message 为中心，扩展接口为 Channel , Transporter , Client ,Server , Codec。</p></li><li><p>serialize 数据序列化层</p><p>可复用的一些工具，扩展接口为Serialization , ObjectInput , ObjectOutput , ThreadPool。</p></li></ul><h3 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h3><h4 id=""><a href="#" class="headerlink" title=""></a></h4><h4 id="源码拉取"><a href="#源码拉取" class="headerlink" title="源码拉取"></a>源码拉取</h4><p>通过以下命令获取最新的dubbo项目源码</p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs basic"><span class="hljs-symbol">1 </span>git clone https://github.<span class="hljs-keyword">com</span>/apache/dubbo.git dubbo<br></code></pre></td></tr></table></figure><p><img src="/blog/./assets/image-a0hfuid4bus35o8pjxxxcgd.PNG" alt="dubbo-2.7.2源码"></p><p>下载源码导入工程后，跳过测试并进行编译。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs java">[ERROR] Failed to execute goal<br>org.xolstice.maven.plugins:protobuf-maven-<br>plugin: <span class="hljs-number">0.</span> <span class="hljs-number">5.</span> <span class="hljs-number">1</span> :compile (<span class="hljs-keyword">default</span>) on project dubbo-<br>serialization-protobuf: Missing:<br>[ERROR] - ---------<br>[ERROR] <span class="hljs-number">1</span> ) com.google.protobuf:protoc:exe:windows-<br>x <span class="hljs-number">86</span> _ <span class="hljs-number">64</span> : <span class="hljs-number">3.</span> <span class="hljs-number">7.</span> <span class="hljs-number">1</span><br>[ERROR]<br>[ERROR] Try downloading the file manually from the<br>project website.<br>[ERROR]<br>[ERROR] Then, install it using the command:<br>[ERROR] mvn install:install-file -<br>DgroupId=com.google.protobuf - DartifactId=protoc -<br>Dversion= <span class="hljs-number">3.</span> <span class="hljs-number">7.</span> <span class="hljs-number">1</span> - Dclassifier=windows-x <span class="hljs-number">86</span> _ <span class="hljs-number">64</span> -<br>Dpackaging=exe - Dfile=/path/to/file<br>[ERROR]<br>[ERROR] Alternatively, <span class="hljs-keyword">if</span> you host your own<br>repository you can deploy the file there:<br>[ERROR] mvn deploy:deploy-file -<br>DgroupId=com.google.protobuf - DartifactId=protoc -<br>Dversion= <span class="hljs-number">3.</span> <span class="hljs-number">7.</span> <span class="hljs-number">1</span> - Dclassifier=windows-x <span class="hljs-number">86</span> _ <span class="hljs-number">64</span> -<br>Dpackaging=exe - Dfile=/path/to/file - Durl=[url] -<br>DrepositoryId=[id]<br>[ERROR]<br>[ERROR] Path to dependency:<br>[ERROR] <span class="hljs-number">1</span> ) org.apache.dubbo:dubbo-serialization-<br>protobuf:jar: <span class="hljs-number">2.</span> <span class="hljs-number">7.</span> <span class="hljs-number">8</span><br>[ERROR] <span class="hljs-number">2</span> ) com.google.protobuf:protoc:exe:windows-<br>x <span class="hljs-number">86</span> _ <span class="hljs-number">64</span> : <span class="hljs-number">3.</span> <span class="hljs-number">7.</span> <span class="hljs-number">1</span><br>[ERROR]<br>[ERROR] - ---------<br>[ERROR] <span class="hljs-number">1</span> required artifact is missing.<br>[ERROR]<br>[ERROR] <span class="hljs-keyword">for</span> artifact:<br>[ERROR] org.apache.dubbo:dubbo-serialization-<br>protobuf:jar: <span class="hljs-number">2.</span> <span class="hljs-number">7.</span> <span class="hljs-number">8</span><br>[ERROR]<br>[ERROR] from the specified remote repositories:<br>[ERROR] apache.snapshots<br>(https:<span class="hljs-comment">//repository.apache.org/snapshots,</span><br>releases=<span class="hljs-literal">false</span>, snapshots=<span class="hljs-literal">true</span>),<br>[ERROR] alimaven<br>(http:<span class="hljs-comment">//maven.aliyun.com/nexus/content/groups/public/,</span><br>releases=<span class="hljs-literal">true</span>, snapshots=<span class="hljs-literal">false</span>)<br></code></pre></td></tr></table></figure><p>根据报错解决问题：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">mvn install:install-file -DgroupId=com.google.protobuf-DartifactId=protoc -Dversion=<span class="hljs-number">3.7</span><span class="hljs-number">.1</span> -Dclassifier=windows-x86_64 -Dpackaging=exe -Dfile=C:\Users\maojun\test\protoc-<span class="hljs-number">3.7</span><span class="hljs-number">.1</span>-windows-x86_64.exe<br></code></pre></td></tr></table></figure><h4 id="源码结构"><a href="#源码结构" class="headerlink" title="源码结构"></a>源码结构</h4><p>dubbo源码各个模块的相关作用：</p><p>dd<img src="/blog/./assets/image-ivymjilkeodmg19pyqke383.PNG" alt="源码结构"></p><h5 id="-1"><a href="#-1" class="headerlink" title=""></a></h5><h4 id="模块说明"><a href="#模块说明" class="headerlink" title="模块说明"></a>模块说明</h4><ul><li><p>dubbo-common 公共逻辑模块</p><p>包括 Util 类和通用模型。</p></li><li><p>dubbo-remoting 远程通讯模块</p><p>相当于 Dubbo 协议的实现，如果RPC 用 RMI协议则不需要使用此包。</p></li><li><p>dubbo-rpc 远程调用模块</p><p>抽象各种协议，以及动态代理，只包含一对一的调用，不关心集群的管理。</p></li><li><p>dubbo-cluster 集群模块</p><p>将多个服务提供方伪装为一个提供方，包括：负载均衡, 容错，路由等，集群的地址列表可以是静态配置的，也可以是由注册中心下发。</p></li><li><p>dubbo-registry 注册中心模块</p><p>基于注册中心下发地址的集群方式，以及对各种注册中心的抽象。</p></li><li><p>dubbo-monitor 监控模块</p><p>统计服务调用次数，调用时间的，调用链跟踪的服务。</p></li><li><p>dubbo-config 配置模块</p><p>是 Dubbo 对外的 API，用户通过 Config 使用Dubbo，隐藏 Dubbo 所有细节。</p></li><li><p>dubbo-container 容器模块</p><p>是一个 Standlone 的容器，以简单的Main 加载 Spring 启动，因为服务通常不需要 Tomcat&#x2F;JBoss 等 Web容器的特性，没必要用 Web 容器去加载服务。</p></li></ul><h4 id="环境导入"><a href="#环境导入" class="headerlink" title="环境导入"></a>环境导入</h4><p>导入到IDEA中。</p><h4 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h4><ol><li>安装zookeeper</li><li>修改demo案例，配置zookeeper地址</li><li>启动服务提供者，启动服务消费者</li></ol><h4 id="管理控制台"><a href="#管理控制台" class="headerlink" title="管理控制台"></a>管理控制台</h4><ol><li><a href="https://github.com/apache/dubbo-admin">下载管理控制台</a></li><li>进入源码目录， 进行打包编译</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">mvn clean <span class="hljs-keyword">package</span> -Dmaven.test.skip=<span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><p>构建成功提示：</p><p><img src="/blog/./assets/image-8d61uru53nes6o12oejf5xt.PNG" alt="构建完成"></p><ol start="3"><li>启动后台管理服务</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-number">1</span> mvn clean <span class="hljs-keyword">package</span> - Dmaven.test.skip=<span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><p><img src="/blog/./assets/image-exqvt54zjjlud8ngxir9jsl.PNG" alt="启动服务"></p><ol start="4"><li>管理后台</li></ol><p>地址： <a href="http://127.0.0.1:8080/">http://127.0.0.1:8080/</a></p><p>默认账户名和密码都为root，进入管控台， 可以看到所启动的服务端与消费端。</p><p><img src="/blog/./assets/image-rg710jvtsndtjaeusw132fp.PNG" alt="管控台"></p><h3 id="Dubbo实践"><a href="#Dubbo实践" class="headerlink" title="Dubbo实践"></a>Dubbo实践</h3><h4 id="与SpringBoot的整合"><a href="#与SpringBoot的整合" class="headerlink" title="与SpringBoot的整合"></a>与SpringBoot的整合</h4><p>基于Zookeeper实现Dubbo与Spring Boot的集成整合。</p><h5 id="项目POM依赖"><a href="#项目POM依赖" class="headerlink" title="项目POM依赖"></a>项目POM依赖</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">properties</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dubbo-version</span>&gt;</span> 2. 7. 8 <span class="hljs-tag">&lt;/<span class="hljs-name">dubbo-version</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">spring-boot.version</span>&gt;</span> 2. 3. 0 .RELEASE&lt;/spring-<br>boot.version&gt;<br><span class="hljs-tag">&lt;/<span class="hljs-name">properties</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependencyManagement</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br><span class="hljs-comment">&lt;!-- Spring Boot - -&gt;</span><br><span class="hljs-comment">&lt;dependency&gt;</span><br><span class="hljs-comment">&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="hljs-comment">&lt;artifactId&gt;spring-boot-</span><br><span class="hljs-comment">dependencies&lt;/artifactId&gt;</span><br><span class="hljs-comment">&lt;version&gt;$&#123;spring-boot.version&#125;&lt;/version&gt;</span><br><span class="hljs-comment">&lt;type&gt;pom&lt;/type&gt;</span><br><span class="hljs-comment">&lt;scope&gt;import&lt;/scope&gt;</span><br><span class="hljs-comment">&lt;/dependency&gt;</span><br><span class="hljs-comment">&lt;!-- Apache Dubbo - -&gt;</span><br><span class="hljs-comment">&lt;dependency&gt;</span><br><span class="hljs-comment">&lt;groupId&gt;org.apache.dubbo&lt;/groupId&gt;</span><br><span class="hljs-comment">&lt;artifactId&gt;dubbo-dependencies-</span><br><span class="hljs-comment">bom&lt;/artifactId&gt;</span><br><span class="hljs-comment">&lt;version&gt;$&#123;dubbo-version&#125;&lt;/version&gt;</span><br><span class="hljs-comment">&lt;type&gt;pom&lt;/type&gt;</span><br><span class="hljs-comment">&lt;scope&gt;import&lt;/scope&gt;</span><br><span class="hljs-comment">&lt;/dependency&gt;</span><br><span class="hljs-comment">&lt;dependency&gt;</span><br><span class="hljs-comment">&lt;groupId&gt;org.apache.dubbo&lt;/groupId&gt;</span><br><span class="hljs-comment">&lt;artifactId&gt;dubbo&lt;/artifactId&gt;</span><br><span class="hljs-comment">&lt;version&gt;$&#123;dubbo-version&#125;&lt;/version&gt;</span><br><span class="hljs-comment">&lt;exclusions&gt;</span><br><span class="hljs-comment">&lt;exclusion&gt;</span><br><span class="hljs-comment">&lt;groupId&gt;org.springframework&lt;/groupId&gt;</span><br><span class="hljs-comment">&lt;artifactId&gt;spring&lt;/artifactId&gt;</span><br><span class="hljs-comment">&lt;/exclusion&gt;</span><br><span class="hljs-comment">&lt;exclusion&gt;</span><br><span class="hljs-comment">&lt;groupId&gt;javax.servlet&lt;/groupId&gt;</span><br><span class="hljs-comment">&lt;artifactId&gt;servlet-</span><br><span class="hljs-comment">api&lt;/artifactId&gt;</span><br><span class="hljs-comment">&lt;/exclusion&gt;</span><br><span class="hljs-comment">&lt;exclusion&gt;</span><br><span class="hljs-comment">&lt;groupId&gt;log 4 j&lt;/groupId&gt;</span><br><span class="hljs-comment">&lt;artifactId&gt;log 4 j&lt;/artifactId&gt;</span><br><span class="hljs-comment">&lt;/exclusion&gt;</span><br><span class="hljs-comment">&lt;/exclusions&gt;</span><br><span class="hljs-comment">&lt;/dependency&gt;</span><br><span class="hljs-comment">&lt;/dependencies&gt;</span><br><span class="hljs-comment">&lt;/dependencyManagement&gt;</span><br><span class="hljs-comment">&lt;dependencies&gt;</span><br><span class="hljs-comment">&lt;!-- Dubbo Spring Boot Starter - -&gt;</span><br><span class="hljs-comment">&lt;dependency&gt;</span><br><span class="hljs-comment">&lt;groupId&gt;org.apache.dubbo&lt;/groupId&gt;</span><br><span class="hljs-comment">&lt;artifactId&gt;dubbo-spring-boot-</span><br><span class="hljs-comment">starter&lt;/artifactId&gt;</span><br><span class="hljs-comment">&lt;version&gt;$&#123;dubbo-version&#125;&lt;/version&gt;</span><br><span class="hljs-comment">&lt;/dependency&gt;</span><br><span class="hljs-comment">&lt;!-- Dubbo核心组件 - -&gt;</span><br><span class="hljs-comment">&lt;dependency&gt;</span><br><span class="hljs-comment">&lt;groupId&gt;org.apache.dubbo&lt;/groupId&gt;</span><br><span class="hljs-comment">&lt;artifactId&gt;dubbo&lt;/artifactId&gt;</span><br><span class="hljs-comment">&lt;/dependency&gt;</span><br><span class="hljs-comment">&lt;!--Spring Boot 依赖 - -&gt;</span><br><span class="hljs-comment">&lt;dependency&gt;</span><br><span class="hljs-comment">&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="hljs-comment">&lt;artifactId&gt;spring-boot-starter-</span><br><span class="hljs-comment">web&lt;/artifactId&gt;</span><br><span class="hljs-comment">&lt;version&gt;$&#123;spring-boot.version&#125;&lt;/version&gt;</span><br><span class="hljs-comment">&lt;/dependency&gt;</span><br><span class="hljs-comment">&lt;!-- Zookeeper客户端框架 - -&gt;</span><br><span class="hljs-comment">&lt;dependency&gt;</span><br><span class="hljs-comment">&lt;groupId&gt;org.apache.curator&lt;/groupId&gt;</span><br><span class="hljs-comment">&lt;artifactId&gt;curator-framework&lt;/artifactId&gt;</span><br><span class="hljs-comment">&lt;version&gt; 4. 0. 1 &lt;/version&gt;</span><br><span class="hljs-comment">&lt;/dependency&gt;</span><br><span class="hljs-comment">&lt;!-- Zookeeper dependencies - -&gt;</span><br><span class="hljs-comment">&lt;dependency&gt;</span><br><span class="hljs-comment">&lt;groupId&gt;org.apache.dubbo&lt;/groupId&gt;</span><br><span class="hljs-comment">&lt;artifactId&gt;dubbo-dependencies-</span><br><span class="hljs-comment">zookeeper&lt;/artifactId&gt;</span><br><span class="hljs-comment">&lt;version&gt;$&#123;dubbo-version&#125;&lt;/version&gt;</span><br><span class="hljs-comment">&lt;type&gt;pom&lt;/type&gt;</span><br><span class="hljs-comment">&lt;exclusions&gt;</span><br><span class="hljs-comment">&lt;exclusion&gt;</span><br><span class="hljs-comment">&lt;groupId&gt;org.slf 4 j&lt;/groupId&gt;</span><br><span class="hljs-comment">&lt;artifactId&gt;slf 4 j-log 4 j 12 &lt;/artifactId&gt;</span><br><span class="hljs-comment">&lt;/exclusion&gt;</span><br><span class="hljs-comment">&lt;/exclusions&gt;</span><br><span class="hljs-comment">&lt;/dependency&gt;</span><br><span class="hljs-comment">&lt;/dependencies&gt;</span><br></code></pre></td></tr></table></figure><p>Dubbo采用2.7.8版本， Spring Boot采用的是2.3.0.RELEASE版本。</p><p>如果依赖下载出现问题， 可以指定具体的仓库：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">repositories</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">repository</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span>apache.snapshots.https<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>Apache Development Snapshot<br>Repository<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">url</span>&gt;</span>https://repository.apache.org/content/repositories/s<br>napshots<span class="hljs-tag">&lt;/<span class="hljs-name">url</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">releases</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">enabled</span>&gt;</span>false<span class="hljs-tag">&lt;/<span class="hljs-name">enabled</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">releases</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">snapshots</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">enabled</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">enabled</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">snapshots</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">repository</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">repositories</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="-2"><a href="#-2" class="headerlink" title=""></a></h4><h5 id="公用RPC接口工程"><a href="#公用RPC接口工程" class="headerlink" title="公用RPC接口工程"></a>公用RPC接口工程</h5><p>为便于客户端与服务端的RPC接口引用， 定义了一个订单服务接口， 用于测试验证。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">OrderService</span> &#123;<br><span class="hljs-comment">/**</span><br><span class="hljs-comment">* 获取订单详情</span><br><span class="hljs-comment">* <span class="hljs-doctag">@param</span> orderId</span><br><span class="hljs-comment">* <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment">*/</span><br>String <span class="hljs-title function_">getOrder</span><span class="hljs-params">(Long orderId)</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h5 id="生产者POM依赖"><a href="#生产者POM依赖" class="headerlink" title="生产者POM依赖"></a>生产者POM依赖</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br><span class="hljs-comment">&lt;!-- Dubbo Spring Boot Starter - -&gt;</span><br><span class="hljs-comment">&lt;dependency&gt;</span><br><span class="hljs-comment">&lt;groupId&gt;org.apache.dubbo&lt;/groupId&gt;</span><br><span class="hljs-comment">&lt;artifactId&gt;dubbo-spring-boot-</span><br><span class="hljs-comment">starter&lt;/artifactId&gt;</span><br><span class="hljs-comment">&lt;version&gt;$&#123;dubbo-version&#125;&lt;/version&gt;</span><br><span class="hljs-comment">&lt;/dependency&gt;</span><br><span class="hljs-comment">&lt;!-- Dubbo 核心依赖 - -&gt;</span><br><span class="hljs-comment">&lt;dependency&gt;</span><br><span class="hljs-comment">&lt;groupId&gt;org.apache.dubbo&lt;/groupId&gt;</span><br><span class="hljs-comment">&lt;artifactId&gt;dubbo&lt;/artifactId&gt;</span><br><span class="hljs-comment">&lt;/dependency&gt;</span><br><span class="hljs-comment">&lt;!-- 公用RPC接口依赖 - -&gt;</span><br><span class="hljs-comment">&lt;dependency&gt;</span><br><span class="hljs-comment">&lt;groupId&gt;xyz.maojun&lt;/groupId&gt;</span><br><span class="hljs-comment">&lt;artifactId&gt;dubbo-spring-</span><br><span class="hljs-comment">interface&lt;/artifactId&gt;</span><br><span class="hljs-comment">&lt;version&gt;$&#123;project.version&#125;&lt;/version&gt;</span><br><span class="hljs-comment">&lt;/dependency&gt;</span><br><span class="hljs-comment">&lt;/dependencies&gt;</span><br></code></pre></td></tr></table></figure><h6 id="RPC服务接口"><a href="#RPC服务接口" class="headerlink" title="RPC服务接口"></a>RPC服务接口</h6><figure class="highlight wren"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs wren">@<span class="hljs-title class_">DubboService</span>(<span class="hljs-variable">version</span> <span class="hljs-operator">=</span><br><span class="hljs-string">&quot;$&#123;dubbo.spring.provider.version&#125;&quot;</span>)<br><span class="hljs-variable">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderServiceImpl</span> <span class="hljs-variable">implements</span><br><span class="hljs-title class_">OrderService</span> &#123;<br><span class="hljs-comment">/**</span><br><span class="hljs-comment">* 服务端口</span><br><span class="hljs-comment">*/</span><br>@<span class="hljs-title class_">Value</span>(<span class="hljs-string">&quot;$&#123;server.port&#125;&quot;</span>)<br><span class="hljs-variable">private</span> <span class="hljs-title class_">String</span> <span class="hljs-variable">serverPort</span>;<br>@<span class="hljs-title class_">Value</span>(<span class="hljs-string">&quot;$&#123;dubbo.spring.provider.version&#125;&quot;</span>)<br><span class="hljs-variable">private</span> <span class="hljs-title class_">String</span> <span class="hljs-variable">serviceVersion</span>;<br><span class="hljs-comment">/**</span><br><span class="hljs-comment">* 获取订单详情</span><br><span class="hljs-comment">* <span class="hljs-doctag">@param</span> orderId</span><br><span class="hljs-comment">* <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment">*/</span><br><span class="hljs-variable">public</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">getOrder</span>(<span class="hljs-params">Long</span> <span class="hljs-params">orderId</span>) &#123;<br><span class="hljs-title class_">String</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;get order detail</span><br><span class="hljs-string">,orderId=&quot;</span><span class="hljs-operator">+</span><span class="hljs-variable">orderId</span> <span class="hljs-operator">+</span><span class="hljs-string">&quot;,serverPort=&quot;</span><span class="hljs-operator">+</span><span class="hljs-variable">serverPort</span><br><span class="hljs-operator">+</span><span class="hljs-string">&quot;,serviceVersion=&quot;</span><span class="hljs-operator">+</span><span class="hljs-variable">serviceVersion</span>;<br><span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-property">println</span>(<span class="hljs-variable">result</span>);<br><span class="hljs-keyword">return</span> <span class="hljs-variable">result</span>;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>通过DubboService注解， 声明为RPC服务，version可以标识具体的版本号， 消费端需匹配保持一致。</p><h6 id="工程配置"><a href="#工程配置" class="headerlink" title="工程配置"></a>工程配置</h6><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-string">server.port=</span> <span class="hljs-number">18081</span><br><span class="hljs-comment"># 应用程序名称</span><br><span class="hljs-string">spring.application.name=dubbo-spring-provider</span><br><span class="hljs-comment"># Dubbo服务扫描路径</span><br><span class="hljs-string">dubbo.scan.base-packages=xyz.maojun</span><br><span class="hljs-comment"># Dubbo 通讯协议</span><br><span class="hljs-string">dubbo.protocol.name=dubbo</span><br><span class="hljs-comment"># Dubbo服务提供的端口， 配置为- 1 ，代表为随机端口 默认</span><br><span class="hljs-number">20880</span><br><span class="hljs-string">dubbo.protocol.port=-</span> <span class="hljs-number">1</span><br><span class="hljs-comment">## Dubbo 注册器配置信息</span><br><span class="hljs-string">dubbo.registry.address=zookeeper://</span> <span class="hljs-attr">127. 0. 0. 1 :</span> <span class="hljs-number">2181</span><br><span class="hljs-string">dubbo.registry.file</span> <span class="hljs-string">=</span> <span class="hljs-string">$&#123;user.home&#125;/dubbo-</span><br><span class="hljs-string">cache/$&#123;spring.application.name&#125;/dubbo.cache</span><br><span class="hljs-string">dubbo.spring.provider.version</span> <span class="hljs-string">=</span> <span class="hljs-number">1</span><span class="hljs-string">.</span> <span class="hljs-number">0</span><span class="hljs-string">.</span> <span class="hljs-number">0</span><br></code></pre></td></tr></table></figure><h6 id="Spring-Boot启动程序"><a href="#Spring-Boot启动程序" class="headerlink" title="Spring Boot启动程序"></a>Spring Boot启动程序</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"># 服务端口<br><span class="hljs-meta">@SpringBootApplication</span><br><span class="hljs-meta">@ComponentScan(basePackages = &#123;&quot;xyz.maojun&quot;&#125;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DubboSpringProviderApplication</span> &#123;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>SpringApplication.run(DubboSpringProviderApplicatio<br>n.class, args);<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="-3"><a href="#-3" class="headerlink" title=""></a></h4><h5 id="消费者POM依赖"><a href="#消费者POM依赖" class="headerlink" title="消费者POM依赖"></a>消费者POM依赖</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br><span class="hljs-comment">&lt;!-- Dubbo Spring Boot Starter - -&gt;</span><br><span class="hljs-comment">&lt;dependency&gt;</span><br><span class="hljs-comment">&lt;groupId&gt;org.apache.dubbo&lt;/groupId&gt;</span><br><span class="hljs-comment">&lt;artifactId&gt;dubbo-spring-boot-</span><br><span class="hljs-comment">starter&lt;/artifactId&gt;</span><br><span class="hljs-comment">&lt;version&gt;$&#123;dubbo-version&#125;&lt;/version&gt;</span><br><span class="hljs-comment">&lt;/dependency&gt;</span><br><span class="hljs-comment">&lt;!-- 公用RPC接口依赖 - -&gt;</span><br><span class="hljs-comment">&lt;dependency&gt;</span><br><span class="hljs-comment">&lt;groupId&gt;xyz.maojun&lt;/groupId&gt;</span><br><span class="hljs-comment">&lt;artifactId&gt;dubbo-spring-</span><br><span class="hljs-comment">interface&lt;/artifactId&gt;</span><br><span class="hljs-comment">&lt;version&gt;$&#123;project.version&#125;&lt;/version&gt;</span><br><span class="hljs-comment">&lt;/dependency&gt;</span><br><span class="hljs-comment">&lt;/dependencies&gt;</span><br></code></pre></td></tr></table></figure><h6 id="消费端调用"><a href="#消费端调用" class="headerlink" title="消费端调用"></a>消费端调用</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Controller</span><br><span class="hljs-meta">@RequestMapping(&quot;/order&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderController</span> &#123;<br><span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Logger</span> <span class="hljs-variable">logger</span> <span class="hljs-operator">=</span><br>LoggerFactory.getLogger(getClass());<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment">* 订单服务接口</span><br><span class="hljs-comment">*/</span><br><span class="hljs-meta">@DubboReference(version =&quot;$&#123;dubbo.spring.provider.version&#125;&quot;)</span><br><span class="hljs-keyword">private</span> OrderService orderService;<br><br> <span class="hljs-comment">/**</span><br><span class="hljs-comment">* 获取订单详情接口</span><br><span class="hljs-comment">* <span class="hljs-doctag">@param</span> orderId</span><br><span class="hljs-comment">* <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment">*/</span><br><span class="hljs-meta">@RequestMapping(&quot;/getOrder&quot;)</span><br><span class="hljs-meta">@ResponseBody</span><br><span class="hljs-keyword">public</span> String <span class="hljs-title function_">getOrder</span><span class="hljs-params">(Long orderId)</span> &#123;<br><span class="hljs-type">String</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br><span class="hljs-keyword">try</span> &#123;<br>result =<br>orderService.getOrder(orderId);<br>&#125;<span class="hljs-keyword">catch</span>(Exception e) &#123;<br>logger.error(e.getMessage(), e);<br>&#125;<br><span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure><h5 id="-4"><a href="#-4" class="headerlink" title=""></a></h5><h6 id="工程配置-1"><a href="#工程配置-1" class="headerlink" title="工程配置"></a>工程配置</h6><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-comment"># 服务端口</span><br><span class="hljs-attr">server.port</span>= <span class="hljs-string">18084</span><br><span class="hljs-comment">#服务名称</span><br><span class="hljs-attr">spring.application.name</span>=<span class="hljs-string">dubbo-spring-consumer</span><br><span class="hljs-comment">#服务版本号</span><br><span class="hljs-attr">dubbo.spring.provider.version</span> = <span class="hljs-string">1. 0. 0</span><br><span class="hljs-comment">#消费端注册器配置信息</span><br><span class="hljs-attr">dubbo.registry.address</span>=<span class="hljs-string">zookeeper:// 127. 0. 0. 1 : 2181</span><br><span class="hljs-attr">dubbo.registry.file</span> = <span class="hljs-string">$&#123;user.home&#125;/dubbo-</span><br><span class="hljs-attr">cache/$&#123;spring.application.name&#125;/dubbo.cache</span><br></code></pre></td></tr></table></figure><h6 id="Spring-Boot启动程序-1"><a href="#Spring-Boot启动程序-1" class="headerlink" title="Spring Boot启动程序"></a>Spring Boot启动程序</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@SpringBootApplication</span><br><span class="hljs-meta">@ComponentScan(basePackages = &#123;&quot;xyz.maojun&quot;&#125;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DubboSpringConsumerApplication</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        SpringApplication.run(DubboSpringConsumerApplicatio<br>n.class, args);<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h5 id="工程调用验证"><a href="#工程调用验证" class="headerlink" title="工程调用验证"></a>工程调用验证</h5><ol><li>启动ZK注册中心</li><li>启动服务端， 运行DubboSpringProviderApplication</li><li>启动消费端， 运行DubboSpringConsumerApplication</li><li>请求获取订单接口， 地址： <a href="http://127.0.0.1:18084/order/getOrder?orderId=1001">http://127.0.0.1:18084/order/getOrder?orderId=1001</a></li></ol><p>调用成功：</p><p><img src="/blog/./assets/image-udh8pihyio84whkpyqspo5b.PNG" alt="调用成功"></p><h3 id="Dubbo高阶配置"><a href="#Dubbo高阶配置" class="headerlink" title="Dubbo高阶配置"></a>Dubbo高阶配置</h3><h4 id="覆盖关系"><a href="#覆盖关系" class="headerlink" title="覆盖关系"></a>覆盖关系</h4><p>官方文档： <a href="https://dubbo.apache.org/zh/docsv2.7/user/configuration/">https://dubbo.apache.org/zh/docsv2.7/user/configuration/</a></p><ol><li><p>通过ProviderConfig配置全局超时（可通过yml配置覆盖）</p></li><li><p>在@DubboService注解上配置接口超时</p></li><li><p>在@DubboService注解上配置接口方法超时</p></li><li><p>在消费方进行配置，查看覆盖情况</p></li></ol><h4 id="覆盖规则"><a href="#覆盖规则" class="headerlink" title="覆盖规则"></a>覆盖规则</h4><p><img src="/blog/./assets/image-03ngyrfq45zdgvrrpsbwuty.PNG" alt="覆盖规则"></p><h4 id="配置规则"><a href="#配置规则" class="headerlink" title="配置规则"></a>配置规则</h4><ol><li>方法级优先;</li><li>接口级次之;</li><li>全局配置再次之。</li><li>如果级别一样，则消费者优先，生产者次之。</li></ol><h4 id="-5"><a href="#-5" class="headerlink" title=""></a></h4><h4 id="服务端超时"><a href="#服务端超时" class="headerlink" title="服务端超时"></a>服务端超时</h4><p>增加配置类：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DubboCustomConfig</span> &#123;<br><span class="hljs-comment">/**</span><br><span class="hljs-comment">* 服务端</span><br><span class="hljs-comment">* <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment">*/</span><br><span class="hljs-meta">@Bean</span><br><span class="hljs-keyword">public</span> ProviderConfig <span class="hljs-title function_">registryConfig</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-type">ProviderConfig</span> <span class="hljs-variable">providerConfig</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span><br><span class="hljs-title class_">ProviderConfig</span>();<br><span class="hljs-comment">// 设定超时时间为 5 S</span><br>providerConfig.setTimeout( <span class="hljs-number">5000</span> );<br><span class="hljs-keyword">return</span> providerConfig;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>修改服务接口实现：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment">* 获取订单详情</span><br><span class="hljs-comment">* <span class="hljs-doctag">@param</span> orderId</span><br><span class="hljs-comment">* <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment">*/</span><br><span class="hljs-keyword">public</span> String <span class="hljs-title function_">getOrder</span><span class="hljs-params">(Long orderId)</span> &#123;<br><span class="hljs-keyword">try</span> &#123;<br><span class="hljs-comment">// 休眠1.5秒</span><br>Thread.sleep(<span class="hljs-number">1500L</span>);<br>&#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>e.printStackTrace();<br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Get Order Detail, Id: &quot;</span> + orderId +<br><span class="hljs-string">&quot;, serverPort: &quot;</span> + serverPort;<br>    &#125;<br></code></pre></td></tr></table></figure><p>客户端调用验证</p><p>请求地址： <a href="http://127.0.0.1:18084/order/getOrder?orderId=123">http://127.0.0.1:18084/order/getOrder?orderId=123</a></p><p> 服务端全局超时设为 2 秒（不触发超时）， 消费端设定超时时间为 1 秒（触发超时）。</p><p> 修改调用代码：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment">* 订单服务接口</span><br><span class="hljs-comment">*/</span><br><span class="hljs-meta">@DubboReference(version =</span><br><span class="hljs-meta">&quot;$&#123;dubbo.spring.provider.version&#125;&quot;, timeout =</span><br><span class="hljs-meta">1000)</span><br><span class="hljs-keyword">private</span> OrderService orderService;<br></code></pre></td></tr></table></figure><p>调用结果， 触发超时：</p><p><img src="/blog/./assets/image-6deg835f0x11eo2w85t796f.PNG" alt="验证超时"></p><p>表明消费端配置优先。</p><p>服务端全局超时设定为1秒（触发超时）， 消费端去掉超时时间配置。触发超时， 表明服务提供方优先级次之。</p><p><img src="/blog/./assets/image-z8w65atrb412ff8vk8a9pcs.PNG" alt="验证超时"></p><h4 id="属性配置优先级"><a href="#属性配置优先级" class="headerlink" title="属性配置优先级"></a>属性配置优先级</h4><p>优先级规则</p><p><img src="/blog/./assets/image-w23jrl0ykmrf8wpqf7xv4ok.PNG" alt="优先级规则"></p><p>优先级从高到低：</p><ul><li>JVM -D 参数；</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">-Ddubbo.protocol.port=<span class="hljs-number">20881</span> <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><ul><li>XML（application.yml&#x2F;application.properties）配置会重写dubbo.properties 中的配置。</li></ul><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">dubbo:</span><br><span class="hljs-attr">protocol:</span><br><span class="hljs-attr">name:</span> <span class="hljs-string">dubbo</span> <span class="hljs-comment"># 通讯协议</span><br><span class="hljs-comment">#port: 20880 # dubbo服务提供方的端口，该值</span><br><span class="hljs-string">是默认值</span><br><span class="hljs-attr">port:</span> <span class="hljs-number">20882</span><br></code></pre></td></tr></table></figure><ul><li>Properties默认配置（dubbo.properties），仅仅作用于以上两者没有配置时，一般配置全局公共配置。</li></ul><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">dubbo.protocol.port</span>=<span class="hljs-string">20883</span><br></code></pre></td></tr></table></figure><h4 id="-6"><a href="#-6" class="headerlink" title=""></a></h4><h3 id="重试与容错处理机制"><a href="#重试与容错处理机制" class="headerlink" title="重试与容错处理机制"></a>重试与容错处理机制</h3><h4 id="容错机制"><a href="#容错机制" class="headerlink" title="容错机制"></a>容错机制</h4><ul><li>Failfast Cluster</li></ul><p>快速失败，只发起一次调用，失败立即报错。通常用于非幂等性的写操作，比如新增记录。</p><ul><li>Failsafe Cluster</li></ul><p>失败安全，出现异常时，直接忽略。通常用于写入审计日志等操作。</p><ul><li>Failback Cluster</li></ul><p>失败自动恢复，后台记录失败请求，定时重发。通常用于消息通知操作。</p><ul><li>Forking Cluster</li></ul><p>并行调用多个服务器，只要一个成功即返回。通常用于实时性要求较高的读操作，但需要浪费更多服务资源。可通过forks&#x3D;”2” 来设置最大并行数。</p><ul><li>Broadcast Cluster</li></ul><p>广播调用所有提供者，逐个调用，任意一台报错则报错。通常用于通知所有提供者更新缓存或日志等本地资源信息。</p><p>调整客户端重试次数,重试次数设定为3次。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 订单服务接口</span><br><span class="hljs-comment"> */</span><br> <span class="hljs-meta">@DubboReference(version =</span><br><span class="hljs-meta">&quot;$&#123;dubbo.spring.provider.version&#125;&quot;,retries = 3)</span><br> <span class="hljs-keyword">private</span> OrderService orderService;<br></code></pre></td></tr></table></figure><p> 修改服务端超时时间模拟超时， 让客户端触发重试。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"> <span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 服务端全局配置</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment"> */</span><br> <span class="hljs-meta">@Bean</span><br> <span class="hljs-keyword">public</span> ProviderConfig <span class="hljs-title function_">registryConfig</span><span class="hljs-params">()</span> &#123;<br> <span class="hljs-type">ProviderConfig</span> <span class="hljs-variable">providerConfig</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span><br><span class="hljs-title class_">ProviderConfig</span>();<br> providerConfig.setTimeout(<span class="hljs-number">1000</span>);<br> <span class="hljs-keyword">return</span> providerConfig;<br> &#125;<br></code></pre></td></tr></table></figure><p>客户端调用（单个服务）</p><p><a href="http://127.0.0.1:18084/order/getOrder?orderId=123">http://127.0.0.1:18084/order/getOrder?orderId=123</a></p><p>查看服务端控制台，可以看到触发重试机制，加上第一次的调用和3次重试， 共4次。</p><p><img src="/blog/./assets/image-k7kwuhcckwpijc5yalcee86.PNG" alt="超时重试"></p><p>允许多个实例运行， 开启多个服务，再次访问。</p><p><img src="/blog/./assets/image-4ueexpcob5sw60ixk4z137o.PNG" alt="集群重试"></p><p>第一个服务实例，访问两次， 其他每个服务访问一次。</p><h3 id="多版本控制"><a href="#多版本控制" class="headerlink" title="多版本控制"></a>多版本控制</h3><p>启动三个服务端。第一个服务端版本为1.0.0， 第二、三个服务端版本分别为：2.0.0 和3.0.0<br>主要是修改application.properties配置：</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-comment">#服务版本号</span><br><span class="hljs-attr">dubbo.spring.provider.version</span> = <span class="hljs-string">2.0.0</span><br></code></pre></td></tr></table></figure><p>启动三个服务提供者，通过 -Ddubbo.spring.provider.version &#x3D;2.0.0 -Dserver.port&#x3D;18082 来启动三个相关的端口不能重复。</p><p> 消费端指定版本号。同样修改application.properties配置：</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-comment">#服务版本号</span><br><span class="hljs-attr">dubbo.spring.provider.version</span> = <span class="hljs-string">2.0.0</span><br></code></pre></td></tr></table></figure><p>仍然通过 -Ddubbo.spring.provider.version &#x3D; 2.0.0 来调用不同版本的服务测试时，注释掉超时的代码</p><p>仍是采用超时配置， 通过重试测试验证测试验证结果,请求只会访问至版本号为2.0.0的服务节点上面。</p><h3 id="本地存根调用"><a href="#本地存根调用" class="headerlink" title="本地存根调用"></a>本地存根调用</h3><p><img src="/blog/./assets/image-bydm1ddiojjppwtu69hzuy0.PNG" alt="实现流程"></p><p>把 Stub 暴露给用户，Stub 可以决定要不要去调 Proxy。</p><p> 客户端存根实现，增加service接口。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderServiceStub</span> <span class="hljs-keyword">implements</span><br><span class="hljs-title class_">OrderService</span> &#123;<br><span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> OrderService orderService;<br><span class="hljs-comment">// 构造函数传入真正的远程代理对象</span><br><span class="hljs-keyword">public</span> <span class="hljs-title function_">OrderServiceStub</span><span class="hljs-params">(OrderService</span><br><span class="hljs-params">orderService)</span>&#123;<br><span class="hljs-built_in">this</span>.orderService = orderService;<br>    &#125;<br><span class="hljs-comment">/**</span><br><span class="hljs-comment">* 获取订单详情</span><br><span class="hljs-comment">* <span class="hljs-doctag">@param</span> orderId</span><br><span class="hljs-comment">* <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment">*/</span><br><span class="hljs-keyword">public</span> String <span class="hljs-title function_">getOrder</span><span class="hljs-params">(Long orderId)</span>&#123;<br><span class="hljs-comment">// 在客户端执行, 预先验证参数是否合法，等等</span><br><span class="hljs-keyword">try</span> &#123;<br><span class="hljs-keyword">if</span>(<span class="hljs-literal">null</span> != orderId) &#123;<br><span class="hljs-keyword">return</span><br>orderService.getOrder(orderId);<br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-string">&quot;参数校验错误！&quot;</span>;<br>&#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br><span class="hljs-comment">//容错处理</span><br><span class="hljs-keyword">return</span> <span class="hljs-string">&quot;出现错误：&quot;</span> + e.getMessage();<br>&#125;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>修改客户端调用配置</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment">* 订单服务接口</span><br><span class="hljs-comment">*/</span><br><span class="hljs-meta">@DubboReference(version =</span><br><span class="hljs-meta">&quot;$&#123;dubbo.spring.provider.version&#125;&quot;,retries = 3, stub</span><br><span class="hljs-meta">=</span><br><span class="hljs-meta">&quot;com.itheima.dubbo.spring.consumer.service.OrderServ</span><br><span class="hljs-meta">iceStub&quot;)</span><br><span class="hljs-keyword">private</span> OrderService orderService;<br></code></pre></td></tr></table></figure><p>stub要配置存根接口的完整路径。</p><p>访问不带参数的地址： <a href="http://127.0.0.1:18084/order/getOrder">http://127.0.0.1:18084/order/getOrder</a></p><p><img src="/blog/./assets/image-efmckq9g1rrri3d9y2yapql.PNG" alt="存根调用"></p><p>会进入存根接口的处理逻辑， 提示校验异常。</p><h3 id="负载均衡机制"><a href="#负载均衡机制" class="headerlink" title="负载均衡机制"></a>负载均衡机制</h3><p>默认负载策略</p><p>Dubbo默认采用的是随机负载策略。</p><p>开启三个服务节点，通过消费端访问验证： <a href="http://127.0.0.1:18084/order/getOrder?orderId=123">http://127.0.0.1:18084/order/getOrder?orderId=123</a></p><p>通过控制后台日志输出， 可以看到每个服务节点呈现不规则的调用。</p><p>Dubbo 支持的负载均衡策略，可用参看源码： AbstractLoadBalance</p><ul><li>Random LoadBalance：默认</li></ul><p>随机，按权重设置随机概率。</p><p>在一个截面上碰撞的概率高，但调用量越大分布越均匀，而且按概率使用权重后也比较均匀，有利于动态调整提供者权重。</p><ul><li>RoundRobin LoadBalance</li></ul><p>加权轮询负载均衡，按公约后的权重设置轮询比率。存在慢的提供者累积请求的问题，比如：第二台机器很慢，但没挂，当请求调到第二台时就卡在那，久而久之，所有请求都卡在调到第二台上。</p><ul><li>LeastActive LoadBalance</li></ul><p>最少活跃调用数，相同活跃数的随机，活跃数指调用前后计数差。活跃数其实就是在当前这个服务调用者中当前这个时刻 某个invoker（某个服务提供者的某个接口）某个方法的调用并发数，在调用之前+1 调用之后-1的一个计数器，如果出现多个活跃数相等invoker的时候使用随机算法来选取一个</p><ul><li>ConsistentHash LoadBalance</li></ul><p>一致性 Hash，相同参数的请求总是发到同一提供者。当某一台提供者挂时，原本发往该提供者的请求，基于虚拟节点，平摊到其它提供者，不会引起剧烈变动。</p><blockquote><p>一致性Hash负载均衡涉及到两个主要的配置参数为</p><p><strong>hash.arguments</strong> 与<strong>hash.nodes</strong>。</p><ol><li><strong>hash.arguments</strong> ： 当进行调用时候根据调用方法的哪几个参数生成key，并根据key来通过一致性hash算法来选择调用结点。</li><li><strong>hash.nodes</strong>： 为结点的副本数</li></ol></blockquote><ul><li>ShortestResponseLoadBalance</li></ul><p>最短响应时间负载均衡<br>从多个服务提供者中选择出调用成功的且响应时间最短的服务提供者，由于满足这样条件的服务提供者有可能有多个。所以当选择出多个服务提供者后要根据他们的权重做分析，如果权重一样，则随机。</p><p>源码实现：</p><p>org.apache.dubbo.rpc.cluster.loadbalance.AbstractLoadBalance</p><p> Dubbo提供了四种实现：</p><p><img src="/blog/./assets/image-wog3j8ay7sm7xrsj6smyk16.PNG" alt="四种实现"></p><p>四种配置方式：</p><p>优先级从下至上：</p><ul><li>服务端的服务级别</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;dubbo:service interface=<span class="hljs-string">&quot;...&quot;</span><br>loadbalance=<span class="hljs-string">&quot;roundrobin&quot;</span> /&gt;<br></code></pre></td></tr></table></figure><ul><li>客户端的服务级别</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;dubbo:reference interface=<span class="hljs-string">&quot;...&quot;</span><br>loadbalance=<span class="hljs-string">&quot;roundrobin&quot;</span> /&gt;<br></code></pre></td></tr></table></figure><blockquote><p>注意：服务提供者配置后最终也只是同步到消费者端。故一般在消费端配置</p></blockquote><ul><li>服务端方法级别</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;dubbo:service interface=<span class="hljs-string">&quot;...&quot;</span>&gt;<br>&lt;dubbo:method name=<span class="hljs-string">&quot;...&quot;</span><br>loadbalance=<span class="hljs-string">&quot;roundrobin&quot;</span>/&gt;<br>&lt;/dubbo:service&gt;<br></code></pre></td></tr></table></figure><ul><li>客户端方法级别</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;dubbo:reference interface=<span class="hljs-string">&quot;...&quot;</span>&gt;<br> &lt;dubbo:method name=<span class="hljs-string">&quot;...&quot;</span><br>loadbalance=<span class="hljs-string">&quot;roundrobin&quot;</span>/&gt;<br> &lt;/dubbo:reference&gt;<br></code></pre></td></tr></table></figure><p>调用验证</p><p>修改客户端的负载策略， 改为轮询策略：</p><blockquote><p>注意很多配置都有三个级别，针对方法的，针对接口的，全局的。</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@DubboReference(version =</span><br><span class="hljs-meta">&quot;$&#123;dubbo.spring.provider.version&#125;&quot;,retries = 3,</span><br><span class="hljs-meta">2 loadbalance = &quot;roundrobin&quot;,</span><br><span class="hljs-meta">3 stub =</span><br><span class="hljs-meta">&quot;xyz.maojun.dubbo.spring.consumer.service.OrderServiceStub&quot;)</span><br></code></pre></td></tr></table></figure><p>开启三个服务节点， 进行访问验证： <a href="http://127.0.0.1:18084/order/g">http://127.0.0.1:18084/order/g</a></p><p>etOrder?orderId&#x3D;123</p><p>会依次轮询进行调用。</p><p> 注意：测试时将服务提供者的版本号都调成一致（1.0.0），超时配置注</p><p>释掉！</p><p>动态权重调整验证</p><p>管理后台地址： <a href="http://127.0.0.1:8080/#">http://127.0.0.1:8080/#</a></p><p>通过管理后台修改服务的权重配置：</p><p><img src="/blog/./assets/image-uge7f3cfqhp7omwtdzrau8r.PNG" alt="管理后台配置权重"></p><p>将两台节点的权重降低至20：</p><p><img src="/blog/./assets/image-0nainutsgxbd1b21ysg0tcm.PNG" alt="权重规则"></p><p>调整后可以看到权重配置已经生效：</p><p><img src="/blog/./assets/image-xu4fu6stfeanc3e0eynsydb.PNG" alt="查看权重"></p><p>通过消费者接口访问， 会发现第一台权重较大的节点， 访问次数会明显增多。</p><h3 id="服务降级运用"><a href="#服务降级运用" class="headerlink" title="服务降级运用"></a>服务降级运用</h3><p>服务动态禁用</p><p>启动单个服务节点，进入Dubbo Admin， 创建动态配置规则：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">configVersion:</span> <span class="hljs-string">v2.7</span><br><span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span><br><span class="hljs-attr">configs:</span><br><span class="hljs-bullet">-</span> <span class="hljs-attr">side:</span> <span class="hljs-string">provider</span><br><span class="hljs-attr">addresses:</span><br><span class="hljs-bullet">-</span> <span class="hljs-string">&#x27;0.0.0.0:20880&#x27;</span><br><span class="hljs-attr">parameters:</span><br><span class="hljs-attr">timeout:</span> <span class="hljs-number">3000</span><br><span class="hljs-attr">disabled:</span> <span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><p>将disabled属性设为true， 服务禁用， 可以错误提示</p><p><img src="/blog/./assets/image-ap7lali9xsuwd8v8iayp9ns.PNG" alt="服务禁用"></p><p>将disabled属性改为false，则恢复正常访问。</p><p><img src="/blog/./assets/image-mu14jewsnvpux223sq7hgxm.PNG" alt="服务启用"></p><p> 服务降级，配置规则。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">RegistryFactory</span> <span class="hljs-variable">registryFactory</span> <span class="hljs-operator">=</span>ExtensionLoader.getExtensionLoader(RegistryFactory.class).getAdaptiveExtension();<br><span class="hljs-type">Registry</span> <span class="hljs-variable">registry</span> <span class="hljs-operator">=</span>registryFactory.getRegistry(URL.valueOf(<span class="hljs-string">&quot;zookeeper://10.20.153.10:2181&quot;</span>));<br>registry.register(URL.valueOf(<span class="hljs-string">&quot;override://0.0.0.0/com.foo.BarService?category=configurators&amp;dynamic=false&amp;application=foo&amp;mock=force:return+null&quot;</span>));<br></code></pre></td></tr></table></figure><p>mock&#x3D;force:return+null 表示消费方对该服务的方法调用都直接返回 null 值，不发起远程调用。用来屏蔽不重要服务不可用时对调用方的影响。</p><p>还可以改为 mock&#x3D;fail:return+null 表示消费方对该服务的方法调用在失败后，再返回 null值，不抛异常。用来容忍不重要服务不稳定时对调用方的影响。</p><p>降级测试（force方式）进入Dubbo Admin进行配置：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">configVersion:</span> <span class="hljs-string">v2.7</span><br><span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span><br><span class="hljs-attr">configs:</span><br><span class="hljs-bullet">-</span> <span class="hljs-attr">side:</span> <span class="hljs-string">consumer</span><br><span class="hljs-attr">addresses:</span><br><span class="hljs-bullet">-</span> <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span><br><span class="hljs-attr">parameters:</span><br><span class="hljs-attr">timeout:</span> <span class="hljs-number">3000</span><br><span class="hljs-attr">mock:</span> <span class="hljs-string">&#x27;force:return null&#x27;</span><br></code></pre></td></tr></table></figure><p>客户端调用， 会直接屏蔽， 并且服务端控制台不会有任何调用记录：</p><p><img src="/blog/./assets/image-rxl2doctkav830fp84p54ai.PNG" alt="返回null"></p><p>降级测试（fail方式）进入Dubbo Admin配置：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">configVersion:</span> <span class="hljs-string">v2.7</span><br><span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span><br><span class="hljs-attr">configs:</span><br><span class="hljs-bullet">-</span> <span class="hljs-attr">side:</span> <span class="hljs-string">consumer</span><br><span class="hljs-attr">addresses:</span><br><span class="hljs-bullet">-</span> <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span><br><span class="hljs-attr">parameters:</span><br><span class="hljs-attr">timeout:</span> <span class="hljs-number">1000</span><br><span class="hljs-attr">mock:</span> <span class="hljs-string">&#x27;fail:return null&#x27;</span><br></code></pre></td></tr></table></figure><p>这里为了触发调用异常， 超时时间缩短为1秒。</p><p>注意这里的超时时间可能不会起作用，最终的超时时间还是得看项目中配置，故在服务提供方将线程休眠时间延长，造成调用超时。客户端调用， 会出现降级显示为空,同时服务端会有调用记录显示（请求会进入服务端，但由于超时， 调用是失败）：</p><p><img src="/blog/./assets/image-i59ctmpgtl1warig85mwupa.PNG" alt="调用失败"></p><h3 id="并发与连接控制"><a href="#并发与连接控制" class="headerlink" title="并发与连接控制"></a>并发与连接控制</h3><p>实际运用， 会碰到高并发与峰值场景， Dubbo是可以做到并发与连接数控制。可使用jmeter进行测试。</p><p><strong>并发数控制</strong></p><ol><li><p>服务端控制</p><p>服务级别</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dubbo:service</span> <span class="hljs-attr">interface</span>=<span class="hljs-string">&quot;com.foo.BarService&quot;</span> <span class="hljs-attr">executes</span>=<span class="hljs-string">&quot;10&quot;</span> /&gt;</span><br></code></pre></td></tr></table></figure><p>服务器端并发执行（或占用线程池线程数）不能超过 10 个。</p><p>方法级别</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dubbo:service</span></span><br><span class="hljs-tag"><span class="hljs-attr">interface</span>=<span class="hljs-string">&quot;com.foo.BarService&quot;</span>&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">dubbo:method</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;sayHello&quot;</span></span><br><span class="hljs-tag"><span class="hljs-attr">executes</span>=<span class="hljs-string">&quot;3&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dubbo:service</span>&gt;</span><br></code></pre></td></tr></table></figure><p>限制具体的方法，服务器端并发执行（或占用线程池线程数）</p><p>不能超过3 个。</p></li><li><p>客户端控制</p></li></ol><p>调用的服务控制</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dubbo:reference</span></span><br><span class="hljs-tag"><span class="hljs-attr">interface</span>=<span class="hljs-string">&quot;com.foo.BarService&quot;</span> <span class="hljs-attr">actives</span>=<span class="hljs-string">&quot;10&quot;</span></span><br><span class="hljs-tag">/&gt;</span><br></code></pre></td></tr></table></figure><p>每客户端并发执行（或占用连接的请求数）不能超过 10 个。</p><p>调用的服务方法控制</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dubbo:reference</span></span><br><span class="hljs-tag"><span class="hljs-attr">interface</span>=<span class="hljs-string">&quot;com.foo.BarService&quot;</span>&gt;</span><br>2 <span class="hljs-tag">&lt;<span class="hljs-name">dubbo:method</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;sayHello&quot;</span></span><br><span class="hljs-tag"><span class="hljs-attr">actives</span>=<span class="hljs-string">&quot;10&quot;</span> /&gt;</span><br>3 <span class="hljs-tag">&lt;/<span class="hljs-name">dubbo:service</span>&gt;</span><br></code></pre></td></tr></table></figure><blockquote><p>注意：dubbo:reference比dubbo:service优先。</p></blockquote><ol start="3"><li>客户端负载配置</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dubbo:reference</span> <span class="hljs-attr">interface</span>=<span class="hljs-string">&quot;com.foo.BarService&quot;</span></span><br><span class="hljs-tag"><span class="hljs-attr">loadbalance</span>=<span class="hljs-string">&quot;leastactive&quot;</span> /&gt;</span><br></code></pre></td></tr></table></figure><p>负载策略为最小连接数时， Loadbalance 会调用并发数最小的Provider。</p><p>连接数控制</p><ol><li>服务端连接控制</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dubbo:provider</span> <span class="hljs-attr">protocol</span>=<span class="hljs-string">&quot;dubbo&quot;</span> <span class="hljs-attr">accepts</span>=<span class="hljs-string">&quot;10&quot;</span> /&gt;</span><br></code></pre></td></tr></table></figure><p>限制服务器端接受的连接不能超过 10 个</p><ol start="2"><li>客户端连接控制</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dubbo:reference</span> <span class="hljs-attr">interface</span>=<span class="hljs-string">&quot;com.foo.BarService&quot;</span></span><br><span class="hljs-tag"><span class="hljs-attr">connections</span>=<span class="hljs-string">&quot;10&quot;</span> /&gt;</span><br></code></pre></td></tr></table></figure><p>限制客户端服务使用连接不能超过 10 个</p><blockquote><p>注意：如果 dubbo:service 和 dubbo:reference 都配了 connections，dubbo:reference 优先。</p></blockquote><p>（完）</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>Dubbo</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Spring</tag>
      
      <tag>Dubbo</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ZooKeeper简介与原理</title>
    <link href="/blog/2020/03/ZooKeeper%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%8E%9F%E7%90%86.html"/>
    <url>/blog/2020/03/ZooKeeper%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%8E%9F%E7%90%86.html</url>
    
    <content type="html"><![CDATA[<h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>ZooKeeper 是 Apache 软件基金会的一个软件项目，它为大型分布式计算提供开源的分布式配置服务、同步服务和命名注册 。 </p><p>ZooKeeper 的架构通过冗余服务实现高可用性(CP)。 </p><blockquote><p>最终一致性，通过Zxid保证。</p></blockquote><p>ZooKeeper 的设计目标是将那些复杂且容易出错的分布式一致性服务封装起来，构成一个高效可靠的原语集，并以一系列简单易用的接口提供给用户使用。 </p><p>一个典型的分布式数据一致性的解决方案，分布式应用程序可以基于它实现诸如数据发布&#x2F;订阅、负载均衡、命名服务、分布式协调&#x2F;通知、集群管理、Master 选举、分布式锁和分布式队列等功能 。</p><p><img src="/blog/./assets/image-yz8dzef528puoo0yk8fg90v.PNG" alt="ZooKeeper介绍"></p><p>分布式协调服务:主要解决分布式应用中经常遇到的数据管理问题 </p><p>ZooKeeper本质是小型的文件存储系统+监听机制的功能。</p><h2 id="数据模型"><a href="#数据模型" class="headerlink" title="数据模型"></a>数据模型</h2><p>ZooKeeper本身是一个树形目录服务(名称空间)，非常类似于标准文件系统(树形层次结构)，key-value 的形式存储。名 称 key 由斜线&#x2F;分割的一系列路径元素，ZooKeeper 名称空间中的每个节点都是由一个路径来标识的。 </p><p><img src="/blog/./assets/image-ul3p5wwikfvjxtpwlhich8b.PNG" alt="znode树形结构"></p><ul><li>每个路径下的节点key(完整路径，名称)是唯一的，即同一级节 点 key 名称是唯一的 </li><li>每个节点中存储了节点value和对应的状态属性(多个)</li></ul><blockquote><p>每个znode存储的数据大小至多1MB，所以适合用来做配置文件信息、状态信息存储</p></blockquote><p>znode由3部分组成: </p><ol><li>data </li><li>stat:状态信息:版本，权限，事务id…</li><li>子节点列表</li></ol><h2 id="节点操作"><a href="#节点操作" class="headerlink" title="节点操作"></a>节点操作</h2><h3 id="节点类型"><a href="#节点类型" class="headerlink" title="节点类型"></a>节点类型</h3><table><thead><tr><th>类型</th><th>描述</th></tr></thead><tbody><tr><td>PERSISTENT</td><td>持久节点，默认</td></tr><tr><td>PERSISTENT SEQUENTIAL</td><td>持久顺序节点，创建时ZooKeeper 会在路径上加上序号作为后缀，非常适合用于分布式锁、分布式选举等场景，创建时添加 -s 参数，如图: <img src="/blog/./assets/image-jo52kummdo0974ht0v6uzc8.PNG" alt="image-jo52kummdo0974ht0v6uzc8"></td></tr><tr><td>EPHEMERAL</td><td>临时节点(不可在拥有子节点)，跟连接会话绑定，临时节点会在客户端会话断开后由zk服务端自动删除。适用于心跳，服务发现等场景，创建时添加-e参数</td></tr><tr><td>EPHEMERAL SEQUENTIAL</td><td>临时顺序节点(不可在拥有子节点)，与持久顺序节点类似，不同之处在于EPHEMERAL_SEQUENTIAL是临时的，会在会话断开后删除，创建时添加 -e -s 参数</td></tr><tr><td>CONTAINER</td><td>容器节点，当子节点都被删除后，Container 也随即删除，创建时添加 -c 参数</td></tr><tr><td>PERSISTENT WITH_TTL</td><td>TTL节点，客户端断开连接后不会自动删除Znode，如果该Znode没有子Znode且在给定TTL时间内无修改，该Znode将会被删除;单位是毫秒;创建时添加 -t 参数</td></tr></tbody></table><h3 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h3><table><thead><tr><th>命令</th><th>描述</th><th>用法示例</th><th>说明</th></tr></thead><tbody><tr><td>ls</td><td>查看某个路径下目录列表</td><td>ls [-s] [-w] [-R] path</td><td>path：代表路径，完整路径<br/>-s：返回状态信息<br/>-w：监听节点变化<br/>-R:递归查看某路径下目录列表</td></tr><tr><td>create</td><td>创建节点并赋值</td><td>create [-s] [-e] [-c] [-t ttl] path [data] [acl]</td><td>[-s] [-e]：-s 和 -e 都是可选的，-s 代表顺序节点， -e 代表临<br/>时节点，注意其中 -s 和 -e 可以同时使用的，并且临时节点不<br/>能再创建子节点<br/>path：指定要创建节点的路径，比如 &#x2F;runoob<br/>data：要在此节点存储的数据<br/>acl：访问权限相关，默认是 world，相当于全世界都能访问</td></tr><tr><td>set</td><td>修改节点存储的数据</td><td>set [-s] [-v version] path data</td><td>path：节点路径。<br/>data：需要存储的数据。<br/>[version]：可选项，版本号(可用作乐观锁)</td></tr><tr><td>get</td><td>获取节点数据和状态信息</td><td>get [-s] [-w] path</td><td>-s：返回结果带上状态信息<br/>-w:返回数据并对对节点进行事件监听</td></tr><tr><td>stat</td><td>查看节点状态信息</td><td>stat [-w] path</td><td>path：代表路径<br/>-w:对节点进行事件监听</td></tr><tr><td>delete &#x2F;deleteall</td><td>删除某节点</td><td>delete [-v version] path<br/>deleteall path [-b batch size]</td><td>如果某节点不为空，则不能用delete命令删除</td></tr></tbody></table><h3 id="Znode结构详解"><a href="#Znode结构详解" class="headerlink" title="Znode结构详解"></a>Znode结构详解</h3><table><thead><tr><th>状态属性</th><th>描述</th></tr></thead><tbody><tr><td>cZxid</td><td>创建节点时的事务ID</td></tr><tr><td>ctime</td><td>创建节点时的时间</td></tr><tr><td>mZxid</td><td>最后修改节点时的事务ID</td></tr><tr><td>mtime</td><td>最后修改节点时的时间</td></tr><tr><td>pZxid</td><td>表示该节点的子节点列表最后一次修改的事务ID,添加子节点或删除子节点就会影响子节点列表，但是修改子节点的数据内容则不影响该ID(注意，只有子节点列表 变更了才会变更pzxid,子节点内容变更不会影响pzxid)</td></tr><tr><td>cversion</td><td>子节点版本号，子节点每次修改版本号加1</td></tr><tr><td>dataversion</td><td>数据版本号，数据每次修改该版本号加1</td></tr><tr><td>aclversion</td><td>权限版本号，权限每次修改该版本号加1</td></tr><tr><td>ephemeralOwner</td><td>创建该临时节点的会话的sessionID。  (<strong>如果该节点是持久节点，那么这个属性值为0)</strong></td></tr><tr><td>dataLength</td><td>该节点的数据长度</td></tr><tr><td>numChildren</td><td>该节点拥有子节点的数量(只统计直接子节点的数量)</td></tr></tbody></table><h2 id="Java客户端"><a href="#Java客户端" class="headerlink" title="Java客户端"></a>Java客户端</h2><h3 id="ZooKeeper（不推荐）"><a href="#ZooKeeper（不推荐）" class="headerlink" title="ZooKeeper（不推荐）"></a>ZooKeeper（不推荐）</h3><p>原生API 不支持session超时重连，没有解决watch注册一次就失效的问题，不支持递归操作… </p><h3 id="zkClient"><a href="#zkClient" class="headerlink" title="zkClient"></a>zkClient</h3><p>不支持一些场景（不如需要自己写分布式锁）</p><h3 id="Curator"><a href="#Curator" class="headerlink" title="Curator"></a>Curator</h3><p>提供fluent编程风格，提供了一些应用场景(分布式锁)</p><p><img src="/blog/./assets/image-1ym0vdj4qaffu5bmvzpat51.PNG" alt="curator"></p><h2 id="集群策略"><a href="#集群策略" class="headerlink" title="集群策略"></a>集群策略</h2><p>ZooKeeper 集群节点个数推荐配置奇数个。</p><h3 id="容错率"><a href="#容错率" class="headerlink" title="容错率"></a>容错率</h3><p>需要保证集群能够有半数进行投票</p><ul><li>2台服务器，至少2台正常运行才行（2的半数为1，半数以上最少为2），正常运行1台服务器都不允许挂掉，但是相对于 单节点服务器，2台服务器还有两个单点故障，所以直接排除了。</li><li>3台服务器，至少2台正常运行才行（3的半数为1.5，半数以上最少为2），正常运行可以允许1台服务器挂掉。</li><li>4台服务器，至少3台正常运行才行（4的半数为2，半数以上最少为3），正常运行可以允许1台服务器挂掉。</li><li>5台服务器，至少3台正常运行才行（5的半数为2.5，半数以上最少为3），正常运行可以允许2台服务器挂掉。</li></ul><h3 id="防脑裂"><a href="#防脑裂" class="headerlink" title="防脑裂"></a>防脑裂</h3><p>脑裂集群的脑裂通常是发生在节点之间通信不可达的情况下，集群会分裂成不同的小集群，小集群各自选出自己的leader节点，导致原有的集群出现多个leader节点的情况，这就是脑裂。</p><ul><li>3台服务器，投票选举半数为1.5，一台服务裂开，和另外两台服务器无法通行，这时候2台服务器的集群（2票大于半数1.5票），所以可以选举出leader，而 1 台服务器的集群无法选举。</li><li>4台服务器，投票选举半数为2，可以分成 1,3两个集群或者2,2两个集群，对于 1,3集群，3集群可以选举；对于2,2集群，则不能选择，造成没有leader节点。</li><li>5台服务器，投票选举半数为2.5，可以分成1,4两个集群，或者2,3两集群，这两个集群分别都只能选举一个集群，满足ZooKeeper集群搭建数目。</li></ul><p>以上分析，我们从容错率以及防止脑裂两方面说明了3台服务器是搭建集群的最少数目，4台发生脑裂时会造成没有leader节点的错误</p><h2 id="选举策略"><a href="#选举策略" class="headerlink" title="选举策略"></a>选举策略</h2><h3 id="Paxos"><a href="#Paxos" class="headerlink" title="Paxos"></a>Paxos</h3><p><strong>Paxos</strong>算法是基于消息传递且具有高度容错特性的一致性算法，是目前公认的解决分布式一致性问题最有效的算法之一，其解决的问题就是在分布式系统中如何就某个值（决议）达成一致，paxos是一个分布式选举算法。</p><p>该算法定义了三种角色</p><ul><li>Proposer：提案(决议)发起者</li><li>Acceptor：提案接收者，可同意或不同意</li><li>Learners：虽然不同意提案，但也只能被动接收学习；或者是后来的，只能被动接受</li></ul><p>提案遵循少数服从多数的原则，过半原则。</p><p><img src="/blog/./assets/image-20240331223712515.png" alt="Paxos"></p><h3 id="ZAB协议"><a href="#ZAB协议" class="headerlink" title="ZAB协议"></a>ZAB协议</h3><p>ZooKeeper使用的是ZAB协议作为数据一致性的算法， ZAB（ZooKeeper Atomic Broadcast ） 全称为：原子消息广播协议。在Paxos算法基础上进行了扩展改造而来的，ZAB协议设计了支持原子广播、崩溃恢复，ZAB协议保证Leader广播的变更序列被顺序的处理。</p><p>四种状态，其中三种跟选举有关</p><ul><li><p>LOOKING：系统刚启动时或者Leader崩溃后正处于选举状态</p></li><li><p>FOLLOWING：Follower节点所处的状态，同步leader状态，参与投票</p></li><li><p>LEADING：Leader所处状态</p></li><li><p>OBSERVING，观察状态,同步leader状态，不参与投票</p></li></ul><p>选举时也是半数以上通过才算通过。</p><p><img src="/blog/./assets/image-ewm2gwjmmzzf1ko832yqo3z.PNG" alt="选举策略源码"></p><h2 id="数据读写"><a href="#数据读写" class="headerlink" title="数据读写"></a>数据读写</h2><h3 id="读请求"><a href="#读请求" class="headerlink" title="读请求"></a>读请求</h3><p>当Client向ZooKeeper发出读请求时，无论是Leader还是Follower，都直接返回查询结果。</p><p><img src="/blog/./assets/image-1wzkjowkzmmqcy3j5z8aw5c.PNG" alt="读请求"></p><h3 id="Leader写请求"><a href="#Leader写请求" class="headerlink" title="Leader写请求"></a>Leader写请求</h3><p>Client向Leader发出写请求，Leader将数据写入到本节点，并将数据发送到所有的Follower节点，等待<br>Follower节点返回，当Leader接收到一半以上节点(包含自己)返回写成功的信息之后，返回写入成功消息给client。</p><p><img src="/blog/./assets/image-uagebw4oi1xhvunuxbu5wv7.PNG" alt="leader写请求"></p><h3 id="follow写请求"><a href="#follow写请求" class="headerlink" title="follow写请求"></a>follow写请求</h3><p>Client向Follower发出写请求,Follower节点将请求转发给Leader,Leader将数据写入到本节点，并将数据发送到所有的Follower节点,等待Follower节点返回,当Leader接收到一半以上节点(包含自己)返回写成功的信息之后，返回写入成功消息给原来的Follower,原来的Follower返回写入成功消息给Client。</p><p><img src="/blog/./assets/image-mpt2jgq8fcmgz1z49gj6t00.PNG" alt="follow写请求"></p><h2 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h2><h3 id="分布式锁"><a href="#分布式锁" class="headerlink" title="分布式锁"></a>分布式锁</h3><p>分布式锁，指在分布式环境下，保护跨进程、跨主机、跨网络的共享资源，实现互斥访问，保证一致性；在zk中，锁就是一个数据节点。</p><ul><li>普通实现</li></ul><p>​注册临时节点，谁注册成功谁获取锁，其他监听该节点的删除事件，一旦被删除，通知其他客户端，再次重复该流程；此为最简单的实现，但存在惊群效应问题。</p><blockquote><p>惊群效应:ZooKeeper分布式锁场景中的羊群效应指的是所有的客户端都尝试对一个临时节点去加锁，当一个锁被占有的时候，其他的客户端都会监听这个临时节点。一旦锁被释放，ZooKeeper反向通知添加监听的客户端，然后大量的客户端都尝试去对同一个临时节点创建锁，最后也只有一个客户端能获得锁，但是大量的请求造成了很大的网络开销，加重了网络的负载，影响ZooKeeper的性能。</p></blockquote><ul><li><p>优化实现</p><p>所有服务要获取锁时都去ZooKeeper中注册一个临时顺序节点，并将基本信息写入临时节点 。</p><p>所有服务获取节点列表并判断自己的节点是否是最小的那个，谁最小谁就获取了 锁 。</p><p>未获取锁的客户端添加对前一个节点删除事件的监听 。</p><p>锁释放&#x2F;持有锁的客户端宕机后，节点被删除 。</p><p>下一个节点的客户端收到通知，重复上述流程。</p><p><img src="/blog/./assets/image-sshlbgrqu3bnrm4vgs4vihk.PNG" alt="临时顺序节点"></p></li></ul><h4 id="共享锁"><a href="#共享锁" class="headerlink" title="共享锁"></a>共享锁</h4><p>又称读锁。如果事务T1对数据对象O1加上了共享锁，那么当前事务只能对O1进行读取操作，其他事务也只能对这个数据对象加共享锁，直到该数据对象上的所有共享锁都被释放。</p><h4 id="排它锁"><a href="#排它锁" class="headerlink" title="排它锁"></a>排它锁</h4><p>又称写锁或独占锁。如果事务T1对数据对象O1加上了排他锁，那么在整个加锁期间，只允许事务T1对O1进行读取或更新操作，其他任务事务都不能对这个数据对象进行任何操作，直到T1释放了排他锁。</p><h4 id="读写分离"><a href="#读写分离" class="headerlink" title="读写分离"></a>读写分离</h4><p>ZooKeeper可以将临时有序节点分为读锁节点和写锁节点 </p><ul><li>当操作是读请求，也就是要获取共享锁，如果没有比自己更小的节点，或比自己小的节点都是读请求，则可以获取到读锁。 若比自己小的节点中有写请求，则当前客户端无法获取到读锁，只能等待前面的写请求完成。 </li><li>如果操作是写请求，也就是要获取独占锁，如果没有比自己更小的节点，则表示当前客户端可以直接获取到写锁，对数据进行修改。 如果发现有比自己更小的节点，无论是读操作还是写操作，当前客户端都无法获取到写锁，等待前面所有的操作完成。</li></ul><p><img src="/blog/./assets/image-1osbsxakddusbnlnb0f5qtk.PNG" alt="读写分离"></p><h4 id="Curator锁实现"><a href="#Curator锁实现" class="headerlink" title="Curator锁实现"></a>Curator锁实现</h4><p><img src="/blog/./assets/image-z826nbt7109likaekz6yn8z.PNG" alt="curator锁实现"></p><ul><li>InterProcessMutex：分布式可重入排它锁（可重入可以借助LocalMap存计数器）</li><li>InterProcessSemaphoreMutex：分布式排它锁</li><li>InterProcessMultiLock：将多个锁作为单个实体管理的容器</li><li>InterProcessReadWriteLock：分布式读写锁</li></ul><h3 id="分布式队列"><a href="#分布式队列" class="headerlink" title="分布式队列"></a>分布式队列</h3><h3 id="数据发布订阅"><a href="#数据发布订阅" class="headerlink" title="数据发布订阅"></a>数据发布订阅</h3><h3 id="负载均衡"><a href="#负载均衡" class="headerlink" title="负载均衡"></a>负载均衡</h3><h3 id="分布式命名服务"><a href="#分布式命名服务" class="headerlink" title="分布式命名服务"></a>分布式命名服务</h3><h3 id="集群管理"><a href="#集群管理" class="headerlink" title="集群管理"></a>集群管理</h3>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>ZooKeeper</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ZooKeeper</tag>
      
      <tag>分布式</tag>
      
      <tag>注册中心</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>互联网架构发展与演变过程</title>
    <link href="/blog/2020/03/%E4%BA%92%E8%81%94%E7%BD%91%E6%9E%B6%E6%9E%84%E5%8F%91%E5%B1%95%E4%B8%8E%E6%BC%94%E5%8F%98%E8%BF%87%E7%A8%8B.html"/>
    <url>/blog/2020/03/%E4%BA%92%E8%81%94%E7%BD%91%E6%9E%B6%E6%9E%84%E5%8F%91%E5%B1%95%E4%B8%8E%E6%BC%94%E5%8F%98%E8%BF%87%E7%A8%8B.html</url>
    
    <content type="html"><![CDATA[<h2 id="业务架构"><a href="#业务架构" class="headerlink" title="业务架构"></a>业务架构</h2><h3 id="单体模式"><a href="#单体模式" class="headerlink" title="单体模式"></a>单体模式</h3><p>早期系统多以单体业务为主，逐个业务线各自扩张。</p><p>系统也多呈现为多个mvc独立运行状态。</p><p>以电商为例，可能按B2B，B2C，C2C不断扩张，每个业务一套系统，每个系统一个维护团队。</p><p><img src="/blog/./assets/image-x2jg6ndr89044xfxdi.PNG" alt="单体架构"></p><h4 id="方案"><a href="#方案" class="headerlink" title="方案"></a>方案</h4><p>代理层设置不同的二级域名，如b2b.example.com，b2c.example.com，分发给不同的服务器。</p><h4 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h4><ul><li>粒度较粗：纯以业务为导向，往往形成业务团队各自为战，新业务线出现时疯狂扩张。</li><li>重复开发：相同功能可能在不同业务的项目中被重复开发，比如短信发送、支付、财务统计。</li><li>资源浪费</li><li>数据孤岛</li></ul><h3 id="中台战略"><a href="#中台战略" class="headerlink" title="中台战略"></a>中台战略</h3><p>特点就是共享。中台需要根据业务来决定，不能未了中台化而做中台。</p><h4 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h4><p>中台在 2015 由阿里提出，其实是阿里共享业务技术部的成型过程。</p><p>中台是一种企业架构而不是单纯的技术层面，目前几乎各大电商都进行着中台化的建设。</p><p>中台不是什么新奇东西，实际上是“共享“理念在业务、系统、组织架构上的一种落地与实施。</p><p>关键词：共享、节约成本、协作。</p><h4 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h4><p>单体业务模式带来很多问题：</p><ul><li><p>技术架构上：</p><ul><li><p>有些相同功能，各个团队重复建设和维护带来的重复投资。</p></li><li><p>业务系统间的集成和协作成本高昂。</p></li><li><p>不利于基础性业务的沉淀和持续发展。</p></li></ul></li><li><p>组织架构上：</p><ul><li>部门在单体模式下往往每个项目一个团队。团队跟随项目疯狂扩展，利用率低。</li></ul></li><li><p>中台类比之下：</p><ul><li><p>中台模式下，基础业务也下沉到技术部门，甚至通过技术反推业务正向发展。</p></li><li><p>下层业务，变化不大的业务持续沉淀，接口像滚雪球一样越来越完善。</p></li><li><p>上层业务，跟业务模式和运营产品有关的系统变化迅速，对底层接口封装组合即可。</p></li></ul></li></ul><h4 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h4><p>以经典电商中台划分为例：</p><p><img src="/blog/./assets/image-i13acsxt4j8xcf3p44.PNG" alt="中台架构"></p><h5 id="业务中台"><a href="#业务中台" class="headerlink" title="业务中台"></a>业务中台</h5><p>业务中台基于公共服务的沉淀，需要积累一些基础的业务服务。</p><p>这些服务在 B2B，B2C 等系统中都会具备，是相同的。</p><ul><li>商品中心：商品、类目、sku、spu</li><li>交易中心：订单、状态流转、条目、支付</li><li>营销中心：促销、优惠券、活动</li><li>会员中心：账户、基本信息、收发货地址、商铺商家信息</li><li>仓储中心：仓库、库存</li><li>物流中心：发货信息、自主物流或外部物流对接</li><li>…</li></ul><h5 id="技术中台"><a href="#技术中台" class="headerlink" title="技术中台"></a>技术中台</h5><p>与业务无关的基础沉淀，技术类内容可以在各个团队之间共享。</p><ul><li><p>基础架构：核心类库、公共框架、基础服务、服务治理框架</p></li><li><p>中间件：分布式缓存、分布式消息、数据存储（db，nosql）、分布式文件、分布式调度</p></li><li><p>自动化运维：监控中心、资源管理、配置中心、发布中心、日志平台</p></li><li><p>自动化测试：任务协同、基础测试、性能测试、接口测试、持续集成</p></li><li><p>运维中台，将开发层和系统层的内容分开</p></li><li><p>…</p></li></ul><h5 id="数据中台"><a href="#数据中台" class="headerlink" title="数据中台"></a>数据中台</h5><p>数据中台不是数据平台，也不是数据仓库，这三者是有区别的。</p><p>举个例子：数据平台可以理解为数据库，数据仓库类比为报表。而数据中台更贴近上层业务，带着业务属性。同样以接口形式为其他上层各个业务线提供持续调用。</p><ul><li><p>数据抽取：从db，nosql，日志等各个来源提供抽取接口</p></li><li><p>数据接口：为上层业务提供需要的定制化业务数据接口</p></li><li><p>数据分析：行业分析与决策、数据驱动运营</p></li><li><p>人工智能：用户画像、商品推荐</p></li><li><p>可视化：数据大屏、信息展示、活动报表等</p></li><li><p>…</p></li></ul><h5 id="服务接入层"><a href="#服务接入层" class="headerlink" title="服务接入层"></a>服务接入层</h5><p>即大中台，小前台的前台，电商中直面用户的B2B,B2C等各个业务线。</p><ul><li>现有的业务模式、流程等根据市场及时调整，变化非常快。</li><li>新的业务线可以被快速实现，不需要再重复开发底层的中台业务，调取中台接口组装即可。</li></ul><h2 id="数据架构"><a href="#数据架构" class="headerlink" title="数据架构"></a>数据架构</h2><h3 id="单数据库"><a href="#单数据库" class="headerlink" title="单数据库"></a>单数据库</h3><p>早在2003-2004淘宝V1.0就使用mysql，V1.1换成oracle，直到 2007 数据库重新往mysql回迁。<br>这个阶段往往引发追逐商业大型db如oracle（淘宝v1.1 ， mysql→oracle）</p><p><img src="/blog/./assets/image-qzi0r0fhntuahdm0t0.PNG" alt="单数据库"></p><h4 id="方案-1"><a href="#方案-1" class="headerlink" title="方案"></a>方案</h4><p>java web项目直接通过jdbc，连接单一的数据库，读写扎堆在一块，单库上的机器io及cpu性能很快达到<br>上限</p><ul><li>数据库：mysql、oracle、sqlserver、db2等</li><li>持久层框架：jdbc，hibernate，jpa，mybatis</li></ul><h3 id="主从读写"><a href="#主从读写" class="headerlink" title="主从读写"></a>主从读写</h3><p>淘宝从oracle换回mysql的历程中实现了主从库部署与读写分离。</p><p><img src="/blog/./assets/image-6q3de494yufdlc5elq.PNG" alt="读写分离"></p><h5 id="方案-2"><a href="#方案-2" class="headerlink" title="方案"></a>方案</h5><p>java web应用层连接多个数据库，数据库之间形成主从关系，主库上写，从库上读。读写压力被分散。</p><ul><li>数据库集群：一主多从、双主单写</li><li>应用层开发：多数据源支持，spring multi datasource</li><li>中间件：Sharding-JDBC，Mycat</li></ul><h5 id="特点-1"><a href="#特点-1" class="headerlink" title="特点"></a>特点</h5><ul><li>数据延迟：从主库到从库之间数据需要经过网络传输，不可避免的有延迟。</li><li>开发层面：需要开发框架具备多数据源的支持，以及自动化的数据源切换。</li><li>单库瓶颈：业务越来越多，表数量越来越多。出现单个库几百张表的现象。</li><li>数据局限：依然无法解决单表大数据的问题，比如订单积累达到亿级，即使在从库，关联查询依然奇慢无比。</li></ul><h3 id="分库分表"><a href="#分库分表" class="headerlink" title="分库分表"></a>分库分表</h3><p>2004-2007，淘宝V2.1，分库。分库更多是基于业务，分表更多是基于数据记录或字段。</p><p><img src="/blog/./assets/image-nq7fsnebif12kfike3.PNG" alt="分库分表"></p><h5 id="方案-3"><a href="#方案-3" class="headerlink" title="方案"></a>方案</h5><p>主从库的写入依然是有一个统一的主库入口。随着业务量的提升，继续细粒度化拆分</p><ul><li><p>业务分库：订单库，产品库，活动库，会员库</p></li><li><p>横向分表：（拆记录） 3 个月内订单，半年内订单，更多订单</p></li><li><p>纵向分表：（拆字段）name、phone一张表，info、address一张表，俩表id一致</p></li></ul><h5 id="特点-2"><a href="#特点-2" class="headerlink" title="特点"></a>特点</h5><ul><li>分库<ul><li>不同的数据库，所以无法使用数据库事务，而分布式事务的效果并不理想，多采用幂等和最终一致性方案。</li></ul></li><li>分表<ul><li>拆了再聚合是一对矛盾，例如按下单时间维度的分表，需要按用户排序统计变得异常困难。<br>中间件：Sharding-JDBC，Mycat，Atlas</li></ul></li></ul><h3 id="高速缓存"><a href="#高速缓存" class="headerlink" title="高速缓存"></a>高速缓存</h3><p>2006-2007，淘宝V2.2架构，分布式缓存Tair引入。</p><p><img src="/blog/./assets/image-mu04tw0appzyki4x4u.PNG" alt="高速缓存"></p><h5 id="方案-4"><a href="#方案-4" class="headerlink" title="方案"></a>方案</h5><p>数据库往往是系统的瓶颈，根据数据的冷热划分，热点数据如类目、商品基础信息放在缓存中，其他数据延迟加载</p><ul><li>ehcache：非分布式，简单，易维护，可用性一般</li><li>memcache：性能可靠，纯内存，客户端需要自己实现，无持久化</li><li>redis：性能可靠，纯内存，自带分片，集群，哨兵，支持持久化，几乎成为当前的标准方案</li></ul><h5 id="特点-3"><a href="#特点-3" class="headerlink" title="特点"></a>特点</h5><ul><li><p>缓存策略</p><ul><li>冷热数据的存放，缓存与db的边界需要把控，重度依赖可能引发问题</li></ul></li><li><p>缓存陷阱</p><ul><li>击穿（单一 key过期），穿透（不存在的 key），雪崩（多个 key 同时过期）</li></ul></li><li><p>数据一致性</p><ul><li>缓存和 db 之间因为同一份数据保存了两份，自然带来了一致性问题</li></ul></li></ul><h3 id="数据多样化"><a href="#数据多样化" class="headerlink" title="数据多样化"></a>数据多样化</h3><p>一个网站中，数据库和缓存只是一种基本的存储手段，除了这些，随着网站架构的发展其他各种形式的存储结构相继涌现：</p><p><img src="/blog/./assets/image-xz83il0ner45c12p9e.PNG" alt="数据多样化存储"></p><p>2006-2007，淘宝V2.2，分布式存储TFS，分布式缓存Tair，V3.0 加入 nosql Cassandra，搜索引擎<br>升级。<br>数据库全文检索 <em>→</em> 搜索引擎、本地上传 <em>+nfs→</em> 分布式文件系统的演进。</p><h4 id="分布式文件"><a href="#分布式文件" class="headerlink" title="分布式文件"></a>分布式文件</h4><p>商品图片，上传的文件等</p><ul><li><p>hdfs：大数据下的分布式存储</p></li><li><p>fastdfs</p></li><li><p>cephFs</p></li></ul><h4 id="nosql"><a href="#nosql" class="headerlink" title="nosql"></a>nosql</h4><ul><li><p>redis</p></li><li><p>mongodb</p></li><li><p>hbase</p></li><li><p>tidb</p></li></ul><h4 id="搜索引擎"><a href="#搜索引擎" class="headerlink" title="搜索引擎"></a>搜索引擎</h4><ul><li>搜索引擎<ul><li>lucene</li><li>solr</li><li>elasticsearch</li></ul></li></ul><h3 id="架构特点"><a href="#架构特点" class="headerlink" title="架构特点"></a>架构特点</h3><ul><li>开发框架支持：存储的数据多样化，要求开发框架架构层面要提供多样化的支撑，并确保访问易用性</li><li>数据运维：多种数据服务器对运维的要求提升，机器的数据维护与灾备工作量加大</li><li>数据安全：多种数据存储的权限，授权与访问隔离需要注意</li></ul><h2 id="应用架构"><a href="#应用架构" class="headerlink" title="应用架构"></a>应用架构</h2><h3 id="单机调优"><a href="#单机调优" class="headerlink" title="单机调优"></a>单机调优</h3><p>早年间的项目大多采用mvc开发。</p><p><img src="/blog/./assets/image-jnhbhe6x4vrgnqmnl6.PNG" alt="单体架构"></p><h4 id="特点-4"><a href="#特点-4" class="headerlink" title="特点"></a>特点</h4><p>每个项目成一个mvc结构，部署在应用服务器上。（tomcat、jboss、websphere，weblogic）。</p><p>随着业务扩张，需求迭代，项目变得越来越大，一个war包动辄几百兆。</p><p>崇尚调优，jvm单节点调优甚至接近于强迫症的地步。</p><h3 id="动静分离"><a href="#动静分离" class="headerlink" title="动静分离"></a>动静分离</h3><p>早年间的Apache+tomcat，后被nginx几乎一统江山。（前后端开发模式的演进： <em>mvc</em> 页面嵌套 <em>→</em> 接口<br>化）</p><p><img src="/blog/./assets/image-c0v6c1qjdkf8e0h7fv.PNG" alt="动静分离"></p><h4 id="方案-5"><a href="#方案-5" class="headerlink" title="方案"></a>方案</h4><ul><li>静态响应：tomcat对静态文件响应一般，提取静态文件，直接由nginx响应</li><li>动态代理：后端api通过代理转发给tomcat应用机器</li></ul><h4 id="特点-5"><a href="#特点-5" class="headerlink" title="特点"></a>特点</h4><ul><li><p>开发层面调整：项目结构要同步调整，由原来的一体化mvc转换为后端api+前端形式。</p></li><li><p>前后协调：前后端的分工变得更明确，互相并行开发，独立部署，但也带来了接口协调与约定等沟通问题。</p></li><li><p>跨域问题：后段与前端如果域名不同，可能存在跨域问题（head头，jsonp等手段可以解决）。</p></li></ul><h3 id="SOA"><a href="#SOA" class="headerlink" title="SOA"></a>SOA</h3><p>单纯的动静分离只解决了自己服务的项目结构，跨项目接口调用时，必须经过rest请求，不利于服务之<br>间的交互。淘宝V3.0，HSF出现，服务化导向，架构师忙于SOA和系统关系的梳理。</p><p><img src="/blog/./assets/image-hcji5g9jyl56vsoqry.PNG" alt="分布式架构"></p><h4 id="方案-6"><a href="#方案-6" class="headerlink" title="方案"></a>方案</h4><ul><li>公共服务：重复开发的基础服务提取出来，形成服务中心，避免重复造轮子，降低成本，架构团队出现。</li><li>独立性：各自服务独立部署升级，粒度更细，低耦合，高内聚。</li><li>SOA理念诞生：服务治理的范畴，重在服务之间的拆分与统一接口。</li></ul><h4 id="技术手段"><a href="#技术手段" class="headerlink" title="技术手段"></a>技术手段</h4><ul><li><p>异步化：</p><ul><li>rabbitmq </li><li>rocketmq</li><li>kafka</li></ul></li><li><p>RPC：</p><ul><li>dubbo</li></ul></li></ul><h4 id="特点-6"><a href="#特点-6" class="headerlink" title="特点"></a>特点</h4><ul><li><p>界限把控：服务的粒度、拆分和公共服务提炼需要架构师的全局把控。设计不好容易引发混乱。</p></li><li><p>部署升级：服务数量增多，人工部署变的不现实，必须借助自动化运维。</p></li><li><p>服务可用性：抽调的微服务因需要被多个上层业务共享，可用性等级变高，一旦down机就是灾难。</p></li><li><p>熔断和限流：做好服务熔断和限流，提防服务单点瓶颈造成整个系统瘫痪。短信提醒失败不要影响下单。</p></li></ul><h3 id="微服务"><a href="#微服务" class="headerlink" title="微服务"></a>微服务</h3><p><img src="/blog/./assets/image-yht298c0fmknupdcuw.PNG" alt="微服务架构"></p><blockquote><p>ESB企业服务总线即微服务中的服务网关。</p></blockquote><h4 id="方案-7"><a href="#方案-7" class="headerlink" title="方案"></a>方案</h4><ul><li>微服务是基于SOA思想，将系统粒度进一步细化而诞生的一种手段</li><li>中台化得以实现，各个中心以及前端业务拆解为多个小的服务单元。</li></ul><h4 id="技术手段-1"><a href="#技术手段-1" class="headerlink" title="技术手段"></a>技术手段</h4><p>微服务经历了从1.0（cloud）到2.0的演化（service mesh），目前企业中主流的解决方案依然是cloud<br>全家桶springcloud。</p><h4 id="特点-7"><a href="#特点-7" class="headerlink" title="特点"></a>特点</h4><p>-<br>  服务拆分：粒度并非越小越好。太小会带来部署维护等一系列成本的上升。</p><ul><li>接口约束：系统增多，各个服务接口的规范化日益重要，要求有统一的服务接口规范，推动企业消息总线的建设</li><li>权限约束：接口不是任意想调就可以调的，做好权限控制，借助oauth2等手段，实现服务之间的权限认证。</li></ul><h2 id="部署架构"><a href="#部署架构" class="headerlink" title="部署架构"></a>部署架构</h2><h3 id="单机器"><a href="#单机器" class="headerlink" title="单机器"></a>单机器</h3><p>小型网站ALL IN ONE。</p><p><img src="/blog/./assets/image-jnhbhe6x4vrgnqmnl6.PNG" alt="单体架构"></p><h4 id="方案-8"><a href="#方案-8" class="headerlink" title="方案"></a>方案</h4><ul><li>单台机器的性能很快达到上限，就是所说的资源不足了。</li><li>然后开始提升配置，推动高配机器的发展，成本高昂。</li></ul><h4 id="特点-8"><a href="#特点-8" class="headerlink" title="特点"></a>特点</h4><ul><li><p>部署简单：采用web包部署与发布，db等资源同台机器连接，简单易操作。</p></li><li><p>资源争夺：在业务发展的初始阶段尚可支撑，随着访问量的上升，单机性能很快会成为系统瓶颈。</p></li></ul><h3 id="角色划分"><a href="#角色划分" class="headerlink" title="角色划分"></a>角色划分</h3><p>稍微大一点的系统，把数据库、缓存、消息等中间件剥离出去，单独机器来部署。</p><p><img src="/blog/./assets/image-1cfqlhsb488utrhf39.PNG" alt="中间件分离"></p><h4 id="方案-9"><a href="#方案-9" class="headerlink" title="方案"></a>方案</h4><ul><li><p>多台机器：tomcat与mysql各自独占机器资源。</p></li><li><p>针对性扩容：tomcat应用机更注重cpu的运算和内存，mysql更注重io与磁盘性能，针对各自情况扩容。</p></li></ul><h4 id="特点-9"><a href="#特点-9" class="headerlink" title="特点"></a>特点</h4><ul><li>数据维护：可以抽出单独的dba来维护数据库服务器。</li><li>数据安全：需要跨机器访问数据库，链接密码需要注意防范泄漏。</li></ul><h3 id="应用集群"><a href="#应用集群" class="headerlink" title="应用集群"></a>应用集群</h3><p>2004-2005，淘宝V2.0，EJB为核心。V2.1架构下，引入spring框架走向轻量化和集群</p><p><img src="/blog/./assets/image-f1tb62rl5y72y1hntx.PNG" alt="集群部署"></p><h4 id="方案-10"><a href="#方案-10" class="headerlink" title="方案"></a>方案</h4><ul><li><p>apache：早期负载均衡方案，性能一般</p></li><li><p>nginx： 7 层代理，性能强悍，配置简洁，当前不二之选</p></li><li><p>haproxy：性能同样可靠，可做 7 层或 4 层代理。</p></li><li><p>lvs： 4 层代理，性能最强，linux集成，配置麻烦</p></li><li><p>f5： 4 层，硬件负载，财大气粗的不二选择</p></li></ul><h4 id="特点-10"><a href="#特点-10" class="headerlink" title="特点"></a>特点</h4><ul><li><p>session保持：集群环境下，用户登陆需要分布式session做支撑。</p></li><li><p>分布式协同：分布式环境下对资源的加锁要超出线程锁的范畴，上升为分布式锁。</p></li><li><p>调度问题：调度程序不能多台部署，容易跑重复，除非使用分布式调度，如elastic-job。</p></li><li><p>机器状态管理：多台应用机的状态检测与替换需要做到及时性，一般niginx层做故障转移。</p></li><li><p>服务升级：滚动升级成为可能，灰度发布。</p></li><li><p>日志管理：日志文件分散在各个机器，促进集中式日志平台的产生。</p></li></ul><h3 id="多层代理"><a href="#多层代理" class="headerlink" title="多层代理"></a>多层代理</h3><p><img src="/blog/./assets/image-187yh63bfltv2irxqy.PNG" alt="多层代理"></p><h4 id="方案-11"><a href="#方案-11" class="headerlink" title="方案"></a>方案</h4><p>机器规模进一步加大，动静态均有多个nginx负载，入口统一交给lvs负载。多层代理形成。</p><h4 id="特点-11"><a href="#特点-11" class="headerlink" title="特点"></a>特点</h4><p>机房受限：lvs依然是单一节点，即使keepalived做到高可用，流量仍然需要在唯一入口进入。</p><h3 id="异地访问"><a href="#异地访问" class="headerlink" title="异地访问"></a>异地访问</h3><p>淘宝V2.1时代 ， 使用自己的TaobaoCDN。</p><p>将相同的系统部署多份，分散到异地多个机房，或者电信、移动等多个网络中。</p><p>不同地点，不同网络接入的用户，有了不同的访问入口和选择。</p><p><img src="/blog/./assets/image-23zcrj50e3dlibkhle.PNG" alt="异地多活"></p><h4 id="方案-12"><a href="#方案-12" class="headerlink" title="方案"></a>方案</h4><ul><li><p>dns轮询：通过配置多个ip将服务部署到多个机房，通过dns的策略轮询调用，可以实现机房层面的扩容。</p></li><li><p>CDN：就近原则，使用户获得就近的机房访问相关资源，自己投资太大，购买他方需要付费。</p></li></ul><h4 id="特点-12"><a href="#特点-12" class="headerlink" title="特点"></a>特点</h4><p>基本解决了机器部署的扩容问题，随着业务的发展，扩容与收缩变得困难，促进资源调度层面的技术发<br>展。</p><h3 id="云平台"><a href="#云平台" class="headerlink" title="云平台"></a>云平台</h3><p>针对中台化的建设及微服务数量的飙升，部署和运维支撑同步进行着变革。面临微服务的快速部署，资源的弹性伸缩等挑战，容器化与云被推进。</p><p>案例：成百上千的服务数量庞大、大促期间某些微服务的临时扩容。</p><p><img src="/blog/./assets/image-bf1c8izqnxc2o83yww.PNG" alt="云平台"></p><h4 id="方案-13"><a href="#方案-13" class="headerlink" title="方案"></a>方案</h4><ul><li><p>虚拟化：vm方案，Openstack，Vmware，VirtualBox</p></li><li><p>容器化：docker</p></li><li><p>编排：swarm，k8s，k3s</p></li><li><p>云化：容器化解决了资源的快速伸缩，但仍需要企业自备大量机器资源。推动私有云到企业云进化。</p></li></ul><h4 id="特点-13"><a href="#特点-13" class="headerlink" title="特点"></a>特点</h4><ul><li>资源预估：注意资源的回收，降低资源闲置和浪费，例如大促结束后要及时回收。</li><li>运维要求：需要运维层面的高度支撑，门槛比较高。</li><li>预估风险：云瘫痪的故障造成的损失不可估量。</li></ul><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><a href="https://db-engines.com/en/ranking">数据库流行度排名</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>工作</category>
      
      <category>编程思想</category>
      
    </categories>
    
    
    <tags>
      
      <tag>业务架构</tag>
      
      <tag>数据架构</tag>
      
      <tag>应用架构</tag>
      
      <tag>部署架构</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Vifm命令行文件管理器入门</title>
    <link href="/blog/2020/03/vifm%E5%91%BD%E4%BB%A4%E8%A1%8C%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86%E5%99%A8%E5%85%A5%E9%97%A8.html"/>
    <url>/blog/2020/03/vifm%E5%91%BD%E4%BB%A4%E8%A1%8C%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86%E5%99%A8%E5%85%A5%E9%97%A8.html</url>
    
    <content type="html"><![CDATA[<p>Vifm是一个实用的类 Vim 快捷键终端文件管理器，可以用来替代图形文件管理器。</p><h2 id="快捷键"><a href="#快捷键" class="headerlink" title="快捷键"></a>快捷键</h2><table><thead><tr><th align="left">快捷键</th><th align="left">描述</th></tr></thead><tbody><tr><td align="left">ctrl-w hjkl</td><td align="left">切换窗口</td></tr><tr><td align="left">ctrl-w s</td><td align="left">水平分隔</td></tr><tr><td align="left">ctrl-w v</td><td align="left">垂直分隔窗口</td></tr><tr><td align="left">w</td><td align="left">另个窗口预览当前光标文件</td></tr><tr><td align="left">e</td><td align="left">当前窗口预览光标文件</td></tr><tr><td align="left">dd</td><td align="left">删除文件</td></tr><tr><td align="left">:trashes</td><td align="left">查看垃圾箱目录</td></tr><tr><td align="left">lstrash</td><td align="left">查看垃圾桶文件</td></tr><tr><td align="left">:restore</td><td align="left">还原选中的垃圾箱文件</td></tr><tr><td align="left">j,k</td><td align="left">上下移动</td></tr><tr><td align="left">h,l</td><td align="left">在父&#x2F;子目录之间移动</td></tr><tr><td align="left">gg</td><td align="left">移动到文件列表首行</td></tr><tr><td align="left">G</td><td align="left">移动到文件列表末行</td></tr><tr><td align="left">M</td><td align="left">光标移动到窗口中间</td></tr><tr><td align="left">H,L</td><td align="left">光标移动到窗口首末文件</td></tr><tr><td align="left">gh</td><td align="left">返回上级目录</td></tr><tr><td align="left">gl,Enter</td><td align="left">进入目录或打开文件</td></tr><tr><td align="left">dd,d</td><td align="left">删除文件(放入回收站)</td></tr><tr><td align="left">DD,D</td><td align="left">删除文件(不放回收站)</td></tr><tr><td align="left">yy,Y,y</td><td align="left">复制文件</td></tr><tr><td align="left">p</td><td align="left">粘贴文件</td></tr><tr><td align="left">u</td><td align="left">撤销操作</td></tr><tr><td align="left">Space,Tab</td><td align="left">在两个panel之间切换</td></tr><tr><td align="left">&#x2F;</td><td align="left">查找文件</td></tr><tr><td align="left">m[a-zA-Z0-9]</td><td align="left">书签</td></tr><tr><td align="left">‘[a-zA-Z0-9]</td><td align="left">跳转到书签位置</td></tr><tr><td align="left">za</td><td align="left">切换隐藏文件显隐</td></tr><tr><td align="left">zo</td><td align="left">显示隐藏文件</td></tr><tr><td align="left">zm</td><td align="left">不显示隐藏文件</td></tr><tr><td align="left">:fil regex</td><td align="left">隐藏匹配regex的文件</td></tr><tr><td align="left">zO</td><td align="left">显示被:fil命令过滤的文件</td></tr><tr><td align="left">zM</td><td align="left">隐藏被:fil命令过滤的文件</td></tr><tr><td align="left">cp</td><td align="left">更改文件属性权限</td></tr><tr><td align="left">cw</td><td align="left">文件&#x2F;文件夹重命名</td></tr><tr><td align="left">cW</td><td align="left">文件&#x2F;文件夹重命名,不包含扩展名</td></tr><tr><td align="left">ga</td><td align="left">计算文件夹大小</td></tr><tr><td align="left">!prog</td><td align="left">执行系统命令, %f可以用来当前选中文件名</td></tr></tbody></table>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>操作演示</category>
      
    </categories>
    
    
    <tags>
      
      <tag>软件</tag>
      
      <tag>Linux</tag>
      
      <tag>Vifm</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>获取网站的 favicon 的方式</title>
    <link href="/blog/2020/03/%E8%8E%B7%E5%8F%96%E7%BD%91%E7%AB%99%E7%9A%84favicon%E7%9A%84%E6%96%B9%E5%BC%8F.html"/>
    <url>/blog/2020/03/%E8%8E%B7%E5%8F%96%E7%BD%91%E7%AB%99%E7%9A%84favicon%E7%9A%84%E6%96%B9%E5%BC%8F.html</url>
    
    <content type="html"><![CDATA[<h2 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h2><p>搭建网址导航时，需要获取网站的favicon.ico来增加辨识度和美观度。可以通过以下几种方式获取到网站的favicon.ico.</p><h2 id="域名拼接"><a href="#域名拼接" class="headerlink" title="域名拼接"></a>域名拼接</h2><p>找到网站的的默认路径，然后在地址后面拼接favicon.ico，就是favicon图标的地址了。 </p><p>例如:<a href="https://maojun.xyz/favicon.ico">https://maojun.xyz/favicon.ico</a></p><blockquote><p>注意：如果网站没有配置favicon.ico则会返回404错误</p></blockquote><h2 id="head元素定位"><a href="#head元素定位" class="headerlink" title="head元素定位"></a>head元素定位</h2><p>当域名后面拼接favicon.ico无法获取图标的，可以尝试通过通过首页的<code>head</code>标签中的<code>rel=&quot;shortcut icon&quot;</code>来找到对应的favicon.ico位置。</p><h2 id="在线获取ico工具"><a href="#在线获取ico工具" class="headerlink" title="在线获取ico工具"></a>在线获取ico工具</h2><p>通过Google的链接工具来找到favicon.ico</p><p><a href="https://www.google.com/s2/favicons?domain=maojun.xyz">https://www.google.com/s2/favicons?domain=maojun.xyz</a></p><blockquote><p>把domain后的域名修改成需要查找favicon.ico的网站</p></blockquote><p>（本文完）</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>操作演示</category>
      
    </categories>
    
    
    <tags>
      
      <tag>软件</tag>
      
      <tag>网页工具</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linux环境中间件单机部署</title>
    <link href="/blog/2020/03/Linux%E7%8E%AF%E5%A2%83%E4%B8%AD%E9%97%B4%E4%BB%B6%E5%8D%95%E6%9C%BA%E9%83%A8%E7%BD%B2.html"/>
    <url>/blog/2020/03/Linux%E7%8E%AF%E5%A2%83%E4%B8%AD%E9%97%B4%E4%BB%B6%E5%8D%95%E6%9C%BA%E9%83%A8%E7%BD%B2.html</url>
    
    <content type="html"><![CDATA[<h2 id="约定项"><a href="#约定项" class="headerlink" title="约定项"></a>约定项</h2><p>安装包存放目录&#x2F;export&#x2F;soft</p><h2 id="JDK8安装"><a href="#JDK8安装" class="headerlink" title="JDK8安装"></a>JDK8安装</h2><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sh">su - root<br><span class="hljs-built_in">mkdir</span> -p /export/soft<br><br><span class="hljs-comment">#上传包</span><br>rz jdk-8u202-linux-x64.tar.gz           <br><span class="hljs-comment">#解压、</span><br>tar -zxvf jdk-8u202-linux-x64.tar.gz      <br><span class="hljs-built_in">cd</span> jdk1.8.0_202     <br></code></pre></td></tr></table></figure><h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><p>编辑<code>/etc/profile </code>文件，追加以下内容</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">export</span> JAVA_HOME=/export/middleware/jdk1.8.0_202<br><span class="hljs-built_in">export</span> PATH=<span class="hljs-variable">$PATH</span>:<span class="hljs-variable">$JAVA_HOME</span>/binH<br></code></pre></td></tr></table></figure><p>刷新配置</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">source</span> /etc/profile<br></code></pre></td></tr></table></figure><h3 id="验证"><a href="#验证" class="headerlink" title="验证"></a>验证</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">java –version            <br>java version <span class="hljs-string">&quot;1.8.0_202&quot;</span><br>Java(TM) SE Runtime Environment (build 1.8.0_202-b08)<br>Java HotSpot(TM) 64-Bit Server VM (build 25.202-b08, mixed mode)<br></code></pre></td></tr></table></figure><h2 id="zookeeper3-6-1安装"><a href="#zookeeper3-6-1安装" class="headerlink" title="zookeeper3.6.1安装"></a>zookeeper3.6.1安装</h2><h3 id="安装-1"><a href="#安装-1" class="headerlink" title="安装"></a>安装</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sh">su - root<br><span class="hljs-built_in">mkdir</span> -p /expoer/soft<br><span class="hljs-comment">#上传</span><br>rz apache-zookeeper-3.6.1-bin.tar.gz<br><span class="hljs-comment">#解压</span><br>tar -zxvf apache-zookeeper-3.6.1-bin.tar.gz<br><span class="hljs-comment">#重命名</span><br><span class="hljs-built_in">mv</span> apache-zookeeper-3.6.1-bin  zk<br></code></pre></td></tr></table></figure><h3 id="配置-1"><a href="#配置-1" class="headerlink" title="配置"></a>配置</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#新建/expoer/soft/zk/data目录</span><br><span class="hljs-built_in">mkdir</span> data<br><span class="hljs-comment">#修改conf</span><br><span class="hljs-built_in">mv</span> zoo_sample.cfg zoo.cfg<br></code></pre></td></tr></table></figure><p>在<code>zoo.cfg</code>中修改以下内容</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">dataDir=/export/soft/zk/data<br></code></pre></td></tr></table></figure><h3 id="验证-1"><a href="#验证-1" class="headerlink" title="验证"></a>验证</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">cd</span> ..<br>sh bin/zkServer.sh start<br>查看状态<br>sh bin/zkServer.sh status<br>查看进程<br>ps -ef|grep zookeeper<br>sh bin/zkCli.sh -server 127.0.0.1:2181<br></code></pre></td></tr></table></figure><h2 id="Dubbo-admin安装"><a href="#Dubbo-admin安装" class="headerlink" title="Dubbo-admin安装"></a>Dubbo-admin安装</h2><h3 id="安装-2"><a href="#安装-2" class="headerlink" title="安装"></a>安装</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">mkdir</span> -p /expoer/soft/dubbo-admin<br><span class="hljs-built_in">cd</span> dubbo-admin<br>rz dubbo-admin-server-0.2.0-SNAPSHOT.jar<br></code></pre></td></tr></table></figure><h3 id="配置-2"><a href="#配置-2" class="headerlink" title="配置"></a>配置</h3><ol><li>复制一份 application.properties</li><li>修改application.properties里的端口和注册地址</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">server.port=9880<br>admin.registry.address=zookeeper://127.0.0.1:2181<br>admin.config-center=zookeeper://127.0.0.1:2181<br>admin.metadata-report.address=zookeeper://127.0.0.1:2181<br></code></pre></td></tr></table></figure><p>启动</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">nohup</span> java -jar dubbo-admin-server-0.2.0-SNAPSHOT.jar --spring.config.location=/ expoer/soft/dubbo-admin/application.properties &gt;&gt; dubbo-damin.log 2&gt;&amp;1 &amp;<br></code></pre></td></tr></table></figure><h3 id="验证-2"><a href="#验证-2" class="headerlink" title="验证"></a>验证</h3><p>登入dubbo管控台验证：</p><p><a href="http://127.0.0.1:9880/">http://127.0.0.1:9880/</a></p><h2 id="Mysql5-7-29安装"><a href="#Mysql5-7-29安装" class="headerlink" title="Mysql5.7.29安装"></a>Mysql5.7.29安装</h2><h3 id="安装-3"><a href="#安装-3" class="headerlink" title="安装"></a>安装</h3><p>下载地址：<a href="https://downloads.mysql.com/archives/community/">https://downloads.mysql.com/archives/community/</a><br>下载linux通用版本 mysql-5.7.29-linux-glibc2.12-x86_64.tar.gz</p><blockquote><p>MySQL Community Server 社区版本，开源免费，但不提供官方技术支持，这也是我们通常用的MySQL的版本。</p><p>MySQL Enterprise Edition 企业版本，需付费，可以试用30天。</p><p>MySQL Cluster 集群版，开源免费。可将几个MySQL Server封装成一个Server。</p><p>MySQL Cluster CGE 高级集群版，需付费。</p></blockquote><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs sh">su - root<br><span class="hljs-built_in">mkdir</span> -p /expoer/soft<br><span class="hljs-comment">#检测系统是否自带mysql</span><br>rpm -qa|grep mysql     <br><span class="hljs-comment">#如果有进行强行卸载</span><br>rpm -e --nodeps mysql-libs-5.1.52-1.el6_0.1.x86_64<br><span class="hljs-comment">#检测系统是否自带mariadb</span><br>rpm -qa|grep mariadb         <br><span class="hljs-comment">#有就卸载</span><br>rpm -e --nodeps mariadb-*   <br><span class="hljs-comment"># 解压安装</span><br>tar -zxvf mysql-5.7.35-linux-glibc2.12-x86_64.tar.gz<br><span class="hljs-built_in">mv</span> mysql-5.7.35-linux-glibc2.12-x86_64  mysql-5.7.35<br><span class="hljs-comment">#安装数据库创建data目录 </span><br><span class="hljs-built_in">mkdir</span> /export/soft/mysql-5.7.35/data<br><span class="hljs-built_in">cd</span> /export/soft/mysql-5.7.35/support-files<br></code></pre></td></tr></table></figure><p>编辑<code>my_default.cnf</code>配置文件，修改下面的内容：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs cnf">[mysqld]<br>basedir =/export/soft/mysql-5.7.35            #设置mysql的安装目录<br>datadir = /export/soft/mysql-5.7.35/data       #设置mysql数据库的数据存放目录<br>port = 3306                                  #设置端口<br>socket = /tmp/mysql.sock<br>character-set-server=utf8                          #设置字符集<br>log-error = /export/soft/mysql-5.7.35/data/mysqld.log   #日志存放目录<br>pid-file = /export/soft/mysql-5.7.35/data/mysqld.pid<br>#允许时间类型的数据为零(去掉NO_ZERO_IN_DATE,NO_ZERO_DATE)<br>sql_mode= STRICT_TRANS_TABLES,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION<br>#ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION<br>lower_case_table_names=1     #表、字段等不区分大小写备注：0,区分大小写; 1,不区分<br>max_connections=1000        #设置最大连接数，默认100<br>max_user_connections=500<br>[client]<br>socket = /tmp/mysql.sock<br></code></pre></td></tr></table></figure><p>新建mysql用户</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#检查mysql组和用户是否存在，如果没有则创建</span><br><span class="hljs-built_in">cat</span> /etc/group|grep mysql<br>groupadd mysql<br></code></pre></td></tr></table></figure><blockquote><p>如果报错 groupadd: cannot open &#x2F;etc&#x2F;group</p><p>解决方法使用root用户</p></blockquote><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs sh">chattr -i /etc/gshadow<br>chattr -i /etc/group<br>groupadd mysql<br><span class="hljs-comment">#创建mysql用户</span><br><span class="hljs-comment">#useradd -r参数表示mysql用户是系统用户，不可用于登录系统</span><br>useradd -r -g mysql mysql　<br>chattr -i /etc/shadow<br>chattr -i /etc/passwd<br>useradd -r -g mysql mysql<br><span class="hljs-comment">#将/usr/local/mysql-5.7.35的所有者及所属组改为mysql</span><br><span class="hljs-built_in">chown</span> -R mysql.mysql /export/soft/mysql-5.7.35/<br><span class="hljs-built_in">cp</span> my_default.cnf /etc/my.cnf<br></code></pre></td></tr></table></figure><p>初始化Mysql</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">cd</span> bin<br>./mysqld --initialize --user=mysql --user=mysql --basedir=/export/soft/mysql-5.7.35/ --datadir=/export/soft/mysql-5.7.35/data/<br></code></pre></td></tr></table></figure><p>初始化完成之后查看日志里的是临时密码</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">cat</span> /export/soft/mysql-5.7.35/data/mysqld.log <br></code></pre></td></tr></table></figure><p>启动Mysql</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#把启动脚本放到开机初始化目录</span><br><span class="hljs-built_in">cp</span> support-files/mysql.server /etc/init.d/mysql<br><span class="hljs-comment">#启动mysql</span><br>service mysql start<br><span class="hljs-comment"># 重启</span><br>service mysql restart 或 sudo /etc/init.d/mysql restart<br></code></pre></td></tr></table></figure><h3 id="配置-3"><a href="#配置-3" class="headerlink" title="配置"></a>配置</h3><p>配置MySQL全局环境变量，编辑<code>/etc/profile</code>文件，添加以下的内容</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">export</span> MySQL_HOME=/export/middleware/mysql-5.7.35<br><span class="hljs-built_in">export</span> PATH=<span class="hljs-variable">$MySQL_HOME</span>/bin:<span class="hljs-variable">$PATH</span><br></code></pre></td></tr></table></figure><p>刷新&#x2F;etc&#x2F;profile配置文件</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">source</span> /etc/profile<br></code></pre></td></tr></table></figure><p>更改root密码</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#进入mysql并更改密码</span><br><span class="hljs-built_in">cd</span> /export/soft/mysql-5.7.35/bin<br>./mysql -uroot  -h127.0.0.1  -p<br><span class="hljs-comment"># 登入mysql后修改root密码</span><br>mysql&gt; <span class="hljs-built_in">set</span> password=password(<span class="hljs-string">&#x27;foo@bar&#x27;</span>);<br>mysql&gt; grant all privileges on *.* to root@<span class="hljs-string">&#x27;%&#x27;</span> identified by <span class="hljs-string">&#x27;foo@bar&#x27;</span>;<br>mysql&gt; flush privileges;<br></code></pre></td></tr></table></figure><p>创建普通账号</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs sh">新建mytest账号 远程登录%<br>mysql&gt; use mysql;<br>mysql&gt; CREATE USER <span class="hljs-string">&#x27;mytest&#x27;</span>@<span class="hljs-string">&#x27;%&#x27;</span>  IDENTIFIED BY <span class="hljs-string">&#x27;foo@bar&#x27;</span>; <br><span class="hljs-comment">#修改mysql库的user表，将host项，从localhost改为%。%这里表示的是允许任意host访问，如果只允许某一个ip访问，则可改为相应的ip</span><br>mysql&gt; update user <span class="hljs-built_in">set</span> host=<span class="hljs-string">&#x27;%&#x27;</span> <span class="hljs-built_in">where</span> user = <span class="hljs-string">&#x27;xdkj&#x27;</span>;<br><span class="hljs-comment">#给mytest授予所有权限</span><br>mysql&gt; GRANT ALL ON *.* TO <span class="hljs-string">&#x27;mytest&#x27;</span>@<span class="hljs-string">&#x27;%&#x27;</span>;<br><span class="hljs-comment">#刷新系统权限表</span><br>mysql&gt;flush privileges;<br>mysql&gt;quit;<br><br><span class="hljs-comment">#查看那些用户可远程登录</span><br>mysql&gt; <span class="hljs-keyword">select</span> host ,user from user;<br>+-----------+---------------+<br>| host      | user             |<br>+-----------+---------------+<br>| %         | root             |<br>| %         | mytest             |<br>| localhost | mysql.session     |<br>| localhost | mysql.sys         |<br>| localhost | root              |<br>+-----------+---------------+<br>5 rows <span class="hljs-keyword">in</span> <span class="hljs-built_in">set</span> (0.00 sec)<br><br><span class="hljs-comment">#重启mysql</span><br>service mysql restart 或 sudo /etc/init.d/mysql restart<br></code></pre></td></tr></table></figure><h3 id="验证-3"><a href="#验证-3" class="headerlink" title="验证"></a>验证</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 普通账号登入</span><br>./bin/mysql -umytest -p<br>foo@bar<br></code></pre></td></tr></table></figure><p>新建test数据库</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sh">mysql&gt; CREATE DATABASE IF NOT EXISTS <span class="hljs-built_in">test</span> default charset utf8 COLLATE utf8_general_ci;<br>mysql&gt; SHOW DATABASES;<br><br>mysql&gt; use <span class="hljs-built_in">test</span>;<br>Database changed<br>mysql&gt; show tables;<br>Empty <span class="hljs-built_in">set</span> (0.00 sec)<br></code></pre></td></tr></table></figure><h2 id="Redis4-0-11安装"><a href="#Redis4-0-11安装" class="headerlink" title="Redis4.0.11安装"></a>Redis4.0.11安装</h2><h3 id="安装-4"><a href="#安装-4" class="headerlink" title="安装"></a>安装</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#上传解压</span><br>tar -xzvf redis-4.0.11.tar.gz<br><span class="hljs-built_in">cd</span> redis-4.0.11<br><span class="hljs-comment">#编译</span><br>make    或者 make MALLOC=libc<br><span class="hljs-comment"># 编译成功后进入redis-4.0.11/src 目录 可以看到redis-cli redis-server 等执行文件</span><br><span class="hljs-built_in">cd</span> src<br><span class="hljs-comment"># 这里我们只需要用到两个文件就可以了：redis-server和redis-cli 创建一个工作目录，然后将下述的文件copy到工作目录下</span><br><span class="hljs-built_in">cd</span> ../..<br><span class="hljs-built_in">mkdir</span> /expoer/soft/redis-4.0<br><span class="hljs-built_in">cp</span> /expoer/soft/redis-4.0.11/src/redis-cli /expoer/soft/redis-4.0<br><span class="hljs-built_in">cp</span> /expoer/soft/redis-4.0.11/src/redis-server /expoer/soft/redis-4.0<br><span class="hljs-built_in">cp</span> /expoer/soft/redis-4.0.11/redis.conf /expoer/soft/redis-4.0<br></code></pre></td></tr></table></figure><h3 id="配置-4"><a href="#配置-4" class="headerlink" title="配置"></a>配置</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">cd</span> /expoer/soft/redis-4.0<br></code></pre></td></tr></table></figure><p>编辑<code>redis.conf</code>文件，添加和修改以下内容：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><code class="hljs conf">bind 0.0.0.0<br>protected-mode yes<br>port 6379<br>tcp-backlog 511<br>#客户端超时时间<br>timeout 300<br>tcp-keepalive 300<br>#守护模式 后台运行<br>daemonize yes<br>supervised no<br>#密码<br>requirepass foo@bar<br>masterauth  foo@bar<br>pidfile /var/run/redis_6379.pid<br>loglevel notice<br>logfile &quot;&quot;<br>databases 16<br>always-show-logo yes<br><br>save 900 1<br>save 300 10<br>save 60 10000<br><br>stop-writes-on-bgsave-error yes<br>rdbcompression yes<br>rdbchecksum yes<br>dbfilename dump.rdb<br>dir ./<br><br>slave-serve-stale-data yes<br>slave-read-only yes<br>repl-diskless-sync no<br>repl-diskless-sync-delay 5<br>repl-disable-tcp-nodelay no<br>slave-priority 100<br><br>lazyfree-lazy-eviction no<br>lazyfree-lazy-expire no<br>lazyfree-lazy-server-del no<br>slave-lazy-flush no<br>#<br>appendonly no<br>appendfilename &quot;appendonly.aof&quot;<br>appendfsync everysec<br>no-appendfsync-on-rewrite no<br>auto-aof-rewrite-percentage 100<br>auto-aof-rewrite-min-size 64mb<br><br>aof-load-truncated yes<br>aof-use-rdb-preamble no<br>lua-time-limit 5000<br>slowlog-log-slower-than 10000<br>slowlog-max-len 128<br>latency-monitor-threshold 0<br><br>notify-keyspace-events &quot;&quot;<br>hash-max-ziplist-entries 512<br>hash-max-ziplist-value 64<br><br>list-max-ziplist-size -2<br><br>list-compress-depth 0<br>set-max-intset-entries 512<br>zset-max-ziplist-entries 128<br>zset-max-ziplist-value 64<br>hll-sparse-max-bytes 3000<br>activerehashing yes<br>client-output-buffer-limit normal 0 0 0<br>client-output-buffer-limit slave 256mb 64mb 60<br>client-output-buffer-limit pubsub 32mb 8mb 60<br>hz 10<br>aof-rewrite-incremental-fsync yes<br></code></pre></td></tr></table></figure><p>启动</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">./redis-server redis.conf<br><span class="hljs-comment"># 查看进程</span><br>ps –ef|grep redis<br></code></pre></td></tr></table></figure><h3 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh">./redis-cli -a foo@bar<br>127.0.0.1:6379&gt; <span class="hljs-built_in">set</span> name hello<br>OK<br>127.0.0.1:6379&gt; get name<br><span class="hljs-string">&quot;hello&quot;</span><br></code></pre></td></tr></table></figure><h2 id="Rocketmq4-7-1-安装"><a href="#Rocketmq4-7-1-安装" class="headerlink" title="Rocketmq4.7.1-安装"></a>Rocketmq4.7.1-安装</h2><h3 id="安装-5"><a href="#安装-5" class="headerlink" title="安装"></a>安装</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 上传</span><br>rz rocketmq-all-4.7.1-bin-release.zip<br>unzip rocketmq-all-4.7.1-bin-release.zip<br><span class="hljs-built_in">mv</span> rocketmq-all-4.7.1-bin-release  rocketmq-4.7.1<br><span class="hljs-built_in">cd</span> rocketmq-4.7.1<br><span class="hljs-built_in">mkdir</span> <span class="hljs-built_in">log</span><br></code></pre></td></tr></table></figure><h3 id="配置-5"><a href="#配置-5" class="headerlink" title="配置"></a>配置</h3><p>启动NameServer 配置自动创建topic</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">shnohup sh bin/mqnamesrv  &gt;&gt; <span class="hljs-built_in">log</span>/mqnamesrv.log 2&gt;&amp;1 &amp;<br></code></pre></td></tr></table></figure><p>启动broker  配置自动创建topic</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">nohup</span> sh bin/mqbroker  -n “10.100.12.157:9876” autoCreateTopicEnable=<span class="hljs-literal">true</span>  &gt;&gt; <span class="hljs-built_in">log</span>/broker.log 2&gt;&amp;1 &amp;<br></code></pre></td></tr></table></figure><p>启动成功后默认端口 9876</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#使用jps命令查看broker</span><br>jps –ml<br></code></pre></td></tr></table></figure><p>broker内存调整</p><p>broker 占用内存过大，如果机器内存不足，可以调整<code>runbroker.sh</code>脚本里的内存。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 默认</span><br><span class="hljs-comment"># JAVA_OPT=&quot;$&#123;JAVA_OPT&#125; -server –Xms8g –Xmx8g –Xmn4g&quot;</span><br><span class="hljs-comment"># 调整为</span><br>JAVA_OPT=<span class="hljs-string">&quot;<span class="hljs-variable">$&#123;JAVA_OPT&#125;</span> -server -Xms4g -Xmx4g -Xmn2g&quot;</span><br></code></pre></td></tr></table></figure><h3 id="验证-4"><a href="#验证-4" class="headerlink" title="验证"></a>验证</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 查看进程</span><br>ps -ef|grep mq<br></code></pre></td></tr></table></figure><h2 id="Rocketmq控制台安装"><a href="#Rocketmq控制台安装" class="headerlink" title="Rocketmq控制台安装"></a>Rocketmq控制台安装</h2><h3 id="安装-6"><a href="#安装-6" class="headerlink" title="安装"></a>安装</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 启动</span><br><span class="hljs-built_in">nohup</span> java -jar rocketmq-console-ng-1.0.1.jar --server.port=9890 --rocketmq.config.namesrvAddr=127.0.0.1:9876 &gt;&gt; console.log 2&gt;&amp;1 &amp;<br></code></pre></td></tr></table></figure><h3 id="验证-5"><a href="#验证-5" class="headerlink" title="验证"></a>验证</h3><p>访问控制台<br><a href="http://127.0.0.1:9890/">http://127.0.0.1:9890/</a></p><h2 id="Minio安装"><a href="#Minio安装" class="headerlink" title="Minio安装"></a>Minio安装</h2><h3 id="安装-7"><a href="#安装-7" class="headerlink" title="安装"></a>安装</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#新建minio目录</span><br><span class="hljs-built_in">mkdir</span> minio<br><span class="hljs-built_in">cd</span> minio<br>rz minio<br></code></pre></td></tr></table></figure><h3 id="配置-6"><a href="#配置-6" class="headerlink" title="配置"></a>配置</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#添加执行权限</span><br><span class="hljs-built_in">chmod</span> +x minio<br><span class="hljs-comment">#新建data子目录</span><br><span class="hljs-built_in">mkdir</span> data<br><br><span class="hljs-comment">#linux 后台指定端口启动</span><br>./minio server  --address 0.0.0.0:9000 /export/soft/minio/data &gt;minilog.log &amp;<br><br><span class="hljs-comment">#查看进程</span><br>ps -ef|grep minio<br><br><span class="hljs-comment">#默认地址账号</span><br>Endpoint:  http:// 10.100.12.157:9000/<br>AccessKey: minioadmin<br>SecretKey: minioadmin<br></code></pre></td></tr></table></figure><h3 id="验证-6"><a href="#验证-6" class="headerlink" title="验证"></a>验证</h3><p>浏览器访问<br><a href="http://127.0.0.1:9000/">http://127.0.0.1:9000/</a></p><h2 id="Elasticsearch安装"><a href="#Elasticsearch安装" class="headerlink" title="Elasticsearch安装"></a>Elasticsearch安装</h2><h3 id="安装-8"><a href="#安装-8" class="headerlink" title="安装"></a>安装</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#解压</span><br>unzip elasticsearch-7.6.0.zip               <br><span class="hljs-built_in">cd</span> elasticsearch-7.6.0                       <br><span class="hljs-built_in">mkdir</span> data<br></code></pre></td></tr></table></figure><h3 id="配置-7"><a href="#配置-7" class="headerlink" title="配置"></a>配置</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">cd</span> config  <br></code></pre></td></tr></table></figure><p>编辑<code>elasticsearch.yml</code>文件,添加或修改下面的内容。</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">cluster.name:</span> <span class="hljs-string">znjc</span><br><span class="hljs-attr">node.name:</span> <span class="hljs-string">node-1</span><br><span class="hljs-attr">path.data:</span> <span class="hljs-string">/export/soft/elasticsearch-7.6.0/data</span><br><span class="hljs-attr">path.logs:</span> <span class="hljs-string">/export/soft/elasticsearch-7.6.0/logs</span><br><span class="hljs-attr">network.host:</span> <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span><br><span class="hljs-attr">http.port:</span> <span class="hljs-number">9200</span><br><span class="hljs-comment">#单节点开启此项</span><br><span class="hljs-attr">discovery.type:</span> <span class="hljs-string">single-node</span><br><span class="hljs-comment"># 增加新的参数，这样head插件可以访问es</span><br><span class="hljs-attr">http.cors.enabled:</span> <span class="hljs-literal">true</span><br><span class="hljs-attr">http.cors.allow-origin:</span> <span class="hljs-string">&quot;*&quot;</span><br><span class="hljs-attr">http.max_initial_line_length:</span> <span class="hljs-string">&quot;64k&quot;</span><br><span class="hljs-attr">http.max_header_size:</span> <span class="hljs-string">&quot;64k&quot;</span><br><span class="hljs-comment">#开启密码认证</span><br><span class="hljs-attr">http.cors.allow-headers:</span> <span class="hljs-string">Authorization</span><br><span class="hljs-attr">xpack.security.enabled:</span> <span class="hljs-literal">true</span><br><span class="hljs-attr">xpack.security.transport.ssl.enabled:</span> <span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><p>启动</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># es不能使用root用户启动</span><br><span class="hljs-built_in">cd</span> elasticsearch-7.6.0/bin<br><span class="hljs-comment">#检查es组和用户是否存在，如果没有则创建</span><br><span class="hljs-built_in">cat</span> /etc/group|grep es<br>groupadd es<br>useradd -r -g es es<br><span class="hljs-built_in">chown</span> -R es elasticsearch-7.6.0<br><span class="hljs-comment"># 切到es用户</span><br>su es<br><span class="hljs-comment"># -d后台启动</span><br>bash-4.2$ ./elasticsearch –d<br><span class="hljs-comment">#初始化密码foo@bar</span><br>./elasticsearch-setup-passwords interactive<br></code></pre></td></tr></table></figure><h3 id="验证-7"><a href="#验证-7" class="headerlink" title="验证"></a>验证</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs sh"> curl --user elastic:foo@bar http://127.0.0.1:9200<br>&#123;<br>  <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;node-1&quot;</span>,<br>  <span class="hljs-string">&quot;cluster_name&quot;</span> : <span class="hljs-string">&quot;znjc&quot;</span>,<br>  <span class="hljs-string">&quot;cluster_uuid&quot;</span> : <span class="hljs-string">&quot;lzB7hS5OTnS00xLbcbcDgQ&quot;</span>,<br>  <span class="hljs-string">&quot;version&quot;</span> : &#123;<br>    <span class="hljs-string">&quot;number&quot;</span> : <span class="hljs-string">&quot;7.6.0&quot;</span>,<br>    <span class="hljs-string">&quot;build_flavor&quot;</span> : <span class="hljs-string">&quot;default&quot;</span>,<br>    <span class="hljs-string">&quot;build_type&quot;</span> : <span class="hljs-string">&quot;tar&quot;</span>,<br>    <span class="hljs-string">&quot;build_hash&quot;</span> : <span class="hljs-string">&quot;7f634e9f44834fbc12724506cc1da681b0c3b1e3&quot;</span>,<br>    <span class="hljs-string">&quot;build_date&quot;</span> : <span class="hljs-string">&quot;2020-02-06T00:09:00.449973Z&quot;</span>,<br>    <span class="hljs-string">&quot;build_snapshot&quot;</span> : <span class="hljs-literal">false</span>,<br>    <span class="hljs-string">&quot;lucene_version&quot;</span> : <span class="hljs-string">&quot;8.4.0&quot;</span>,<br>    <span class="hljs-string">&quot;minimum_wire_compatibility_version&quot;</span> : <span class="hljs-string">&quot;6.8.0&quot;</span>,<br>    <span class="hljs-string">&quot;minimum_index_compatibility_version&quot;</span> : <span class="hljs-string">&quot;6.0.0-beta1&quot;</span><br>  &#125;,<br>  <span class="hljs-string">&quot;tagline&quot;</span> : <span class="hljs-string">&quot;You Know, for Search&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure><h2 id="Nginx安装"><a href="#Nginx安装" class="headerlink" title="Nginx安装"></a>Nginx安装</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 上传</span><br>rz nginx-1.14.2.tar.gz<br>tar zxvf nginx-1.14.2.tar.gz<br><span class="hljs-comment">#安装依赖</span><br>yum install -y gcc gcc-c++ pcre pcre-devel zlib zlib-devel openssl openssl-devel<br><span class="hljs-built_in">cd</span> nginx-1.14.2<br><span class="hljs-comment">#指定安装目录</span><br>./configure --prefix=/export/soft/nginx<br><span class="hljs-comment">#编译安装</span><br>make &amp;&amp; make install <br><span class="hljs-comment"># 进入执行完后出现nginx目录</span><br><span class="hljs-built_in">cd</span> nginx<br><span class="hljs-comment">#检查</span><br>./nginx -t<br></code></pre></td></tr></table></figure><h3 id="配置-8"><a href="#配置-8" class="headerlink" title="配置"></a>配置</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">cd</span> nginx/conf<br></code></pre></td></tr></table></figure><p>编辑<code>nginx.conf</code>文件。</p><p>启动</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 进入执行目录</span><br><span class="hljs-built_in">cd</span> nginx/sbin<br><span class="hljs-comment"># 启动</span><br>./nginx<br><span class="hljs-comment"># 停止</span><br>./nginx -s stop<br><span class="hljs-comment"># 重启</span><br>./nginx -s reload<br></code></pre></td></tr></table></figure><h3 id="验证-8"><a href="#验证-8" class="headerlink" title="验证"></a>验证</h3><p>验证<br><a href="http://127.0.0.1/">http://127.0.0.1:80/</a> </p><p>（完）</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Mysql</tag>
      
      <tag>Dubbo</tag>
      
      <tag>Linux</tag>
      
      <tag>JDK</tag>
      
      <tag>Zookeeper</tag>
      
      <tag>Redis</tag>
      
      <tag>RocketMQ</tag>
      
      <tag>Minio</tag>
      
      <tag>Elasticsearch</tag>
      
      <tag>Nginx</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linux下不解压直接修改压缩包内文件</title>
    <link href="/blog/2020/03/Linux%E4%B8%8B%E4%B8%8D%E8%A7%A3%E5%8E%8B%E7%9B%B4%E6%8E%A5%E4%BF%AE%E6%94%B9%E5%8E%8B%E7%BC%A9%E5%8C%85%E5%86%85%E6%96%87%E4%BB%B6.html"/>
    <url>/blog/2020/03/Linux%E4%B8%8B%E4%B8%8D%E8%A7%A3%E5%8E%8B%E7%9B%B4%E6%8E%A5%E4%BF%AE%E6%94%B9%E5%8E%8B%E7%BC%A9%E5%8C%85%E5%86%85%E6%96%87%E4%BB%B6.html</url>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>从 Windows 转到 Linux 桌面发行版后，就对在终端上完成一些工作产生痴迷。比如修改，复制，移动，删除文件等等。加上 Linux 服务器都不带 GUI 工具，能够直接使用命令行可以提高工作效率。</p><h2 id="修改压缩包文件"><a href="#修改压缩包文件" class="headerlink" title="修改压缩包文件"></a>修改压缩包文件</h2><p>VIM 可以直接打开压缩包，然后对想要的压缩文件进行编辑保存，一切都是vim的命令完成。修改后｀wp&#96;就保存退出了。</p><blockquote><p>注意，viｍ 要依赖zip工具来完成打开压缩包。</p></blockquote><h2 id="添加压缩包文件"><a href="#添加压缩包文件" class="headerlink" title="添加压缩包文件"></a>添加压缩包文件</h2><p>如果用图形工具则直接鼠标双击打开压缩包，把想要添加的内容拖拽到压缩包里即可。</p><p> 但是生产上的服务器没有图形工具，若下载本地再上传服务器会显得非常麻烦。可以针对不同的文件使用不同的命令。</p><ul><li><p>tar类型</p><p>添加新文件到压缩包：</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ tar rvf  /path/to/archive.tar  /path/to/newfile.txt<br></code></pre></td></tr></table></figure><p>​更新文件到压缩包：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ tar uvf /path/to/archive.tar  /path/to/newfile.txt<br></code></pre></td></tr></table></figure><ul><li>zip类型</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ zip -rv zipfile.zip newfile.txt newfile1.txt<br></code></pre></td></tr></table></figure><ul><li>jar类型</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ jar -uvf jarfile.jar newfile.txt<br></code></pre></td></tr></table></figure><h2 id="从压缩包删除文件"><a href="#从压缩包删除文件" class="headerlink" title="从压缩包删除文件"></a>从压缩包删除文件</h2><ul><li>tar类型</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">1$ tar -dvf archive.tar filename.txt<br></code></pre></td></tr></table></figure><ul><li>zip类型</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">1$ zip -d zipfile.zip filename.doc \*.txt<br></code></pre></td></tr></table></figure><ul><li>jar类型</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">1$ zip -d jarfile.jar file1.txt file2.txt<br></code></pre></td></tr></table></figure><p>（本文完）</p><p><strong>参考链接：</strong></p><ul><li><a href="http://www.lostsaloon.com/technology/how-to-add-files-to-archive-file-in-linux-also-delete-files">how to add new files into an archive file (tar, gz, zip) in linux (also delete files)</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>Shell</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>终端下的 Emacs 命令使用</title>
    <link href="/blog/2020/03/%E7%BB%88%E7%AB%AF%E4%B8%8B%E7%9A%84emacs%E5%91%BD%E4%BB%A4%E4%BD%BF%E7%94%A8.html"/>
    <url>/blog/2020/03/%E7%BB%88%E7%AB%AF%E4%B8%8B%E7%9A%84emacs%E5%91%BD%E4%BB%A4%E4%BD%BF%E7%94%A8.html</url>
    
    <content type="html"><![CDATA[<h2 id="默认快捷键"><a href="#默认快捷键" class="headerlink" title="默认快捷键"></a>默认快捷键</h2><p><code>Bash</code> 默认绑定的是 <code>Emacs</code> 的快捷键，可以修改成Vi(<code>set - o vi</code>)的操作方式。 学会使用<code>Bash</code>默认的快捷键来操作命令行可以提高效率。</p><p>更多信息可以查看帮助手册：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">$ man bash<br></code></pre></td></tr></table></figure><h2 id="启动编辑器"><a href="#启动编辑器" class="headerlink" title="启动编辑器"></a>启动编辑器</h2><p><code>Ctrl+x-Ctrl+x</code>打开一个编辑器</p><blockquote><p>根据 $FCEDIT 或 $EDITOR 环境变量打开对应的编辑器,若这两个变量都为空，则运行emacs</p></blockquote><h2 id="控制屏幕"><a href="#控制屏幕" class="headerlink" title="控制屏幕"></a>控制屏幕</h2><ul><li><code>Ctrl+l</code>清屏（同<code>clear</code>命令）</li><li><code>Ctrl+s</code>暂停屏幕输出</li><li><code>Ctrl+q</code>恢复<code>Ctrl+s</code>后的屏幕输出</li></ul><h2 id="控制光标"><a href="#控制光标" class="headerlink" title="控制光标"></a>控制光标</h2><ul><li><p><code>Ctrl+a</code>&#x2F;<code>Home</code>移动光标到行首</p></li><li><p><code>Ctrl+e</code>&#x2F;<code>End</code>移动光标到行尾</p></li><li><p><code>Ctrl+b</code>&#x2F;<code>左箭头&lt;-</code>向左移动一个字符</p></li><li><p><code>Ctrl+f</code>&#x2F;<code>右箭头-&gt;</code>向右移动一个字符</p></li><li><p><code>Ctrl+左箭头&lt;-</code>&#x2F;<code>Alt+b</code>&#x2F;<code>ESC-b</code>向左移动一个单词（以空格分隔)</p></li><li><p><code>Ctrl+右箭头-&gt;</code>&#x2F;<code>Alt+c</code>&#x2F;<code>ESC-f</code>向右移动一个单词（以空格分隔)</p></li></ul><blockquote><p><code>Alt+c</code>向右移动一个单词时会将单词首字母变大写</p></blockquote><h2 id="搜索历史"><a href="#搜索历史" class="headerlink" title="搜索历史"></a>搜索历史</h2><ul><li><code>上箭头</code>&#x2F;<code>下箭头</code>上箭头搜索上一条历史，下箭头相反</li><li><code>Ctrl+p</code>&#x2F;<code>Ctp+n</code>同上下箭头</li><li><code>Ctrl+r</code>搜索匹配的历史关键字</li><li><code>Ctrl+s</code>反向搜索</li><li><code>Ctrl+g</code>取消反向搜索</li></ul><h2 id="删除文本"><a href="#删除文本" class="headerlink" title="删除文本"></a>删除文本</h2><ul><li><code>Ctrl+d</code>&#x2F;<code>Delete</code> 删除光标所在的字符</li><li><code>Ctrl+k</code> 删除光标到行尾的的文本</li><li><code>Ctrl+x-Backspace</code> 删除光标到行首的文本</li></ul><h2 id="修改文本"><a href="#修改文本" class="headerlink" title="修改文本"></a>修改文本</h2><ul><li><code>Ctrl+t</code> 光标处字符和前一个字符交换位置</li><li><code>ESC+t</code>与光标前一各单词交换位置（以空格分隔）</li><li><code>ESC+u</code> 将光标所在处单词字符到词尾转大写</li><li><code>ESC+l</code> 将光标所在单词字符到词尾写</li><li><code>Esc+c</code> 将光标所在单词字符转大写，单词光标后字符到词尾转小写</li></ul><h2 id="控制进程"><a href="#控制进程" class="headerlink" title="控制进程"></a>控制进程</h2><ul><li><code>Ctrl+z</code> 挂起当前进程</li><li><code>Ctrl+c</code> 结束当前进程</li><li><code>Ctrl+d</code> 退出Bash（同<code>exit</code>命令）</li></ul><h2 id="Bang-命令"><a href="#Bang-命令" class="headerlink" title="Bang(!)命令"></a>Bang(!)命令</h2><ul><li><code>!!</code> 执行上一条命令</li><li><code>!top</code> 执行最近以top开头的命令</li><li><code>!top:p</code> 只显示但不执行最近以top开头的命令</li><li><code>!$</code> 将上个命令中最后一个单词作为新命令执行（同<code>Alt+.</code>但要回车执行)</li><li><code>!$:p</code> 显示<code>!$</code>要执行的命令</li><li><code>!*</code> 执行上个命令中首单词除外的命令</li><li><code>!*:p</code> 显示<code>!*</code>要执行的命令</li></ul><p>（本文完）</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>Shell</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>PowerShell入门和使用</title>
    <link href="/blog/2020/03/PowerShell%E5%85%A5%E9%97%A8%E5%92%8C%E4%BD%BF%E7%94%A8.html"/>
    <url>/blog/2020/03/PowerShell%E5%85%A5%E9%97%A8%E5%92%8C%E4%BD%BF%E7%94%A8.html</url>
    
    <content type="html"><![CDATA[<p><img src="/blog/./assets/Powershell_00.png" alt="Powershell_00"></p><p>（完）</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>PowerShell</category>
      
    </categories>
    
    
    <tags>
      
      <tag>PowerShell</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SSHFS 挂载远程服务器目录</title>
    <link href="/blog/2020/03/SSHFS%E6%8C%82%E8%BD%BD%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9B%AE%E5%BD%95.html"/>
    <url>/blog/2020/03/SSHFS%E6%8C%82%E8%BD%BD%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9B%AE%E5%BD%95.html</url>
    
    <content type="html"><![CDATA[<h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p><code>GNU/Linux</code>系统中经常需要用到目录挂载,比如挂载<strong>U盘</strong>,<strong>移动硬盘</strong>等。目录挂载可以使用<code>Linux</code>的<code>mount</code>工具完成。</p><p>有的时候我们希望能将远程服务器上的某个文件夹挂载到本地目录，比如<code>tomcat</code>下的<code>webapps</code>目录，这样不再通过<code>sftp</code>工具拷贝上传了，直接将本地<code>war</code>包拷贝到挂载的<code>webapps</code>目录即可。</p><h2 id="SSHFS"><a href="#SSHFS" class="headerlink" title="SSHFS"></a>SSHFS</h2><p><code>sshfs</code>走的是<code>ssh</code>协议，只需要在本机上安装对应的<code>sshfs</code>客户端即可，通过 <code>sshfs</code> 挂载远程服务器上的目录到本地。常见的<code>sshfs</code>有如下几类：</p><ul><li>Linux平台：<a href="https://web.archive.org/web/20201019221920/https://github.com/libfuse/sshfs">https://github.com/libfuse/sshfs</a></li><li>Mac平台: <a href="https://web.archive.org/web/20201019221920/https://github.com/osxfuse/sshfs">https://github.com/osxfuse/sshfs</a></li><li>Windows平台:<a href="https://web.archive.org/web/20201019221920/https://github.com/feo-cz/win-sshfs">https://github.com/feo-cz/win-sshfs</a></li></ul><p>这里以 <code>pacman</code> 包管理系统为例，<code>pacman</code> 仓库已经提供了 <code>sshfs</code> 的二进制包，所以直接安装即可:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ pacman -S sshfs<br></code></pre></td></tr></table></figure><p>安装后先在本地创建一个挂载点:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 本机创建一个webapps的挂载目录</span><br>$ sudo <span class="hljs-built_in">mkdir</span> /mnt/webapps <br></code></pre></td></tr></table></figure><blockquote><p>挂载目录可以指定任意位置</p></blockquote><p>使用<code>sshfs</code>命令挂载远程目录:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sshfs -o allow_other,transform_symlinks [email protected]:/home/user /etc/letsencrypt<br></code></pre></td></tr></table></figure><blockquote><p>参数说明：<code>allow_other</code>:提供访问权限 ; <code>transform_symlinks</code>:挂载软链接。</p></blockquote><p>可能会出现的错误：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">fusermount3: option allow_other only allowed <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;user_allow_other&#x27;</span> is <span class="hljs-built_in">set</span> <span class="hljs-keyword">in</span> /etc/fuse.conf<br></code></pre></td></tr></table></figure><p>解决方法：在本机的文件<code>/etc/fuse.conf</code>中取消注释下面的内容:</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini">user_allow_other<br></code></pre></td></tr></table></figure><blockquote><p>如果没有则自行添加即可。</p></blockquote><p>如果是使用账号密码登入远程服务器的则进行目录挂载的时候需要输入密码。如果想通过<code>ssh密钥</code>登入，需指定密钥的位置:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sshfs -o allow_other,transform_symlinks -o IdentityFile=~/.ssh/id_rsa [email protected]:/home/user/webapps /mnt/webapps<br></code></pre></td></tr></table></figure><blockquote><p><code>IdentityFile</code>:指定<code>ssh</code>密钥位置</p></blockquote><p>创建远程目录挂载后，就可以像操作本地目录一样操作远程目录上的文件了。对挂载目录中文件的修改将直接同步给远程目录。</p><p>如果有多个目录需要挂载，重复以上挂载步骤即可。需要注意是,这种挂载仅是临时挂载点，如果本地或者远程机器关机或者重启则需要再次挂载生效。</p><p>如果需要设置永久挂载则需要编辑<code>/etc/fstab</code>文件,设置自动挂载文件系统:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo vim /etc/fstab<br></code></pre></td></tr></table></figure><p>添加以下内容:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sshfs<span class="hljs-comment">#[email protected]:/home/user/webapps /mnt/webapps</span><br></code></pre></td></tr></table></figure><blockquote><p>设置完永久挂载点后需要重启生效 最好不要在生产机器上设置永久挂载点，以免本地机器被入侵造成连带损失</p></blockquote><p>设置完远程挂载点后，就可以通过在本地操作挂载目录:除了无法在挂载目录执行程序或使用脚本，其他增删改查操作就可以像本地目录一样操作。</p><p>一个典型用法是，如果您在VPS上托管网站，并且需要定期更改网站。在本地挂载文件系统允许您启动您希望编辑站点的任何代码编辑器，IDE或文本编辑器，您所做的任何更改将在本地计算机上生成后立即反映在虚拟服务器上。</p><p>类似地，在用于编码项目的测试环境在服务器上，它允许非常简易的代码修改，可以立即测试而无需在本地和远程修改代码。</p><p>通过远程目录挂载，我们就可以实现在本地直接通过<code>IDE</code>编辑远程服务器上的文件，实现<strong>本地修改，远程更新</strong>的效果。</p><h2 id="通过跳板机挂载机器"><a href="#通过跳板机挂载机器" class="headerlink" title="通过跳板机挂载机器"></a>通过跳板机挂载机器</h2><p>sshfs 通过跳板机挂载远程服务器,配置配置跳板机和需要跳板机登入的服务器。如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">Host jump<br>    HostName xxx.xxx.xxx.xxx<br>    User xxx<br>    Port 22<br>    IdentityFile ~/.ssh/id_rsa<br><br>Host foo<br>    HostName xxx.xxx.xxx.xxx<br>    Port 22<br>    User xxx<br>    IdentityFile ~/.ssh/id_rsa<br>    ProxyCommand ssh jump -W %h:%p<br></code></pre></td></tr></table></figure><blockquote><p>将上面的<code>xxx</code>替换成实际的服务器<code>IP</code>和用户名。 配置了上面的跳板机，服务器就是可以通过<code>ssh foo</code>连接了，配置中会已经配置使用跳板机的代理。</p></blockquote><p>因为<code>sshfs</code>是基于<code>SSH</code>协议的，也可以通过以下的命令挂载远程的服务器目录:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sshfs foo:/app/test ~/test<br></code></pre></td></tr></table></figure><blockquote><p>将远程服务器中的<code>/app/test</code>目录挂载到本地家目录的<code>test</code>下。</p></blockquote><p>如果需要卸载挂载点，则可以通过以下命令:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo umount /mnt/webapps<br></code></pre></td></tr></table></figure><p>或者下面的命令，两个命令都可以卸载挂载点。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo fusermount -u /mnt/webapps<br></code></pre></td></tr></table></figure><p>(本文完）</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>操作演示</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Windows</tag>
      
      <tag>SSHFS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SSH 使用 lrzsz 进行上传和下载</title>
    <link href="/blog/2020/03/SSH%E4%BD%BF%E7%94%A8lrzsz%E8%BF%9B%E8%A1%8C%E4%B8%8A%E4%BC%A0%E5%92%8C%E4%B8%8B%E8%BD%BD.html"/>
    <url>/blog/2020/03/SSH%E4%BD%BF%E7%94%A8lrzsz%E8%BF%9B%E8%A1%8C%E4%B8%8A%E4%BC%A0%E5%92%8C%E4%B8%8B%E8%BD%BD.html</url>
    
    <content type="html"><![CDATA[<h2 id="SSH上传下载"><a href="#SSH上传下载" class="headerlink" title="SSH上传下载"></a>SSH上传下载</h2><p>通过 <code>SSH</code> 命令连接到服务器，当有上传和下载的需求，通常需要借助其他工具来完成，比如<code>FTP</code>、<code>SFTP</code>工具等。</p><p>这时可以借助 Zmodem 文件传输协议，常见的图形工具<code>Xshell</code>、<code>SecureCRT</code>都是支持<code>Zmodem</code>协议的，但<code>Putty</code>并不支持。</p><p><code>zmodem</code>协议有以下的优点:</p><ol><li>通过<code>rz</code>、<code>sz</code>命令，简化了上传和下载的步骤。</li><li>上传和下载不需要再次输入用户密码.</li></ol><p>为了使用 <code>Zmodem</code> 协议上传和下载文件，首先安装支持该协议的工具。 其中<a href="https://web.archive.org/web/20201024060121/https://wiki.maojun.xyz/#lrzsz">lrzsz</a>就是该协议的实现工具之一。<code>lrzsz</code>这个工具只适合传输小文件，不适合传输大型文件。大文件传输更推荐使用<code>Rsync</code>传输，支持增量差异传输。</p><h2 id="zssh-和-lrzsz"><a href="#zssh-和-lrzsz" class="headerlink" title="zssh 和 lrzsz"></a>zssh 和 lrzsz</h2><p>如果使用<code>GNU/Linux</code>终端则需要安装。这里以的<code>pacman</code>包管理 Linux 操作系统为例，在命令行执行以下命令:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 让ssh支持zmodem协议</span><br>$ sudo pacman -S zssh <br><span class="hljs-comment"># 提供rz,sz命令</span><br>$ sudo pacman -S lrzsz <br></code></pre></td></tr></table></figure><p>lrzsz 常用的两个命令来上传和下载文件：</p><ul><li>rz: 接受文件</li><li>sz: 发送文件</li></ul><blockquote><p>方便记忆可以将<code>r</code>记忆为receive,<code>s</code>记忆为send</p></blockquote><p>在使用上要将 <code>ssh</code> 替换成 <code>zssh</code> 命令，即支持<code>zmodem</code>协议的<code>ssh</code>。 <code>zssh</code>和<code>ssh</code>使用上并无差异，例如原先使用<code>ssh</code>连接服务器的命令如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ssh user@password<br></code></pre></td></tr></table></figure><p>使用<code>zssh</code>命令替换：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">zssh user@password<br></code></pre></td></tr></table></figure><p>本地安装<code>lrzsz</code>后，再去对应的服务器上安装。这里以 <code>yum</code> 包管理为例安装 <code>lrzsz</code> ,输入以下命令进行安装：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo yum -y install lrzsz<br></code></pre></td></tr></table></figure><p>安装后就可以模拟测试文件传输，如果使用命令行终端则使用<code>zssh</code>连接安装了<code>lrzsz</code>的服务器。如果使用<code>Xshell</code>等图形工具正常连接即可。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ zssh user@password<br>Press ^@ (C-Space) to enter file transfer mode, <span class="hljs-keyword">then</span> ? <span class="hljs-keyword">for</span> <span class="hljs-built_in">help</span><br></code></pre></td></tr></table></figure><p>连接成功后可以看到一行命令提示，如果要使用<code>zssh</code>则输入<code>ctrl+2（@）</code>快捷键即可切换。(若不是<code>zssh</code>登入服务器没有该提示)。</p><p>如果需要上传文件到服务器，使用<code>xshell</code>等支持<code>Zmodem</code>协议的图形工具，直接输入命令<code>rz</code>接收文件,<code>xshell</code>会打开一个窗口可以方便的选择文件上传。</p><p>使用终端模拟工具则在当前服务器使用<code>ctrl+2</code>切换到<code>zssh</code>窗口：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 快捷键输入`ctrl+2`切换到`zssh`</span><br><span class="hljs-comment"># 查看一下本地目录</span><br>zssh&gt;<span class="hljs-built_in">pwd</span><br><span class="hljs-comment"># 查看本地文件</span><br>zssh&gt;<span class="hljs-built_in">ls</span><br><span class="hljs-comment"># 上传`foo.txt`文件到服务器</span><br>zssh&gt;sz foo.txt<br></code></pre></td></tr></table></figure><blockquote><p>注意：切换到<code>zssh</code>后可以使用本地机器的终端命令。</p></blockquote><p>如果需要下载服务器的文件到本地，使用<code>xshell</code>等支持<code>Zmodem</code>协议的图形工具则可以输入<code>sz</code>加上发送的文件名，<code>xshell</code>会打开一个窗口可以方便的保存文件位置。</p><p>使用终端模拟工具则先用<code>sz</code>命令发送对应的文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 使用`sz`命令发送`bar.txt`</span><br>sz bar.txt <br><span class="hljs-comment"># `sz`命令后会出现一行乱码，然后快捷键`ctrl+2`切换到`zssh`</span><br><span class="hljs-comment"># 查看本机当前位置</span><br>zssh &gt; <span class="hljs-built_in">pwd</span> <br><span class="hljs-comment"># 接收服务器`sz`发送的文件`bar.txt`</span><br>zssh &gt; rz <br></code></pre></td></tr></table></figure><p>使用<code>lrzsz</code>命令可以帮助我们在不使用<code>sftp</code>的情况下传输文件，并且可以方便快捷的上传和下载文件。</p><p>(本文完）</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>Shell</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>通过跳板机连接 SSH 服务器</title>
    <link href="/blog/2020/03/%E9%80%9A%E8%BF%87%E8%B7%B3%E6%9D%BF%E6%9C%BA%E8%BF%9E%E6%8E%A5SSH%E6%9C%8D%E5%8A%A1%E5%99%A8.html"/>
    <url>/blog/2020/03/%E9%80%9A%E8%BF%87%E8%B7%B3%E6%9D%BF%E6%9C%BA%E8%BF%9E%E6%8E%A5SSH%E6%9C%8D%E5%8A%A1%E5%99%A8.html</url>
    
    <content type="html"><![CDATA[<h2 id="SSH无法直连"><a href="#SSH无法直连" class="headerlink" title="SSH无法直连"></a>SSH无法直连</h2><p>服务器因为安全原因不能直接通过外网访问，要经过中转连接。</p><p>服务器提供了两种方式连接：</p><ol><li>通过堡垒机调用本地 <code>SSH</code> 客户端登入到服务器。</li><li>通过跳板机端口转发访问</li></ol><p>当：</p><ul><li>本机可以访问–&gt;跳板机</li><li>跳板机可以访问–&gt;服务器</li><li>笔记本不能访问—-x服务器</li></ul><p>可以使用跳板机代理访问服务器。</p><h2 id="跳板机"><a href="#跳板机" class="headerlink" title="跳板机"></a>跳板机</h2><p>跳板机正如它的名字一样，可以在本机和服务器之间提供一个跳板。本地主机 A 可以直接访问 B 主机，但是无法访问 C 主机，但 B 主机可以访问 C 主机。可以通过将 B 主机作为主机 A 的跳板机来间接访问 C 主机。</p><p>服务器提供了跳板机的账号和密码，为了避免每次输入账号密码以及提高登入的安全性。配置生成公钥并上传到跳板机后面就无需输入账号密码了。通过<code>ssh-keygen</code>命令直接一路回车生成的两个文件：</p><ul><li>公钥文件 <code>~/.ssh/id_rsa.pub</code></li><li>私钥文件 <code>~/.ssh/id_rsa</code></li></ul><p>生成的公钥通过以下的命令上传到跳板机:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ ssh-copy-id  -i /etc/.ssh/id_rsa user@server<br></code></pre></td></tr></table></figure><blockquote><p>user@server替换为跳板机实际的用户和地址 如果出现<code>bash: sh-copy-id: command not found</code>，则安装<code>openssh-clients</code>解决</p></blockquote><p>上传公钥后，就可以免密登入了:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ ssh user@server<br></code></pre></td></tr></table></figure><p>完成跳板机的配置后，如果现在直接通过跳板机访问远程服务器的话是需要远程服务器的账号密码的。</p><p>由于远程服务器的密码由于安全原因能不能使用了。这里可以采用<code>2</code>种方法将本地的公钥上传到远程的服务器。</p><ol><li>借助页面堡垒机登入到<code>sftp</code>，然后将本地之前生成的公钥追加到远程服务器的<code>~/.ssh/authorized_keys</code>文件中。</li><li>借助跳板机，先将公钥上传到跳板机，再通过跳板机追加到远程服务器的<code>~/.ssh/authorized_keys</code>文件中。</li></ol><p>配置完远程服务器的公钥后，就可以实现本机通过跳板机访问服务器免密登入了:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ ssh -J user@jumpserver user@remoteserver<br></code></pre></td></tr></table></figure><blockquote><p><code>jumpserver</code>为跳板机，<code>remoteserver</code>为远程目的服务器 <code>ssh</code>的<code>-J</code>参数用来指定跳板机，后面空格然后再跟上远程服务器</p></blockquote><p>带端口例子:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ ssh -J user@jumpserver:port user@remoteserver:port<br></code></pre></td></tr></table></figure><p>如果有多层跳板机，同单一跳板机使用<code>-J</code>参数，之间用逗号<code>,</code>分隔跳板机。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">$ ssh -J user@jumpserver1,user@jumpserver2:port user@remoteserver<br></code></pre></td></tr></table></figure><p>通过上面的命令就能通过跳板机访问服务器了。</p><h2 id="配置管理"><a href="#配置管理" class="headerlink" title="配置管理"></a>配置管理</h2><p>可以通过<code>ssh</code>的<code>config</code>文件将以上信息管理起来，编辑<code>~/.ssh/config</code>文件:</p><p>对应的<code>ssh -J user@jumpserver:port  user@remoteserver:port</code>命令的配置如下:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 跳板机</span><br>Host jump<br>    HostName jumpIP<br>    User user<br>    Port 22<br>    IdentityFile ~/.ssh/id_rsa<br><br><span class="hljs-comment"># 远程服务器</span><br>Host remote<br>    HostName remoteIP<br>    Port 22<br>    User user<br>    IdentityFile ~/.ssh/id_rsa<br>    ProxyCommand ssh jump -W %h:%p<br></code></pre></td></tr></table></figure><blockquote><ul><li>Host:定义一个名称</li><li>HostName:定义服务器的地址</li><li>User:定义服务器的用户名</li><li>Port:定义服务器的端口</li><li>IdentityFile:定义公钥位置</li><li>proxyCommand:定义代理命令</li><li><code>W</code>参数:通过<code>jump</code>服务器建立隧道连接</li></ul></blockquote><p>如果服务器需要多层跳板机才能访问，可以通过 <code>ssh</code> 的配置文件 <code>config</code> 中的 <code>ProxyJump</code> 来指定跳板机( <code>openssh&gt;=7.3</code> )。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 跳板机1</span><br>Host jump1<br>    HostName jumpIP1<br>    User user<br>    Port 22<br>    IdentityFile ~/.ssh/id_rsa<br><br><span class="hljs-comment"># 跳板机2</span><br>Host jump2<br>    HostName jumpIP2<br>    User user<br>    Port 22<br>    IdentityFile ~/.ssh/id_rsa<br><br>Host remote<br>  HostName remoteIP<br>  ProxyJump jump1,jump2<br></code></pre></td></tr></table></figure><p>配置完成后就可以通过 <code>ssh remote</code> 进行登入，会先经过跳板机 <code>jump1</code> ，然后经过跳板机 <code>jump2</code> 并登入到 <code>remote</code> 服务器。</p><p>（本文完）</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>Shell</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Typecho 默认主题功能增强</title>
    <link href="/blog/2020/03/Typecho%E9%BB%98%E8%AE%A4%E4%B8%BB%E9%A2%98%E5%8A%9F%E8%83%BD%E5%A2%9E%E5%BC%BA.html"/>
    <url>/blog/2020/03/Typecho%E9%BB%98%E8%AE%A4%E4%B8%BB%E9%A2%98%E5%8A%9F%E8%83%BD%E5%A2%9E%E5%BC%BA.html</url>
    
    <content type="html"><![CDATA[<h2 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h2><p>在Typecho默认主题优化<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Typecho 默认主题优化 ](https://maojun.xyz/blog/2020/02/Typecho默认主题优化.html)">[1]</span></a></sup>中对 <code>Typecho</code> 的主题进行了一些页面显示优化。在此基础上，增加一些配置让 <code>Typecho</code> 更加实用。</p><h2 id="一言"><a href="#一言" class="headerlink" title="一言"></a>一言</h2><p> <code>Typecho</code> 默认主题的右侧搜索框下有空白区，显示有点空白。增加<strong>一言</strong>功能，让页面每次刷新或打开新页面时都可以显示<strong>一言</strong>，增加页面的趣味性。<strong>一言</strong>可以采用网络接口的方式或者读取本地的方式。这里采用本地读取<strong>一言</strong>,方便后期维护。</p><p>在默认的主题下，编辑 <code>function.php</code> 文件，追加以下内容:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">/**</span><br><span class="hljs-comment">*  每日一句</span><br><span class="hljs-comment">*</span><br><span class="hljs-comment">*/</span><br><br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">one_sentence</span>(<span class="hljs-params"></span>)</span>&#123;<br><br><span class="hljs-variable">$filename</span> = <span class="hljs-string">&#x27;data.dat&#x27;</span>;<br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Content-type: text/html; charset=utf-8&#x27;</span>);<br><br><span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">file_exists</span>(<span class="hljs-variable">$filename</span>)) &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-variable">$filename</span> . <span class="hljs-string">&#x27; 数据文件不存在&#x27;</span>);<br>&#125;<br><br><span class="hljs-variable">$data</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$filename</span>);<br><span class="hljs-variable">$data</span> = <span class="hljs-title function_ invoke__">explode</span>(PHP_EOL, <span class="hljs-variable">$data</span>);<br><span class="hljs-variable">$result</span> = <span class="hljs-variable">$data</span>[<span class="hljs-title function_ invoke__">array_rand</span>(<span class="hljs-variable">$data</span>)];<br><span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;\r&quot;</span>,<span class="hljs-string">&quot;\n&quot;</span>,<span class="hljs-string">&quot;\r\n&quot;</span>), <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$result</span>);<br><br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$result</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>编辑 <code>header.php</code> 文件，找到以下内容所在的行：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;nav id=<span class="hljs-string">&quot;nav-menu&quot;</span> <span class="hljs-class"><span class="hljs-keyword">class</span>=&quot;<span class="hljs-title">clearfix</span>&quot; <span class="hljs-title">role</span>=&quot;<span class="hljs-title">navigation</span>&quot;&gt;</span><br><span class="hljs-class">&lt;/<span class="hljs-title">nav</span>&gt;</span><br></code></pre></td></tr></table></figure><p>在 <code>&lt;/nav&gt;</code> 之前增加函数调用语句：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;span <span class="hljs-class"><span class="hljs-keyword">class</span>=&quot;<span class="hljs-title">kit</span>-<span class="hljs-title">hidden</span>-<span class="hljs-title">tb</span>&quot; <span class="hljs-title">style</span>=&quot;<span class="hljs-title">float</span>:<span class="hljs-title">right</span>&quot;&gt; &lt;?<span class="hljs-title">php</span> <span class="hljs-title">echo</span> <span class="hljs-title">one_sentence</span>();?&gt; &lt;/<span class="hljs-title">span</span>&gt;</span><br></code></pre></td></tr></table></figure><blockquote><p><code>class</code>的样式是让<strong>一言</strong>在小屏幕不显示，宽屏时右对齐。</p></blockquote><p>在<strong>根目录</strong>添加 <code>data.dat</code> 文件,添加需要显示的<strong>一言</strong>内容:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs dat">往者不可谏，来着犹可追。——《论语·微子》<br>多行不义必自毙。——《左传》<br>敏而好学，不耻下问。——《论语·公冶长》<br>避其锐气，击其惰归。——《孙子兵法·军争》<br>十年树木，百年树人。——《管子·权修》<br>居安思危，思则有备，有备无患。——《左传》<br>天时不如地利，地利不如人和。——《孟子·公孙丑》<br>人谁无过？过而能改，善莫大焉。——《论语》<br>信言不美，美言不信。——老子<br>满招损，谦受益。——《尚书·大禹谟》<br>高岸为谷，深谷为陵。——《诗经·小雅》<br>天作孽，犹可违，自作孽，不可活。——《尚书》<br>言之无文，行而不远。——《左传》<br>三军可夺帅也，匹夫不可夺志也。——《论语·子罕》<br>天行健，君子以自强不息。——《周易·乾·象》<br>皮之不存，毛将焉附。——《左传》<br>路漫漫其修远兮，吾将上下而求索。——屈原《离骚》<br>长太息以掩涕兮，哀民生之多艰。——屈原《离骚》<br>人而无仪，不死何为。——《诗经·鄘风》<br>捐躯赴国难，视死忽如归。——曹植《白马篇》<br>天下之事常成于困约，而败于奢靡。——陆游<br>知之者不如好之者，好之者不如乐之者。——《论语·雍也》<br>志当存高远。——诸葛亮《诫外生书》<br>不去庆父，鲁难未已。——《左传》<br>老吾老，以及人之老；幼吾幼，以及人之幼。——《孟子·梁惠王下》<br>博学之，审问之，慎思之，明辨之，笃行之。——《中庸》<br>人非圣贤，孰能无过。——《训俗遗规》<br>亦余心之所善兮，虽九死其犹未悔。——《屈原·离骚》<br>若要功夫深，铁杵磨成针。——曹学《蜀中广记·上川南道彭山县》<br>少壮不努力，老大徒悲伤。——汉乐府古辞《长歌行》<br>穷则独善其身，达则兼济天下。——《孟子·尽心上》<br>仁者见仁，智者见智。——《易经·系辞上》<br>青，取之于蓝而青于蓝；冰，水为之而寒于水。——《荀子·劝学》<br>千羊之皮，不如一狐之腋。——《史记》<br>余将董道而不豫兮，固将重昏而终身。——《屈原·涉江》<br>高山仰止，景行行止。——《诗经·小雅·车辖》<br>锲而舍之，朽木不折；锲而不舍，金石可镂。——《荀子·劝学》<br>不傲才以骄人，不以宠而作威。——诸葛亮<br>尺有所短；寸有所长。物有所不足；智有所不明。——屈原《卜居》<br>言必信，行必果。——《论语·子路》<br>有志者事竟成。——《后汉书·耿列传》<br>其身正，不令而行；其身不正，虽令不从。——论语·子路<br>三人行，必有我师焉：择其善而从之，其不善者而改之。——《论语·述而》<br>非学无以广才，非志无以成学。——《三国·诸葛亮·诫子书》<br>绳锯木断，水滴石穿。——罗大经《鹤林玉露》<br>君子坦荡荡，小人长戚戚。——孔子<br>老当益壮，宁知白首之心；穷且益坚，不坠青云之志。——王勃<br>尺有所短，寸有所长。——《史记》<br>他山之石，可以攻玉。——《诗经·小雅·鹤鸣》<br>苟余心之端直兮，虽僻远其何伤？——《屈原·涉江》<br>人有不为也，而后可以有为。——《孟子·离娄下》<br>路漫漫其修远今，吾将上下而求索。——屈原<br>孔子登东山而小鲁，登泰山而小天下。——《孟子·尽心上》<br>积土而为山，积水而为海。——《荀子·儒效》<br>生于忧患，死于安乐。——《孟子·告子下》<br>知足不辱，知止不殆。——老子<br>桃李不言，下自成蹊。——《史记》<br>傲不可长，欲不可纵，乐不可极，志不可满。——魏徵<br>既来之，则安之。——《论语·季氏》<br>知己知彼，百战不殆。——《孙子兵法·谋攻》<br>真者，精诚之至也，不精不诚，不能动人。——《庄子·渔夫》<br>独学而无友，则孤陋而寡闻。——《礼记·杂记》<br>勿以恶小而为之，勿以善小而不为。惟贤惟德，能服于人。——刘备<br></code></pre></td></tr></table></figure><blockquote><p>注意：一言的内容不要过长，不然页面显示效果不好。</p></blockquote><p>保存后刷新页面即可查看效果。</p><h2 id="博客总访问"><a href="#博客总访问" class="headerlink" title="博客总访问"></a>博客总访问</h2><p>为了统计博客一共被访问了多少次，可以在页面底部增加统计功能。在默认主题目录下编辑 <code>function.php</code> 内容，追加以下内容：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">total_view</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">        </span>&#123;<br>            <span class="hljs-variable">$db</span> = <span class="hljs-title class_">Typecho_Db</span>::<span class="hljs-title function_ invoke__">get</span>();<br>            <span class="hljs-variable">$row</span> = <span class="hljs-variable">$db</span>-&gt;<span class="hljs-title function_ invoke__">fetchAll</span>(<span class="hljs-string">&#x27;SELECT SUM(VIEWS) FROM `typecho_contents`&#x27;</span>);<br>                <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">number_format</span>(<span class="hljs-variable">$row</span>[<span class="hljs-number">0</span>][<span class="hljs-string">&#x27;SUM(VIEWS)&#x27;</span>]);<br>        &#125;<br></code></pre></td></tr></table></figure><p>然后编辑 <code>footer.php</code> 文件，在 <code>&lt;/footer&gt;</code> 标签前添加：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">_e</span>(<span class="hljs-string">&#x27;Total UV): &#x27;</span>); <span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">get_total_view</span>(<span class="hljs-variable">$this</span>); <span class="hljs-meta">?&gt;</span>.<br></code></pre></td></tr></table></figure><p>保存后刷新页面即可查看效果。</p><h2 id="文章更新时间："><a href="#文章更新时间：" class="headerlink" title="文章更新时间："></a>文章更新时间：</h2><p><code>Typecho </code>默认的文章页面只显示创建时间，而没有更新时间。不方便浏览者知晓页面内容是否有更新变化。同样在默认主题的目录下编辑 <code>post.php</code> 文件,在 <code>&lt;ul class=&quot;post-meta&quot;&gt;&lt;/ul&gt;</code> 下找到之前的<strong>时间</strong>文字并将其修改为<strong>发布时间</strong>，然后在下面增加一行代码显示<strong>更新时间</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;li&gt;<span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">_e</span>(<span class="hljs-string">&#x27;更新时间: &#x27;</span>); <span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">date</span>(<span class="hljs-string">&#x27;Y-m-d H:i:s&#x27;</span>, <span class="hljs-variable">$this</span>-&gt;modified);<span class="hljs-meta">?&gt;</span>&lt;/li&gt;<br></code></pre></td></tr></table></figure><p>保存刷新页面查看。</p><h2 id="归档页自定义模板"><a href="#归档页自定义模板" class="headerlink" title="归档页自定义模板"></a>归档页自定义模板</h2><p><code>Typecho </code>默认的归档页面是有主页显示效果类似的。里面包含了文章内容，为了更直接的查看文章归档，可以只保留标题和评论数显示。在默认主题目录下新建 <code>timeline.php</code>（保留原先的 <code>archive.php</code> )文件：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">defined</span>(<span class="hljs-string">&#x27;__TYPECHO_ROOT_DIR__&#x27;</span>)) <span class="hljs-keyword">exit</span>; <span class="hljs-meta">?&gt;</span><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * archive</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@package</span> custom</span><br><span class="hljs-comment"> */</span><br> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">need</span>(<span class="hljs-string">&#x27;header.php&#x27;</span>); <span class="hljs-meta">?&gt;</span><br><br>&lt;div <span class="hljs-class"><span class="hljs-keyword">class</span>=&quot;<span class="hljs-title">col</span>-<span class="hljs-title">mb</span>-12 <span class="hljs-title">col</span>-12&quot; <span class="hljs-title">id</span>=&quot;<span class="hljs-title">main</span>&quot; <span class="hljs-title">role</span>=&quot;<span class="hljs-title">main</span>&quot;&gt;</span><br><span class="hljs-class">    &lt;<span class="hljs-title">article</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">post</span>&quot; <span class="hljs-title">itemscope</span> <span class="hljs-title">itemtype</span>=&quot;<span class="hljs-title">http</span>://<span class="hljs-title">schema</span>.<span class="hljs-title">org</span>/<span class="hljs-title">BlogPosting</span>&quot;&gt;</span><br><span class="hljs-class">        &lt;<span class="hljs-title">h1</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">post</span>-<span class="hljs-title">title</span>&quot; <span class="hljs-title">itemprop</span>=&quot;<span class="hljs-title">name</span> <span class="hljs-title">headline</span>&quot;&gt;&lt;<span class="hljs-title">a</span> <span class="hljs-title">itemprop</span>=&quot;<span class="hljs-title">url</span>&quot; <span class="hljs-title">href</span>=&quot;&lt;?<span class="hljs-title">php</span> $<span class="hljs-title">this</span>-&gt;<span class="hljs-title">permalink</span>() ?</span><br><span class="hljs-class">&gt;&quot;&gt;&lt;?<span class="hljs-title">php</span> $<span class="hljs-title">this</span>-&gt;<span class="hljs-title">title</span>() ?&gt;&lt;/<span class="hljs-title">a</span>&gt;&lt;/<span class="hljs-title">h1</span>&gt;</span><br><span class="hljs-class"></span><br><span class="hljs-class">&lt;?<span class="hljs-title">php</span> <span class="hljs-title">if</span>($<span class="hljs-title">this</span>-&gt;<span class="hljs-title">user</span>-&gt;<span class="hljs-title">hasLogin</span>()):?&gt;</span><br><span class="hljs-class">&lt;<span class="hljs-title">a</span> <span class="hljs-title">href</span>=&quot;&lt;?<span class="hljs-title">php</span> $<span class="hljs-title">this</span>-&gt;<span class="hljs-title">options</span>-&gt;<span class="hljs-title">adminUrl</span>(); ?&gt;<span class="hljs-title">write</span>-<span class="hljs-title">page</span>.<span class="hljs-title">php</span>?<span class="hljs-title">cid</span>=&lt;?<span class="hljs-title">php</span> <span class="hljs-title">echo</span> $<span class="hljs-title">this</span>-&gt;<span class="hljs-title">cid</span>;?&gt;&quot; &gt;编辑&lt;/<span class="hljs-title">a</span>&gt;</span><br><span class="hljs-class">&lt;?<span class="hljs-title">php</span> <span class="hljs-title">endif</span>;?&gt;</span><br><span class="hljs-class"></span><br><span class="hljs-class"></span><br><span class="hljs-class">        &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">post</span>-<span class="hljs-title">content</span>&quot; <span class="hljs-title">itemprop</span>=&quot;<span class="hljs-title">articleBody</span>&quot;&gt;</span><br><span class="hljs-class">&lt;?<span class="hljs-title">php</span> $<span class="hljs-title">this</span>-&gt;<span class="hljs-title">widget</span>(&#x27;<span class="hljs-title">Widget_Contents_Post_Recent</span>&#x27;, &#x27;<span class="hljs-title">pageSize</span>=10000&#x27;)-&gt;<span class="hljs-title">to</span>($<span class="hljs-title">archives</span>);</span><br><span class="hljs-class">    $<span class="hljs-title">year</span>=0; $<span class="hljs-title">mon</span>=0; $<span class="hljs-title">i</span>=0; $<span class="hljs-title">j</span>=0;</span><br><span class="hljs-class">    $<span class="hljs-title">output</span> = &#x27;&lt;<span class="hljs-title">div</span> <span class="hljs-title">id</span>=&quot;<span class="hljs-title">archives</span>&quot;&gt;&#x27;;</span><br><span class="hljs-class">    <span class="hljs-title">while</span>($<span class="hljs-title">archives</span>-&gt;<span class="hljs-title">next</span>()):</span><br><span class="hljs-class">        $<span class="hljs-title">year_tmp</span> = <span class="hljs-title">date</span>(&#x27;<span class="hljs-title">Y</span>&#x27;,$<span class="hljs-title">archives</span>-&gt;<span class="hljs-title">created</span>);</span><br><span class="hljs-class">&lt;?<span class="hljs-title">php</span> $<span class="hljs-title">this</span>-&gt;<span class="hljs-title">widget</span>(&#x27;<span class="hljs-title">Widget_Contents_Post_Recent</span>&#x27;, &#x27;<span class="hljs-title">pageSize</span>=10000&#x27;)-&gt;<span class="hljs-title">to</span>($<span class="hljs-title">archives</span>);</span><br><span class="hljs-class">&lt;?<span class="hljs-title">php</span> <span class="hljs-title">if</span> (!<span class="hljs-title">defined</span>(&#x27;<span class="hljs-title">__TYPECHO_ROOT_DIR__</span>&#x27;)) <span class="hljs-title">exit</span>; ?&gt;</span><br><span class="hljs-class">&lt;?<span class="hljs-title">php</span></span><br><span class="hljs-class">/**</span><br><span class="hljs-class"> * <span class="hljs-title">archive</span></span><br><span class="hljs-class"> *</span><br><span class="hljs-class"> * @<span class="hljs-title">package</span> <span class="hljs-title">custom</span></span><br><span class="hljs-class"> */</span><br><span class="hljs-class"> $<span class="hljs-title">this</span>-&gt;<span class="hljs-title">need</span>(&#x27;<span class="hljs-title">header</span>.<span class="hljs-title">php</span>&#x27;); ?&gt;</span><br><span class="hljs-class"></span><br><span class="hljs-class">&lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">col</span>-<span class="hljs-title">mb</span>-12 <span class="hljs-title">col</span>-12&quot; <span class="hljs-title">id</span>=&quot;<span class="hljs-title">main</span>&quot; <span class="hljs-title">role</span>=&quot;<span class="hljs-title">main</span>&quot;&gt;</span><br><span class="hljs-class">    &lt;<span class="hljs-title">article</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">post</span>&quot; <span class="hljs-title">itemscope</span> <span class="hljs-title">itemtype</span>=&quot;<span class="hljs-title">http</span>://<span class="hljs-title">schema</span>.<span class="hljs-title">org</span>/<span class="hljs-title">BlogPosting</span>&quot;&gt;</span><br><span class="hljs-class">        &lt;<span class="hljs-title">h1</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">post</span>-<span class="hljs-title">title</span>&quot; <span class="hljs-title">itemprop</span>=&quot;<span class="hljs-title">name</span> <span class="hljs-title">headline</span>&quot;&gt;&lt;<span class="hljs-title">a</span> <span class="hljs-title">itemprop</span>=&quot;<span class="hljs-title">url</span>&quot; <span class="hljs-title">href</span>=&quot;&lt;?<span class="hljs-title">php</span> $<span class="hljs-title">this</span>-&gt;<span class="hljs-title">permalink</span>() ?</span><br><span class="hljs-class">&gt;&quot;&gt;&lt;?<span class="hljs-title">php</span> $<span class="hljs-title">this</span>-&gt;<span class="hljs-title">title</span>() ?&gt;&lt;/<span class="hljs-title">a</span>&gt;&lt;/<span class="hljs-title">h1</span>&gt;</span><br><span class="hljs-class"></span><br><span class="hljs-class">&lt;?<span class="hljs-title">php</span> <span class="hljs-title">if</span>($<span class="hljs-title">this</span>-&gt;<span class="hljs-title">user</span>-&gt;<span class="hljs-title">hasLogin</span>()):?&gt;</span><br><span class="hljs-class">&lt;<span class="hljs-title">a</span> <span class="hljs-title">href</span>=&quot;&lt;?<span class="hljs-title">php</span> $<span class="hljs-title">this</span>-&gt;<span class="hljs-title">options</span>-&gt;<span class="hljs-title">adminUrl</span>(); ?&gt;<span class="hljs-title">write</span>-<span class="hljs-title">page</span>.<span class="hljs-title">php</span>?<span class="hljs-title">cid</span>=&lt;?<span class="hljs-title">php</span> <span class="hljs-title">echo</span> $<span class="hljs-title">this</span>-&gt;<span class="hljs-title">cid</span>;?&gt;&quot; &gt;编辑&lt;/<span class="hljs-title">a</span>&gt;</span><br><span class="hljs-class">&lt;?<span class="hljs-title">php</span> <span class="hljs-title">endif</span>;?&gt;</span><br><span class="hljs-class"></span><br><span class="hljs-class"></span><br><span class="hljs-class">        &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">post</span>-<span class="hljs-title">content</span>&quot; <span class="hljs-title">itemprop</span>=&quot;<span class="hljs-title">articleBody</span>&quot;&gt;</span><br><span class="hljs-class">&lt;?<span class="hljs-title">php</span> $<span class="hljs-title">this</span>-&gt;<span class="hljs-title">widget</span>(&#x27;<span class="hljs-title">Widget_Contents_Post_Recent</span>&#x27;, &#x27;<span class="hljs-title">pageSize</span>=10000&#x27;)-&gt;<span class="hljs-title">to</span>($<span class="hljs-title">archives</span>);</span><br><span class="hljs-class">    $<span class="hljs-title">year</span>=0; $<span class="hljs-title">mon</span>=0; $<span class="hljs-title">i</span>=0; $<span class="hljs-title">j</span>=0;</span><br><span class="hljs-class">    $<span class="hljs-title">output</span> = &#x27;&lt;<span class="hljs-title">div</span> <span class="hljs-title">id</span>=&quot;<span class="hljs-title">archives</span>&quot;&gt;&#x27;;</span><br><span class="hljs-class">    <span class="hljs-title">while</span>($<span class="hljs-title">archives</span>-&gt;<span class="hljs-title">next</span>()):</span><br><span class="hljs-class">        $<span class="hljs-title">year_tmp</span> = <span class="hljs-title">date</span>(&#x27;<span class="hljs-title">Y</span>&#x27;,$<span class="hljs-title">archives</span>-&gt;<span class="hljs-title">created</span>);</span><br><span class="hljs-class">        $<span class="hljs-title">mon_tmp</span> = <span class="hljs-title">date</span>(&#x27;<span class="hljs-title">m</span>&#x27;,$<span class="hljs-title">archives</span>-&gt;<span class="hljs-title">created</span>);</span><br><span class="hljs-class">        $<span class="hljs-title">y</span>=$<span class="hljs-title">year</span>; $<span class="hljs-title">m</span>=$<span class="hljs-title">mon</span>;</span><br><span class="hljs-class">        <span class="hljs-title">if</span> ($<span class="hljs-title">mon</span> != $<span class="hljs-title">mon_tmp</span> &amp;&amp; $<span class="hljs-title">mon</span> &gt; 0) $<span class="hljs-title">output</span> .= &#x27;&lt;/<span class="hljs-title">ul</span>&gt;&lt;/<span class="hljs-title">li</span>&gt;&#x27;;</span><br><span class="hljs-class">        <span class="hljs-title">if</span> ($<span class="hljs-title">year</span> != $<span class="hljs-title">year_tmp</span> &amp;&amp; $<span class="hljs-title">year</span> &gt; 0) $<span class="hljs-title">output</span> .= &#x27;&lt;/<span class="hljs-title">ul</span>&gt;&#x27;;</span><br><span class="hljs-class">        <span class="hljs-title">if</span> ($<span class="hljs-title">year</span> != $<span class="hljs-title">year_tmp</span>) </span>&#123;<br>            <span class="hljs-variable">$year</span> = <span class="hljs-variable">$year_tmp</span>;<br>            <span class="hljs-variable">$output</span> .= <span class="hljs-string">&#x27;&lt;h3&gt;&#x27;</span>. <span class="hljs-variable">$year</span> .<span class="hljs-string">&#x27; 年&lt;/h3&gt;&lt;ul&gt;&#x27;</span>;<br>        &#125;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$mon</span> != <span class="hljs-variable">$mon_tmp</span>) &#123;<br>            <span class="hljs-variable">$mon</span> = <span class="hljs-variable">$mon_tmp</span>;<br>            <span class="hljs-variable">$output</span> .= <span class="hljs-string">&#x27;&lt;li&gt;&lt;span&gt;&#x27;</span>. <span class="hljs-variable">$mon</span> .<span class="hljs-string">&#x27; 月&lt;/span&gt;&lt;ul&gt;&#x27;</span>;<br>        &#125;<br>        <span class="hljs-variable">$output</span> .= <span class="hljs-string">&#x27;&lt;li&gt;&#x27;</span>.<span class="hljs-title function_ invoke__">date</span>(<span class="hljs-string">&#x27;d日: &#x27;</span>,<span class="hljs-variable">$archives</span>-&gt;created).<span class="hljs-string">&#x27;&lt;a href=&quot;&#x27;</span>.<span class="hljs-variable">$archives</span>-&gt;permalink .<span class="hljs-string">&#x27;&quot;&gt;&#x27;</span>. <span class="hljs-variable">$archiv</span><br>es-&gt;title .<span class="hljs-string">&#x27;&lt;/a&gt; &lt;em&gt;(&#x27;</span>. <span class="hljs-variable">$archives</span>-&gt;commentsNum.<span class="hljs-string">&#x27;)&lt;/em&gt;&lt;/li&gt;&#x27;</span>;<br>    <span class="hljs-keyword">endwhile</span>;<br>    <span class="hljs-variable">$output</span> .= <span class="hljs-string">&#x27;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&#x27;</span>;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$output</span>;<br><span class="hljs-meta">?&gt;</span><br>        &lt;/div&gt;<br>    &lt;/article&gt;<br>&lt;/div&gt;&lt;!-- end <span class="hljs-comment">#main--&gt;</span><br><br><span class="hljs-meta">&lt;?php</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">need</span>(<span class="hljs-string">&#x27;sidebar.php&#x27;</span>); <span class="hljs-meta">?&gt;</span><br><span class="hljs-meta">&lt;?php</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">need</span>(<span class="hljs-string">&#x27;footer.php&#x27;</span>); <span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>然后登入到 <code>Typecho</code> 的管理后台，新建<strong>独立页面</strong>,然后选择默认为 <strong>timeline</strong> ，保存后点击新建的页面名称查看效果。</p><h2 id="分页标题"><a href="#分页标题" class="headerlink" title="分页标题"></a>分页标题</h2><p><code>Typecho </code>的文章分页标题默认都是一样的，为了更好的区分页面。可以在不同页面中显示不同的页面标题。编辑 <code>header.php</code> 文件，在 &lt;<code>title&gt;&lt;/title&gt;</code> 尾部添加以下内容：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;_currentPage&gt;<span class="hljs-number">1</span>) <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27; _ 第 &#x27;</span>.<span class="hljs-variable">$t</span><br>his-&gt;_currentPage.<span class="hljs-string">&#x27; 页 &#x27;</span>; <span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>保存后刷新页面即可查看到效果。</p><h2 id="浏览器标识"><a href="#浏览器标识" class="headerlink" title="浏览器标识"></a>浏览器标识</h2><p>可以给访问的用户添加浏览器标识，在默认主题目录下编辑 <code>function.php</code> 文件，追加以下内容：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">/** 获取浏览器信息 */</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getBrowser</span>(<span class="hljs-params"><span class="hljs-variable">$agent</span></span>)</span><br><span class="hljs-function"></span>&#123; <span class="hljs-variable">$outputer</span> = <span class="hljs-literal">false</span>;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/MSIE\s([^\s|;]+)/i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br>        <span class="hljs-variable">$outputer</span> = <span class="hljs-string">&#x27;&lt;i&gt;&lt;/i&gt; IE浏览器&#x27;</span>;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/FireFox\/([^\s]+)/i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br>        <span class="hljs-variable">$outputer</span> = <span class="hljs-string">&#x27;&lt;i&gt;&lt;/i&gt; 火狐浏览器&#x27;</span>;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/Maxthon([\d]*)\/([^\s]+)/i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br>        <span class="hljs-variable">$outputer</span> = <span class="hljs-string">&#x27;&lt;i&gt;&lt;/i&gt; 傲游浏览器&#x27;</span>;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;#SE 2([a-zA-Z0-9.]+)#i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br>        <span class="hljs-variable">$outputer</span> = <span class="hljs-string">&#x27;&lt;i&gt;&lt;/i&gt; 搜狗浏览器&#x27;</span>;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;#360([a-zA-Z0-9.]+)#i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br>        <span class="hljs-variable">$outputer</span> = <span class="hljs-string">&#x27;&lt;i&gt;&lt;/i&gt; 360浏览器&#x27;</span>;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/Edge([\d]*)\/([^\s]+)/i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br>        <span class="hljs-variable">$outputer</span> = <span class="hljs-string">&#x27;&lt;i&gt;&lt;/i&gt; Edge&#x27;</span>;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/EdgiOS([\d]*)\/([^\s]+)/i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br>        <span class="hljs-variable">$outputer</span> = <span class="hljs-string">&#x27;&lt;i&gt;&lt;/i&gt; Edge&#x27;</span>;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/UC/i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br>        <span class="hljs-variable">$outputer</span> = <span class="hljs-string">&#x27;&lt;i&gt;&lt;/i&gt; UC浏览器 &#x27;</span>;<br>    &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/OPR/i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br>        <span class="hljs-variable">$outputer</span> = <span class="hljs-string">&#x27;&lt;i&gt;&lt;/i&gt; 欧朋浏览器&#x27;</span>;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/MicroMesseng/i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br>        <span class="hljs-variable">$outputer</span> = <span class="hljs-string">&#x27;&lt;i&gt;&lt;/i&gt; 微信内嵌浏览器&#x27;</span>;<br>    &#125;  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/WeiBo/i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br>        <span class="hljs-variable">$outputer</span> = <span class="hljs-string">&#x27;&lt;i&gt;&lt;/i&gt; 微博内嵌浏览器&#x27;</span>;<br>    &#125;  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/QQ/i&#x27;</span>, <span class="hljs-variable">$agent</span>)||<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/QQBrowser\/([^\s]+)/i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br>        <span class="hljs-variable">$outputer</span> = <span class="hljs-string">&#x27;&lt;i&gt;&lt;/i&gt; QQ浏览器&#x27;</span>;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/MQBHD/i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br>        <span class="hljs-variable">$outputer</span> = <span class="hljs-string">&#x27;&lt;i&gt;&lt;/i&gt; QQ浏览器 &#x27;</span>;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/BIDU/i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br>        <span class="hljs-variable">$outputer</span> = <span class="hljs-string">&#x27;&lt;i&gt;&lt;/i&gt; 百度浏览器&#x27;</span>;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/LBBROWSER/i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br>        <span class="hljs-variable">$outputer</span> = <span class="hljs-string">&#x27;&lt;i&gt;&lt;/i&gt; 猎豹浏览器&#x27;</span>;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/TheWorld/i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br>        <span class="hljs-variable">$outputer</span> = <span class="hljs-string">&#x27;&lt;i&gt;&lt;/i&gt; 世界之窗浏览器&#x27;</span>;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/XiaoMi/i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br>        <span class="hljs-variable">$outputer</span> = <span class="hljs-string">&#x27;&lt;i&gt;&lt;/i&gt; 小米浏览器&#x27;</span>;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/UBrowser/i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br>        <span class="hljs-variable">$outputer</span> = <span class="hljs-string">&#x27;&lt;i&gt;&lt;/i&gt; UC浏览器 &#x27;</span>;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/mailapp/i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br>        <span class="hljs-variable">$outputer</span> = <span class="hljs-string">&#x27;&lt;i&gt;&lt;/i&gt; email内嵌浏览器&#x27;</span>;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/2345Explorer/i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br>        <span class="hljs-variable">$outputer</span> = <span class="hljs-string">&#x27;&lt;i&gt;&lt;/i&gt; 2345浏览器&#x27;</span>;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/Sleipnir/i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br>        <span class="hljs-variable">$outputer</span> = <span class="hljs-string">&#x27;&lt;i&gt;&lt;/i&gt; 神马浏览器&#x27;</span>;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/YaBrowser/i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br>        <span class="hljs-variable">$outputer</span> = <span class="hljs-string">&#x27;&lt;i&gt;&lt;/i&gt; Yandex浏览器&#x27;</span>;<br>    &#125;  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/Opera[\s|\/]([^\s]+)/i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br>        <span class="hljs-variable">$outputer</span> = <span class="hljs-string">&#x27;&lt;i&gt;&lt;/i&gt; Opera浏览器&#x27;</span>;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/MZBrowser/i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br>        <span class="hljs-variable">$outputer</span> = <span class="hljs-string">&#x27;&lt;i&gt;&lt;/i&gt; 魅族浏览器&#x27;</span>;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/VivoBrowser/i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br>        <span class="hljs-variable">$outputer</span> = <span class="hljs-string">&#x27;&lt;i&gt;&lt;/i&gt; vivo浏览器&#x27;</span>;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/Quark/i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br>        <span class="hljs-variable">$outputer</span> = <span class="hljs-string">&#x27;&lt;i&gt;&lt;/i&gt; 夸克浏览器&#x27;</span>;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/mixia/i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br>        <span class="hljs-variable">$outputer</span> = <span class="hljs-string">&#x27;&lt;i&gt;&lt;/i&gt; 米侠浏览器&#x27;</span>;<br>    &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/fusion/i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br>        <span class="hljs-variable">$outputer</span> = <span class="hljs-string">&#x27;&lt;i&gt;&lt;/i&gt; 客户端&#x27;</span>;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/CoolMarket/i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br>        <span class="hljs-variable">$outputer</span> = <span class="hljs-string">&#x27;&lt;i&gt;&lt;/i&gt; 基安内置浏览器&#x27;</span>;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/Thunder/i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br>        <span class="hljs-variable">$outputer</span> = <span class="hljs-string">&#x27;&lt;i&gt;&lt;/i&gt; 迅雷内置浏览器&#x27;</span>;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/Chrome([\d]*)\/([^\s]+)/i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br>        <span class="hljs-variable">$outputer</span> = <span class="hljs-string">&#x27;&lt;i&gt;&lt;/i&gt; Chrome &#x27;</span>;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/safari\/([^\s]+)/i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br>        <span class="hljs-variable">$outputer</span> = <span class="hljs-string">&#x27;&lt;i&gt;&lt;/i&gt; Safari&#x27;</span>;<br>    &#125; <span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>   <span class="hljs-keyword">return</span> <span class="hljs-variable">$outputer</span>;<br>&#125;<br><span class="hljs-comment">/** 获取操作系统信息 */</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getOs</span>(<span class="hljs-params"><span class="hljs-variable">$agent</span></span>)</span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-variable">$os</span> = <span class="hljs-literal">false</span>;<br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/win/i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/nt 6.0/i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br>            <span class="hljs-variable">$os</span> = <span class="hljs-string">&#x27;&lt;i&gt;&lt;/i&gt; Windows Vista&#x27;</span>;<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/nt 6.1/i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br>            <span class="hljs-variable">$os</span> = <span class="hljs-string">&#x27;&lt;i&gt;&lt;/i&gt; Windows 7&#x27;</span>;<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/nt 6.2/i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br>            <span class="hljs-variable">$os</span> = <span class="hljs-string">&#x27;&lt;i&gt;&lt;/i&gt; Windows 8&#x27;</span>;<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/nt 6.3/i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br>            <span class="hljs-variable">$os</span> = <span class="hljs-string">&#x27;&lt;i&gt;&lt;/i&gt; Windows 8.1&#x27;</span>;<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/nt 5.1/i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br>            <span class="hljs-variable">$os</span> = <span class="hljs-string">&#x27;&lt;i&gt;&lt;/i&gt; Windows XP&#x27;</span>;<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/nt 10.0/i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br>            <span class="hljs-variable">$os</span> = <span class="hljs-string">&#x27;&lt;i&gt;&lt;/i&gt; Windows 10&#x27;</span>;<br>        &#125; <span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-variable">$os</span> = <span class="hljs-string">&#x27;&lt;i&gt;&lt;/i&gt; Windows&#x27;</span>;<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/android/i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/android 9/i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br>        <span class="hljs-variable">$os</span> = <span class="hljs-string">&#x27;&lt;i&gt;&lt;/i&gt; Android P&#x27;</span>;<br>    &#125;<br><span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/android 8/i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br>        <span class="hljs-variable">$os</span> = <span class="hljs-string">&#x27;&lt;i&gt;&lt;/i&gt; Android O&#x27;</span>;<br>    &#125;<br><span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/android 7/i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br>        <span class="hljs-variable">$os</span> = <span class="hljs-string">&#x27;&lt;i&gt;&lt;/i&gt; Android N&#x27;</span>;<br>    &#125;<br><span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/android 6/i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br>        <span class="hljs-variable">$os</span> = <span class="hljs-string">&#x27;&lt;i&gt;&lt;/i&gt; Android M&#x27;</span>;<br>    &#125;<br><span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/android 5/i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br>        <span class="hljs-variable">$os</span> = <span class="hljs-string">&#x27;&lt;i&gt;&lt;/i&gt; Android L&#x27;</span>;<br>    &#125;<br><span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-variable">$os</span> = <span class="hljs-string">&#x27;&lt;i&gt;&lt;/i&gt; Android&#x27;</span>;<br>&#125;<br>    &#125;<br> <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/ubuntu/i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br>        <span class="hljs-variable">$os</span> = <span class="hljs-string">&#x27;&lt;i&gt;&lt;/i&gt; Linux&#x27;</span>;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/linux/i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br>        <span class="hljs-variable">$os</span> = <span class="hljs-string">&#x27;&lt;i&gt;&lt;/i&gt; Linux&#x27;</span>;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/iPhone/i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br>        <span class="hljs-variable">$os</span> = <span class="hljs-string">&#x27;&lt;i&gt;&lt;/i&gt; iPhone&#x27;</span>;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/iPad/i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br>        <span class="hljs-variable">$os</span> = <span class="hljs-string">&#x27;&lt;i&gt;&lt;/i&gt; iPad&#x27;</span>;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/mac/i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br>        <span class="hljs-variable">$os</span> = <span class="hljs-string">&#x27;&lt;i&gt;&lt;/i&gt; OSX&#x27;</span>;<br>    &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/cros/i&#x27;</span>, <span class="hljs-variable">$agent</span>)) &#123;<br>        <span class="hljs-variable">$os</span> = <span class="hljs-string">&#x27;chrome os&#x27;</span>;<br>    &#125;<span class="hljs-keyword">else</span> &#123;<br> <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>   <span class="hljs-keyword">return</span> <span class="hljs-variable">$os</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>然后在对应需要显示浏览器标识的地方输出以上函数即可。</p><h2 id="默认后台地址"><a href="#默认后台地址" class="headerlink" title="默认后台地址"></a>默认后台地址</h2><p>默认的后台登入地址是域名后跟<code>/admin</code>，如果熟悉<code>Typecho</code>的用户就有可能尝试登入。为了安全可以将其修改为其他登入地址，进入网站的<strong>根目录</strong>，编辑 <strong>config.inc.php</strong> 文件，找到下面这行，将<code>/admin</code>修改成自己想要的后台登入地址。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">/** 后台路径(相对路径) */</span><br><span class="hljs-title function_ invoke__">define</span>(<span class="hljs-string">&#x27;__TYPECHO_ADMIN_DIR__&#x27;</span>, <span class="hljs-string">&#x27;/admin/&#x27;</span>);<br></code></pre></td></tr></table></figure><p>保存后将<strong>根目录</strong>的 <strong>admin</strong> 文件夹重名名修改的地址。</p><p>保存后刷新页面查看效果。</p><h2 id="分页页数"><a href="#分页页数" class="headerlink" title="分页页数"></a>分页页数</h2><p><code>Typecho </code>的默认分页数量是 <code>5</code>，可以将其增加到 <code>10 </code>提高阅读体验。编辑默认主题目录下的 <code>functioin.php</code> 文件，追加以下内容：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">/**</span><br><span class="hljs-comment">* 自定义分页数量</span><br><span class="hljs-comment">*/</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">themeInit</span>(<span class="hljs-params"><span class="hljs-variable">$archive</span></span>) </span>&#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$archive</span>-&gt;<span class="hljs-title function_ invoke__">is</span>(<span class="hljs-string">&#x27;index&#x27;</span>)) &#123;<br>                <span class="hljs-variable">$archive</span>-&gt;parameter-&gt;pageSize = <span class="hljs-number">10</span>;<br>        &#125;<span class="hljs-keyword">elseif</span>(<span class="hljs-variable">$archive</span>-&gt;<span class="hljs-title function_ invoke__">is</span>(<span class="hljs-string">&#x27;archive&#x27;</span>))&#123;<br>                <span class="hljs-variable">$archive</span>-&gt;parameter-&gt;pageSize = <span class="hljs-number">10</span>;<br>        &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>保存后刷新即可。</p><h2 id="文章自动摘要"><a href="#文章自动摘要" class="headerlink" title="文章自动摘要"></a>文章自动摘要</h2><p><code>Typecho</code> 的文章在主页默认是全文显示了，可以在后台编写文章时通过<strong>摘要分隔线</strong>功能划分显示的摘要部分，每次手动设置容易忘记。为了简单起见，可以在代码中设置自动摘要内容。在默认主题目录下编辑 <code>index.php</code> ，找到以下内容：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">content</span>(<span class="hljs-string">&#x27;阅读剩余部分&#x27;</span>); <span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>将其内容替换为</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">excerpt</span>(<span class="hljs-number">200</span>, <span class="hljs-string">&#x27;...&#x27;</span>); <span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>上面的&#96;200&#96;&#96;数值可以自行修改，表示截取多少个字节作为摘要显示。</p><h2 id="GitHub-star"><a href="#GitHub-star" class="headerlink" title="GitHub star"></a>GitHub star</h2><p>分享 GitHub 仓库时可以让其显示 <code>star</code> 的数量，只需要增加以下代码即可：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">iframe</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;https://ghbtns.com/github-btn.html?user=amplest&amp;repo=molerose-typecho-themes-dev&amp;type=star&amp;count=true&quot;</span> <span class="hljs-attr">frameborder</span>=<span class="hljs-string">&quot;0&quot;</span> <span class="hljs-attr">scrolling</span>=<span class="hljs-string">&quot;0&quot;</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;170px&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;20px&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">iframe</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="文章回复可见"><a href="#文章回复可见" class="headerlink" title="文章回复可见"></a>文章回复可见</h2><p>文章正文设置回复可见。在默认主题目录下编辑 <code>post.php</code> 文件， 找到 <code>&lt;?php $this-&gt;content(&#39;&#39;); ?&gt;</code> ,将其替换为：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$db</span> = <span class="hljs-title class_">Typecho_Db</span>::<span class="hljs-title function_ invoke__">get</span>();<br><span class="hljs-variable">$sql</span> = <span class="hljs-variable">$db</span>-&gt;<span class="hljs-title function_ invoke__">select</span>()-&gt;<span class="hljs-keyword">from</span>(<span class="hljs-string">&#x27;table.comments&#x27;</span>)<br>    -&gt;<span class="hljs-title function_ invoke__">where</span>(<span class="hljs-string">&#x27;cid = ?&#x27;</span>,<span class="hljs-variable">$this</span>-&gt;cid)<br>    -&gt;<span class="hljs-title function_ invoke__">where</span>(<span class="hljs-string">&#x27;mail = ?&#x27;</span>, <span class="hljs-variable">$this</span>-&gt;<span class="hljs-title function_ invoke__">remember</span>(<span class="hljs-string">&#x27;mail&#x27;</span>,<span class="hljs-literal">true</span>))<br>    -&gt;<span class="hljs-title function_ invoke__">limit</span>(<span class="hljs-number">1</span>);<br><span class="hljs-variable">$result</span> = <span class="hljs-variable">$db</span>-&gt;<span class="hljs-title function_ invoke__">fetchAll</span>(<span class="hljs-variable">$sql</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;user-&gt;<span class="hljs-title function_ invoke__">hasLogin</span>() || <span class="hljs-variable">$result</span>) &#123;<br>    <span class="hljs-variable">$content</span> = <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&quot;/\[hide\](.*?)\[\/hide\]/sm&quot;</span>,<span class="hljs-string">&#x27;&lt;div class=&quot;reply2view&quot;&gt;&lt;i class=&quot;icon-lock-open&quot;&gt;&lt;/i&gt;$1&lt;/div&gt;&#x27;</span>,<span class="hljs-variable">$this</span>-&gt;content);<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-variable">$content</span> = <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&quot;/\[hide\](.*?)\[\/hide\]/sm&quot;</span>,<span class="hljs-string">&#x27;&lt;div class=&quot;reply2view&quot;&gt;&lt;i class=&quot;icon-lock&quot;&gt;&lt;/i&gt;此处内容需要评论回复后方可阅读。&lt;/div&gt;&#x27;</span>,<span class="hljs-variable">$this</span>-&gt;content);<br>&#125;<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$content</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>（本文完）</p><p><strong>参考链接：</strong></p><ul><li><a href="https://web.archive.org/web/20201019231412/https://www.lanka.cn/Typecho-1_3284.html#comment-763">Typecho非插件实现内容回复可见功能</a></li></ul><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://maojun.xyz/blog/2020/02/Typecho%E9%BB%98%E8%AE%A4%E4%B8%BB%E9%A2%98%E4%BC%98%E5%8C%96.html">Typecho 默认主题优化 </a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>操作演示</category>
      
    </categories>
    
    
    <tags>
      
      <tag>博客平台</tag>
      
      <tag>Typecho</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Typecho 开启Redis缓存</title>
    <link href="/blog/2020/02/Typecho%E5%BC%80%E5%90%AFRedis%E7%BC%93%E5%AD%98.html"/>
    <url>/blog/2020/02/Typecho%E5%BC%80%E5%90%AFRedis%E7%BC%93%E5%AD%98.html</url>
    
    <content type="html"><![CDATA[<h2 id="延迟问题"><a href="#延迟问题" class="headerlink" title="延迟问题"></a>延迟问题</h2><p> 在访问博客的时候会稍有等待。但是博客内容以文字为主，配图为辅。页面的延迟会给用户带来不好的体验，所以想着加一个缓存提高页面的响应速度。</p><p>为了统计不同地区访问的速度，使用了站长工具的多个地点Ping服务器<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="[多个地点Ping服务器](http://ping.chinaz.com/)">[1]</span></a></sup>来进行统计分析。检测完发现除了海外地区访问速度善可，国内大部分地区访问速度都不理想。</p><h2 id="配置缓存"><a href="#配置缓存" class="headerlink" title="配置缓存"></a>配置缓存</h2><p>个人博客是属于<strong>读多写少</strong>的业务。为了提高服务的响应速度，决定给<code>Typecho</code>增加缓存，选用目前市场上热门的<code>Redis</code>作为缓存。</p><p>  以<code>Centos 7.xx</code>环境为例，首先安装<code>redis</code>服务和<code>php-redis</code>模块服务:</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo yum -y install redis<br>$ sudo yum -y install php-pecl-redis<br></code></pre></td></tr></table></figure><p>  安装完后添加开机自启服务并启动<code>redis</code>:</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo systemctl <span class="hljs-built_in">enable</span> redis<br>$ sudo systemctl start redis<br></code></pre></td></tr></table></figure><p>  检查<code>redis</code>服务是否启动成功：</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ systemctl status redis<br></code></pre></td></tr></table></figure><p>  检查<code>php-redis</code>模块是否安装成功：</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">php -m |grep redis<br></code></pre></td></tr></table></figure><blockquote><p> 有输出内容则说明安装成功。</p></blockquote><p>安装完缓存服务后，需要在<code>Typecho</code>中开启缓存。为了让<code>Typecho</code>可以支持<code>Redis</code>缓存，这里采用安装插件的方式让<code>Typecho</code>集成缓存配置功能。下载TpCache插件<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="[TpCache](https://github.com/phpgao/TpCache)">[2]</span></a></sup>，放入到<code>Typecho</code>的<strong>plugins</strong>目录下。然后去后台点击<strong>插件管理</strong>按钮并启用<strong>TpCache</strong>插件。接着点击<strong>设置</strong>按钮进入缓存配置页面，填写相应的配置信息，点击保存设置。</p><p>配置完缓存后，可以去页面刷新查看效果。</p><p>注意配置是否开启了<strong>对登入用户失效</strong>,如果开启则用隐私窗口或者先退出账号再测试。</p><p>验证<code>Redis</code>的缓存是否在工作，可以进入服务器中输入命令<code>redis-cli</code>登入<code>Redis</code>客户端：</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ redis-cli<br>127.0.0.1:6379&gt; keys *<br>1) <span class="hljs-string">&quot;43efe54439fbb9c6f647120ec9e02821&quot;</span><br>2) <span class="hljs-string">&quot;fcf92f7cb8f50717bba68d1655b4c9a2&quot;</span><br>3) <span class="hljs-string">&quot;a8356448e7efd93fdc4c068d4bcb91fb&quot;</span><br>4) <span class="hljs-string">&quot;c9db569cb388e160e4b86ca1ddff84d7&quot;</span><br>5) <span class="hljs-string">&quot;04ce4f80d6159435fb9b9362fa19442d&quot;</span><br>6) <span class="hljs-string">&quot;30da41efe7963d8e81fc37eaf8b656b1&quot;</span><br>7) <span class="hljs-string">&quot;45e1dc83b4f004caf1b43bbceccad223&quot;</span><br>8) <span class="hljs-string">&quot;271f8547640193f2e8dcaa8bd6cd4be7&quot;</span><br></code></pre></td></tr></table></figure><p>如果输入<code>keys *</code>有输出则说明<code>Redis</code>缓存已经起作用了。或者可以通过<code>redis-cli</code>的<code>info</code>命令查看缓存命中信息：</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ redis-cli<br>127.0.0.1:6379&gt; info<br><span class="hljs-comment"># Stats</span><br>...<br>keyspace_hits:26<br>keyspace_misses:9<br>...<br></code></pre></td></tr></table></figure><blockquote><p>通过**keyspace_hits&#x2F;(keyspace_hits+keyspace_misses)**计算命令率。</p></blockquote><p>(本文完）</p><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="http://ping.chinaz.com/">多个地点Ping服务器</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://github.com/phpgao/TpCache">TpCache</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>操作演示</category>
      
    </categories>
    
    
    <tags>
      
      <tag>博客平台</tag>
      
      <tag>Typecho</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>配置 docker 镜像加速</title>
    <link href="/blog/2020/02/%E9%85%8D%E7%BD%AEdocker%E9%95%9C%E5%83%8F%E5%8A%A0%E9%80%9F.html"/>
    <url>/blog/2020/02/%E9%85%8D%E7%BD%AEdocker%E9%95%9C%E5%83%8F%E5%8A%A0%E9%80%9F.html</url>
    
    <content type="html"><![CDATA[<h2 id="配置镜像加速"><a href="#配置镜像加速" class="headerlink" title="配置镜像加速"></a>配置镜像加速</h2><p>根据官方文档给出的配置步骤进行操作：  </p><p>针对 Docker 客户端版本大于 1.10.0 版本的，通过修改daemon配置文件 <code>/etc/docker/daemon.json</code> 来加速：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sh">sudo <span class="hljs-built_in">mkdir</span> -p /etc/docker<br>sudo <span class="hljs-built_in">tee</span> /etc/docker/daemon.json &lt;&lt;-<span class="hljs-string">&#x27;EOF&#x27;</span><br>&#123;<br>  <span class="hljs-string">&quot;registry-mirrors&quot;</span>: [<span class="hljs-string">&quot;https://8jngaj3j.mirror.aliyuncs.com&quot;</span>]<br>&#125;<br>EOF<br>sudo systemctl daemon-reload<br>sudo systemctl restart docker<br></code></pre></td></tr></table></figure><p>根据以上命令配置并重启 docke r服务后，重新进行镜像拉取。</p><p>（本文完）</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>操作演示</category>
      
    </categories>
    
    
    <tags>
      
      <tag>容器</tag>
      
      <tag>docker</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>使用 docker 搭建 nextcloud 网盘</title>
    <link href="/blog/2020/02/%E4%BD%BF%E7%94%A8docker%E6%90%AD%E5%BB%BAnextcloud%E7%BD%91%E7%9B%98.html"/>
    <url>/blog/2020/02/%E4%BD%BF%E7%94%A8docker%E6%90%AD%E5%BB%BAnextcloud%E7%BD%91%E7%9B%98.html</url>
    
    <content type="html"><![CDATA[<h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>Nextcloud 中文有下一代云盘的意思，在这个私有部署网盘上我们可以做很多事情：资料存储、密码管理、存储、离线下载等。有些功能已经自带集成在 Nextcloud 中了，另一些功能可以通过安装插件实现。</p><p>下面使用 docker-compose 来安装配置 nextcloud 网盘。</p><h2 id="环境依赖"><a href="#环境依赖" class="headerlink" title="环境依赖"></a>环境依赖</h2><ul><li>centos 7.x</li><li>docker</li><li>docker-compose</li></ul><blockquote><p> 使用docker-compose可以快速编排<code>docker</code>服务，让容器管理变得简单。</p></blockquote><p>编写 <code>docker-compose.yaml</code> 文件，内容如下:</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">version:</span> <span class="hljs-string">&#x27;3&#x27;</span><br><span class="hljs-attr">services:</span><br>  <span class="hljs-attr">nextcloud:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">nextcloud:apache</span><br>    <span class="hljs-attr">container_name:</span> <span class="hljs-string">nextcloud_web</span><br>    <span class="hljs-attr">depends_on:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">redis</span><br>    <span class="hljs-attr">environment:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">uid=1000</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">gid=1000</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">upload_max_size=10g</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">apc_shm_size=128m</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">opcache_mem_size=128</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">cron_period=15m</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">tz=aisa/shanghai</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">domain=http://exmaple.com</span><br><br><br>    <span class="hljs-attr">volumes:</span><br>       <span class="hljs-bullet">-</span> <span class="hljs-string">/app/docker/nextcloud:/var/www/html</span><br>    <span class="hljs-attr">expose:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-number">7009</span><br>    <span class="hljs-attr">ports:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-number">7009</span><span class="hljs-string">:80/tcp</span><br>    <span class="hljs-attr">restart:</span> <span class="hljs-string">always</span><br><br>  <span class="hljs-attr">redis:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">redis:alpine</span><br>    <span class="hljs-attr">container_name:</span> <span class="hljs-string">redis</span><br>    <span class="hljs-attr">restart:</span> <span class="hljs-string">always</span><br>    <span class="hljs-attr">expose:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-number">6379</span><br>    <span class="hljs-attr">restart:</span> <span class="hljs-string">always</span><br><br>  <span class="hljs-attr">onlyoffice:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">onlyoffice/documentserver</span><br>    <span class="hljs-attr">container_name:</span> <span class="hljs-string">onlyoffice</span><br>    <span class="hljs-attr">hostname:</span> <span class="hljs-string">onlyoffice</span><br>    <span class="hljs-attr">environment:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">redis_server_host=redis</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">redis_server_port=6379</span><br>    <span class="hljs-attr">volumes:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">/app/docker/onlyoffice/data:/var/www/onlyoffice/data</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">/app/docker/onlyoffice/logs:/var/log/onlyoffice</span><br>    <span class="hljs-attr">restart:</span> <span class="hljs-string">always</span><br>    <span class="hljs-attr">expose:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-number">9000</span><br>    <span class="hljs-attr">ports:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-number">9000</span><span class="hljs-string">:80</span><br></code></pre></td></tr></table></figure><blockquote><p>注意:<code>yaml</code>文件严格区分缩进和空格。</p></blockquote><p><code>docker-compose</code>参数说明:</p><ul><li>image 镜像地址</li><li>container_name 容器名称</li><li>depends_on 依赖服务（关系到启动顺序,先启动依赖）</li><li>enviroment 环境变量参数，对应相应的软件服务</li><li>volumes 将docker里的目录和宿主机目录映射挂载</li><li>expose 需要暴露的端口</li><li>ports 和宿主机端口映射</li><li>restart:always 设置开机自启</li><li>links 设置连接容器（如web服务连接到db)</li></ul><blockquote><p>注意,容器无法保存数据，删除后数据就丢失了，配置volumes有利于数据持久化到硬盘</p></blockquote><p>由于是个人和小团队使用，上述的配置中使用了<code>nextcloud</code>默认的<code>sqlite</code>数据库。如果你的<code>nextcloud</code>需要考虑到一定的并发和一定规模人数使用，建议使用<code>mysql</code>等数据库替换内嵌型数据库。</p><p>配置redis: 上述的配置我们让docker依赖了redis，这个需要配置才能让docker redis缓存生效。编辑配置文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ vim /app/docker/nextcloud/config/config.php<br></code></pre></td></tr></table></figure><blockquote><p>具体路径为<code>docker-compse</code>中volume中映射的宿主机路径</p></blockquote><p>找准位置在【’memcache.local’ &#x3D;&gt; ‘\OC\Memcache\APCu’,】 这行后面</p><p>增加下面的代码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-string">&#x27;memcache.locking&#x27;</span> =&gt; <span class="hljs-string">&#x27;\OC\Memcache\Redis&#x27;</span>,<br><span class="hljs-string">&#x27;redis&#x27;</span> =&gt; <span class="hljs-keyword">array</span>(<br>     <span class="hljs-string">&#x27;host&#x27;</span> =&gt; <span class="hljs-string">&#x27;redis&#x27;</span>,<br>     <span class="hljs-string">&#x27;port&#x27;</span> =&gt; <span class="hljs-number">6379</span>,<br>      ),<br></code></pre></td></tr></table></figure><blockquote><p>注意修改对应的<code>host</code>和<code>port</code>，<code>redis</code>和<code>nextcloud</code>同<code>docekr</code>网络故可以用<code>container name</code>替代。由于修改的是<strong>php</strong>脚本文件，所以保存后无需重启就可生效。</p></blockquote><p>检查redis配置是否生效: 进入<code>redis</code>容器环境</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ docker <span class="hljs-built_in">exec</span> -it redis /bin/sh<br></code></pre></td></tr></table></figure><p>执行redis监控</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">redis-cli monitor<br></code></pre></td></tr></table></figure><p>然后去访问<code>nextcloud</code>页面并进行页面操作。查看<code>redis</code>监控日志，如果有日志输出则说明配置成功。</p><p>启动服务: 在docker-compose.yaml文件目录使用<code>docker-compose up -d</code>即可后台启动服务,启动并设置账号密码登入。</p><p>安装插件： 由于服务是安装在内网上，并且是直接通过ip和端口访问的，所以并没有配置https.部门需要https状态才可以使用，故不在这推荐，下面一些插件都是可以在http状态使用的。插件可以在应用里面找到并开启，但是nextcloud插件市场在国内访问是有问题的，无法显示插件信息及下载插件。</p><p>所以我们可以通过离线安装的方式使用插件： <a href="https://web.archive.org/web/20201019230404/https://apps.nextcloud.com/">all apps - app store - nextcloud</a> 在nextcloud应用市场找到插件包并下载，然后将其上传到nextcloud的apps目录,如果是linux系统可以直接借助scp或rsync上传.以scp上传onlyoffice插件为例：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">$ scp onlyoffice.tar.gz [email protected]:/app/docker/nextloud/apps<br></code></pre></td></tr></table></figure><p>进入apps目录解压并删除压缩包：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">$  tar -zxf onlyoffice.tar.gz &amp;&amp; <span class="hljs-built_in">rm</span> -rf onlyoffice.tar.gz<br></code></pre></td></tr></table></figure><blockquote><p>注意：如果不是root账号，可以会上传失败。(docker目录是root用户组)</p></blockquote><p>以下插件安装步骤同上：</p><ul><li><p>onlyoffice office 文档在线编辑，支持团队协作。这个插件需要配置本地服务使用（即docker-compose.yaml中的onlyoffice),然后在设置中配置对应的onlyoffice 服务地址和开启对应的在线预览office格式。</p></li><li><p>drawio 在线画流程图，uml工具。官方可以通过draw.io直接使用，不过要同步数据的话要登入goole或github等，国内用这些服务容易受限于网络环境。用nextcloud 插件可以让数据保存在网盘上。在设置，其他设置下服务地址，主题和默认语言设置等。</p></li></ul><p>新建drawio文件,选择+创建diagam文件会创建一个xml格式的文件并进入drawio工作空间。 选择导入draw.io创建保存的本地文件</p><blockquote><p>注意，在draw.io保存的格式是<code>.drawio</code>格式,不能直接用nextcloud点击打开</p></blockquote><ul><li>javascript xmpp chat 在线即时沟通工具。 安装后进入设置,找到javascript xmpp chat设置即可。</li></ul><p>注意，默认消息是不会持久化保存的，如果需要将聊天记录存档，需要通过右侧聊天窗口右下角点击设置</p><p>Nextcloud 具有高度的可定制性，上面只是 Nextcloud 的一小部分功能，更多功能可以参考 Nextcloud 官方文档。</p><p>(本文完）</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>操作演示</category>
      
    </categories>
    
    
    <tags>
      
      <tag>对象存储</tag>
      
      <tag>Nextcloud</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Typecho 默认主题优化</title>
    <link href="/blog/2020/02/Typecho%E9%BB%98%E8%AE%A4%E4%B8%BB%E9%A2%98%E4%BC%98%E5%8C%96.html"/>
    <url>/blog/2020/02/Typecho%E9%BB%98%E8%AE%A4%E4%B8%BB%E9%A2%98%E4%BC%98%E5%8C%96.html</url>
    
    <content type="html"><![CDATA[<h2 id="优化需求"><a href="#优化需求" class="headerlink" title="优化需求"></a>优化需求</h2><p>在博客迁移到Typecho<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="[博客迁移到 Typecho](https://maojun.xyz/blog/2020/02/博客迁移到Typecho.html)">[1]</span></a></sup>文章中，介绍了迁移到<code>Typecho</code>后做的一些配置。为了让默认主题发挥出更好的效果，在原基础上对其进一步优化。主要优化的内容有：</p><ul><li>前置上下篇文章</li><li>文章页编辑功能</li><li>独立页编辑功能</li><li>文章页阅读次数</li><li>文章页加载时间</li></ul><h2 id="前置上下篇文章"><a href="#前置上下篇文章" class="headerlink" title="前置上下篇文章"></a>前置上下篇文章</h2><p><code>Typecho</code>默认主题的上下篇文章是在评论输入框后面的。如果前置上下篇文章会和文章之间的关联性更强，方便用户点击查看。 编辑<code>post.php</code>文件，默认的代码顺序如下：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">need</span>(<span class="hljs-string">&#x27;comments.php&#x27;</span>); <span class="hljs-meta">?&gt;</span><br><br>   &lt;ul <span class="hljs-class"><span class="hljs-keyword">class</span>=&quot;<span class="hljs-title">post</span>-<span class="hljs-title">near</span>&quot;&gt;</span><br><span class="hljs-class">        &lt;<span class="hljs-title">li</span>&gt;上一篇: &lt;?<span class="hljs-title">php</span> $<span class="hljs-title">this</span>-&gt;<span class="hljs-title">thePrev</span>(&#x27;%<span class="hljs-title">s</span>&#x27;,&#x27;没有了&#x27;); ?&gt;&lt;/<span class="hljs-title">li</span>&gt;</span><br><span class="hljs-class">        &lt;<span class="hljs-title">li</span>&gt;下一篇: &lt;?<span class="hljs-title">php</span> $<span class="hljs-title">this</span>-&gt;<span class="hljs-title">theNext</span>(&#x27;%<span class="hljs-title">s</span>&#x27;,&#x27;没有了&#x27;); ?&gt;&lt;/<span class="hljs-title">li</span>&gt;</span><br><span class="hljs-class">    &lt;/<span class="hljs-title">ul</span>&gt;</span><br></code></pre></td></tr></table></figure><p>将行尾部分的上下篇代码前置到评论前：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;ul <span class="hljs-class"><span class="hljs-keyword">class</span>=&quot;<span class="hljs-title">post</span>-<span class="hljs-title">near</span>&quot;&gt;</span><br><span class="hljs-class">        &lt;<span class="hljs-title">li</span>&gt;上一篇: &lt;?<span class="hljs-title">php</span> $<span class="hljs-title">this</span>-&gt;<span class="hljs-title">thePrev</span>(&#x27;%<span class="hljs-title">s</span>&#x27;,&#x27;没有了&#x27;); ?&gt;&lt;/<span class="hljs-title">li</span>&gt;</span><br><span class="hljs-class">        &lt;<span class="hljs-title">li</span>&gt;下一篇: &lt;?<span class="hljs-title">php</span> $<span class="hljs-title">this</span>-&gt;<span class="hljs-title">theNext</span>(&#x27;%<span class="hljs-title">s</span>&#x27;,&#x27;没有了&#x27;); ?&gt;&lt;/<span class="hljs-title">li</span>&gt;</span><br><span class="hljs-class">    &lt;/<span class="hljs-title">ul</span>&gt;</span><br><span class="hljs-class"></span><br><span class="hljs-class">    &lt;?<span class="hljs-title">php</span> $<span class="hljs-title">this</span>-&gt;<span class="hljs-title">need</span>(&#x27;<span class="hljs-title">comments</span>.<span class="hljs-title">php</span>&#x27;); ?&gt;</span><br></code></pre></td></tr></table></figure><p>保存退出刷新页面，即可查看到效果。</p><h2 id="文章页编辑功能"><a href="#文章页编辑功能" class="headerlink" title="文章页编辑功能"></a>文章页编辑功能</h2><p><code>Typecho</code>的文章页面默认没有提供<strong>编辑</strong>的功能，需要登入到后台管理文章时才可以编辑。像 <code>WordPress</code> 之类的博客平台都有提供文章页面<strong>编辑</strong>功能。这个功能可以让有权限的用户快速的编辑文章。 在默认主题文件夹下编辑 <code>post.php</code> 文件，在带 <code>post-meta</code> 属性的 <code>ul</code> 标签下增加以下代码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;user-&gt;<span class="hljs-title function_ invoke__">hasLogin</span>()):<span class="hljs-meta">?&gt;</span><br>&lt;a href=<span class="hljs-string">&quot;&lt;?php <span class="hljs-subst">$this</span>-&gt;options-&gt;adminUrl(); ?&gt;write-post.php?cid=&lt;?php echo <span class="hljs-subst">$this</span>-&gt;cid;?&gt;&quot;</span>&gt;编辑&lt;/a&gt;<br><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">endif</span>;<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h2 id="独立页编辑功能"><a href="#独立页编辑功能" class="headerlink" title="独立页编辑功能"></a>独立页编辑功能</h2><p>同文章页面设置，在默认主题文件夹下编辑 <code>page.php</code> 文件，在带 <code>post-content</code> 属性的 <code>div</code> 标签之前增加以下代码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;user-&gt;<span class="hljs-title function_ invoke__">hasLogin</span>()):<span class="hljs-meta">?&gt;</span><br>&lt;a href=<span class="hljs-string">&quot;&lt;?php <span class="hljs-subst">$this</span>-&gt;options-&gt;adminUrl(); ?&gt;write-page.php?cid=&lt;?php echo <span class="hljs-subst">$this</span>-&gt;cid;?&gt;&quot;</span> &gt;编辑&lt;/a&gt;<br><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">endif</span>;<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h2 id="文章页阅读次数"><a href="#文章页阅读次数" class="headerlink" title="文章页阅读次数"></a>文章页阅读次数</h2><p>在默认主题文件夹下编辑 <code>functions.php</code>，在行尾增加以下代码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">/**</span><br><span class="hljs-comment">* 阅读次数统计</span><br><span class="hljs-comment">*</span><br><span class="hljs-comment">*/</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get_post_view</span>(<span class="hljs-params"><span class="hljs-variable">$archive</span></span>)</span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-variable">$cid</span>    = <span class="hljs-variable">$archive</span>-&gt;cid;<br>    <span class="hljs-variable">$db</span>     = <span class="hljs-title class_">Typecho_Db</span>::<span class="hljs-title function_ invoke__">get</span>();<br>    <span class="hljs-variable">$prefix</span> = <span class="hljs-variable">$db</span>-&gt;<span class="hljs-title function_ invoke__">getPrefix</span>();<br>    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">array_key_exists</span>(<span class="hljs-string">&#x27;views&#x27;</span>, <span class="hljs-variable">$db</span>-&gt;<span class="hljs-title function_ invoke__">fetchRow</span>(<span class="hljs-variable">$db</span>-&gt;<span class="hljs-title function_ invoke__">select</span>()-&gt;<span class="hljs-keyword">from</span>(<span class="hljs-string">&#x27;table.contents&#x27;</span>)))) &#123;<br>        <span class="hljs-variable">$db</span>-&gt;<span class="hljs-title function_ invoke__">query</span>(<span class="hljs-string">&#x27;ALTER TABLE `&#x27;</span> . <span class="hljs-variable">$prefix</span> . <span class="hljs-string">&#x27;contents` ADD `views` INT(10) DEFAULT 0;&#x27;</span>);<br>        <span class="hljs-keyword">echo</span> <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br>    <span class="hljs-variable">$row</span> = <span class="hljs-variable">$db</span>-&gt;<span class="hljs-title function_ invoke__">fetchRow</span>(<span class="hljs-variable">$db</span>-&gt;<span class="hljs-title function_ invoke__">select</span>(<span class="hljs-string">&#x27;views&#x27;</span>)-&gt;<span class="hljs-keyword">from</span>(<span class="hljs-string">&#x27;table.contents&#x27;</span>)-&gt;<span class="hljs-title function_ invoke__">where</span>(<span class="hljs-string">&#x27;cid = ?&#x27;</span>, <span class="hljs-variable">$cid</span>));<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$archive</span>-&gt;<span class="hljs-title function_ invoke__">is</span>(<span class="hljs-string">&#x27;single&#x27;</span>)) &#123;<br> <span class="hljs-variable">$views</span> = <span class="hljs-title class_">Typecho_Cookie</span>::<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-string">&#x27;extend_contents_views&#x27;</span>);<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$views</span>))&#123;<br>            <span class="hljs-variable">$views</span> = <span class="hljs-keyword">array</span>();<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-variable">$views</span> = <span class="hljs-title function_ invoke__">explode</span>(<span class="hljs-string">&#x27;,&#x27;</span>, <span class="hljs-variable">$views</span>);<br>        &#125;<br><span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$cid</span>,<span class="hljs-variable">$views</span>))&#123;<br>       <span class="hljs-variable">$db</span>-&gt;<span class="hljs-title function_ invoke__">query</span>(<span class="hljs-variable">$db</span>-&gt;<span class="hljs-title function_ invoke__">update</span>(<span class="hljs-string">&#x27;table.contents&#x27;</span>)-&gt;<span class="hljs-title function_ invoke__">rows</span>(<span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;views&#x27;</span> =&gt; (<span class="hljs-keyword">int</span>) <span class="hljs-variable">$row</span>[<span class="hljs-string">&#x27;views&#x27;</span>] + <span class="hljs-number">1</span>))-&gt;<span class="hljs-title function_ invoke__">where</span>(<span class="hljs-string">&#x27;cid = ?&#x27;</span>, <span class="hljs-variable">$cid</span>));<br><span class="hljs-title function_ invoke__">array_push</span>(<span class="hljs-variable">$views</span>, <span class="hljs-variable">$cid</span>);<br>            <span class="hljs-variable">$views</span> = <span class="hljs-title function_ invoke__">implode</span>(<span class="hljs-string">&#x27;,&#x27;</span>, <span class="hljs-variable">$views</span>);<br>            <span class="hljs-title class_">Typecho_Cookie</span>::<span class="hljs-title function_ invoke__">set</span>(<span class="hljs-string">&#x27;extend_contents_views&#x27;</span>, <span class="hljs-variable">$views</span>); <span class="hljs-comment">//记录查看cookie</span><br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$row</span>[<span class="hljs-string">&#x27;views&#x27;</span>];<br>&#125;<br></code></pre></td></tr></table></figure><p>在需要统计阅读量的页面，如<strong>文章查看页</strong>增加阅读量。可以在默认主题文件夹下编辑 <code>post.php</code> 文件，在带 <code>post-meta</code> 属性的 <code>ul</code> 标签下增加以下代码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;li&gt;<span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">_e</span>(<span class="hljs-string">&#x27;阅读量: &#x27;</span>); <span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">get_post_view</span>(<span class="hljs-variable">$this</span>); <span class="hljs-meta">?&gt;</span>&lt;/li&gt;<br></code></pre></td></tr></table></figure><h2 id="文章页加载时间"><a href="#文章页加载时间" class="headerlink" title="文章页加载时间"></a>文章页加载时间</h2><p>同阅读次数统计，先在默认主题文件夹下编辑 <code>functions.php</code> ,在行尾添加以下内容：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 加载时间</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> bool</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">timer_start</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">global</span> <span class="hljs-variable">$timestart</span>;<br>        <span class="hljs-variable">$mtime</span>     = <span class="hljs-title function_ invoke__">explode</span>( <span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-title function_ invoke__">microtime</span>() );<br>        <span class="hljs-variable">$timestart</span> = <span class="hljs-variable">$mtime</span>[<span class="hljs-number">1</span>] + <span class="hljs-variable">$mtime</span>[<span class="hljs-number">0</span>];<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br>    <span class="hljs-title function_ invoke__">timer_start</span>();<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">timer_stop</span>(<span class="hljs-params"> <span class="hljs-variable">$display</span> = <span class="hljs-number">0</span>, <span class="hljs-variable">$precision</span> = <span class="hljs-number">3</span> </span>) </span>&#123;<br>        <span class="hljs-keyword">global</span> <span class="hljs-variable">$timestart</span>, <span class="hljs-variable">$timeend</span>;<br>        <span class="hljs-variable">$mtime</span>     = <span class="hljs-title function_ invoke__">explode</span>( <span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-title function_ invoke__">microtime</span>() );<br>        <span class="hljs-variable">$timeend</span>   = <span class="hljs-variable">$mtime</span>[<span class="hljs-number">1</span>] + <span class="hljs-variable">$mtime</span>[<span class="hljs-number">0</span>];<br>        <span class="hljs-variable">$timetotal</span> = <span class="hljs-title function_ invoke__">number_format</span>( <span class="hljs-variable">$timeend</span> - <span class="hljs-variable">$timestart</span>, <span class="hljs-variable">$precision</span> );<br>        <span class="hljs-variable">$r</span>         = <span class="hljs-variable">$timetotal</span> &lt; <span class="hljs-number">1</span> ? <span class="hljs-variable">$timetotal</span> * <span class="hljs-number">1000</span> . <span class="hljs-string">&quot; ms&quot;</span> : <span class="hljs-variable">$timetotal</span> . <span class="hljs-string">&quot; s&quot;</span>;<br>        <span class="hljs-keyword">if</span> ( <span class="hljs-variable">$display</span> ) &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable">$r</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$r</span>;<br>    &#125;<br></code></pre></td></tr></table></figure><p>然后在需要统计阅读次数的页面，比如<strong>文章查看页</strong>增加加载时间统计。可以在默认主题文件夹下编辑 <code>post.php</code> 文件，在带 <code>post-meta</code> 属性的<code>ul</code>标签下增加以下代码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;li&gt;<span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">_e</span>(<span class="hljs-string">&#x27;加载时间: &#x27;</span>); <span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">timer_stop</span>();<span class="hljs-meta">?&gt;</span> &lt;/li&gt;<br></code></pre></td></tr></table></figure><p>在做好以上的配置后，我们就可以刷新页面查看效果了。在配置后备份自己的主题，方便以后重装使用。</p><p>(完）</p><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://maojun.xyz/blog/2020/02/%E5%8D%9A%E5%AE%A2%E8%BF%81%E7%A7%BB%E5%88%B0Typecho.html">博客迁移到 Typecho</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>操作演示</category>
      
    </categories>
    
    
    <tags>
      
      <tag>博客平台</tag>
      
      <tag>Typecho</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>使用 Cloudflare 服务优化图床</title>
    <link href="/blog/2020/02/%E4%BD%BF%E7%94%A8Cloudflare%E6%9C%8D%E5%8A%A1%E4%BC%98%E5%8C%96%E5%9B%BE%E5%BA%8A.html"/>
    <url>/blog/2020/02/%E4%BD%BF%E7%94%A8Cloudflare%E6%9C%8D%E5%8A%A1%E4%BC%98%E5%8C%96%E5%9B%BE%E5%BA%8A.html</url>
    
    <content type="html"><![CDATA[<h2 id="图床优化"><a href="#图床优化" class="headerlink" title="图床优化"></a>图床优化</h2><p>使用backblaze-B2搭建自己的图床<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="[使用 backblaze-B2 搭建自己的图床](https://maojun.xyz/blog/2020/02/21/使用backblaze-B2搭建自己的图床.html)">[1]</span></a></sup>获取图片地址后，发现图片的链接难以记忆，并且不是自己的域名。</p><p>虽然可以通过域名的<code>DNS</code>服务并设置<code>CNAME</code>绑定二级域名到<code>f000.backblazeb2.com</code>,这样就可以通过自定义域名访问图片地址。比如<code>img.maojun.xyz/file/test/bar.png</code>。但是又有一个问题，<code>/file/test</code>这个也是固定的，如果直接显示为<code>img.maojun.xyz/bar.png</code>，这样就显得清爽多了。所以首先对图片的返回地址做下优化，可以将图床地址绑定成自己的域名。比如图片地址器地址是<strong>img.maojunxyz</strong>。 同时将默认图片地址后的路径<code>/file/bucketName/foo.png</code>优化缩短为<code>foo.png</code>，这样和图片前缀地址拼接上就是: <strong>img.maojun.xyz&#x2F;foo.png</strong>。</p><h2 id="自定义图片地址"><a href="#自定义图片地址" class="headerlink" title="自定义图片地址"></a>自定义图片地址</h2><p>这里将使用<code>Cloudflare</code>作为<code>DNS</code>的服务商。因为<code>Cloudflare</code>提供了一系列对站长友好的工具，并且可以免费使用。比如<code>CDN</code>,<code>Worker</code>,网站信息统计等功能。当然这一步不是必须的,你可以维持你的<code>DNS</code>服务提供商,这不会对后续的操作有影响。只需根据下面的步骤作为参考并在<code>DNS</code>服务商处做相应的修改即可。</p><p>下面以<code>Cloudflare</code>做为演示: 如果没有<code>Cloudflare</code>账号先注册并登入，<code>Cloudflare</code>的官网地址是Cloudflare<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Cloudflare - The Web Performance & Security Company | Cloudflare](https://cloudflare.com/)">[2]</span></a></sup>。</p><p>使用<code>Cloudflare</code>的<code>DNS</code>解析服务，首先添加域名，点击按钮<strong>Add a Site</strong>,然后根据提示。将<code>DNS</code>地址修改成<code>Cloudflare</code>提供的地址即可完成绑定解析。</p><p>绑定后然后点击自己的域名进入到控制台,点击菜单图标<strong>DNS</strong>，进入<code>DNS</code>控制面板。</p><p>点击<strong>record</strong>按钮，在输入框中输入并绑定自己的图片域名到<code>b2</code>服务地址。 填写完成后，点击<strong>SAVE</strong>按钮保存设置。</p><p>等待片刻就可以通过自定义图片域名+后缀访问图片地址了。 前后对比：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">https://f000.backblazeb2.com/file/bucketName/foo.png <span class="hljs-comment"># 老的图片链接</span><br>https://img.maojun.xyz/file/bucketName/foo.png <span class="hljs-comment"># 新的图片键接</span><br></code></pre></td></tr></table></figure><h2 id="配置页面规则"><a href="#配置页面规则" class="headerlink" title="配置页面规则"></a>配置页面规则</h2><p>在上面的链接中，访问<code>https://img.maojun.xyz/file/bucketName/foo.png</code>，当<code>bucketName</code>正确匹配我们自己创建的<code>buckets</code>时，可以正常访问到图片链接。 当<code>bucketName</code>是其他名称或者不是我们创建的<code>buckets</code>名称时，我们让其跳转到错误页面。</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">https:<span class="hljs-regexp">//img</span>.maojun.xyz<span class="hljs-regexp">/file/</span>bucketName/foo.png <span class="hljs-comment"># 正确的，提供服务</span><br>https:<span class="hljs-regexp">//img</span>.maojun.xyz<span class="hljs-regexp">/file/</span>aaaaaaaa/foo.png  <span class="hljs-comment"># 不正确的，跳转到404页面</span><br></code></pre></td></tr></table></figure><p>可以通过<code>Cloudflare</code>的<strong>Page ruler</strong>进行配置。点击域名下的控制面板，点击菜单<strong>Page ruler</strong>进入服务。 点击<strong>Create Page Ruler</strong>按钮，配置如下信息：</p><table><thead><tr><th align="left">URL</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left"><a href="https://web.archive.org/web/20201019223844/https://img.maojun.xyz/file/imgxyz/">https://img.maojun.xyz/file/imgxyz/</a>*</td><td align="left">Cache Level: Standard</td></tr><tr><td align="left"><a href="https://web.archive.org/web/20201019223844/https://img.maojun.xyz/file/*/">https://img.maojun.xyz/file/*&#x2F;</a>*</td><td align="left">Forwarding URL (Status Code: 302 - Temporary Redirect, Url: <a href="https://web.archive.org/web/20201019223844/https://maojun.xyz/404notfound">https://maojun.xyz/404notfound</a>)</td></tr></tbody></table><p>上面的配置信息规则为：</p><ul><li>当访问<code>https://img.maojun.xyz/file/imgxyz/*</code>时，使用标准缓存。</li><li>当访问<code>https://img.maojun.xyz/file/*/*</code>(即除了上面的规则外的地址如：<a href="https://img.maojun.xyz/file/abc/">https://img.maojun.xyz/file/abc/</a>*) 就302掉转到指定的404页面。)</li></ul><blockquote><p>注意上面的规则顺序不能错，如果第二条规则在上面则会拦截所有地址包括<code>https://img.maojun.xyz/file/imgxyz/*</code>。</p></blockquote><p>这样当访问的请求不是来自配置的页面放行规则时就会被<code>302</code>跳转到指定的页面。 </p><h2 id="简化图片链接"><a href="#简化图片链接" class="headerlink" title="简化图片链接"></a>简化图片链接</h2><p>通过自定义域名绑定后，链接地址比之前要更加直观。但是后面的长路径依然存在，我们可以想办法把它去除，让最终的链接格式如下：</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">https:</span><span class="hljs-comment">//img.maojun.xyz/foo.png</span><br></code></pre></td></tr></table></figure><p>我们可以使用<code>Cloudflare</code>提供的<code>Workers</code>服务来重写图片的<code>URL</code>地址，让链接地址更加友好和简洁。<code>Workers</code>是一个边缘计算服务，允许你在<code>Cloudflare</code>全球网络中的边界服务器运行<code>JavaScript</code>代码。开发者可以部署<code>serverless</code>(轻服务) 的应用程序。</p><p>免费版：</p><ul><li>每天<strong>10万</strong>次请求</li><li><strong>30</strong>个<code>Workers</code>脚本</li><li>运行在<strong>200</strong>个数据中心</li><li>免费的<strong>workers.dev</strong>二级域名</li><li>每次请求最大占用<code>CPU</code>运行时间为<strong>10ms</strong></li><li>首次请求后最低延迟</li></ul><p>在<code>Cloudflare</code>的主界面，在右侧位置点击进入<strong>Workers</strong>服务。 点击<strong>Craate a Workers</strong>按钮创建一个新的<code>Workers</code>脚本。</p><p>在<strong>Scripe</strong>代码框中清除原先代码并粘贴以下内容：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-meta">&#x27;use strict&#x27;</span>;<br><span class="hljs-keyword">const</span> b2Domain = <span class="hljs-string">&#x27;img.domain.com&#x27;</span>; <span class="hljs-comment">// configure this as per instructions above</span><br><span class="hljs-keyword">const</span> b2Bucket = <span class="hljs-string">&#x27;bucket-name&#x27;</span>; <span class="hljs-comment">// configure this as per instructions above</span><br><span class="hljs-keyword">const</span> b2UrlPath = <span class="hljs-string">`/file/<span class="hljs-subst">$&#123;b2Bucket&#125;</span>/`</span>;<br><span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;fetch&#x27;</span>, <span class="hljs-function"><span class="hljs-params">event</span> =&gt;</span> &#123;<br>    <span class="hljs-keyword">return</span> event.<span class="hljs-title function_">respondWith</span>(<span class="hljs-title function_">fileReq</span>(event));<br>&#125;);<br><br><span class="hljs-comment">// define the file extensions we wish to add basic access control headers to</span><br>0<span class="hljs-keyword">const</span> corsFileTypes = [<span class="hljs-string">&#x27;png&#x27;</span>, <span class="hljs-string">&#x27;jpg&#x27;</span>, <span class="hljs-string">&#x27;gif&#x27;</span>, <span class="hljs-string">&#x27;jpeg&#x27;</span>, <span class="hljs-string">&#x27;webp&#x27;</span>];<br><br><span class="hljs-comment">// backblaze returns some additional headers that are useful for debugging, but unnecessary in production. We can remove these to save some size</span><br><span class="hljs-keyword">const</span> removeHeaders = [<br>    <span class="hljs-string">&#x27;x-bz-content-sha1&#x27;</span>,<br>    <span class="hljs-string">&#x27;x-bz-file-id&#x27;</span>,<br>    <span class="hljs-string">&#x27;x-bz-file-name&#x27;</span>,<br>    <span class="hljs-string">&#x27;x-bz-info-src_last_modified_millis&#x27;</span>,<br>    <span class="hljs-string">&#x27;X-Bz-Upload-Timestamp&#x27;</span>,<br>    <span class="hljs-string">&#x27;Expires&#x27;</span><br>];<br><span class="hljs-keyword">const</span> expiration = <span class="hljs-number">31536000</span>; <span class="hljs-comment">// override browser cache for images - 1 year</span><br><br><span class="hljs-comment">// define a function we can re-use to fix headers</span><br><span class="hljs-keyword">const</span> fixHeaders = <span class="hljs-keyword">function</span>(<span class="hljs-params">url, status, headers</span>)&#123;<br>    <span class="hljs-keyword">let</span> newHdrs = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Headers</span>(headers);<br>    <span class="hljs-comment">// add basic cors headers for images</span><br>    <span class="hljs-keyword">if</span>(corsFileTypes.<span class="hljs-title function_">includes</span>(url.<span class="hljs-property">pathname</span>.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;.&#x27;</span>).<span class="hljs-title function_">pop</span>()))&#123;<br>        newHdrs.<span class="hljs-title function_">set</span>(<span class="hljs-string">&#x27;Access-Control-Allow-Origin&#x27;</span>, <span class="hljs-string">&#x27;*&#x27;</span>);<br>    &#125;<br>    <span class="hljs-comment">// override browser cache for files when 200</span><br>    <span class="hljs-keyword">if</span>(status === <span class="hljs-number">200</span>)&#123;<br>        newHdrs.<span class="hljs-title function_">set</span>(<span class="hljs-string">&#x27;Cache-Control&#x27;</span>, <span class="hljs-string">&quot;public, max-age=&quot;</span> + expiration);<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-comment">// only cache other things for 5 minutes</span><br>        newHdrs.<span class="hljs-title function_">set</span>(<span class="hljs-string">&#x27;Cache-Control&#x27;</span>, <span class="hljs-string">&#x27;public, max-age=300&#x27;</span>);<br>    &#125;<br>    <span class="hljs-comment">// set ETag for efficient caching where possible</span><br>    <span class="hljs-keyword">const</span> <span class="hljs-title class_">ETag</span> = newHdrs.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;x-bz-content-sha1&#x27;</span>) || newHdrs.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;x-bz-info-src_last_modified_millis&#x27;</span>) || newHdrs.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;x-bz-file-id&#x27;</span>);<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title class_">ETag</span>)&#123;<br>        newHdrs.<span class="hljs-title function_">set</span>(<span class="hljs-string">&#x27;ETag&#x27;</span>, <span class="hljs-title class_">ETag</span>);<br>    &#125;<br>    <span class="hljs-comment">// remove unnecessary headers</span><br>    removeHeaders.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">header</span> =&gt;</span> &#123;<br>        newHdrs.<span class="hljs-title function_">delete</span>(header);<br>    &#125;);<br>    <span class="hljs-keyword">return</span> newHdrs;<br>&#125;;<br><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fileReq</span>(<span class="hljs-params">event</span>)&#123;<br>    <span class="hljs-keyword">const</span> cache = caches.<span class="hljs-property">default</span>; <span class="hljs-comment">// Cloudflare edge caching</span><br>    <span class="hljs-keyword">const</span> url = <span class="hljs-keyword">new</span> <span class="hljs-title function_">URL</span>(event.<span class="hljs-property">request</span>.<span class="hljs-property">url</span>);<br>    <span class="hljs-keyword">if</span>(url.<span class="hljs-property">host</span> === b2Domain &amp;&amp; !url.<span class="hljs-property">pathname</span>.<span class="hljs-title function_">startsWith</span>(b2UrlPath))&#123;<br>        url.<span class="hljs-property">pathname</span> = b2UrlPath + url.<span class="hljs-property">pathname</span>;<br>    &#125;<br>    <span class="hljs-keyword">let</span> response = <span class="hljs-keyword">await</span> cache.<span class="hljs-title function_">match</span>(url); <span class="hljs-comment">// try to find match for this request in the edge cache</span><br>    <span class="hljs-keyword">if</span>(response)&#123;<br>        <span class="hljs-comment">// use cache found on Cloudflare edge. Set X-Worker-Cache header for helpful debug</span><br>        <span class="hljs-keyword">let</span> newHdrs = <span class="hljs-title function_">fixHeaders</span>(url, response.<span class="hljs-property">status</span>, response.<span class="hljs-property">headers</span>);<br>        newHdrs.<span class="hljs-title function_">set</span>(<span class="hljs-string">&#x27;X-Worker-Cache&#x27;</span>, <span class="hljs-string">&quot;true&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Response</span>(response.<span class="hljs-property">body</span>, &#123;<br>            <span class="hljs-attr">status</span>: response.<span class="hljs-property">status</span>,<br>            <span class="hljs-attr">statusText</span>: response.<span class="hljs-property">statusText</span>,<br>            <span class="hljs-attr">headers</span>: newHdrs<br>        &#125;);<br>    &#125;<br>    <span class="hljs-comment">// no cache, fetch image, apply Cloudflare lossless compression</span><br>    response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(url, &#123;<span class="hljs-attr">cf</span>: &#123;<span class="hljs-attr">polish</span>: <span class="hljs-string">&quot;lossless&quot;</span>&#125;&#125;);<br>    <span class="hljs-keyword">let</span> newHdrs = <span class="hljs-title function_">fixHeaders</span>(url, response.<span class="hljs-property">status</span>, response.<span class="hljs-property">headers</span>);<br><br>  <span class="hljs-keyword">if</span>(response.<span class="hljs-property">status</span> === <span class="hljs-number">200</span>)&#123;<br><br>    response = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Response</span>(response.<span class="hljs-property">body</span>, &#123;<br>      <span class="hljs-attr">status</span>: response.<span class="hljs-property">status</span>,<br>      <span class="hljs-attr">statusText</span>: response.<span class="hljs-property">statusText</span>,<br>      <span class="hljs-attr">headers</span>: newHdrs<br>    &#125;);<br>  &#125;<span class="hljs-keyword">else</span>&#123;<br>    response = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Response</span>(<span class="hljs-string">&#x27;File not found!&#x27;</span>, &#123; <span class="hljs-attr">status</span>: <span class="hljs-number">404</span> &#125;)<br>  &#125;<br><br>    event.<span class="hljs-title function_">waitUntil</span>(cache.<span class="hljs-title function_">put</span>(url, response.<span class="hljs-title function_">clone</span>()));<br>    <span class="hljs-keyword">return</span> response;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>注意代码的第<code>2-3</code>行:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> b2Domain = <span class="hljs-string">&#x27;img.domain.com&#x27;</span>; <span class="hljs-comment">// configure this as per instructions above</span><br><span class="hljs-keyword">const</span> b2Bucket = <span class="hljs-string">&#x27;bucket-name&#x27;</span>; <span class="hljs-comment">// configure this as per instructions above</span><br></code></pre></td></tr></table></figure><ul><li>b2Domain:修改成自己图床的域名。</li><li>b2Bucket，修改成自己的<code>bucket</code>名字。</li></ul><p>修改后点击按钮<strong>Save and Depoly</strong>保存。</p><p>保存后还不能直接使用，我们需要配置下规则。</p><p>进入域名下的控制面板。点击菜单<strong>Workers</strong>进入面板，然后点击<strong>Add route</strong>按钮。</p><p>添加路由为之前配置的图片服务器地址，后面使用<code>*</code>匹配该域名下的所有所有内容。 并在<em>Worker</em>处选择刚才创建的<em>Workers</em>名称。 </p><p>配置好少，稍等片刻生效。即可以通过最终的图片地址访问了:</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">https:</span><span class="hljs-comment">//img.maojun.xyz/foo.png</span><br></code></pre></td></tr></table></figure><blockquote><p>注意：配置<code>Workers</code>后上面配置的<code>Page ruler</code>规则会失效。配置了<code>Workers</code>规则会先走。</p></blockquote><h2 id="配置防盗链"><a href="#配置防盗链" class="headerlink" title="配置防盗链"></a>配置防盗链</h2><p>可以配置<code>Referer</code>来判断是否是自己的来自自己域名，如果不是则都拦截。 由于<code>Referer</code>是可以修改的，所以这只能简单的进行拦截。</p><p>进入域名下的面板，点击菜单<strong>Firewall</strong>进入服务。点击**+ Create firewall rule**进入防火墙规则服务。 </p><p>填写规则名称和规则匹配条件：</p><table><thead><tr><th align="left">Field</th><th align="left">Operator</th><th align="left">Value</th></tr></thead><tbody><tr><td align="left">Referer</td><td align="left">does not contains</td><td align="left">maojun.xyz</td></tr><tr><td align="left">URI Full</td><td align="left">contains</td><td align="left">img.maojun.xyz</td></tr></tbody></table><blockquote><p>(not http.referer contains “maojun.xyz” and http.request.full_uri contains “img.maojun.xyz”)</p></blockquote><p>上面的规则是： 如果<code>URI</code>全路径中包含了<code>img.maojun.xyz</code>内容，<strong>同时</strong><code>Referer</code>不包含<code>maojun.xyz</code>则拦截。 由于这个图床我暂时只有一个域名即<code>maojun.xyz</code>在用，如果你有多个域名使用同一图床，可以在上面的规则中填加多个域名放行。</p><p>配置完以上后，就可以通过优化后的图片地址<code>https://img.maojun.xyz/test.png</code>访问了。</p><p>(本文完）</p><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://maojun.xyz/blog/2020/02/21/%E4%BD%BF%E7%94%A8backblaze-B2%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E5%9B%BE%E5%BA%8A.html">使用 backblaze-B2 搭建自己的图床</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://cloudflare.com/">Cloudflare - The Web Performance &amp; Security Company | Cloudflare</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>操作演示</category>
      
    </categories>
    
    
    <tags>
      
      <tag>对象存储</tag>
      
      <tag>Cloudflare</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>使用 backblaze-B2 搭建自己的图床</title>
    <link href="/blog/2020/02/%E4%BD%BF%E7%94%A8backblaze-B2%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E5%9B%BE%E5%BA%8A.html"/>
    <url>/blog/2020/02/%E4%BD%BF%E7%94%A8backblaze-B2%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E5%9B%BE%E5%BA%8A.html</url>
    
    <content type="html"><![CDATA[<h2 id="图床需求"><a href="#图床需求" class="headerlink" title="图床需求"></a>图床需求</h2><p>在搭建完<code>Typecho</code> 博客，并给上传的图片添加图片阴影效果后，发现在使用<code>Typecho</code>自身的图片上传功能时，每次截图后不支持直接粘贴。而是需要先将图片保存到本地后，才能上传到服务器。</p><p>这在使用的体验上就不太顺畅，并且上传的图片是不经过任何处理的。每次截图的大小都在<code>50kb</code>上下了，保存的位置也是同博客的目录。长久下来会占用不少的空间，毕竟个人的服务器资源有限。最要紧的还是图片加载问题了，所有请求都是向同一服务器发起请求。页面的响应速度也是会受到一定的影响。</p><p>带着以上的问题，决定将图片迁移到图片服务器。比如**阿里云 OSS **, <strong>Amazon S3</strong> 等，本着全面了解的心情，在了解其他产品同类产品后。发现 <strong>backblaze B2</strong> 提供了免费<code>10G</code>的存储服务，这让我想到了之前的 <strong>七牛云</strong> 也是有<code>10G</code>免费图片托管服务。但是国内的网站备案才能使用让我望而却步，最终决定尝试 <strong>backblaze B2</strong>,同时本着鸡蛋不放在同一个篮子的思想，后续将继续在其他平台开启图片托管服务，实现多机备份。</p><p><strong>Backblaze B2</strong> 提供了<code>10G</code>免费文件存储服务。超出部分将按量付费，但是对与博客平台而言，存图片能把<strong>10G</strong>空间用完还真不容易，以一张图片<code>100K</code>计算，差不多可以存储<code>10w</code>张图片。对于文件我更倾向与上传到网盘后分享，而不是通过文件存储服务器。所以只用来当图床已经足够了。<strong>Backblaze</strong> 官网也对比了其他储存服务的价格，总之是很便宜了。</p><h2 id="使用-B2-服务"><a href="#使用-B2-服务" class="headerlink" title="使用 B2 服务"></a>使用 B2 服务</h2><p>点击进入<a href="https://web.archive.org/web/20201024065121/https://secure.backblaze.com/user_signin.htm">backblaze注册</a>页面，输入邮箱密码后进入填写相关信息进入到控制台界面。 </p><p>点击<strong>Create a Bucket</strong>，输入服务要创建的<code>bucket</code>名称，文件权限选择<strong>public</strong>,然后点击<strong>Create a Bucket</strong>。</p><p>创建完<code>bucket</code>后，就可以通过<code>backblaze</code>提供的网页来上传图片了。在控制台界面点击<strong>Browse Files</strong>,进入我们刚才创建的&#96;bucket*中，点击<strong>upload</strong>按钮就可以拖拽文件或者访问本地图片路径上上传图片到<strong>backblzze b2</strong>了。</p><p>上传文件后，就可以点击文件名称后面的<strong>i</strong>图标按钮查看图片的信息，点击<strong>Friendly URL</strong>链接就可以访问到图片了。如果我们每次都要通过网页上传并且点击图片信息获取链接的就会显得非常的繁琐。<strong>backblaze b2</strong>也提供了客户端工具给我们使用。</p><p>如果需要利用客户端上传，则需要在<code>bucket</code>创建后，在控制台界面点击<strong>App Keys</strong>创建应用密钥，点击<strong>Add a New Application Key</strong>,在弹出的窗口中填写密钥的名称，以及访问<code>bucket</code>的范围，默认是可以访问所有的<code>bucket</code>,权限选择<strong>Read and Write</strong>，允许有<strong>读写</strong>权限。</p><p>保存后会显示三个值的内容。</p><ul><li>keyID</li><li>keyName</li><li>applicationKey</li></ul><blockquote><p>注意保存<strong>applicationKey</strong>的值，<strong>applicationKey</strong>只会显示一遍。如果没保存就需要重复上面的步骤再创建一个，把之前的删除即可。</p></blockquote><p>生成应用密钥的目的是为了让第三方应用可以用上传图片到<code>backblaze</code>的权限。方便我们将截图保存并访问截图链接。由于我使用的是<code>Archlinux</code>系统，目前没有支持<code>backblaze b2</code>的<code>linux</code>平台工具，所以我只能通过官方提供的命令行工具来实现客户端上传。如果你是<code>Windows</code>或者<code>Mac</code>用户则可以在这里查看支持的<a href="https://web.archive.org/web/20201024065121/https://help.backblaze.com/hc/en-us/articles/226688888-How-can-I-upload-files-to-B2-">backblaze客户端</a>。</p><p>这里以<strong>backblaze b2</strong>命令行客户端为例，首先去<code>GitHub</code>下载官方开源的命令行工具:<a href="https://web.archive.org/web/20201024065121/https://github.com/Backblaze/B2_Command_Line_Tool">b2-command</a>。根据官方文档安装工具，安装后使用命令登入<code>backblaze b2</code>,</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">1$ b2 authorize-account<br></code></pre></td></tr></table></figure><p>根据提示输入:</p><ul><li>keyID</li><li>applicationKey</li></ul><blockquote><p>在控制台<strong>App Keys</strong>查看<code>keyID</code>，<code>applicationKey</code>即之前保存的密钥，如果忘记需重新生成创建。</p></blockquote><p>查看<code>buckets</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">1$ b2 list_buckets<br></code></pre></td></tr></table></figure><blockquote><p>注意：如果输出为空则说明没有创建<code>buckets</code></p></blockquote><p>上传图片到<code>bucket</code>:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">1$ b2 upload-file  &lt;bucketName&gt; &lt;localFilePath&gt; &lt;b2FileName&gt;<br></code></pre></td></tr></table></figure><ul><li><strong>bucketName</strong>参数是<code>bucket</code>名称</li><li><strong>localFilePath</strong>参数为本地文件路径</li><li><strong>b2FileName</strong>参数为上传后的文件名称</li></ul><p>例如：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">1$ b2 upload-file  <span class="hljs-built_in">test</span> foo.png bar.png<br></code></pre></td></tr></table></figure><p>上面的格式为上传本地图片<code>foo.png</code>到名为<code>test</code>的<code>bucket</code>并命令为<code>bar.png</code>文件。</p><p>上传成功会在控制台返回以下内容：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">1foo.png: 100%|███████████████████████████████████████████████████████████████████| 73.2k/73.2k [00:30&lt;00:00, 2.39kB/s]<br>2URL by file name: https://f000.backblazeb2.com/file/bucketName/foo.png<br>3URL by fileId: https://f000.backblazeb2.com/b2api/v2/b2_download_file_by_id?fileId=4_zb21c374aec406a66740d0716_f109b36d0492bfbf2_d20200222_m133812_c000_v0001063_t0000<br>4&#123;<br>5  <span class="hljs-string">&quot;action&quot;</span>: <span class="hljs-string">&quot;upload&quot;</span>,<br>6  <span class="hljs-string">&quot;fileId&quot;</span>: <span class="hljs-string">&quot;4_zb21c374aec406a66740d0716_f109b36d0492bfbf2_d20200222_m133812_c000_v0001063_t0000&quot;</span>,<br>7  <span class="hljs-string">&quot;fileName&quot;</span>: <span class="hljs-string">&quot;foo.png&quot;</span>,<br>8  <span class="hljs-string">&quot;size&quot;</span>: 73243,<br>9  <span class="hljs-string">&quot;uploadTimestamp&quot;</span>: 1582378692000<br>10&#125;<br></code></pre></td></tr></table></figure><p>可以看到控制台返回了图片的<code>URL</code>，所以我们只要处理下返回结果。过滤出链接就可以。</p><ul><li>URL by file name 上面返回的参数可以通过管道命令先过滤出<code>URL</code>所在的行内容，即</li></ul><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver"><span class="hljs-number">1</span><span class="hljs-built_in">URL</span> <span class="hljs-keyword">by</span> <span class="hljs-built_in">file</span> name: <span class="hljs-keyword">https</span>://f000.backblazeb2.com/<span class="hljs-built_in">file</span>/bucketName/foo.png<br></code></pre></td></tr></table></figure><p>然后再用<code>akw</code>工具通过<code>name:</code>列分隔取得后面的链接。</p><p>所以图片的<code>URL</code>链接就可以通过下面的命令过滤出来了。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">1$ b2 upload-file  <span class="hljs-built_in">test</span> foo.png bar.png | grep <span class="hljs-string">&quot;URL by file name&quot;</span> |awk -F <span class="hljs-string">&#x27;name:&#x27;</span> <span class="hljs-string">&#x27;&#123;print $2&#125;&#x27;</span><br></code></pre></td></tr></table></figure><p>但是现在的问题是我们要获取上传的图片名称和保存到图床的名称，上传到<code>backblaze b2</code>的文件名可以和本地图片的文件名一样。这样我们可以可以写一个脚本实现截图后自动上传及获取图片的链接地址。</p><h2 id="优化和改良"><a href="#优化和改良" class="headerlink" title="优化和改良"></a>优化和改良</h2><p>我们通过<code>b2</code>客户端上传图片并过滤获取到了图片的地址。但是其中存在着大量的手工步骤：</p><ul><li>截图</li><li>截图后命名文件</li><li>获取图片上传路径</li><li>修改脚本的图片地址</li><li>复制上传后返回的链接</li><li>粘贴使用</li></ul><p>如果我们需要在短时间内上传大量的图片那重复的步骤就会很多。我们可以将重复的步骤自动化，优化后如下：</p><ul><li>截图</li><li>自动化（命令文件;获取获取图片上传路径;修改脚本中的图片地址;返回链接到剪切板中）</li><li>粘贴使用</li></ul><p>这里将用到命令行截图工具<code>maim</code>做为演示，如果是<code>Archlinux</code>用户或者使用<code>Pacman</code>作为包管理的系统，可以使用以下命令安装<code>maim</code>:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">1$ sudo pacman -S maim<br></code></pre></td></tr></table></figure><p>安装完后可以通过命令<code>maim -h</code>或者帮助信息。其中我们要用到的参数有<code>-s</code>，即选择区域截图。比如将截图保存到<code>/tmp</code>目录下命令为<code>screenshot.png</code>文件命令为：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">1$ maim -s /tmp/screenshot.png<br></code></pre></td></tr></table></figure><p>这样我们就有了本地图片名称了，但是当我们的图床名称和本地图片一样时，多次上传同样的名称图片会覆盖图床上的同名文件。所以最好使用随机产生不重复名称作为文件名。</p><p>这里我们可以使用格式化的日期函数作为文件名称:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">1$ <span class="hljs-built_in">echo</span> $(<span class="hljs-built_in">date</span> +%y%m%d%k%M%s)<br></code></pre></td></tr></table></figure><p>参数说明：</p><ul><li>y:年份后2位数字</li><li>m:2位数月份数字</li><li>d:2位数单天数字</li><li>K:24制小时数字</li><li>M:60制分钟数字</li><li>s:UTC到当前时间的秒数 上面的输出结果格式为：</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">120022323001582470005<br></code></pre></td></tr></table></figure><p>得到这个随机数字作为图片名称后，再加上图片的后缀<code>.jpg</code>或者<code>.png</code>就完成上传的图片名称定义了。</p><p>接着我们将前面的<code>b2</code>上传和图片过滤地址命令结合起来作为一个组合命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">1<span class="hljs-comment">#!/bin/sh</span><br>2picName=$(<span class="hljs-built_in">date</span> +%y%m%d%k%M%s)<br>3picSuffix=png<br>4<span class="hljs-comment"># protocol:http or https</span><br>5protocol=https<br>6domainName=img.maojun.xyz<br>7<br>8sleep 2;<br>9maim -s /tmp/screenshot.png; b2 upload-file  imgxyz  /tmp/screenshot.png <span class="hljs-string">&quot;<span class="hljs-variable">$picName</span>&quot;</span>.<span class="hljs-string">&quot;<span class="hljs-variable">$picSuffix</span>&quot;</span> | grep name |awk -F <span class="hljs-string">&#x27;/&#x27;</span> <span class="hljs-string">&#x27;&#123;print $(NF)&#125;&#x27;</span> |sed <span class="hljs-string">&quot;s/^/<span class="hljs-variable">$protocol</span>:\/\/<span class="hljs-variable">$domainName</span>\//&quot;</span> | xclip -selection clipboard<br>10<br>11echo url:  <span class="hljs-string">&quot;<span class="hljs-variable">$protocol</span>&quot;</span>://<span class="hljs-string">&quot;<span class="hljs-variable">$domainName</span>&quot;</span>/<span class="hljs-string">&quot;<span class="hljs-variable">$picName</span>&quot;</span>.<span class="hljs-string">&quot;<span class="hljs-variable">$picSuffix</span>&quot;</span><br></code></pre></td></tr></table></figure><p>上面的脚本地址定义了:</p><ul><li>picName：上传到图床的随机名称</li><li>picSuffix:上传的图片后缀名</li><li>protocol:自定义域名的前缀协议</li><li>domainName:自定义域名</li></ul><blockquote><p>注意:使用自定义域名需要先完成<code>DNS</code>的<code>CNAME</code>解析。</p></blockquote><p>组合脚本将<code>b2</code>上传后返回的图片<code>URL</code>地址过滤只保留下<strong>文件名称和后缀名</strong>,通过拼接我们的自定义域名然后发送给剪切板。这样只要将脚本绑定到快捷键就可以快速调用脚本并生成需要的链接，然后粘贴到需要的地方使用就可以了。</p><p>上面的脚本中，我将本地的图片地址写死为<code>screenshot.png</code>，而不是随机名称。因为上传到图床的图片我不想保存在本地，每次都替换上一次的文件。如果你希望保留在本地，可以将这里替换成随机生成的图片名称。</p><p>现在就可以愉快的截图并上传到图床使用了。同时为了区分本地截图和图床截图，我绑定了<code>2</code>个快捷键给不同的功能。这样就能区分场景完成截图的需求了。</p><p>后续的图片地址优化过程将在<a href="https://web.archive.org/web/20201024065121/https://maojun.xyz/archives/using-cloudflare-to-optimize-image-services.html">使用Cloudflare服务优化图床</a>中介绍。</p><p>（本文完）</p><p><strong>参考内容</strong></p><ul><li><a href="https://web.archive.org/web/20201024065121/https://jross.me/free-personal-image-hosting-with-backblaze-b2-and-cloudflare-workers/">free-personal-image-hosting-with-backblaze-b2-and-cloudflare-workers</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>操作演示</category>
      
    </categories>
    
    
    <tags>
      
      <tag>对象存储</tag>
      
      <tag>backblaze</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>博客迁移到 Typecho</title>
    <link href="/blog/2020/02/%E5%8D%9A%E5%AE%A2%E8%BF%81%E7%A7%BB%E5%88%B0Typecho.html"/>
    <url>/blog/2020/02/%E5%8D%9A%E5%AE%A2%E8%BF%81%E7%A7%BB%E5%88%B0Typecho.html</url>
    
    <content type="html"><![CDATA[<h2 id="尝试"><a href="#尝试" class="headerlink" title="尝试"></a>尝试</h2><p>博客平台历经 <code>HEXO</code>, <code>HUGO</code>, <code>Wordpress</code>, <code>GitHub Issues</code>，使用这些作为博客平台有着不同的体验。</p><p>但最终我都没有坚持使用下去。目前除了<code>HEXO</code>博客托管在<code>GitLab</code>网站，以及<code>GitHub Issues</code>做为省事的博客平台外。</p><p>其他博客平台都已经下线，结束了他们早期作为博客平台的使命。</p><p>以上的博客平台都属于开源项目，还有一些商业的博客平台目前也已注销和放弃了。</p><p>直到今天迁移到 <code>Typecho</code>，迁移的时候有过犹豫。会不会是下一个被我放弃的平台（后续被证实），以后的事我不好打保票。当我在这写下这篇迁移博文时，我是打算长期使用下去的。之前那些博客平台放弃的原因无乎不是折腾完了，没有了之前安装时的兴致，伴随着时间也就慢慢忘却了写作的本质。没想到当初抱着以写博客为开始，到最终以折腾捣鼓为结束。好似忘记了搭建博客的初心了。</p><h2 id="迁移"><a href="#迁移" class="headerlink" title="迁移"></a>迁移</h2><p>迁移到 <code>Typecho</code> 后，打开默认的首页后，惊乎有个似曾相识的感觉。没错，这和我使用较长时间 <code>WordPress</code> 有那么的相似。相似的是界面和风格，但是不相似的是 <code>Typecho</code> 的思想。为什么这么说，体验下来 <code>Typecho</code> 是轻量及支持 <code>MarkDown</code> 语法，可以开箱即用。<code>WordPress</code> 虽也可以开箱即用，但是作为一个拥有多功能的后台而言，免不了要进行一版配置和优化。而 <code>Typecho</code> 就不用了，毕竟本身就没过多的配置。</p><p>当然，为了达到我想要的效果。我还是对 <strong>Typecho</strong> 进行了一般研究和配置。修改了默认主题以下内容：</p><ul><li>页面宽度</li><li>代码高亮</li><li>导航链接</li><li>图片阴影</li><li>设置<code>favicon</code></li><li>链接重定向去掉<code>index.php</code></li></ul><p>其他一些配置是在网站后台管理界面修改。</p><p>由于安装是基于经典的<code>LAMP</code>平台，所以没有过多要说明的。后期考虑迁移到<code>Docker</code>,有机会再做介绍。</p><h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><p>安装后默认网站是没有配置<code>favicon.ico</code>的，所以这个需要自己配置。进入对应的项目目录:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ <span class="hljs-built_in">cd</span> &lt;WebHome&gt;/usr/themes/default<br></code></pre></td></tr></table></figure><p>然后编辑<code>header.php</code>,指定<code>favicon.ico</code>文件位置:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-comment">&lt;!-- favicon ico --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;shortcut icon&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;/favicon.ico&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;image/x-icon&quot;</span>&gt;</span><br></code></pre></td></tr></table></figure><blockquote><p>注意:<code>/favicon.ico</code>对应的是网站根目录</p></blockquote><p>修改后即可刷新页面查看到网站已经可以显示自定义的<code>favicon.ico</code>图标了。</p><h3 id="链接重定向去掉index-php"><a href="#链接重定向去掉index-php" class="headerlink" title="链接重定向去掉index.php"></a>链接重定向去掉<code>index.php</code></h3><p>进入网站后台配置管理页面，选择<strong>设置-&gt;永久链接-&gt;启用地址重写功能</strong>。 如果有警告信息，点击保存即可。然后需要配置重定向：这里以<code>Apache</code>服务器为示例。 进入网站的服务器根目录，编写<code>.htaccess</code>配置文件，写入以下内容：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs .htaccess">Options +FollowSymLinks<br>RewriteEngine on<br>RewriteBase /<br>RewriteCond %&#123;REQUEST_FILENAME&#125; !-f<br>RewriteCond %&#123;REQUEST_FILENAME&#125; !-d<br>RewriteRule ^(.*)$ /index.php/$1 [L]<br></code></pre></td></tr></table></figure><p>保存然后去网站首页刷新页面，点击文章链接查看效果。</p><h3 id="修改页面宽度"><a href="#修改页面宽度" class="headerlink" title="修改页面宽度"></a>修改页面宽度</h3><p>主题默认提供的是二栏分布，我偏爱更宽的内容区域，这样阅读起来比较舒服。所以去网站后台管理界面，<strong>控制台-&gt;设置外观-&gt;关闭侧边栏显示</strong>。</p><p>接着配置<code>php</code>页面,进入默认主题<strong>Default</strong>目录，编辑以下文件：</p><ul><li>archive.php</li><li>index.php</li><li>page.php</li><li>post.php</li></ul><p>找到<code>&lt;div class=&quot;col-mb-12 col-8&quot; id=&quot;main&quot; role=&quot;main&quot;&gt;</code>所在的行，将<code>col-8</code>修改为<code>col-12</code>。即占满<strong>12</strong>个单元。 去页面刷新查看效果，发现宽度边宽了。但是两边有较大留白空隙，去页面查看元素，发现是有<code>container</code>属性控制的。在<code>Default**目录下编写</code>diy.css&#96;文件，加入以下内容：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-keyword">@media</span> (<span class="hljs-attribute">min-width</span>: <span class="hljs-number">1200px</span>) &#123;<br>    <span class="hljs-selector-class">.container</span>&#123;<br>        <span class="hljs-attribute">max-width</span>: <span class="hljs-number">1400px</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>即将<code>container</code>的最大宽度设置为<code>1400px</code>.保存后编辑<code>header.php</code>，添加自定义的<code>CSS</code>文件：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;!-- diy css --&gt;<br>&lt;link rel=<span class="hljs-string">&quot;stylesheet&quot;</span> href=<span class="hljs-string">&quot;&lt;?php <span class="hljs-subst">$this</span>-&gt;options-&gt;themeUrl(&#x27;diy.css&#x27;); ?&gt;&quot;</span>&gt;<br></code></pre></td></tr></table></figure><p>保存后刷新页面查看效果。</p><h3 id="增加图片阴影"><a href="#增加图片阴影" class="headerlink" title="增加图片阴影"></a>增加图片阴影</h3><p><code>Typecho</code>上传图片后默认是没有效果的，显得非常的平。于是想到给增加些阴影更有立体感，图片的阴影样式是引用自<strong>王垠</strong>博客的图片样式。编辑原先定义的<code>diy.css</code>样式，追加以下内容：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">img</span> &#123;<br>    <span class="hljs-attribute">display</span>: block;<br>    <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">10px</span> <span class="hljs-number">#555</span>;<br>    <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">6px</span>;<br>    <span class="hljs-attribute">margin-left</span>: auto;<br>    <span class="hljs-attribute">margin-right</span>: auto;<br>    <span class="hljs-attribute">margin-top</span>: <span class="hljs-number">10px</span>;<br>    <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">10px</span>;<br>    -webkit-<span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">10px</span> <span class="hljs-number">#555</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>在配置页面宽度时，已经引用过该<code>css</code>文件，所以直接去页面刷新查看效果即可。</p><h3 id="代码高亮"><a href="#代码高亮" class="headerlink" title="代码高亮"></a>代码高亮</h3><p><code>Typecho</code>默认是不支持代码高亮的，为了显示和阅读上更加美观。我们可以通过插件或脚本让<code>Typecho</code>支持代码高亮。这里采用导入<code>JS</code>和<code>CSS</code>的方案让代码高亮，使用的是<code>prismjs</code>。去<a href="https://web.archive.org/web/20201019231149/https://prismjs.com/">官网下载</a>选择配置代码高亮主题及支持的代码类型，同时可以勾选插件让支持更多的功能。</p><p>配置好用，下载对应的<code>JS</code>和<code>CSS</code>文件上传到主题的目录，配置<code>header.php</code>文件，引入<code>prismjs</code>的依赖：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;link rel=<span class="hljs-string">&quot;stylesheet&quot;</span> href=<span class="hljs-string">&quot;&lt;?php <span class="hljs-subst">$this</span>-&gt;options-&gt;themeUrl(&#x27;prism.css&#x27;); ?&gt;&quot;</span>&gt;<br>&lt;script src=<span class="hljs-string">&quot;&lt;?php <span class="hljs-subst">$this</span>-&gt;options-&gt;themeUrl(&#x27;prism.js&#x27;);?&gt;&quot;</span>&gt;&lt;/script&gt;<br></code></pre></td></tr></table></figure><p>保存后，刷新网站的页面查看效果。</p><h3 id="增加导航链接"><a href="#增加导航链接" class="headerlink" title="增加导航链接"></a>增加导航链接</h3><p><code>Typeche</code>新增的自定义页面只支持站内链接。如果需要点击导航跳转到外部链接就不能通过<strong>新建独立页面</strong>的方式。同样的，我们可以在<code>header.php</code>中配置想要的外部链接。找到<code>&lt;nav id=&quot;nav-menu&quot; class=&quot;clearfix&quot; role=&quot;navigation&quot;&gt;</code>这行，在对应的<code>&lt;/nav&gt;</code>标签前增加自定义链接：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;a href=<span class="hljs-string">&quot;//blog.maojun.xyz&quot;</span>&gt;博客&lt;/a&gt;<br>&lt;a href=<span class="hljs-string">&quot;//maojun.xyz/feed/&quot;</span>&gt;RSS&lt;/a&gt;<br></code></pre></td></tr></table></figure><p>保存后，去页面刷新查看效果。</p><p>到此为止，配置后的 <code>Typecho</code> 已经能满足我的要求了。</p><p>（本文完）</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>操作演示</category>
      
    </categories>
    
    
    <tags>
      
      <tag>博客平台</tag>
      
      <tag>Typecho</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Kubernetes核心概念</title>
    <link href="/blog/2020/01/Kubernetes%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5.html"/>
    <url>/blog/2020/01/Kubernetes%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5.html</url>
    
    <content type="html"><![CDATA[<h2 id="什么是-Kubernetes"><a href="#什么是-Kubernetes" class="headerlink" title="什么是 Kubernetes"></a>什么是 Kubernetes</h2><p>Kubernetes，从官方网站上可以看到，它是一个工业级的容器编排平台。Kubernetes 这个单词是希腊语，它的中文翻译是“舵手”或者“飞行员”。在一些常见的资料中也会看到“ks”这个词，也就是“k8s”，它是通过将8个字母“ubernete ”替换为“8”而导致的一个缩写。</p><p>Kubernetes 为什么要用“舵手”来命名呢？大家可以看一下这张图：</p><p><img src="/blog/./assets/c527ac282e3203015720b5c9bb29043806839b73.png" alt="img"></p><p>这是一艘载着一堆集装箱的轮船，轮船在大海上运着集装箱奔波，把集装箱送到它们该去的地方。我们之前其实介绍过一个概念叫做 container，container 这个英文单词也有另外的一个意思就是“集装箱”。Kubernetes 也就借着这个寓意，希望成为运送集装箱的一个轮船，来帮助我们管理这些集装箱，也就是管理这些容器。</p><p>这个就是为什么会选用 Kubernetes 这个词来代表这个项目的原因。更具体一点地来说：Kubernetes 是一个自动化的容器编排平台，它负责应用的部署、应用的弹性以及应用的管理，这些都是基于容器的。</p><h2 id="Kubernetes-有如下几个核心的功能："><a href="#Kubernetes-有如下几个核心的功能：" class="headerlink" title="Kubernetes 有如下几个核心的功能："></a>Kubernetes 有如下几个核心的功能：</h2><ul><li>服务的发现与负载的均衡； </li><li>容器的自动装箱，我们也会把它叫做 scheduling，就是“调度”，把一个容器放到一个集群的某一个机器上，Kubernetes 会帮助我们去做存储的编排，让存储的声明周期与容器的生命周期能有一个连接； </li><li>Kubernetes 会帮助我们去做自动化的容器的恢复。在一个集群中，经常会出现宿主机的问题或者说是 OS 的问题，导致容器本身的不可用，Kubernetes 会自动地对这些不可用的容器进行恢复； </li><li>Kubernetes 会帮助我们去做应用的自动发布与应用的回滚，以及与应用相关的配置密文的管理； </li><li>对于 job 类型任务，Kubernetes 可以去做批量的执行； </li><li>为了让这个集群、这个应用更富有弹性，Kubernetes 也支持水平的伸缩。</li></ul><p>下面，我们希望以三个例子跟大家更切实地介绍一下 Kubernetes 的能力。</p><h3 id="调度"><a href="#调度" class="headerlink" title="调度"></a>调度</h3><p>Kubernetes 可以把用户提交的容器放到 Kubernetes 管理的集群的某一台节点上去。Kubernetes 的调度器是执行这项能力的组件，它会观察正在被调度的这个容器的大小、规格。</p><p>比如说它所需要的 CPU以及它所需要的 memory，然后在集群中找一台相对比较空闲的机器来进行一次 placement，也就是一次放置的操作。在这个例子中，它可能会把红颜色的这个容器放置到第二个空闲的机器上，来完成一次调度的工作。</p><p><img src="/blog/./assets/d4303aaa6f0a3993ffd302b6a4b6200d058642b1.png" alt="img"></p><h3 id="自动修复"><a href="#自动修复" class="headerlink" title="自动修复"></a>自动修复</h3><p>Kubernetes 有一个节点健康检查的功能，它会监测这个集群中所有的宿主机，当宿主机本身出现故障，或者软件出现故障的时候，这个节点健康检查会自动对它进行发现。</p><p>下面 Kubernetes 会把运行在这些失败节点上的容器进行自动迁移，迁移到一个正在健康运行的宿主机上，来完成集群内容器的一个自动恢复。</p><p><img src="/blog/./assets/df517f98621ce485e61d0fd1dcfe454569ab616c.png" alt="img"></p><p><img src="/blog/./assets/3bb896b71c93d6b398df2e5758c7b24d8d60ce5d.png" alt="img"></p><h3 id="水平伸缩"><a href="#水平伸缩" class="headerlink" title="水平伸缩"></a>水平伸缩</h3><p>Kubernetes 有业务负载检查的能力，它会监测业务上所承担的负载，如果这个业务本身的 CPU 利用率过高，或者响应时间过长，它可以对这个业务进行一次扩容。</p><p>比如说在下面的例子中，黄颜色的过度忙碌，Kubernetes 就可以把黄颜色负载从一份变为三份。接下来，它就可以通过负载均衡把原来打到第一个黄颜色上的负载平均分到三个黄颜色的负载上去，以此来提高响应的时间。</p><p><img src="/blog/./assets/5ce6d4e792b0602ace43d2fe5fd22fc396a3df6d.png" alt="img"></p><p><img src="/blog/./assets/2c8b31fe93d10d59f8e026005ed31d2c2cc88c46.png" alt="img"></p><p>以上就是 Kubernetes 三个核心能力的简单介绍。</p><h2 id="Kubernetes-的架构"><a href="#Kubernetes-的架构" class="headerlink" title="Kubernetes 的架构"></a>Kubernetes 的架构</h2><p>Kubernetes 架构是一个比较典型的二层架构和 server-client 架构。Master 作为中央的管控节点，会去与 Node 进行一个连接。</p><p>所有 UI 的、clients、这些 user 侧的组件，只会和 Master 进行连接，把希望的状态或者想执行的命令下发给 Master，Master 会把这些命令或者状态下发给相应的节点，进行最终的执行。</p><p><img src="/blog/./assets/5728b58a8d2cf6c2be789bca5acbb77dde9c4d4c.png" alt="img"></p><p>Kubernetes 的 Master 包含四个主要的组件：API Server、Controller、Scheduler 以及 etcd。如下图所示：</p><p><img src="/blog/./assets/b161e11eae280d950de7259873193f1a9359b97f.png" alt="img"></p><ul><li>API Server： 顾名思义是用来处理 API 操作的，Kubernetes 中所有的组件都会和 API Server 进行连接，组件与组件之间一般不进行独立的连接，都依赖于 API Server 进行消息的传送； </li><li>Controller： 是控制器，它用来完成对集群状态的一些管理。比如刚刚我们提到的两个例子之中，第一个自动对容器进行修复、第二个自动进行水平扩张，都是由 Kubernetes 中的 Controller 来进行完成的； </li><li>Scheduler：是调度器，“调度器”顾名思义就是完成调度的操作，就是我们刚才介绍的第一个例子中，把一个用户提交的 Container，依据它对 CPU、对 memory 请求大小，找一台合适的节点，进行放置； </li><li>etcd： 是一个分布式的一个存储系统，API Server 中所需要的这些原信息都被放置在 etcd 中，etcd 本身是一个高可用系统，通过 etcd 保证整个 Kubernetes 的 Master 组件的高可用性。</li></ul><p>我们刚刚提到的 API Server，它本身在部署结构上是一个可以水平扩展的一个部署组件；Controller 是一个可以进行热备的一个部署组件，它只有一个 active，它的调度器也是相应的，虽然只有一个 active，但是可以进行热备。</p><h3 id="Kubernetes-的架构：Node"><a href="#Kubernetes-的架构：Node" class="headerlink" title="Kubernetes 的架构：Node"></a>Kubernetes 的架构：Node</h3><p>Kubernetes 的 Node 是真正运行业务负载的，每个业务负载会以 Pod 的形式运行。等一下我会介绍一下 Pod 的概念。一个 Pod 中运行的一个或者多个容器，真正去运行这些 Pod 的组件的是叫做 kubelet，也就是 Node 上最为关键的组件，它通过 API Server 接收到所需要 Pod 运行的状态，然后提交到我们下面画的这个 Container Runtime 组件中。</p><p><img src="/blog/./assets/9dbdfbe3b7068f32d95b02dc2dd29302c82c9e3e.png" alt="img"></p><p>在 OS 上去创建容器所需要运行的环境，最终把容器或者 Pod 运行起来，也需要对存储跟网络进行管理。Kubernetes 并不会直接进行网络存储的操作，他们会靠 Storage Plugin 或者是网络的 Plugin 来进行操作。用户自己或者云厂商都会去写相应的 Storage Plugin 或者 Network Plugin，去完成存储操作或网络操作。</p><p>在 Kubernetes 自己的环境中，也会有 Kubernetes 的 Network，它是为了提供 Service network 来进行搭网组网的。（等一下我们也会去介绍“service”这个概念。）真正完成 service 组网的组件的是 Kube-proxy，它是利用了 iptable 的能力来进行组建 Kubernetes 的 Network，就是 cluster network，以上就是 Node 上面的四个组件。</p><p>Kubernetes 的 Node 并不会直接和 user 进行 interaction，它的 interaction 只会通过 Master。而 User 是通过 Master 向节点下发这些信息的。Kubernetes 每个 Node 上，都会运行我们刚才提到的这几个组件。</p><p>下面我们以一个例子再去看一下 Kubernetes 架构中的这些组件，是如何互相进行 interaction 的。</p><p><img src="/blog/./assets/c5cad06a9318860017d56ee709ddba6650941ec0.png" alt="img"></p><p>用户可以通过 UI 或者 CLI 提交一个 Pod 给 Kubernetes 进行部署，这个 Pod 请求首先会通过 CLI 或者 UI 提交给 Kubernetes API Server，下一步 API Server 会把这个信息写入到它的存储系统 etcd，之后 Scheduler 会通过 API Server 的 watch 或者叫做 notification 机制得到这个信息：有一个 Pod 需要被调度。</p><p>这个时候 Scheduler 会根据它的内存状态进行一次调度决策，在完成这次调度之后，它会向 API Server report 说：“OK！这个 Pod 需要被调度到某一个节点上。”</p><p>这个时候 API Server 接收到这次操作之后，会把这次的结果再次写到 etcd 中，然后 API Server 会通知相应的节点进行这次 Pod 真正的执行启动。相应节点的 kubelet 会得到这个通知，kubelet 就会去调 Container runtime 来真正去启动配置这个容器和这个容器的运行环境，去调度 Storage Plugin 来去配置存储，network Plugin 去配置网络。</p><p>这个例子我们可以看到：这些组件之间是如何相互沟通相互通信，协调来完成一次Pod的调度执行操作的。</p><h2 id="Kubernetes-的核心概念与它的-API"><a href="#Kubernetes-的核心概念与它的-API" class="headerlink" title="Kubernetes 的核心概念与它的 API"></a>Kubernetes 的核心概念与它的 API</h2><h3 id="核心概念"><a href="#核心概念" class="headerlink" title="核心概念"></a>核心概念</h3><h4 id="Pod"><a href="#Pod" class="headerlink" title="Pod"></a>Pod</h4><p>Pod 是 Kubernetes 的一个最小调度以及资源单元。用户可以通过 Kubernetes 的 Pod API 生产一个 Pod，让 Kubernetes 对这个 Pod 进行调度，也就是把它放在某一个 Kubernetes 管理的节点上运行起来。一个 Pod 简单来说是对一组容器的抽象，它里面会包含一个或多个容器。</p><p>比如像下面的这幅图里面，它包含了两个容器，每个容器可以指定它所需要资源大小。比如说，一个核一个 G，或者说 0.5 个核，0.5 个 G。</p><p>当然在这个 Pod 中也可以包含一些其他所需要的资源：比如说我们所看到的 Volume 卷这个存储资源；比如说我们需要 100 个 GB 的存储或者 20GB 的另外一个存储。</p><p><img src="/blog/./assets/616cc75b2ce8d734d6389f521c16f4d1d6f56dff.png" alt="img"></p><p>在 Pod 里面，我们也可以去定义容器所需要运行的方式。比如说运行容器的 Command，以及运行容器的环境变量等等。Pod 这个抽象也给这些容器提供了一个共享的运行环境，它们会共享同一个网络环境，这些容器可以用 localhost 来进行直接的连接。而 Pod 与 Pod 之间，是互相有 isolation 隔离的。</p><h4 id="Volume"><a href="#Volume" class="headerlink" title="Volume"></a>Volume</h4><p>Volume 就是卷的概念，它是用来管理 Kubernetes 存储的，是用来声明在 Pod 中的容器可以访问文件目录的，一个卷可以被挂载在 Pod 中一个或者多个容器的指定路径下面。</p><p>而 Volume 本身是一个抽象的概念，一个 Volume 可以去支持多种的后端的存储。比如说 Kubernetes 的 Volume 就支持了很多存储插件，它可以支持本地的存储，可以支持分布式的存储，比如说像 ceph，GlusterFS ；它也可以支持云存储，比如说阿里云上的云盘、AWS 上的云盘、Google 上的云盘等等。</p><p><img src="/blog/./assets/5d7c4142358a29dee77740cb9ebe978b04aec2eb.png" alt="img"></p><h4 id="Deployment"><a href="#Deployment" class="headerlink" title="Deployment"></a>Deployment</h4><p>Deployment 是在 Pod 这个抽象上更为上层的一个抽象，它可以定义一组 Pod 的副本数目、以及这个 Pod 的版本。一般大家用 Deployment 这个抽象来做应用的真正的管理，而 Pod 是组成 Deployment 最小的单元。</p><p>Kubernetes 是通过 Controller，也就是我们刚才提到的控制器去维护 Deployment 中 Pod 的数目，它也会去帮助 Deployment 自动恢复失败的 Pod。</p><p>比如说我可以定义一个 Deployment，这个 Deployment 里面需要两个 Pod，当一个 Pod 失败的时候，控制器就会监测到，它重新把 Deployment 中的 Pod 数目从一个恢复到两个，通过再去新生成一个 Pod。通过控制器，我们也会帮助完成发布的策略。比如说进行滚动升级，进行重新生成的升级，或者进行版本的回滚。</p><p><img src="/blog/./assets/70fdf18aac3c814fff9c0a6f2a83dd9eed29f387.png" alt="img"></p><h4 id="Service"><a href="#Service" class="headerlink" title="Service"></a>Service</h4><p>Service 提供了一个或者多个 Pod 实例的稳定访问地址。</p><p>比如在上面的例子中，我们看到：一个 Deployment 可能有两个甚至更多个完全相同的 Pod。对于一个外部的用户来讲，访问哪个 Pod 其实都是一样的，所以它希望做一次负载均衡，在做负载均衡的同时，我只想访问某一个固定的 VIP，也就是 Virtual IP 地址，而不希望得知每一个具体的 Pod 的 IP 地址。</p><p>我们刚才提到，这个 pod 本身可能 terminal go（终止），如果一个 Pod 失败了，可能会换成另外一个新的。</p><p>对一个外部用户来讲，提供了多个具体的 Pod 地址，这个用户要不停地去更新 Pod 地址，当这个 Pod 再失败重启之后，我们希望有一个抽象，把所有 Pod 的访问能力抽象成一个第三方的一个 IP 地址，实现这个的 Kubernetes 的抽象就叫 Service。</p><p>实现 Service 有多种方式，Kubernetes 支持 Cluster IP，上面我们讲过的 kuber-proxy 的组网，它也支持 nodePort、 LoadBalancer 等其他的一些访问的能力。</p><p><img src="/blog/./assets/ac386185dd887052ed3236a05c82cb9e565733fd.png" alt="img"></p><h4 id="Namespace"><a href="#Namespace" class="headerlink" title="Namespace"></a>Namespace</h4><p>Namespace 是用来做一个集群内部的逻辑隔离的，它包括鉴权、资源管理等。Kubernetes 的每个资源，比如刚才讲的 Pod、Deployment、Service 都属于一个 Namespace，同一个 Namespace 中的资源需要命名的唯一性，不同的 Namespace 中的资源可以重名。</p><p>Namespace 一个用例，比如像在阿里巴巴，我们内部会有很多个 business units，在每一个 business units 之间，希望有一个视图上的隔离，并且在鉴权上也不一样，在 cuda 上面也不一样，我们就会用 Namespace 来去给每一个 BU 提供一个他所看到的这么一个看到的隔离的机制。</p><p><img src="/blog/./assets/8995bce3a619f4e182fd65410ddddf477cbf869a.png" alt="img"></p><h3 id="Kubernetes-的-API"><a href="#Kubernetes-的-API" class="headerlink" title="Kubernetes 的 API"></a>Kubernetes 的 API</h3><p>下面我们介绍一下 Kubernetes 的 API 的基础知识。从 high-level 上看，Kubernetes API 是由 HTTP+JSON 组成的：用户访问的方式是 HTTP，访问的 API 中 content 的内容是 JSON 格式的。</p><p>Kubernetes 的 kubectl 也就是 command tool，Kubernetes UI，或者有时候用 curl，直接与 Kubernetes 进行沟通，都是使用 HTTP + JSON 这种形式。</p><p>下面有个例子：比如说，对于这个 Pod 类型的资源，它的 HTTP 访问的路径，就是 API，然后是 apiVesion: V1, 之后是相应的 Namespaces，以及 Pods 资源，最终是 Podname，也就是 Pod 的名字。</p><p><img src="/blog/./assets/9f2ba062136191e31834a2c2b7f7439cedee5d52.png" alt="img"></p><p>如果我们去提交一个 Pod，或者 get 一个 Pod 的时候，它的 content 内容都是用 JSON 或者是 YAML 表达的。上图中有个 yaml 的例子，在这个 yaml file 中，对 Pod 资源的描述也分为几个部分。</p><p>第一个部分，一般来讲会是 API 的 version。比如在这个例子中是 V1，它也会描述我在操作哪个资源；比如说我的 kind如果是 pod，在 Metadata 中，就写上这个 Pod 的名字；比如说 nginx，我们也会给它打一些 label，我们等下会讲到 label 的概念。在 Metadata 中，有时候也会去写 annotation，也就是对资源的额外的一些用户层次的描述。</p><p>比较重要的一个部分叫做 Spec，Spec 也就是我们希望 Pod 达到的一个预期的状态。比如说它内部需要有哪些 container 被运行；比如说这里面有一个 nginx 的 container，它的 image 是什么？它暴露的 port 是什么？</p><p>当我们从 Kubernetes API 中去获取这个资源的时候，一般来讲在 Spec 下面会有一个项目叫 status，它表达了这个资源当前的状态；比如说一个 Pod 的状态可能是正在被调度、或者是已经 running、或者是已经被 terminates，就是被执行完毕了。</p><p>刚刚在 API 之中，我们讲了一个比较有意思的 metadata 叫做“label”，这个 label 可以是一组 KeyValuePair。</p><p>比如下图的第一个 pod 中，label 就可能是一个 color 等于 red，即它的颜色是红颜色。当然你也可以加其他 label，比如说 size: big 就是大小，定义为大的，它可以是一组 label。</p><p>这些 label 是可以被 selector，也就是选择器所查询的。这个能力实际上跟我们的 sql 类型的 select 语句是非常相似的，比如下图中的三个 Pod 资源中，我们就可以进行 select。name color 等于 red，就是它的颜色是红色的，我们也可以看到，只有两个被选中了，因为只有他们的 label 是红色的，另外一个 label 中写的 color 等于 yellow，也就是它的颜色是黄色，是不会被选中的。</p><p><img src="/blog/./assets/e527e99921303d9bd9457a098da31d83fc8b8e74.png" alt="img"></p><p>通过 label，kubernetes 的 API 层就可以对这些资源进行一个筛选，那这些筛选也是 kubernetes 对资源的集合所表达默认的一种方式。</p><p>例如说，我们刚刚介绍的 Deployment，它可能是代表一组的 Pod，它是一组 Pod 的抽象，一组 Pod 就是通过 label selector 来表达的。当然我们刚才讲到说 service 对应的一组 Pod，就是一个 service 要对应一个或者多个的 Pod，来对它们进行统一的访问，这个描述也是通过 label selector 来进行 select 选取的一组 Pod。</p><p>所以可以看到 label 是一个非常核心的 kubernetes API 的概念，我们在接下来的课程中也会着重地去讲解和介绍 label 这个概念，以及如何更好地去使用它。</p><h2 id="以一个-demo-结尾"><a href="#以一个-demo-结尾" class="headerlink" title="以一个 demo 结尾"></a>以一个 demo 结尾</h2><p>最后一部分，我想以一个例子来结束，让大家跟我一起来尝试一个 kubernetes，在尝试 Kubernetes 之前，我希望大家能在本机上安装一下 Kubernetes，安装一个 Kubernetes 沙箱环境。</p><p>安装这个沙箱环境，主要有三个步骤：</p><ul><li>首先需要安装一个虚拟机，来在虚拟机中启动 Kubernetes。我们会推荐大家利用 virtualbox 来作为虚拟机的运行环境；</li></ul><p>安装 VirtualBox：<a href="https://www.virtualbox.org/wiki/Downloads">https://www.virtualbox.org/wiki/Downloads</a></p><ul><li>其次我们需要在虚拟机中启动 Kubernetes，Kubernetes 有一个非常有意思的项目，叫 minikube，也就是启动一个最小的 local 的 Kubernetes 的一个环境。</li></ul><p>minikube 我们推荐使用下面写到的阿里云的版本，它和官方 minikube 的主要区别就是把 minikube 中所需要的 Google 上的依赖换成国内访问比较快的一些镜像，这样就方便了大家的安装工作；</p><p>安装 MiniKube（中国版）:<a href="https://yq.aliyun.com/articles/221687">https://yq.aliyun.com/articles/221687</a></p><ul><li>最后在安装完 virtualbox 和 minikube 之后，大家可以对 minikube 进行启动，也就是下面这个命令。</li></ul><p>启动命令：minikube start —vm-driver virtualbox</p><p>如果大家不是 Mac 系统，其他操作系统请访问下面这个链接，查看其它操作系统如何安装 minikube 沙箱环境。</p><p><a href="https://kubernetes.io/docs/tasks/tools/install-minikube%EF%BC%8C">https://kubernetes.io/docs/tasks/tools/install-minikube/</a></p><p>当大家安装好之后，我会跟大家一起做一个例子，来做三件事情：</p><ol><li>提交一个 nginx deployment；</li></ol><p>kubectl apply  -f  <a href="https://k8s.io/examples/application/deployment.yaml">https://k8s.io/examples/application/deployment.yaml</a></p><ol><li>升级 nginx deployment；</li></ol><p>kubectl apply -f  <a href="https://k8s.io/examples/application/deployment-update.yaml">https://k8s.io/examples/application/deployment-update.yaml</a></p><ol><li>扩容 nginx deployment。</li></ol><p>kubectl apply -f  <a href="https://k8s.io/examples/application/deployment-scale.yaml">https://k8s.io/examples/application/deployment-scale.yaml</a></p><p>第一步，我们提交一个 nginx 的 Deployment，然后对这个 Deployment 进行一次版本升级，也就是改变它中间 Pod 的版本。最后我们也会尝试对 nginx 进行一次扩容，进行一次水平的伸缩，下面就让大家一起跟我来尝试这三个操作吧。</p><p>首先，我们先看一下 minikube 的 status，可以看到 kubelet master 和 kubectl 都是配置好的。</p><p><img src="/blog/./assets/5394b7b26ec1b134501533f0dc00f6f5580ae525.png" alt="img"></p><p>下一步我们利用 kubectl 来看一下这个集群中节选的状态，可以看到这个master 的节点已经是running状态：</p><p><img src="/blog/./assets/54fac1c5eb76db2f8409e888d595151571d6288c.png" alt="img"></p><p>我们就以这个为节点，下面我们尝试去看一下现在集群中 Deployment 这个资源：</p><p><img src="/blog/./assets/080068ebf0f94e145d04bb34cadc3b77b0d365ff.png" alt="img"></p><p>可以看到集群中没有任何的 Deployment，我们可以利用 watch 这个语义去看集群中 Deployment 这个资源的变化情况。</p><p>下面我们去做刚才想要的三个操作：第一个操作是去创建一个 Deployment。可以看到下面第一个图，这是一个 API 的 content，它的 kind 是 Deployment，name 是 nginx-deployment, 有图中它的 replicas 数目是2，它的镜像版本是 1.7.9。</p><p><img src="/blog/./assets/ba972a30cb83222a37fbd3b08956b75226aefc59.png" alt="img"></p><p><img src="/blog/./assets/92234b488d9e59b1e46469c5d2454dc5a54f5be8.png" alt="img"></p><p>我们下面还是回到 kubectl 这个 commnd 来执行这次 Deployment 的真正的操作。我们可以看到一个简单的操作，就会去让 Deployment 不停地生成副本。</p><p><img src="/blog/./assets/523aedddd93eb0f7eea35175a352ac5138c637d0.png" alt="img"></p><p>Deployment 副本数目是 2 个，下面也可以 describe 一下现在的 Deployment 的状态。我们知道之前是没有这个 Deployment 的，现在我们去 describe 这个 nginx-deployment。</p><p>下图中可以看到：有一个 nginx-deployment 已经被生成了，它的 replicas 数目也是我们想要的、selector 也是我们想要的、它的 image 的版本也是 1.7.9。还可以看到，里面的 deployment-controller 这种版本控制器也是在管理它的生成。</p><p><img src="/blog/./assets/46650884c993437cb2221a5c6d500e770962c0f8.png" alt="img"></p><p>下面我们去升级这个 Deployment 版本，首先下载另外一个 yaml 文件 deployment-update.yaml，可以看到这里面的 image 本身的版本号从 1.7.9 升级到 1.8。</p><p><img src="/blog/./assets/e818958afc9134d38c3b268cdc6c2f5f357b3532.png" alt="img"></p><p>接下来我们重新 apply 新的 deployment-update 这个 yaml 文件。</p><p>可以看到，在另一边的屏幕上显示出了这个 Deployment 升级的一些操作，最终它的 up-to-date 值从 0 变成了 2，也就是说所有的容器都是最新版本的，所有的 Pod 都是最新版本的。我们也可以 discribe 具体去看一下是不是所有 Pod 的版本都被更新了，可以看到这个 image 的版本由 1.7.9 真正更新到了 1.8。</p><p>最后，我们也可以看到 controller 又执行了几次新的操作，这个控制器维护了整个 Deployment 和 Pod 状态。</p><p><img src="/blog/./assets/3a48ceac3b08a99f6881a52bc06191f2a1378137.png" alt="img"></p><p>最后我们演示一下给 Deployment 做水平扩张，下载另一个 yaml 文件 deployment-scale.yaml，这里面的 replicas 数目已经从 2 改成了 4。</p><p><img src="/blog/./assets/6548fa86926f44c92ce6c319a86c81d2d968e8d5.png" alt="img"></p><p>回到最开始的窗口，用 kubectl 去 apply 这个新的 deployment-scale.yaml 文件，在另外一个窗口上可以看到，当我们执行了 deployment-scale 操作之后，它的容器 Pod 数目从 2 变成了 4。我们可以再一次 describ 一下当前集群中的 deployment 的情况，可以看到它的 replicas 的数目从 2 变到了 4，同时也可以看到 controller 又做了几次新的操作，这个 scale up 成功了。</p><p><img src="/blog/./assets/e377ed7b0a8884f758e614e5034d22280c9b5222.png" alt="img"></p><p>最后，让我们利用 delete 操作把我们刚才生成的 Deployment 给删除掉。kubectl delete deployment，也是刚才我们本身的 deployment name，当我们把它删除掉之后，我们今天所有的操作就完成了。</p><p>我们再去重新 get 这个 Deployment，也会显示这个资源不再存在，这个集群又回到了最开始干净的状态。</p><p><img src="/blog/./assets/605065468f68e9a9b3477a582dfefc2c6166765f.png" alt="img"></p><p>(完)</p><p><strong>引用</strong></p><ul><li><a href="https://edu.aliyun.com/course/314164/lesson/341312172">Kubernetes核心概念</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>翻译转载</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Kubernetes</tag>
      
      <tag>容器</tag>
      
      <tag>转载</tag>
      
      <tag>云原生</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>容器基本概念</title>
    <link href="/blog/2020/01/%E5%AE%B9%E5%99%A8%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5.html"/>
    <url>/blog/2020/01/%E5%AE%B9%E5%99%A8%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5.html</url>
    
    <content type="html"><![CDATA[<h2 id="容器与镜像"><a href="#容器与镜像" class="headerlink" title="容器与镜像"></a>容器与镜像</h2><h3 id="什么是容器？"><a href="#什么是容器？" class="headerlink" title="什么是容器？"></a>什么是容器？</h3><p>在介绍容器的具体概念之前，先简单回顾一下操作系统是如何管理进程的。</p><p>首先，当我们登录到操作系统之后，可以通过 ps 等操作看到各式各样的进程，这些进程包括系统自带的服务和用户的应用进程。那么，这些进程都有什么样的特点？</p><ul><li>第一，这些进程可以相互看到、相互通信； </li><li>第二，它们使用的是同一个文件系统，可以对同一个文件进行读写操作； </li><li>第三，这些进程会使用相同的系统资源。</li></ul><p>这样的三个特点会带来什么问题呢？</p><ul><li>因为这些进程能够相互看到并且进行通信，高级权限的进程可以攻击其他进程； </li><li>因为它们使用的是同一个文件系统，因此会带来两个问题：这些进程可以对于已有的数据进行增删改查，具有高级权限的进程可能会将其他进程的数据删除掉，破坏掉其他进程的正常运行；此外，进程与进程之间的依赖可能会存在冲突，如此一来就会给运维带来很大的压力； </li><li>因为这些进程使用的是同一个宿主机的资源，应用之间可能会存在资源抢占的问题，当一个应用需要消耗大量 CPU 和内存资源的时候，就可能会破坏其他应用的运行，导致其他应用无法正常地提供服务。</li></ul><p>针对上述的三个问题，如何为进程提供一个独立的运行环境呢？</p><ul><li>针对不同进程使用同一个文件系统所造成的问题而言，Linux 和 Unix 操作系统可以通过 chroot 系统调用将子目录变成根目录，达到视图级别的隔离；进程在 chroot 的帮助下可以具有独立的文件系统，对于这样的文件系统进行增删改查不会影响到其他进程； </li><li>因为进程之间相互可见并且可以相互通信，使用 Namespace 技术来实现进程在资源的视图上进行隔离。在 chroot 和 Namespace 的帮助下，进程就能够运行在一个独立的环境下了； </li><li>但在独立的环境下，进程所使用的还是同一个操作系统的资源，一些进程可能会侵蚀掉整个系统的资源。为了减少进程彼此之间的影响，可以通过 Cgroup 来限制其资源使用率，设置其能够使用的 CPU 以及内存量。</li></ul><p>那么，应该如何定义这样的进程集合呢？</p><p>其实，容器就是一个视图隔离、资源可限制、独立文件系统的进程集合。所谓“视图隔离”就是能够看到部分进程以及具有独立的主机名等；控制资源使用率则是可以对于内存大小以及 CPU 使用个数等进行限制。容器就是一个进程集合，它将系统的其他资源隔离开来，具有自己独立的资源视图。</p><p>容器具有一个独立的文件系统，因为使用的是系统的资源，所以在独立的文件系统内不需要具备内核相关的代码或者工具，我们只需要提供容器所需的二进制文件、配置文件以及依赖即可。只要容器运行时所需的文件集合都能够具备，那么这个容器就能够运行起来。</p><h3 id="什么是镜像？"><a href="#什么是镜像？" class="headerlink" title="什么是镜像？"></a>什么是镜像？</h3><p>综上所述，我们将这些容器运行时所需要的所有的文件集合称之为容器镜像。</p><p>那么，一般都是通过什么样的方式来构建镜像的呢？通常情况下，我们会采用 Dockerfile 来构建镜像，这是因为 Dockerfile 提供了非常便利的语法糖，能够帮助我们很好地描述构建的每个步骤。当然，每个构建步骤都会对已有的文件系统进行操作，这样就会带来文件系统内容的变化，我们将这些变化称之为 changeset。当我们把构建步骤所产生的变化依次作用到一个空文件夹上，就能够得到一个完整的镜像。</p><p>changeset 的分层以及复用特点能够带来几点优势：</p><ul><li>第一，能够提高分发效率，简单试想一下，对于大的镜像而言，如果将其拆分成各个小块就能够提高镜像的分发效率，这是因为镜像拆分之后就可以并行下载这些数据； </li><li>第二，因为这些数据是相互共享的，也就意味着当本地存储上包含了一些数据的时候，只需要下载本地没有的数据即可，举个简单的例子就是 golang 镜像是基于 alpine 镜像进行构建的，当本地已经具有了 alpine 镜像之后，在下载 golang 镜像的时候只需要下载本地 alpine 镜像中没有的部分即可； </li><li>第三，因为镜像数据是共享的，因此可以节约大量的磁盘空间，简单设想一下，当本地存储具有了 alpine 镜像和 golang 镜像，在没有复用的能力之前，alpine 镜像具有 5M 大小，golang 镜像有 300M 大小，因此就会占用 305M 空间；而当具有了复用能力之后，只需要 300M 空间即可。</li></ul><h3 id="如何构建镜像？"><a href="#如何构建镜像？" class="headerlink" title="如何构建镜像？"></a>如何构建镜像？</h3><p>如下图所示的 Dockerfile 适用于描述如何构建 golang 应用的。</p><p><img src="/blog/./assets/319d28c2644985380f0dc6710173516d4e6dc095.png" alt="Dockerfile "></p><p>如图所示：</p><ol><li>FROM 行表示以下的构建步骤基于什么镜像进行构建，正如前面所提到的，镜像是可以复用的； </li><li>WORKDIR 行表示会把接下来的构建步骤都在哪一个相应的具体目录下进行，其起到的作用类似于 Shell 里面的 cd； </li><li>COPY 行表示的是可以将宿主机上的文件拷贝到容器镜像内； </li><li>RUN 行表示在具体的文件系统内执行相应的动作。当我们运行完毕之后就可以得到一个应用了； </li><li>CMD 行表示使用镜像时的默认程序名字。</li></ol><p>当有了 Dockerfile 之后，就可以通过 docker build 命令构建出所需要的应用。构建出的结果存储在本地，一般情况下，镜像构建会在打包机或者其他的隔离环境下完成。</p><p>那么，这些镜像如何运行在生产环境或者测试环境上呢？这时候就需要一个中转站或者中心存储，我们称之为 docker registry，也就是镜像仓库，其负责存储所有产生的镜像数据。我们只需要通过 docker push 就能够将本地镜像推动到镜像仓库中，这样一来，就能够在生产环境上或者测试环境上将相应的数据下载下来并运行了。</p><h3 id="如何运行容器？"><a href="#如何运行容器？" class="headerlink" title="如何运行容器？"></a>如何运行容器？</h3><p>运行一个容器一般情况下分为三步：</p><ul><li>第一步：从镜像仓库中将相应的镜像下载下来； </li><li>第二步：当镜像下载完成之后就可以通过 docker images 来查看本地镜像，这里会给出一个完整的列表，我们可以在列表中选中想要的镜像； </li><li>第三步：当选中镜像之后，就可以通过 docker run 来运行这个镜像得到想要的容器，当然可以通过多次运行得到多个容器。一个镜像就相当于是一个模板，一个容器就像是一个具体的运行实例，因此镜像就具有了一次构建、到处运行的特点。</li></ul><h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p>简单回顾一下，容器就是和系统其它部分隔离开来的进程集合，这里的其他部分包括进程、网络资源以及文件系统等。而镜像就是容器所需要的所有文件集合，其具备一次构建、到处运行的特点。</p><h2 id="二、容器的生命周期"><a href="#二、容器的生命周期" class="headerlink" title="二、容器的生命周期"></a>二、容器的生命周期</h2><h3 id="容器运行时的生命周期"><a href="#容器运行时的生命周期" class="headerlink" title="容器运行时的生命周期"></a>容器运行时的生命周期</h3><p>容器是一组具有隔离特性的进程集合，在使用 docker run 的时候会选择一个镜像来提供独立的文件系统并指定相应的运行程序。这里指定的运行程序称之为 initial 进程，这个 initial 进程启动的时候，容器也会随之启动，当 initial 进程退出的时候，容器也会随之退出。</p><p>因此，可以认为容器的生命周期和 initial 进程的生命周期是一致的。当然，因为容器内不只有这样的一个 initial 进程，initial 进程本身也可以产生其他的子进程或者通过 docker exec 产生出来的运维操作，也属于 initial 进程管理的范围内。当 initial 进程退出的时候，所有的子进程也会随之退出，这样也是为了防止资源的泄漏。</p><p>但是这样的做法也会存在一些问题，首先应用里面的程序往往是有状态的，其可能会产生一些重要的数据，当一个容器退出被删除之后，数据也就会丢失了，这对于应用方而言是不能接受的，所以需要将容器所产生出来的重要数据持久化下来。容器能够直接将数据持久化到指定的目录上，这个目录就称之为数据卷。</p><p>数据卷有一些特点，其中非常明显的就是数据卷的生命周期是独立于容器的生命周期的，也就是说容器的创建、运行、停止、删除等操作都和数据卷没有任何关系，因为它是一个特殊的目录，是用于帮助容器进行持久化的。简单而言，我们会将数据卷挂载到容器内，这样一来容器就能够将数据写入到相应的目录里面了，而且容器的退出并不会导致数据的丢失。</p><p>通常情况下，数据卷管理主要有两种方式：</p><ul><li>第一种是通过 bind 的方式，直接将宿主机的目录直接挂载到容器内；这种方式比较简单，但是会带来运维成本，因为其依赖于宿主机的目录，需要对于所有的宿主机进行统一管理。 </li><li>第二种是将目录管理交给运行引擎。</li></ul><h2 id="三、容器项目架构"><a href="#三、容器项目架构" class="headerlink" title="三、容器项目架构"></a>三、容器项目架构</h2><h3 id="moby-容器引擎架构"><a href="#moby-容器引擎架构" class="headerlink" title="moby 容器引擎架构"></a>moby 容器引擎架构</h3><p>moby 是目前最流行的容器管理引擎，moby daemon 会对上提供有关于容器、镜像、网络以及 Volume的管理。moby daemon 所依赖的最重要的组件就是 containerd，containerd 是一个容器运行时管理引擎，其独立于 moby daemon ，可以对上提供容器、镜像的相关管理。</p><p>containerd 底层有 containerd shim 模块，其类似于一个守护进程，这样设计的原因有几点：</p><ul><li>首先，containerd 需要管理容器生命周期，而容器可能是由不同的容器运行时所创建出来的，因此需要提供一个灵活的插件化管理。而 shim 就是针对于不同的容器运行时所开发的，这样就能够从 containerd 中脱离出来，通过插件的形式进行管理。 </li><li>其次，因为 shim 插件化的实现，使其能够被 containerd 动态接管。如果不具备这样的能力，当 moby daemon 或者 containerd daemon 意外退出的时候，容器就没人管理了，那么它也会随之消失、退出，这样就会影响到应用的运行。 </li><li>最后，因为随时可能会对 moby 或者 containerd 进行升级，如果不提供 shim 机制，那么就无法做到原地升级，也无法做到不影响业务的升级，因此 containerd shim 非常重要，它实现了动态接管的能力。</li></ul><p>本节课程只是针对于 moby 进行一个大致的介绍，在后续的课程也会详细介绍。</p><h2 id="四、容器-VS-VM"><a href="#四、容器-VS-VM" class="headerlink" title="四、容器 VS VM"></a>四、容器 VS VM</h2><h3 id="容器和-VM-之间的差异"><a href="#容器和-VM-之间的差异" class="headerlink" title="容器和 VM 之间的差异"></a>容器和 VM 之间的差异</h3><p>VM 利用 Hypervisor 虚拟化技术来模拟 CPU、内存等硬件资源，这样就可以在宿主机上建立一个 Guest OS，这是常说的安装一个虚拟机。</p><p>每一个 Guest OS 都有一个独立的内核，比如Ubuntu、CentOS 甚至是 Windows 等，在这样的 Guest OS 之下，每个应用都是相互独立的，VM 可以提供一个更好的隔离效果。但这样的隔离效果需要付出一定的代价，因为需要把一部分的计算资源交给虚拟化，这样就很难充分利用现有的计算资源，并且每个 Guest OS 都需要占用大量的磁盘空间，比如 Windows 操作系统的安装需要 10<del>30G 的磁盘空间，Ubuntu 也需要 5</del>6G，同时这样的方式启动很慢。正是因为虚拟机技术的缺点，催生出了容器技术。</p><p>容器是针对于进程而言的，因此无需 Guest OS，只需要一个独立的文件系统提供其所需要文件集合即可。所有的文件隔离都是进程级别的，因此启动时间快于 VM，并且所需的磁盘空间也小于 VM。当然了，进程级别的隔离并没有想象中的那么好，隔离效果相比 VM 要差很多。</p><p>总体而言，容器和 VM 相比，各有优劣，因此容器技术也在向着强隔离方向发展。</p><p>（完）</p><p><strong>引用</strong></p><ul><li><a href="https://edu.aliyun.com/course/314164/lesson/341312088">容器基本概念</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>翻译转载</category>
      
    </categories>
    
    
    <tags>
      
      <tag>容器</tag>
      
      <tag>转载</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>什么是云原生</title>
    <link href="/blog/2020/01/%E4%BB%80%E4%B9%88%E6%98%AF%E4%BA%91%E5%8E%9F%E7%94%9F.html"/>
    <url>/blog/2020/01/%E4%BB%80%E4%B9%88%E6%98%AF%E4%BA%91%E5%8E%9F%E7%94%9F.html</url>
    
    <content type="html"><![CDATA[<h2 id="云原生技术发展简史"><a href="#云原生技术发展简史" class="headerlink" title="云原生技术发展简史"></a>云原生技术发展简史</h2><p>云原生、CNCF 都是目前非常热门的关键词，但是这些技术并不是非常新鲜的内容。</p><ul><li>2004 年— 2007 年，Google 已在内部大规模地使用像 Cgroups 这样的容器技术； </li><li>2008 年，Google 将 Cgroups 合并进入了 Linux 内核主干； </li><li>2013 年，Docker 项目正式发布。 </li><li>2014 年，Kubernetes 项目也正式发布。这样的原因也非常容易理解，因为有了容器和 Docker 之后，就需要有一种方式去帮助大家方便、快速、优雅地管理这些容器，这就是 Kubernetes 项目的初衷。在 Google 和 Redhat 发布了 Kubernetes 之后，这个项目的发展速度非常之快。 </li><li>2015 年，由Google、Redhat 以及微软等大型云计算厂商以及一些开源公司共同牵头成立了 CNCF 云原生基金会。CNCF 成立之初，就有 22 个创始会员，而且 Kubernetes 也成为了 CNCF 托管的第一个开源项目。在这之后，CNCF 的发展速度非常迅猛； </li><li>2017 年，CNCF 达到 170 个成员和 14 个基金项目； </li><li>2018 年，CNCF 成立三周年有了 195 个成员，19 个基金会项目和 11 个孵化项目，如此之快的发展速度在整个云计算领域都是非常罕见的。</li></ul><h2 id="云原生技术生态现状"><a href="#云原生技术生态现状" class="headerlink" title="云原生技术生态现状"></a>云原生技术生态现状</h2><p>因此，如今我们所讨论的云原生技术生态是一个庞大的技术集合。CNCF 有一张云原生全景图（<a href="https://github.com/cncf/landscape%EF%BC%89%EF%BC%8C%E5%9C%A8%E8%BF%99%E4%B8%AA%E5%85%A8%E6%99%AF%E5%9B%BE%E9%87%8C%E5%B7%B2%E7%BB%8F%E6%9C%89">https://github.com/cncf/landscape），在这个全景图里已经有</a> 200 多个项目和产品了，这些项目和产品也都是和 CNCF 的观点所契合的。所以如果以这张全景图作为背景，加以思考就会发现，我们今天所讨论的云原生其实主要谈论了以下几点：</p><ol><li>云原生基金会 —— CNCF； </li><li>云原生技术社区，比如像 CNCF 目前正式托管的 20 多个项目共同构成了现代云计算生态的基石，其中像 Kubernetes 这样的项目已经成为了世界第四活跃的开源项目； </li><li>除了前面两点之外，现在全球各大公有云厂商都已经支持了 Kubernetes。此外，还有 100 多家技术创业公司也在持续地进行投入。现在阿里巴巴也在谈全面上云，而且上云就要上云原生，这也是各大技术公司拥抱云原生的一个例子。</li></ol><h2 id="我们正处于时代的关键节点"><a href="#我们正处于时代的关键节点" class="headerlink" title="我们正处于时代的关键节点"></a>我们正处于时代的关键节点</h2><p>2019 年正是云原生时代的关键节点，为什么这么说？我们这里就为大家简单梳理一下。</p><p>从 2013 年 Docker 项目发布开始说起，Docker 项目的发布使得全操作系统语义的沙盒技术唾手可得，使得用户能够更好地、更完整地打包自己的应用，使得开发者可以轻而易举的获得了一个应用的最小可运行单位，而不需要依赖任何 PaaS 能力。这对经典 PaaS 产业其实是一个“降维打击”。</p><p>2014 年的时候，Kubernetes 项目发布，其意义在于 Google 将内部的 Borg&#x2F;Omega 系统思想借助开源社区实现了“重生”，并且提出了“容器设计模式”的思想。而 Google 之所以选择间接开源 Kubernetes 而不是直接开源 Borg 项目，其实背后的原因也比较容易理解：Borg&#x2F;Omega 这样的系统太复杂了，是没办法提供给 Google 之外的人使用，但是 Borg&#x2F;Omega 这样的设计思想却可以借助 Kubernetes 让大家接触到，这也是开源 Kubernetes 的重要背景。</p><p>这样到了 2015 年到 2016 年，就到了容器编排“三国争霸”的时代，当时 Docker、Swarm、Mesos、Kubernetes 都在容器编排领域展开角逐，他们竞争的原因其实也比较容易理解， 那就是 Docker 或者容器本身的价值虽然大，但是如果想要让其产生商业价值或者说对云的价值，那么就一定需要在编排上面占据一个有利的位置。</p><p>Swarm 和 Mesos 的特点，那就是各自只在生态和技术方面比较强，其中，Swarm 更偏向于生态，而 Mesos 技术更强一些。相比之下， Kubernetes 则兼具了两者优势，最终在 2017 年“三国争霸”的局面中得以胜出，成为了当时直到现在的容器编排标准。这一过程的代表性事件就是 Docker 公司宣布在核心产品中内置了 Kubernetes 服务，并且 Swarm 项目逐渐停止维护。</p><p>到了 2018 年的时候，云原生技术理念开始逐渐萌芽，这是因为此时 Kubernetes 以及容器都成为了云厂商的既定标准，以“云”为核心的软件研发思想逐步形成。</p><p>而到了 2019 年，情况似乎又将发生一些变化。</p><h2 id="2019-年——云原生技术普及元年"><a href="#2019-年——云原生技术普及元年" class="headerlink" title="2019 年——云原生技术普及元年"></a>2019 年——云原生技术普及元年</h2><p>为什么说 2019 年很可能是一个关键节点呢？我们认为 2019 年是云原生技术的普及元年。</p><p>首先大家可以看到，在 2019 年，阿里巴巴宣布要全面上云，而且“上云就要上云原生”。我们还可以看到，以“云”为核心的软件研发思想，正逐步成为所有开发者的默认选项。像 Kubernetes 等云原生技术正在成为技术人员的必修课，大量的工作岗位正在涌现出来。</p><p>这种背景下，“会 Kubernetes”已经远远不够了，“懂 Kubernetes”、“会云原生架构”的重要性正日益凸显出来。 从 2019 年开始，云原生技术将会大规模普及，这也是为什么大家都要在这个时间点上学习和投资云原生技术的重要原因。</p><h2 id="云原生的定义"><a href="#云原生的定义" class="headerlink" title="云原生的定义"></a>云原生的定义</h2><p>很多人都会问“到底什么是云原生？”</p><p>实际上，云原生是一条最佳路径或者最佳实践。更详细的说，云原生为用户指定了一条低心智负担的、敏捷的、能够以可扩展、可复制的方式最大化地利用云的能力、发挥云的价值的最佳路径。</p><p>因此，云原生其实是一套指导进行软件架构设计的思想。按照这样的思想而设计出来的软件：首先，天然就“生在云上，长在云上”；其次，能够最大化地发挥云的能力，使得我们开发的软件和“云”能够天然地集成在一起，发挥出“云”的最大价值。</p><p>所以，云原生的最大价值和愿景，就是认为未来的软件，会从诞生起就生长在云上，并且遵循一种新的软件开发、发布和运维模式，从而使得软件能够最大化地发挥云的能力。说到了这里，大家可以思考一下为什么容器技术具有革命性？</p><p>其实，容器技术和集装箱技术的革命性非常类似，即：容器技术使得应用具有了一种“自包含”的定义方式。所以，这样的应用才能以敏捷的、以可扩展可复制的方式发布在云上，发挥出云的能力。这也就是容器技术对云发挥出的革命性影响所在，所以说，容器技术正是云原生技术的核心底盘。</p><h2 id="云原生的技术范畴"><a href="#云原生的技术范畴" class="headerlink" title="云原生的技术范畴"></a>云原生的技术范畴</h2><p>云原生的技术范畴包括了以下几个方面：</p><ul><li>第一部分是云应用定义与开发流程。这包括应用定义与镜像制作、配置 CI&#x2F;CD、消息和 Streaming 以及数据库等。 </li><li>第二部分是云应用的编排与管理流程。这也是 Kubernetes 比较关注的一部分，包括了应用编排与调度、服务发现治理、远程调用、API 网关以及 Service Mesh。 </li><li>第三部分是监控与可观测性。这部分所强调的是云上应用如何进行监控、日志收集、Tracing 以及在云上如何实现破坏性测试，也就是混沌工程的概念。 </li><li>第四部分就是云原生的底层技术，比如容器运行时、云原生存储技术、云原生网络技术等。 </li><li>第五部分是云原生工具集，在前面的这些核心技术点之上，还有很多配套的生态或者周边的工具需要使用，比如流程自动化与配置管理、容器镜像仓库、云原生安全技术以及云端密码管理等。 </li><li>最后则是 Serverless。Serverless 是一种 PaaS 的特殊形态，它定义了一种更为“极端抽象”的应用编写方式，包含了 FaaS 和 BaaS 这样的概念。而无论是 FaaS 还是 BaaS，其最为典型的特点就是按实际使用计费（Pay as you go），因此 Serverless 计费也是重要的知识和概念。</li></ul><h2 id="云原生思想的两个理论"><a href="#云原生思想的两个理论" class="headerlink" title="云原生思想的两个理论"></a>云原生思想的两个理论</h2><p>在了解完云原生的技术范畴之后你就会发现，其所包含的技术内容还是很多的，但是这些内容的技术本质却是类似的。云原生技术的本质是两个理论基础。</p><ul><li>第一个理论基础是：不可变基础设施 。这一点目前是通过容器镜像来实现的，其含义就是应用的基础设施应该是不可变的，是一个自包含、自描述可以完全在不同环境中迁移的东西； </li><li>第二个理论基础就是：云应用编排理论。当前的实现方式就是 Google 所提出来的“容器设计模式”，这也是本系列课程中的 Kubernetes 部分所需主要讲解的内容。</li></ul><h2 id="基础设施向云演进的过程"><a href="#基础设施向云演进的过程" class="headerlink" title="基础设施向云演进的过程"></a>基础设施向云演进的过程</h2><p>首先为大家介绍一下“不可变基础设施”的概念。其实，应用所依赖的基础设施也在经历一个向云演进的过程，举例而言，对于传统的应用基础设施而言，其实往往是可变的。</p><p>大家可能经常会干这样一件事情，比如需要发布或者更新一个软件，那么流程大致是这样的，先通过 SSH 连到服务器，然后手动升级或者降级软件包，逐个调整服务器上的配置文件，并且将新代码直接都部署到现有服务器上。因此，这套基础设施会不断地被调整和修改。</p><p>但是在云上，对“云”友好的应用基础设施是不可变的。</p><p>这种场景下的上述更新过程会这么做：一旦应用部署完成之后，那么这套应用基础设施就不会再修改了。如果需要更新，那么需要现更改公共镜像来构建新服务直接替换旧服务。而我们之所以能够实现直接替换，就是因为容器提供了自包含的环境（包含应用运行所需的所有依赖）。所以对于应用而言，完全不需要关心容器发生了什么变化，只需要把容器镜像本身修改掉就可以了。因此，对于云友好的基础设施是随时可以替换和更换的，这就是因为容器具有敏捷和一致性的能力，也就是云时代的应用基础设施。</p><p>所以，总结而言，云时代的基础设施就像是可以替代的“牲口”，可以随时替换；而传统的基础设施则是独一无二的“宠物”，需要细心呵护，这就体现出了云时代不可变基础设施的优点。</p><h2 id="基础设施向云演进的意义"><a href="#基础设施向云演进的意义" class="headerlink" title="基础设施向云演进的意义"></a>基础设施向云演进的意义</h2><p>所以，像这样的基础设施向“不可变”演进的过程，为我们提供了两个非常重要的优点。</p><ol><li>基础设施的一致性和可靠性。同样一个镜像，无论是在美国打开，在中国打开，还是在印度打开都是一样的。并且其中的 OS 环境对于应用而言都是一致的。而对于应用而言，它就不需要关心容器跑在哪里，这就是基础设施一致性非常重要的一个特征。 </li><li>这样的镜像本身就是自包含的，其包含了应用运行所需要的所有依赖，因此也可以漂移到云上的任何一个位置。</li></ol><p>此外，云原生的基础设施还提供了简单、可预测的部署和运维能力。由于现在有了镜像，应用还是自描述的，通过镜像运行起来的整个容器其实可以像 Kubernetes 的 Operator 技术一样将其做成自运维的，所以整个应用本身都是自包含的行为，使得其能够迁移到云上任何一个位置。这也使得整个流程的自动化变得非常容易。</p><p>应用本身也可以更好地扩容，从 1 个实例变成 100 个实例，进而变成 1 万个实例，这个过程对于容器化后的应用没有任何特殊的。最后，我们这时也能够通过不可变的基础设施来地快速周围的管控系统和支撑组件。因为，这些组件本身也是容器化的，是符合不可变基础设施这样一套理论的组件。</p><p>以上就是不可变基础设施为用户带来的最大的优点。</p><h2 id="云原生关键技术点"><a href="#云原生关键技术点" class="headerlink" title="云原生关键技术点"></a>云原生关键技术点</h2><p>当我们回过头来看云原生关键技术点或者说它所依赖的技术理论的时候，可以看到主要有这样的四个方向：</p><ol><li>如何构建自包含、可定制的应用镜像； </li><li>能不能实现应用快速部署与隔离能力； </li><li>应用基础设施创建和销毁的自动化管理； </li><li>可复制的管控系统和支撑组件。</li></ol><p>（完）</p><p><strong>引用</strong></p><ul><li><a href="https://edu.aliyun.com/course/314164/lesson/341311954">第一堂“云原生”课</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>翻译转载</category>
      
    </categories>
    
    
    <tags>
      
      <tag>容器</tag>
      
      <tag>转载</tag>
      
      <tag>云原生</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SpringMVC参数绑定的方式</title>
    <link href="/blog/2019/11/SpringMVC%E5%8F%82%E6%95%B0%E7%BB%91%E5%AE%9A%E7%9A%84%E6%96%B9%E5%BC%8F.html"/>
    <url>/blog/2019/11/SpringMVC%E5%8F%82%E6%95%B0%E7%BB%91%E5%AE%9A%E7%9A%84%E6%96%B9%E5%BC%8F.html</url>
    
    <content type="html"><![CDATA[<h2 id="名称匹配接收参数"><a href="#名称匹配接收参数" class="headerlink" title="名称匹配接收参数"></a>名称匹配接收参数</h2><p>入参和接收参数名称一致。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Controller</span><br><span class="hljs-meta">@RequestMapping(&quot;/param&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestParamController</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Logger</span> <span class="hljs-variable">logger</span> <span class="hljs-operator">=</span> LoggerFactory.getLogger(TestParamController.class);<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 请求参数名和Controller方法的参数一致</span><br><span class="hljs-comment">     * produces 设置返回参数的编码格式可以设置返回数据的类型以及编码，可以是json或者xml</span><br><span class="hljs-comment">     * &#123;</span><br><span class="hljs-comment">     *     <span class="hljs-doctag">@RequestMapping</span>(value=&quot;/xxx&quot;,produces = &#123;&quot;application/json;charset=UTF-8&quot;&#125;)</span><br><span class="hljs-comment">     *      或</span><br><span class="hljs-comment">     *     <span class="hljs-doctag">@RequestMapping</span>(value=&quot;/xxx&quot;,produces = &#123;&quot;application/xml;charset=UTF-8&quot;&#125;)</span><br><span class="hljs-comment">     *      或</span><br><span class="hljs-comment">     *     <span class="hljs-doctag">@RequestMapping</span>(value=&quot;/xxx&quot;,produces = &quot;&#123;text/html;charset=utf-8&#125;&quot;)</span><br><span class="hljs-comment">     * &#125;</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> name 用户名</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> pwd 密码</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@RequestMapping(value = &quot;/add&quot;, method = RequestMethod.GET, produces = &#123;&quot;application/json;charset=UTF-8&quot;&#125;)</span><br>    <span class="hljs-meta">@ResponseBody</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">addUser</span><span class="hljs-params">(String name, String pwd)</span>&#123;<br>        logger.debug(<span class="hljs-string">&quot;name:&quot;</span> + name + <span class="hljs-string">&quot;,pwd:&quot;</span> + pwd);<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;name:&quot;</span> + name + <span class="hljs-string">&quot;,pwd:&quot;</span> + pwd;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>请求方式：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs curl">curl http://localhost:8080/sty/param/add.action?name=张三&amp;pwd=123456<br></code></pre></td></tr></table></figure><h2 id="对象属性名称匹配接收参数"><a href="#对象属性名称匹配接收参数" class="headerlink" title="对象属性名称匹配接收参数"></a>对象属性名称匹配接收参数</h2><p>Java实体类定义：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> &#123;<br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> String pwd;<br>&#125;<br></code></pre></td></tr></table></figure><p>入参和接收对象的参数一致。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Controller</span><br><span class="hljs-meta">@RequestMapping(&quot;/param&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestParamController</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Logger</span> <span class="hljs-variable">logger</span> <span class="hljs-operator">=</span> LoggerFactory.getLogger(TestParamController.class);<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 请求参数名和Controller方法的参数一致</span><br><span class="hljs-comment">     * produces 设置返回参数的编码格式可以设置返回数据的类型以及编码，可以是json或者xml</span><br><span class="hljs-comment">     * &#125;</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> user 用户信息</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@RequestMapping(value = &quot;/addByObject&quot;, method = RequestMethod.GET, produces = &#123;&quot;application/json;charset=UTF-8&quot;&#125;)</span><br>    <span class="hljs-meta">@ResponseBody</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">addUserByObject</span><span class="hljs-params">(User user)</span>&#123;<br>        logger.debug(<span class="hljs-string">&quot;name:&quot;</span> + user.getName() + <span class="hljs-string">&quot;,pwd:&quot;</span> + user.getPwd());<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;name:&quot;</span> + user.getName() + <span class="hljs-string">&quot;,pwd:&quot;</span> + user.getPwd();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>请求方式：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs curl">curl http://localhost:8080/sty/param/addByObject.action?name=张三&amp;pwd=123456<br></code></pre></td></tr></table></figure><h2 id="重命名接收参数"><a href="#重命名接收参数" class="headerlink" title="重命名接收参数"></a>重命名接收参数</h2><p>当请求参数名与方法参数名不一致时。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 自定义方法参数名-当请求参数名与方法参数名不一致时</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> u_name 用户名</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> u_pwd 密码</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@RequestMapping(value = &quot;/addByDifName&quot;, method = RequestMethod.GET, produces = &#123;&quot;application/json;charset=UTF-8&quot;&#125;)</span><br><span class="hljs-meta">@ResponseBody</span><br><span class="hljs-keyword">public</span> String <span class="hljs-title function_">addUserByDifName</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(&quot;name&quot;)</span> String u_name, <span class="hljs-meta">@RequestParam(&quot;pwd&quot;)</span>String u_pwd)</span>&#123;<br>    logger.debug(<span class="hljs-string">&quot;name:&quot;</span> + u_name + <span class="hljs-string">&quot;,pwd:&quot;</span> + u_pwd);<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;name:&quot;</span> + u_name + <span class="hljs-string">&quot;,pwd:&quot;</span> + u_pwd;<br>&#125;<br></code></pre></td></tr></table></figure><p>请求方式：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs curl">curl http://localhost:8080/sty/param/addUserByDifName.action?name=张三&amp;pwd=123456<br></code></pre></td></tr></table></figure><h2 id="HttpServletRequest接收参数"><a href="#HttpServletRequest接收参数" class="headerlink" title="HttpServletRequest接收参数"></a>HttpServletRequest接收参数</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"> * 通过HttpServletRequest接收</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> request</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment"></span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-meta">@RequestMapping(value = &quot;/addByHttpServletRequest&quot;, method = RequestMethod.GET, produces = &#123;&quot;application/json;charset=UTF-8&quot;&#125;)</span><br><br><span class="hljs-meta">@ResponseBody</span><br><br><span class="hljs-keyword">public</span> String <span class="hljs-title function_">addUserByHttpServletRequest</span><span class="hljs-params">(HttpServletRequest request)</span>&#123;<br><br>    <span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> request.getParameter(<span class="hljs-string">&quot;name&quot;</span>);<br><br>    <span class="hljs-type">String</span> <span class="hljs-variable">pwd</span> <span class="hljs-operator">=</span> request.getParameter(<span class="hljs-string">&quot;pwd&quot;</span>);<br><br>    logger.debug(<span class="hljs-string">&quot;name:&quot;</span> + name + <span class="hljs-string">&quot;,pwd:&quot;</span> + pwd);<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;name:&quot;</span> + name + <span class="hljs-string">&quot;,pwd:&quot;</span> + pwd;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>请求方式：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs curl">curl http://localhost:8080/sty/param/addByHttpServletRequest.action?name=张三&amp;pwd=123456<br></code></pre></td></tr></table></figure><h2 id="PathVariable接收路径中的参数"><a href="#PathVariable接收路径中的参数" class="headerlink" title="@PathVariable接收路径中的参数"></a>@PathVariable接收路径中的参数</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"> * 通过<span class="hljs-doctag">@PathVariable</span>获取路径中的参数 </span><br><span class="hljs-comment"></span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> name 用户名</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> pwd 密码</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment"></span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-meta">@RequestMapping(value = &quot;/add/&#123;name&#125;/&#123;pwd&#125;&quot;, method = RequestMethod.GET, produces = &#123;&quot;application/json;charset=UTF-8&quot;&#125;)</span><br><br><span class="hljs-meta">@ResponseBody</span><br><br><span class="hljs-keyword">public</span> String <span class="hljs-title function_">addUserByPathVariable</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> String name, <span class="hljs-meta">@PathVariable</span> String pwd)</span>&#123;<br><br>    logger.debug(<span class="hljs-string">&quot;name:&quot;</span> + name + <span class="hljs-string">&quot;,pwd:&quot;</span> + pwd);<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;name:&quot;</span> + name + <span class="hljs-string">&quot;,pwd:&quot;</span> + pwd;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>请求方式：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs curl">curl http://localhost:8080/sty/param/add/zhangsan/123456.action<br></code></pre></td></tr></table></figure><h2 id="RequestBody接收对象"><a href="#RequestBody接收对象" class="headerlink" title="@RequestBody接收对象"></a>@RequestBody接收对象</h2><h3 id="接收JSON对象"><a href="#接收JSON对象" class="headerlink" title="接收JSON对象"></a>接收JSON对象</h3><p>需要依赖jackson-databind.jar，并设置json格式的支持。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"> * RequestBody-JSON 对象方式</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> user</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment"></span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-meta">@RequestMapping(value = &quot;/addByObjectJSON&quot;, produces = &#123;&quot;application/json;charset=UTF-8&quot;&#125;)</span><br><br><span class="hljs-meta">@ResponseBody</span><br><br><span class="hljs-keyword">public</span> String <span class="hljs-title function_">addUserByObjectJSON</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> User user)</span>&#123;<br><br>    logger.debug(<span class="hljs-string">&quot;name:&quot;</span> + user.getName() + <span class="hljs-string">&quot;,pwd:&quot;</span> + user.getPwd());<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;name:&quot;</span> + user.getName() + <span class="hljs-string">&quot;,pwd:&quot;</span> + user.getPwd();<br><br>&#125;<br></code></pre></td></tr></table></figure><p>请求方式：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs curl">curl --request POST \<br>  --url http://localhost:8080/sty/param/addByObjectJSON.action \<br>  --header &#x27;content-type: application/json&#x27; \<br>  --data &#x27;&#123;<br>  &quot;name&quot;: &quot;zhangsan&quot;,<br>  &quot;pwd&quot;: &quot;123456&quot;<br>&#125;&#x27;<br></code></pre></td></tr></table></figure><h3 id="接收JSON数组"><a href="#接收JSON数组" class="headerlink" title="接收JSON数组"></a>接收JSON数组</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * RequestBody-JSON List对象方式</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> users</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@RequestMapping(value = &quot;/addByListJSON&quot;, produces = &#123;&quot;application/json;charset=UTF-8&quot;&#125;)</span><br><span class="hljs-meta">@ResponseBody</span><br><span class="hljs-keyword">public</span> String <span class="hljs-title function_">addUsersByListJSON</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> List&lt;User&gt; users)</span>&#123;<br>    <span class="hljs-type">StringBuilder</span> <span class="hljs-variable">sb</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>(<span class="hljs-string">&quot;&#123;&quot;</span>);<br>    <span class="hljs-keyword">if</span>(<span class="hljs-literal">null</span> != users)&#123;<br>        <span class="hljs-keyword">for</span>(User user : users)&#123;<br>            sb.append(<span class="hljs-string">&quot;&#123;&quot;</span> + <span class="hljs-string">&quot;name:&quot;</span> + user.getName() + <span class="hljs-string">&quot;,pwd:&quot;</span> + user.getPwd() + <span class="hljs-string">&quot;&#125;&quot;</span>);<br>        &#125;<br>    &#125;<br>    sb.append(<span class="hljs-string">&quot;&#125;&quot;</span>);<br>    logger.debug(sb.toString());<br>    <span class="hljs-keyword">return</span> sb.toString();<br>&#125;<br></code></pre></td></tr></table></figure><p>请求方式：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs curl">curl --request POST \<br>  --url http://localhost:8080/sty/param/addByObjectJSON.action \<br>  --header &#x27;content-type: application/json&#x27; \<br>  --data &#x27;[<br>  &#123;<br>    &quot;name&quot;: &quot;zhangsan&quot;,<br>    &quot;pwd&quot;: &quot;123456&quot;<br>  &#125;,<br>  &#123;<br>    &quot;name&quot;: &quot;lisi&quot;,<br>    &quot;pwd&quot;: &quot;654321&quot;<br>  &#125;<br>]&#x27;<br></code></pre></td></tr></table></figure><h3 id="接收Map对象"><a href="#接收Map对象" class="headerlink" title="接收Map对象"></a>接收Map对象</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"> * RequestBody-JSON Map对象方式</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> users</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment"></span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-meta">@RequestMapping(value = &quot;/addByMapJSON&quot;, produces = &#123;&quot;application/json;charset=UTF-8&quot;&#125;)</span><br><br><span class="hljs-meta">@ResponseBody</span><br><br><span class="hljs-keyword">public</span> String <span class="hljs-title function_">addUsersByMapJSON</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> Map&lt;String, User&gt; users)</span>&#123;<br><br>    <span class="hljs-type">StringBuilder</span> <span class="hljs-variable">sb</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>(<span class="hljs-string">&quot;&#123;&quot;</span>);<br><br>    <span class="hljs-keyword">if</span>(<span class="hljs-literal">null</span> != users)&#123;<br><br>        <span class="hljs-type">Iterator</span> <span class="hljs-variable">it</span> <span class="hljs-operator">=</span> users.keySet().iterator();<br><br>        <span class="hljs-keyword">while</span>(it.hasNext())&#123;<br><br>            <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> users.get(it.next());<br><br>            sb.append(<span class="hljs-string">&quot;&#123;&quot;</span> + <span class="hljs-string">&quot;name:&quot;</span> + user.getName() + <span class="hljs-string">&quot;,pwd:&quot;</span> + user.getPwd() + <span class="hljs-string">&quot;&#125;&quot;</span>);<br><br>        &#125;<br><br>    &#125;<br><br>    sb.append(<span class="hljs-string">&quot;&#125;&quot;</span>);<br><br>    logger.debug(sb.toString());<br><br>    <span class="hljs-keyword">return</span> sb.toString();<br><br>&#125;<br></code></pre></td></tr></table></figure><p>请求方式：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs curl">curl --request POST \<br>  --url http://localhost:8080/sty/param/addByObjectJSON.action \<br>  --header &#x27;content-type: application/json&#x27; \<br>  --data &#x27;[<br>  &#123;<br>    &quot;name&quot;: &quot;zhangsan&quot;,<br>    &quot;pwd&quot;: &quot;123456&quot;<br>  &#125;,<br>  &#123;<br>    &quot;name&quot;: &quot;lisi&quot;,<br>    &quot;pwd&quot;: &quot;654321&quot;<br>  &#125;<br>]&#x27;<br></code></pre></td></tr></table></figure><p>（完）</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SpringMVC</tag>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>mysql</title>
    <link href="/blog/2019/03/mysql.html"/>
    <url>/blog/2019/03/mysql.html</url>
    
    <content type="html"><![CDATA[<p>三大范式<br>    1NF： 每列字段的原子性的，不可再拆分（比如省市区）<br>    2NF：满足1NF,表中的字段必须完全依赖于全部主键而非部分主键。<br>    3NF：满足2NF,非主键外的所有字段必须互不依赖</p><p>但是开发中一般会进行字段冗余。减少表关联，降低开发难度。</p><p>乐观锁和悲观锁</p><p>mysql服务层结构<br>    查询解析器<br>    查询优化器<br>    缓存</p><p>myql的索引<br>    innodb:<br>    myisam</p><p>mysql性能优化<br>注意：不设置优化器最大容量的话，可能会导致优化器返回的结果不全。</p><p>mysql为什么快<br>    mysql底层数据结构b+tree<br>    查到的节点数据是放到内存中的，这个速度是非常快的。</p><p>为什么不用b树，把b树的度设置的越大来降低树的高度<br>    因为内存和硬盘的数据交换有个存储位，称为页，1页的大小为4k.一次交互只能是页的整数倍，页根据机器是有上限的。<br>    mysql底层将一个数据节点的大小默认设置为4页，也就是16k<br>    加入一次只能读1页，也就是16k.<br>    度不是无上限的。</p><p>对比其他数据结构<br>    二叉数（速度慢，单节点只有2个分叉）<br>    红黑数（平衡二叉数）<br>    hash<br>    B-Tree<br>    B+Tree(B-Tree变种)</p><p>InnoDB表必须有主键，并且推荐使用整型的自增主键<br>    满足MySQL的索引数据结构B+树的特性，必须要有索引作为主键<br>    整型占有的磁盘空间或内存空间相比字符串更少<br>    整型比较比字符串比较更快速，字符串比较是先转换为ASCII码，然后再比较的。<br>    B+树本质是多路多叉树<br>    磁盘写数据快满了，是分配一页4k的数据，自增在写磁盘的时候容易分配到同一个磁盘扇区，范围查找更快</p><p>非主键索引叶子节点存储的是主键值<br>    节省内存（一致性和节省存储空间）</p><p>myisam（非聚集）索引<br>    表级锁<br>    不支持事务<br>    全文类型索引<br>    不支持外键<br>    叶子节点保存是数据指针（内存地址）<br>    MyISAM索引文件和数据文件是分离的<br>    主键和非主键索引之间，叶子节点保存的数据没有区别。<br>    叶字节点数据保存的是数据指针，所以还多一次查找数据的步骤。<br>    磁盘文件<br>        表结构文件→test_myisam_frm<br>        数据结构文件↔test_myisam_MYD<br>        索引文件↔test_myisam_MYI</p><p>innodb(聚集)索引<br>    行级锁<br>    支持事务<br>    不支持全文索引<br>    支持外键<br>    叶子节点保存是数据本身而不是数据指针。<br>    主键保存的是完整的数据和主键索引<br>    叶子节点保存的是主键值。避免数据重复和方便维护更新。<br>    表数据文件本身就是按B+Tree组织的一个索引结构文件(ibd文件合并了索引和数据)<br>    聚集索引-叶节点包含了完整的数据记录<br>    数据文件本身就是索引文件(索引和数据保存在同一文件）</p><p>mysql单表行上限<br>    myisam<br>    InnoDB引擎</p><p>数据库性能<br>    单机<br>    集群<br>update可以用索引<br>insert无法用索引的<br>join应该用小表驱动大表，不要超过3张表以上的join,join的操作不能用做跨库的join</p>]]></content>
    
    
    <categories>
      
      <category>生活</category>
      
      <category>经验</category>
      
    </categories>
    
    
    <tags>
      
      <tag>技巧</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>软件测试中常见术语和含义</title>
    <link href="/blog/2019/03/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%B8%B8%E8%A7%81%E6%9C%AF%E8%AF%AD%E5%92%8C%E5%90%AB%E4%B9%89.html"/>
    <url>/blog/2019/03/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%B8%B8%E8%A7%81%E6%9C%AF%E8%AF%AD%E5%92%8C%E5%90%AB%E4%B9%89.html</url>
    
    <content type="html"><![CDATA[<h2 id="性能测试"><a href="#性能测试" class="headerlink" title="性能测试"></a>性能测试</h2><table><thead><tr><th>术语</th><th>含义</th></tr></thead><tbody><tr><td>TPS（&#x2F;s）</td><td>每秒事务数，在每秒时间内系统可以处理完毕的事务数</td></tr><tr><td>RT（ms）</td><td>响应时间，单位：毫秒</td></tr><tr><td>ART（ms）</td><td>平均响应时间，系统处理事务的平均响应时间，单位：毫秒</td></tr><tr><td>MaxRT（ms）</td><td>最大响应时间，系统处理事务的最大响应时间，单位：毫秒</td></tr><tr><td>MinRT（ms）</td><td>最小响应时间，系统处理事务的最小响应时间，单位：毫秒</td></tr><tr><td>TP99（ms）</td><td>响应时间在99分位时的响应时间，单位：毫秒</td></tr><tr><td>TP999（ms）</td><td>响应时间在99.9分位时的响应时间，单位：毫秒</td></tr><tr><td>Succ（%）</td><td>系统处理请求的成功率，单位：%</td></tr><tr><td>开放模型</td><td>控制用户到达率，系统达到瓶颈时，请求按预设持续注入</td></tr><tr><td>RPS模式</td><td>以吞吐量为目标，在施压过程中依据RT自适应调整并发量</td></tr></tbody></table><h2 id="蓝绿发布"><a href="#蓝绿发布" class="headerlink" title="蓝绿发布"></a>蓝绿发布</h2><p>绿色是生产的，蓝色是测试用的（当测试环境具备生产上线时），通过反向代理来切换，速度很快。</p><p>优点：升级切换和回退速度非常的快</p><p>不足：全量切换，需要2倍的机器资源</p><h2 id="金丝雀发布（灰度发布）"><a href="#金丝雀发布（灰度发布）" class="headerlink" title="金丝雀发布（灰度发布）"></a>金丝雀发布（灰度发布）</h2><p>金丝雀发布是指在生产环境中逐步推出新版本应用程序，只在一小部分用户或流量中使用该版本，并根据反馈逐步扩大规模，最终完全替换旧版本。金丝雀发布允许快速检测新版本与旧版本之间是否存在兼容性问题、性能问题或其他问题，并减轻了在实施全新发布时可能遭受的损失。</p><h2 id="session、token、cookie区别"><a href="#session、token、cookie区别" class="headerlink" title="session、token、cookie区别"></a>session、token、cookie区别</h2><p>都属于登入状态的一种实现方式，他们的特征就是有状态，会占用服务端资源。<br>对应无状态的就是JWT，仅占用客户端的资源。有状态的好处就是可以实现续命，踢人的效果。这是JWT无状态做不到的。</p><ul><li><p>token和jwt服务器不需要保存登入信息，session需要将登录记录信息存储在服务器；</p></li><li><p>token的返回，没有规定要放在cookie中，开发可任意定制。比如请求体的json中或请求头中。</p></li><li><p>token通常具有自证功能，服务器一般不需要存储用户登录状态信息,去中心化</p></li><li><p>session需要将登录记录信息存储在服务器,中心化存储，服务器挂了，session信息可能丢失</p></li></ul><h3 id="session的校验流程"><a href="#session的校验流程" class="headerlink" title="session的校验流程"></a>session的校验流程</h3><ol><li>提交用户名和密码，后端验证通过，代表登录成功。会保留登入信息。</li><li>然后创建在服务器保存登录用户信息，称之为session数据</li><li>并将sessionID和value以键值对的形式响应给客户端，登录后的每次请求将携带cookie</li><li>服务器提取cookie中的sessionid和后端保存的信息进行比对</li><li>app和小程序不能直接使用cookie，所以移动端更推荐使用token</li></ol><h3 id="token的校验流程"><a href="#token的校验流程" class="headerlink" title="token的校验流程"></a>token的校验流程</h3><ol><li>相对cookie,可用做客户端防抖，幂等校验。</li><li>提交用户名和密码，后端验证通过，代表登录成功。无需保存登入信息。</li><li>生成令牌（特殊的字符串），响应给客户端。</li><li>登录后的每次请求将携带token，服务器检查token合法性。</li><li>token本身-自带防伪标记-token由客户端保存</li></ol><h2 id="http和https的区别"><a href="#http和https的区别" class="headerlink" title="http和https的区别"></a>http和https的区别</h2><ol><li>https是http的安全版，https是由ssl+http协议构建的可进行加密传输、身份认证的网络协议。</li><li>默认端口不同，http默认端口是80,https默认端口是443。</li><li>http是明文传输，https是附带有安全性的ssl加密传输协议。</li><li>https需要到ca申请证书，需要一定费用。</li><li>htps握手阶段比较费时，对网站响应速度有影响。</li></ol><h2 id="前后端问题定位"><a href="#前后端问题定位" class="headerlink" title="前后端问题定位"></a>前后端问题定位</h2><ul><li>看有没有调接口<ul><li>没调接口是前端的问题</li></ul></li><li>传参是否正确<ul><li>传参错误导致的是前端的bug</li><li>传参正确，响应结果错误，后端的bug</li></ul></li><li>传参和响应都正确，页面错误<ul><li>前端的bug</li></ul></li></ul><h2 id="稳定性测试"><a href="#稳定性测试" class="headerlink" title="稳定性测试"></a>稳定性测试</h2><p>先有负载，再有稳定<br>比如负载是500瓶颈，再多系统就下滑了。<br>以500瓶颈的量去跑稳定性，跑个5小时，或者8小时。稳定性就是看它的健康性。<br>稳定性是不增加人数的，是长期稳定值的长时间测试。</p><p>（完）</p><p><strong>参考</strong></p><ul><li><a href="https://mp.weixin.qq.com/s?__biz=MzIzOTU0NTQ0MA==&mid=2247491204&idx=1&sn=db790a37e61a1c568b7ffef0354b1dc6&chksm=e929238bde5eaa9d1027482d6a36b1c6600220640f086fa79124ab9366f97b6e31a7d4e3fbfe&token=608060273&lang=zh_CN&scene=21">阿里研究员：测试稳定性三板斧，我怎么用？</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>软件测试</category>
      
    </categories>
    
    
    <tags>
      
      <tag>软件测试</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>技术架构中为什么要使用消息队列</title>
    <link href="/blog/2019/03/%E6%8A%80%E6%9C%AF%E6%9E%B6%E6%9E%84%E4%B8%AD%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E4%BD%BF%E7%94%A8%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97.html"/>
    <url>/blog/2019/03/%E6%8A%80%E6%9C%AF%E6%9E%B6%E6%9E%84%E4%B8%AD%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E4%BD%BF%E7%94%A8%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97.html</url>
    
    <content type="html"><![CDATA[<h2 id="为什么要使用MQ"><a href="#为什么要使用MQ" class="headerlink" title="为什么要使用MQ"></a>为什么要使用MQ</h2><h3 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h3><ul><li>解耦</li><li>异步</li><li>削峰</li></ul><h4 id="解耦"><a href="#解耦" class="headerlink" title="解耦"></a>解耦</h4><p><img src="/blog/./assets/EY4H6BIAQ4.png" alt="po_bhabgicahgihfa"></p><h4 id="异步"><a href="#异步" class="headerlink" title="异步"></a>异步</h4><p><img src="/blog/./assets/YI4X6BIA5A.png" alt="po_bhabgichdfehfa"></p><h4 id="削峰"><a href="#削峰" class="headerlink" title="削峰"></a>削峰</h4><p><img src="/blog/./assets/IA5X6BIBG4.png" alt="po_bhabgidbcfadda"></p><h3 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h3><h4 id="系统可用性降低"><a href="#系统可用性降低" class="headerlink" title="系统可用性降低"></a>系统可用性降低</h4><p>MQ 挂了</p><h4 id="系统复杂度提高"><a href="#系统复杂度提高" class="headerlink" title="系统复杂度提高"></a>系统复杂度提高</h4><p>重复消费</p><h4 id="一致性问题"><a href="#一致性问题" class="headerlink" title="一致性问题"></a>一致性问题</h4><p>BD系统成功，C系统写失败。即存在事务问题。</p><p>（完）</p>]]></content>
    
    
    <categories>
      
      <category>工作</category>
      
      <category>技术架构</category>
      
    </categories>
    
    
    <tags>
      
      <tag>消息队列</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>《奇迹男孩》观后感</title>
    <link href="/blog/2018/11/%E3%80%8A%E5%A5%87%E8%BF%B9%E7%94%B7%E5%AD%A9%E3%80%8B%E8%A7%82%E5%90%8E%E6%84%9F.html"/>
    <url>/blog/2018/11/%E3%80%8A%E5%A5%87%E8%BF%B9%E7%94%B7%E5%AD%A9%E3%80%8B%E8%A7%82%E5%90%8E%E6%84%9F.html</url>
    
    <content type="html"><![CDATA[<h2 id="奇妙"><a href="#奇妙" class="headerlink" title="奇妙"></a>奇妙</h2><p>影片开场以太空为景切入生活，是一个小男孩戴着航天帽在跳跃，被这天真和活泼的小男孩所吸引着。</p><p>这不就是我们小时候天真的样子吗？各种模仿和好奇尝试。小男孩被子上的宇航服图案，当盖上那一刻仿佛和小男孩合为一体了。</p><h2 id="丑陋"><a href="#丑陋" class="headerlink" title="丑陋"></a>丑陋</h2><p>跟随着影片走进小男孩的生活中，小男孩出生就面部毁容了。医生作了二十多次手术才将小男孩抢救过来，但是面部被塑造成“完美”的形态。</p><p>小男孩的名字是奥吉，“丑陋”的面容让他从小在家由母亲辅导功课和学习。直到五年级才做为新生第一次去学校上课。</p><p>先天的缺陷让父母把大多数的经历都放在了奥吉身上，母亲甚至为奥吉放弃了自己的梦想。</p><p>去学校上课，由于自己先天面貌的缺陷，学校同学都不愿意和奥吉左朋友甚至霸凌奥吉。</p><p>奥吉也感到非常委屈和难过，因为自己的先天缺陷而受尽了同龄人不公平的对待。</p><h2 id="善良"><a href="#善良" class="headerlink" title="善良"></a>善良</h2><p>在奥吉上课时，老师上课黑板上写了一句箴言。</p><blockquote><p>如果在正确和善良之前必选其一，请选择善良。</p></blockquote><p>或许上帝为你关上一扇门，说不定会为你打开一扇窗。</p><p>慢慢地，奥吉用自己的善良和真诚让身边的同学对他的看法发生了改变， 并且愿意和奥吉一起做朋友。</p><p>奥吉也慢慢打开了心扉变得快乐起来。</p><h2 id="缩影"><a href="#缩影" class="headerlink" title="缩影"></a>缩影</h2><p>这部电影讲述了奥吉和小伙伴之间的故事。也可以映射到这个社会上，每个人之间都是差异化的。</p><p>我们有的时候会用自身的优势去比对那些没有我们好的人，从而让自身有一种优越感。</p><p>正如奥吉课堂上的箴言一样，如果我们都选择善良，彼此之间或许都可以温柔以待。</p><p>（本文完）</p>]]></content>
    
    
    <categories>
      
      <category>生活</category>
      
      <category>娱乐</category>
      
    </categories>
    
    
    <tags>
      
      <tag>电影</tag>
      
      <tag>观后感</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>北京阳台山游记</title>
    <link href="/blog/2018/10/%E5%8C%97%E4%BA%AC%E9%98%B3%E5%8F%B0%E5%B1%B1%E6%B8%B8%E8%AE%B0.html"/>
    <url>/blog/2018/10/%E5%8C%97%E4%BA%AC%E9%98%B3%E5%8F%B0%E5%B1%B1%E6%B8%B8%E8%AE%B0.html</url>
    
    <content type="html"><![CDATA[<h2 id="出发"><a href="#出发" class="headerlink" title="出发"></a>出发</h2><p>北京的10月中旬和11月上旬正是看香山红叶的季节，听同事说红叶红的不是那么透。</p><p>加上住的地方离香山比较近，想下周再去一览香山红叶。这次先找来个相对比较近的阳台山。周六中午出门，马路是通向香山的，来看香山红叶的人非常多，路上非常的堵，公交停留好久才开出一段距离，很是磨练人们的耐心，继而转了三趟公交来到目的地。</p><p>阳台山离公交站大概有1.5公里，跟随着弯曲的道路走向景点，一路上可以听见农家在吆喝卖着自家的土特产。</p><p>马上走到一个丁字路口，左边通往阳台山和鹫峰国家森林公园，右边也通往阳台山，我选择了走左边的道路。</p><p>当时想用一个下午时间把这两个地方都走完，后来才发现我这个想法太单纯了。</p><h2 id="登山"><a href="#登山" class="headerlink" title="登山"></a>登山</h2><p>走进入口，来阳台山的人对比去香山的人，显得冷清多了。开始登山后看了登山地图，路途中一直担心自己是否可以爬到山顶，毕竟到景点时已经下午1点30多了。</p><p>查阅资料时发现阳台山有三条路可以上山，我选择走的是古道，据说当初是给慈禧修建的。走着就上了一个小平台，景点里也有农家在卖野果和农家特产。</p><p>一路爬着感觉并不是累，道路是石头铺设的虽然不整齐，但是台阶相对缓和。一路快上直到金山寺庙，在附近拍得一些秋黄的银杏叶，在阳光的照射下显得十分耀眼。沿途路上行人也不多，零零散散可以遇到一些从山顶往回走的。路上的石阶上散落着凋零的落叶。接着就爬到一个小上坡了，在小山坡可以遥望北京城。</p><p>爬到快三点的时候，发现距离终点还有一段距离。冬天的夜色总是降临的比较快。心想爬到4点就下山。一路向前，道路曲折而悠长，这次来时也没有准备充足，带足了水源可并没有带能量食品，爬山非常消耗能量，一边是饥饿，一边是体能逐渐下滑。</p><p>这时只能发挥意志力的作用了，抱着不到山顶不死心的念头坚持爬着。又继续爬了半个多小时，可以逐渐看到一些小屋子了，于是加快步伐爬了上去。发现是妙儿洼茶棚遗址，继而爬了不多远，眼前突然明朗开阔了起来，万物尽收眼底。</p><p>这里几个小卖部，饥肠辘辘的我在这里要了一碗泡面。山上面的风真是好大，虽然在一个小屋子里，不过风刮进来可真是刺骨的冷。虽然是顶着寒风吃泡面，此时就感觉在品尝人间美味。 后面询问了大妈上距离登顶还需要多久，一打听还要1个半小时，盘算了下继续登顶的话天就黑了，天黑再下山就非常危险。</p><p>在吃完泡面后就准备下山了。</p><h2 id="下山"><a href="#下山" class="headerlink" title="下山"></a>下山</h2><p>趁着太阳快落山那会，拍了一些上山并没有拍的一些风景作为这次留念。</p><p>回来路上有些堵，公交车上也非常拥挤，坚持着腰酸腿疼一路站回来。</p><p>到住处后吃了些东西，然后泡了个热水脚，不多久就入睡了。</p><h2 id=""><a href="#" class="headerlink" title=""></a></h2>]]></content>
    
    
    <categories>
      
      <category>生活</category>
      
      <category>经验</category>
      
    </categories>
    
    
    <tags>
      
      <tag>生活</tag>
      
      <tag>游记</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>并发编程下存在的问题</title>
    <link href="/blog/2017/11/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E4%B8%8B%E5%AD%98%E5%9C%A8%E7%9A%84%E9%97%AE%E9%A2%98.html"/>
    <url>/blog/2017/11/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E4%B8%8B%E5%AD%98%E5%9C%A8%E7%9A%84%E9%97%AE%E9%A2%98.html</url>
    
    <content type="html"><![CDATA[<h2 id="Java内存模型"><a href="#Java内存模型" class="headerlink" title="Java内存模型"></a>Java内存模型</h2><p>Java内存模型（Java Memory Model，简称JMM）是Java编程语言中关于多线程并发编程的一个重要概念。JMM规定了多线程程序中，线程如何与内存交互，以确保多线程程序的正确性和可移植性。它定义了一组规则和语义，用于确保线程之间的协作和共享数据的一致性。</p><p>以下是Java内存模型的一些关键概念和规则：</p><ol><li><p><strong>主内存（Main Memory）</strong>：主内存是所有线程共享的内存区域，包含了共享变量和对象实例。主内存中的数据可以被多个线程同时访问。</p></li><li><p><strong>工作内存（Working Memory）</strong>：每个线程都有自己的工作内存，用于存储线程私有的局部变量和线程栈。线程在执行时会从主内存中读取数据到工作内存，然后对数据进行操作，最后再写回主内存。</p></li><li><p><strong>可见性（Visibility）</strong>：JMM规定了当一个线程写入主内存中的数据时，其他线程应该能够立即看到这个修改。这是通过使用volatile关键字、synchronized关键字或其他同步机制来实现的。</p></li><li><p><strong>原子性（Atomicity）</strong>：JMM确保一些特定操作的原子性，这意味着它们不会被其他线程中断。例如，通过synchronized关键字或java.util.concurrent包中的原子类可以实现原子性操作。</p></li><li><p><strong>有序性（Ordering）</strong>：JMM规定了操作执行的顺序，以确保多线程程序的执行顺序与程序员的预期一致。这包括指令重排的规则，以及通过同步机制来确保操作的有序性。</p></li></ol><pre><code class=" mermaid">graph并发问题--&gt;可见性--硬件--&gt;CPU缓存并发问题--&gt;原子性--操作系统--&gt;线程切换并发问题--&gt;有序性--编程语言--&gt;编译器优化</code></pre><h2 id="可见性和原子性"><a href="#可见性和原子性" class="headerlink" title="可见性和原子性"></a>可见性和原子性</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> count;<br>    <br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Thread1</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Thread</span> &#123;<br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000</span>; i++) &#123;<br>                count++;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> InterruptedException &#123;<br>        <span class="hljs-type">Thread1</span> <span class="hljs-variable">t1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread1</span>();<br>        <span class="hljs-type">Thread1</span> <span class="hljs-variable">t2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread1</span>();<br>        t1.start();<br>        t2.start();<br>        t1.join();<br>        t2.join();<br>        System.out.println(count);<br>    &#125;<br>&#125; <br></code></pre></td></tr></table></figure><p>上面的代码存在以下问题：</p><ol><li><strong>可见性问题：</strong> 可见性问题指的是一个线程对共享变量的修改在其他线程中不可见。在这段代码中，<code>count</code>是一个共享的静态变量，同时被<code>t1</code>和<code>t2</code>线程访问。由于缺乏适当的同步机制（如<code>synchronized</code>或<code>volatile</code>关键字），一个线程对<code>count</code>的修改可能不会被另一个线程立即看到。这可能导致<code>count</code>的值不是2000，因为两个线程并发地递增<code>count</code>，但它们的修改可能不会被正确地同步。</li></ol><pre><code class=" mermaid">graph可见性问题--&gt;单核CPU--&gt;所有线程都在一个CPU上执行--&gt;通常不存在可见性问题可见性问题--&gt;多核CPU--&gt;多个线程在不同的CPU上执行--&gt;存在可见性问题</code></pre><p>使用<code>synchronized</code>块，确保一个线程对<code>count</code>的修改在退出同步块时对其他线程是可见的。这消除了可见性问题。<code>synchronized</code>同时解决了有序性和原子性。</p><p>优化后的代码：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> count;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">Object</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Thread1</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Thread</span> &#123;<br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000</span>; i++) &#123;<br>                <span class="hljs-keyword">synchronized</span> (lock) &#123;<br>                    count++;<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> InterruptedException &#123;<br>        <span class="hljs-type">Thread1</span> <span class="hljs-variable">t1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread1</span>();<br>        <span class="hljs-type">Thread1</span> <span class="hljs-variable">t2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread1</span>();<br>        t1.start();<br>        t2.start();<br>        t1.join();<br>        t2.join();<br>        System.out.println(count);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ol start="2"><li><strong>原子性问题：</strong> 原子性问题指的是一个操作是否在多线程环境下是不可分割的。在这段代码中，<code>count++</code>操作不是原子操作，它包括读取<code>count</code>的当前值、递增该值，然后将结果写回<code>count</code>。在多线程环境中，这个操作不是原子的，因此多个线程可以在同一时刻读取和修改<code>count</code>，导致竞争条件和不正确的结果。</li></ol><pre><code class=" mermaid">sequenceDiagram    participant 线程A    participant 线程B    线程A--&gt;线程A: count=0加载到寄存器中    线程A--&gt;&gt;线程B: 线程切换    线程B--&gt;线程B: count=0加载到寄存器中    线程B--&gt;线程B: count+1=1    线程B--&gt;线程B: count=1写入内存    线程B--&gt;&gt;线程A: 线程切换    线程A--&gt;线程A: count+1=1    线程A--&gt;线程A: count=1写入内存</code></pre><p>使用AtomicInteger类和incrementAndGet方法解决原子性问题，同时 <code>AtomicInteger</code> 使用内存屏障等机制来保证可见性和通过使用硬件级别的原子性指令来保证原子性和有序性。</p><p>优化后的代码：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.concurrent.atomic.AtomicInteger;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">AtomicInteger</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicInteger</span>(<span class="hljs-number">0</span>);<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Thread1</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Thread</span> &#123;<br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000</span>; i++) &#123;<br>                count.incrementAndGet();<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> InterruptedException &#123;<br>        <span class="hljs-type">Thread1</span> <span class="hljs-variable">t1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread1</span>();<br>        <span class="hljs-type">Thread1</span> <span class="hljs-variable">t2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread1</span>();<br>        t1.start();<br>        t2.start();<br>        t1.join();<br>        t2.join();<br>        System.out.println(count.get());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="有序性和可见性"><a href="#有序性和可见性" class="headerlink" title="有序性和可见性"></a>有序性和可见性</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Singleton</span> &#123;<br>    <span class="hljs-keyword">static</span> Singleton instance;<br><br>    <span class="hljs-keyword">static</span> Singleton <span class="hljs-title function_">getInstance</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">if</span> (instance == <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">synchronized</span> (Singleton.class) &#123;<br>                <span class="hljs-keyword">if</span> (instance == <span class="hljs-literal">null</span>) &#123;<br>                    instance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Singleton</span>();<br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> instance;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>上面的代码存在的问题：</p><ul><li><strong>可见性问题：</strong> 多个线程可能无法立即看到<code>instance</code>对象的更新。这是因为在没有适当的同步机制（如<code>volatile</code>或<code>synchronized</code>）的情况下，一个线程可能在另一个线程修改<code>instance</code>对象后，仍然看到<code>instance</code>为<code>null</code>，导致不正确的结果。</li><li><strong>有序性问题</strong>：没有适当的同步机制来确保操作的有序性。指令重排可能会导致线程在不正确的顺序下执行某些操作，从而破坏了单例模式的正确性。</li></ul><pre><code class=" mermaid">sequenceDiagram    participant 线程A    participant 线程B    线程A--&gt;线程A: instance == null?    线程A--&gt;线程A: 分配内存M    线程A--&gt;线程A: instance = &amp;M    线程A--&gt;&gt;线程B: 线程切换    线程B--&gt;线程B: instance == null?    线程B--&gt;线程B: 返回了未初始化但分配了内存地址的M    线程B--&gt;线程B: 使用M，报空指针异常    线程B--&gt;&gt;线程A: 线程切换    线程A--&gt;线程A: M = 初始化后的Singleton对象</code></pre><p><code>volatile</code> 保证一个线程对 <code>volatile</code> 变量的写操作将立即可见于其他线程。同时<code>volatile</code> 也禁止编译器和处理器对 <code>volatile</code> 变量相关的操作进行重排，从而确保操作按照程序中的顺序执行。所以，<code>volatile</code> 不仅确保可见性，还确保了操作的有序性。</p><p>优化后的代码：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Singleton</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">volatile</span> Singleton instance;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-title function_">Singleton</span><span class="hljs-params">()</span> &#123;&#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Singleton <span class="hljs-title function_">getInstance</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">if</span> (instance == <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">synchronized</span> (Singleton.class) &#123;<br>                <span class="hljs-keyword">if</span> (instance == <span class="hljs-literal">null</span>) &#123;<br>                    instance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Singleton</span>();<br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> instance;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>（本文完）</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>并发编程</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>多线程</tag>
      
      <tag>原子性</tag>
      
      <tag>有序性</tag>
      
      <tag>可见性</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Bat脚本速查速用</title>
    <link href="/blog/2011/09/Bat%E8%84%9A%E6%9C%AC%E9%80%9F%E6%9F%A5%E9%80%9F%E7%94%A8.html"/>
    <url>/blog/2011/09/Bat%E8%84%9A%E6%9C%AC%E9%80%9F%E6%9F%A5%E9%80%9F%E7%94%A8.html</url>
    
    <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>bat作为一种轻量级Windows脚本语言,易于入门与使用。</p><p>bat程序是Windows系统内置的批处理文件解释器,用于执行.bat或.cmd命令脚本文件。它起源于DOS时期,随Windows发展被深度集成到系统中。Bat脚本使用简单的命令行语法,可以调用各种Windows系统命令与工具,实现简单的自动化任务。</p><p>bat不需要安装任何软件,直接创建并运行.bat文件即可。其语法简单明了,适合初学者,也能满足轻量级脚本需求。通过组合语句与命令.Bat可以创建矩阵风格动画、启动菜单项目、定时执行任务等小工具。</p><h2 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h2><h3 id="pause-暂停"><a href="#pause-暂停" class="headerlink" title="pause-暂停"></a>pause-暂停</h3><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs gauss"><span class="hljs-meta"># bat脚本执行完后不关闭窗口(按任意键结束)</span><br><span class="hljs-built_in">pause</span><br></code></pre></td></tr></table></figure><h3 id="覆盖重定向"><a href="#覆盖重定向" class="headerlink" title="&gt;-覆盖重定向"></a>&gt;-覆盖重定向</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 覆盖重定向到a.txt</span><br><span class="hljs-built_in">dir</span> &gt; a.txt<br></code></pre></td></tr></table></figure><h3 id="追加重定向"><a href="#追加重定向" class="headerlink" title="&gt;&gt;-追加重定向"></a>&gt;&gt;-追加重定向</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 追加重定向到a.txt</span><br><span class="hljs-built_in">dir</span> &gt;&gt; a.txt<br></code></pre></td></tr></table></figure><h3 id="通配符"><a href="#通配符" class="headerlink" title="*?通配符"></a>*?通配符</h3><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli"><span class="hljs-comment"># 以txt结尾的</span><br>*<span class="hljs-string">.txt</span><br></code></pre></td></tr></table></figure><h3 id="md-创建目录"><a href="#md-创建目录" class="headerlink" title="md-创建目录"></a>md-创建目录</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs css"># 创建 <span class="hljs-selector-tag">a</span> <span class="hljs-selector-tag">b</span> c三个目录<br>md <span class="hljs-selector-tag">a</span> <span class="hljs-selector-tag">b</span> c<br># 创建 &quot;<span class="hljs-selector-tag">a</span> <span class="hljs-selector-tag">b</span> c&quot;一个目录<br>md &quot;<span class="hljs-selector-tag">a</span> <span class="hljs-selector-tag">b</span> c&quot;<br></code></pre></td></tr></table></figure><h3 id="dir-打印目录"><a href="#dir-打印目录" class="headerlink" title="dir-打印目录"></a>dir-打印目录</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 打印当前目录的信息</span><br><span class="hljs-built_in">dir</span><br><span class="hljs-comment"># 打印当前目录名称</span><br><span class="hljs-built_in">dir</span> /b<br><span class="hljs-comment"># 打印当前目录和子文件名</span><br><span class="hljs-built_in">dir</span> /b /s<br></code></pre></td></tr></table></figure><h3 id="REN-重命名"><a href="#REN-重命名" class="headerlink" title="REN-重命名"></a>REN-重命名</h3><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs axapta"><span class="hljs-meta"># 重命名文件</span><br>ren old <span class="hljs-keyword">new</span><br></code></pre></td></tr></table></figure><h3 id="COPY-拷贝命令"><a href="#COPY-拷贝命令" class="headerlink" title="COPY-拷贝命令"></a>COPY-拷贝命令</h3><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-comment"># 拷贝单文件</span><br><span class="hljs-keyword">copy</span><span class="language-bash"> filea <span class="hljs-built_in">dir</span>/fileb</span><br></code></pre></td></tr></table></figure><h3 id="XCOPY-增强拷贝"><a href="#XCOPY-增强拷贝" class="headerlink" title="XCOPY-增强拷贝"></a>XCOPY-增强拷贝</h3><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livescript">xcopy C:<span class="hljs-string">\source</span> D:<span class="hljs-string">\destination</span><br></code></pre></td></tr></table></figure><h3 id="MOVE-移动命令"><a href="#MOVE-移动命令" class="headerlink" title="MOVE-移动命令"></a>MOVE-移动命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">move filea <span class="hljs-built_in">dir</span>/fileb<br></code></pre></td></tr></table></figure><h3 id="DEL-删除命令"><a href="#DEL-删除命令" class="headerlink" title="DEL-删除命令"></a>DEL-删除命令</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs css"># 删除选项 /s 递归删除  /<span class="hljs-selector-tag">q</span> 静默删除<br><span class="hljs-selector-tag">del</span> <span class="hljs-selector-tag">a</span><span class="hljs-selector-class">.txt</span><br></code></pre></td></tr></table></figure><h3 id="Type-查看文件内容"><a href="#Type-查看文件内容" class="headerlink" title="Type-查看文件内容"></a>Type-查看文件内容</h3><figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs elm"><span class="hljs-keyword">type</span> test.txt<br></code></pre></td></tr></table></figure><h2 id="实践"><a href="#实践" class="headerlink" title="实践"></a>实践</h2><h3 id="设置系统代理"><a href="#设置系统代理" class="headerlink" title="设置系统代理"></a>设置系统代理</h3><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile">@echo off<br>set ie_proxy=<span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">1080</span><br>reg <span class="hljs-keyword">add</span><span class="language-bash"> <span class="hljs-string">&quot;HKCU\Software\Microsoft\Windows\CurrentVersion\Internet Settings&quot;</span> /v ProxyEnable /t REG_DWORD /d 1 /f &gt;nul 2&gt;nul</span><br>reg <span class="hljs-keyword">add</span><span class="language-bash"> <span class="hljs-string">&quot;HKCU\Software\Microsoft\Windows\CurrentVersion\Internet Settings&quot;</span> /v ProxyServer /d <span class="hljs-string">&quot;%ie_proxy%&quot;</span> /f &gt;nul 2&gt;nul</span><br>reg <span class="hljs-keyword">add</span><span class="language-bash"> <span class="hljs-string">&quot;HKCU\Software\Microsoft\Windows\CurrentVersion\Internet Settings&quot;</span> /v ProxyOverride /t REG_SZ /d <span class="hljs-string">&quot; </span></span><br>reg <span class="hljs-keyword">add</span><span class="language-bash"><span class="hljs-string"> &quot;</span>HKCU\Software\Microsoft\Windows\CurrentVersion\Internet Settings<span class="hljs-string">&quot; /v &quot;</span>ProxyOverride<span class="hljs-string">&quot; /t REG_SZ /d &quot;</span>10.*.*.*;11.*.*.*;example.com;google.com;maojun.xyz<span class="hljs-string">&quot; /f 1&gt;nul</span></span><br>echo proxy set ok！<br></code></pre></td></tr></table></figure><p>（完）</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>Bat</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Bat</tag>
      
      <tag>Windows</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
